var wx=Object.defineProperty;var vx=(e,i,o)=>i in e?wx(e,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[i]=o;var Kr=(e,i,o)=>(vx(e,typeof i!="symbol"?i+"":i,o),o),up=(e,i,o)=>{if(!i.has(e))throw TypeError("Cannot "+o)};var jt=(e,i,o)=>(up(e,i,"read from private field"),o?o.call(e):i.get(e)),vr=(e,i,o)=>{if(i.has(e))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(e):i.set(e,o)},an=(e,i,o,s)=>(up(e,i,"write to private field"),s?s.call(e,o):i.set(e,o),o);var Rr=(e,i,o)=>(up(e,i,"access private method"),o);function _mergeNamespaces(e,i){for(var o=0;o<i.length;o++){const s=i[o];if(typeof s!="string"&&!Array.isArray(s)){for(const c in s)if(c!=="default"&&!(c in e)){const g=Object.getOwnPropertyDescriptor(s,c);g&&Object.defineProperty(e,c,g.get?g:{enumerable:!0,get:()=>s[c]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))s(c);new MutationObserver(c=>{for(const g of c)if(g.type==="childList")for(const b of g.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&s(b)}).observe(document,{childList:!0,subtree:!0});function o(c){const g={};return c.integrity&&(g.integrity=c.integrity),c.referrerPolicy&&(g.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?g.credentials="include":c.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function s(c){if(c.ep)return;c.ep=!0;const g=o(c);fetch(c.href,g)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var i=e.default;if(typeof i=="function"){var o=function s(){if(this instanceof s){var c=[null];c.push.apply(c,arguments);var g=Function.bind.apply(i,c);return new g}return i.apply(this,arguments)};o.prototype=i.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(s){var c=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(o,s,c.get?c:{enumerable:!0,get:function(){return e[s]}})}),o}var jsxRuntimeExports={},jsxRuntime={get exports(){return jsxRuntimeExports},set exports(e){jsxRuntimeExports=e}},reactJsxRuntime_production_min={},reactExports={},react={get exports(){return reactExports},set exports(e){reactExports=e}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,o){this.props=e,this.context=i,this.refs=D$1,this.updater=o||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,o){this.props=e,this.context=i,this.refs=D$1,this.updater=o||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,o){var s,c={},g=null,b=null;if(i!=null)for(s in i.ref!==void 0&&(b=i.ref),i.key!==void 0&&(g=""+i.key),i)J.call(i,s)&&!L$1.hasOwnProperty(s)&&(c[s]=i[s]);var $=arguments.length-2;if($===1)c.children=o;else if(1<$){for(var _e=Array($),et=0;et<$;et++)_e[et]=arguments[et+2];c.children=_e}if(e&&e.defaultProps)for(s in $=e.defaultProps,$)c[s]===void 0&&(c[s]=$[s]);return{$$typeof:l$1,type:e,key:g,ref:b,props:c,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape$1(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(o){return i[o]})}var P$1=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):i.toString(36)}function R$1(e,i,o,s,c){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var b=!1;if(e===null)b=!0;else switch(g){case"string":case"number":b=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:b=!0}}if(b)return b=e,c=c(b),e=s===""?"."+Q$1(b,0):s,I$1(c)?(o="",e!=null&&(o=e.replace(P$1,"$&/")+"/"),R$1(c,i,o,"",function(et){return et})):c!=null&&(O$1(c)&&(c=N$1(c,o+(!c.key||b&&b.key===c.key?"":(""+c.key).replace(P$1,"$&/")+"/")+e)),i.push(c)),1;if(b=0,s=s===""?".":s+":",I$1(e))for(var $=0;$<e.length;$++){g=e[$];var _e=s+Q$1(g,$);b+=R$1(g,i,o,_e,c)}else if(_e=A$1(e),typeof _e=="function")for(e=_e.call(e),$=0;!(g=e.next()).done;)g=g.value,_e=s+Q$1(g,$++),b+=R$1(g,i,o,_e,c);else if(g==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return b}function S$1(e,i,o){if(e==null)return e;var s=[],c=0;return R$1(e,s,"","",function(g){return i.call(o,g,c++)}),s}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(o){(e._status===0||e._status===-1)&&(e._status=1,e._result=o)},function(o){(e._status===0||e._status===-1)&&(e._status=2,e._result=o)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function(e,i,o){S$1(e,function(){i.apply(this,arguments)},o)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(e,i,o){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=C$1({},e.props),c=e.key,g=e.ref,b=e._owner;if(i!=null){if(i.ref!==void 0&&(g=i.ref,b=K$1.current),i.key!==void 0&&(c=""+i.key),e.type&&e.type.defaultProps)var $=e.type.defaultProps;for(_e in i)J.call(i,_e)&&!L$1.hasOwnProperty(_e)&&(s[_e]=i[_e]===void 0&&$!==void 0?$[_e]:i[_e])}var _e=arguments.length-2;if(_e===1)s.children=o;else if(1<_e){$=Array(_e);for(var et=0;et<_e;et++)$[et]=arguments[et+2];s.children=$}return{$$typeof:l$1,type:e.type,key:c,ref:g,props:s,_owner:b}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,o){return U$1.current.useImperativeHandle(e,i,o)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,o){return U$1.current.useReducer(e,i,o)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,o){return U$1.current.useSyncExternalStore(e,i,o)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";(function(e){e.exports=react_production_min})(react);const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,o){var s,c={},g=null,b=null;o!==void 0&&(g=""+o),i.key!==void 0&&(g=""+i.key),i.ref!==void 0&&(b=i.ref);for(s in i)m$1.call(i,s)&&!p$1.hasOwnProperty(s)&&(c[s]=i[s]);if(e&&e.defaultProps)for(s in i=e.defaultProps,i)c[s]===void 0&&(c[s]=i[s]);return{$$typeof:k,type:e,key:g,ref:b,props:c,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;(function(e){e.exports=reactJsxRuntime_production_min})(jsxRuntime);const Fragment=jsxRuntimeExports.Fragment,jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs;var client={},reactDomExports={},reactDom={get exports(){return reactDomExports},set exports(e){reactDomExports=e}},reactDom_production_min={},schedulerExports={},scheduler={get exports(){return schedulerExports},set exports(e){schedulerExports=e}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(It,Ht){var qt=It.length;It.push(Ht);e:for(;0<qt;){var dr=qt-1>>>1,yt=It[dr];if(0<c(yt,Ht))It[dr]=Ht,It[qt]=yt,qt=dr;else break e}}function o(It){return It.length===0?null:It[0]}function s(It){if(It.length===0)return null;var Ht=It[0],qt=It.pop();if(qt!==Ht){It[0]=qt;e:for(var dr=0,yt=It.length,$t=yt>>>1;dr<$t;){var jr=2*(dr+1)-1,Yn=It[jr],cn=jr+1,un=It[cn];if(0>c(Yn,qt))cn<yt&&0>c(un,Yn)?(It[dr]=un,It[cn]=qt,dr=cn):(It[dr]=Yn,It[jr]=qt,dr=jr);else if(cn<yt&&0>c(un,qt))It[dr]=un,It[cn]=qt,dr=cn;else break e}}return Ht}function c(It,Ht){var qt=It.sortIndex-Ht.sortIndex;return qt!==0?qt:It.id-Ht.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var b=Date,$=b.now();e.unstable_now=function(){return b.now()-$}}var _e=[],et=[],nt=1,ot=null,ct=3,at=!1,lt=!1,gt=!1,wt=typeof setTimeout=="function"?setTimeout:null,ft=typeof clearTimeout=="function"?clearTimeout:null,ut=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function pt(It){for(var Ht=o(et);Ht!==null;){if(Ht.callback===null)s(et);else if(Ht.startTime<=It)s(et),Ht.sortIndex=Ht.expirationTime,i(_e,Ht);else break;Ht=o(et)}}function vt(It){if(gt=!1,pt(It),!lt)if(o(_e)!==null)lt=!0,rr(bt);else{var Ht=o(et);Ht!==null&&ar(vt,Ht.startTime-It)}}function bt(It,Ht){lt=!1,gt&&(gt=!1,ft(Pt),Pt=-1),at=!0;var qt=ct;try{for(pt(Ht),ot=o(_e);ot!==null&&(!(ot.expirationTime>Ht)||It&&!hr());){var dr=ot.callback;if(typeof dr=="function"){ot.callback=null,ct=ot.priorityLevel;var yt=dr(ot.expirationTime<=Ht);Ht=e.unstable_now(),typeof yt=="function"?ot.callback=yt:ot===o(_e)&&s(_e),pt(Ht)}else s(_e);ot=o(_e)}if(ot!==null)var $t=!0;else{var jr=o(et);jr!==null&&ar(vt,jr.startTime-Ht),$t=!1}return $t}finally{ot=null,ct=qt,at=!1}}var Ct=!1,At=null,Pt=-1,Rt=5,Wt=-1;function hr(){return!(e.unstable_now()-Wt<Rt)}function Sr(){if(At!==null){var It=e.unstable_now();Wt=It;var Ht=!0;try{Ht=At(!0,It)}finally{Ht?er():(Ct=!1,At=null)}}else Ct=!1}var er;if(typeof ut=="function")er=function(){ut(Sr)};else if(typeof MessageChannel<"u"){var Qt=new MessageChannel,ir=Qt.port2;Qt.port1.onmessage=Sr,er=function(){ir.postMessage(null)}}else er=function(){wt(Sr,0)};function rr(It){At=It,Ct||(Ct=!0,er())}function ar(It,Ht){Pt=wt(function(){It(e.unstable_now())},Ht)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(It){It.callback=null},e.unstable_continueExecution=function(){lt||at||(lt=!0,rr(bt))},e.unstable_forceFrameRate=function(It){0>It||125<It?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Rt=0<It?Math.floor(1e3/It):5},e.unstable_getCurrentPriorityLevel=function(){return ct},e.unstable_getFirstCallbackNode=function(){return o(_e)},e.unstable_next=function(It){switch(ct){case 1:case 2:case 3:var Ht=3;break;default:Ht=ct}var qt=ct;ct=Ht;try{return It()}finally{ct=qt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(It,Ht){switch(It){case 1:case 2:case 3:case 4:case 5:break;default:It=3}var qt=ct;ct=It;try{return Ht()}finally{ct=qt}},e.unstable_scheduleCallback=function(It,Ht,qt){var dr=e.unstable_now();switch(typeof qt=="object"&&qt!==null?(qt=qt.delay,qt=typeof qt=="number"&&0<qt?dr+qt:dr):qt=dr,It){case 1:var yt=-1;break;case 2:yt=250;break;case 5:yt=1073741823;break;case 4:yt=1e4;break;default:yt=5e3}return yt=qt+yt,It={id:nt++,callback:Ht,priorityLevel:It,startTime:qt,expirationTime:yt,sortIndex:-1},qt>dr?(It.sortIndex=qt,i(et,It),o(_e)===null&&It===o(et)&&(gt?(ft(Pt),Pt=-1):gt=!0,ar(vt,qt-dr))):(It.sortIndex=yt,i(_e,It),lt||at||(lt=!0,rr(bt))),It},e.unstable_shouldYield=hr,e.unstable_wrapCallback=function(It){var Ht=ct;return function(){var qt=ct;ct=Ht;try{return It.apply(this,arguments)}finally{ct=qt}}}})(scheduler_production_min);(function(e){e.exports=scheduler_production_min})(scheduler);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,o,s){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return s?!1:o!==null?!o.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,o,s){if(i===null||typeof i>"u"||pa(e,i,o,s))return!0;if(s)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,o,s,c,g,b){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=s,this.attributeNamespace=c,this.mustUseProperty=o,this.propertyName=e,this.type=i,this.sanitizeURL=g,this.removeEmptyString=b}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,o,s){var c=z.hasOwnProperty(i)?z[i]:null;(c!==null?c.type!==0:s||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,o,c,s)&&(o=null),s||c===null?oa(i)&&(o===null?e.removeAttribute(i):e.setAttribute(i,""+o)):c.mustUseProperty?e[c.propertyName]=o===null?c.type===3?!1:"":o:(i=c.attributeName,s=c.attributeNamespace,o===null?e.removeAttribute(i):(c=c.type,o=c===3||c===4&&o===!0?"":""+o,s?e.setAttributeNS(s,i,o):e.setAttribute(i,o))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(et){var s=et}Reflect.construct(e,[],i)}else{try{i.call()}catch(et){s=et}e.call(i.prototype)}else{try{throw Error()}catch(et){s=et}e()}}catch(et){if(et&&s&&typeof et.stack=="string"){for(var c=et.stack.split(`
`),g=s.stack.split(`
`),b=c.length-1,$=g.length-1;1<=b&&0<=$&&c[b]!==g[$];)$--;for(;1<=b&&0<=$;b--,$--)if(c[b]!==g[$]){if(b!==1||$!==1)do if(b--,$--,0>$||c[b]!==g[$]){var _e=`
`+c[b].replace(" at new "," at ");return e.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",e.displayName)),_e}while(1<=b&&0<=$);break}}}finally{Na=!1,Error.prepareStackTrace=o}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),s=""+e[i];if(!e.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var c=o.get,g=o.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return c.call(this)},set:function(b){s=""+b,g.call(this,b)}}),Object.defineProperty(e,i,{enumerable:o.enumerable}),{getValue:function(){return s},setValue:function(b){s=""+b},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var o=i.getValue(),s="";return e&&(s=Ta(e)?e.checked?"true":"false":e.value),e=s,e!==o?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var o=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??e._wrapperState.initialChecked})}function Za(e,i){var o=i.defaultValue==null?"":i.defaultValue,s=i.checked!=null?i.checked:i.defaultChecked;o=Sa(i.value!=null?i.value:o),e._wrapperState={initialChecked:s,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var o=Sa(i.value),s=i.type;if(o!=null)s==="number"?(o===0&&e.value===""||e.value!=o)&&(e.value=""+o):e.value!==""+o&&(e.value=""+o);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,o):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var s=i.type;if(!(s!=="submit"&&s!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,o||i===e.value||(e.value=i),e.defaultValue=i}o=e.name,o!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,o!==""&&(e.name=o)}function cb(e,i,o){(i!=="number"||Xa(e.ownerDocument)!==e)&&(o==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+o&&(e.defaultValue=""+o))}var eb=Array.isArray;function fb(e,i,o,s){if(e=e.options,i){i={};for(var c=0;c<o.length;c++)i["$"+o[c]]=!0;for(o=0;o<e.length;o++)c=i.hasOwnProperty("$"+e[o].value),e[o].selected!==c&&(e[o].selected=c),c&&s&&(e[o].defaultSelected=!0)}else{for(o=""+Sa(o),i=null,c=0;c<e.length;c++){if(e[c].value===o){e[c].selected=!0,s&&(e[c].defaultSelected=!0);return}i!==null||e[c].disabled||(i=e[c])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(p(92));if(eb(o)){if(1<o.length)throw Error(p(93));o=o[0]}i=o}i==null&&(i=""),o=i}e._wrapperState={initialValue:Sa(o)}}function ib(e,i){var o=Sa(i.value),s=Sa(i.defaultValue);o!=null&&(o=""+o,o!==e.value&&(e.value=o),i.defaultValue==null&&e.defaultValue!==o&&(e.defaultValue=o)),s!=null&&(e.defaultValue=""+s)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,s,c){MSApp.execUnsafeLocalFunction(function(){return e(i,o,s,c)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var o=e.firstChild;if(o&&o===e.lastChild&&o.nodeType===3){o.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var o in i)if(i.hasOwnProperty(o)){var s=o.indexOf("--")===0,c=rb(o,i[o],s);o==="float"&&(o="cssFloat"),s?e.setProperty(o,c):e[o]=c}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,o){if(Ib)return e(i,o);Ib=!0;try{return Gb(e,i,o)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var o=e.stateNode;if(o===null)return null;var s=Db(o);if(s===null)return null;o=s[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(o&&typeof o!="function")throw Error(p(231,i,typeof o));return o}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,o,s,c,g,b,$,_e){var et=Array.prototype.slice.call(arguments,3);try{i.apply(o,et)}catch(nt){this.onError(nt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,o,s,c,g,b,$,_e){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,o,s,c,g,b,$,_e){if(Tb.apply(this,arguments),Ob){if(Ob){var et=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=et)}}function Vb(e){var i=e,o=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(o=i.return),e=i.return;while(e)}return i.tag===3?o:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p(188));return i!==e?null:e}for(var o=e,s=i;;){var c=o.return;if(c===null)break;var g=c.alternate;if(g===null){if(s=c.return,s!==null){o=s;continue}break}if(c.child===g.child){for(g=c.child;g;){if(g===o)return Xb(c),e;if(g===s)return Xb(c),i;g=g.sibling}throw Error(p(188))}if(o.return!==s.return)o=c,s=g;else{for(var b=!1,$=c.child;$;){if($===o){b=!0,o=c,s=g;break}if($===s){b=!0,s=c,o=g;break}$=$.sibling}if(!b){for($=g.child;$;){if($===o){b=!0,o=g,s=c;break}if($===s){b=!0,s=g,o=c;break}$=$.sibling}if(!b)throw Error(p(189))}}if(o.alternate!==s)throw Error(p(190))}if(o.tag!==3)throw Error(p(188));return o.stateNode.current===o?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var o=e.pendingLanes;if(o===0)return 0;var s=0,c=e.suspendedLanes,g=e.pingedLanes,b=o&268435455;if(b!==0){var $=b&~c;$!==0?s=tc($):(g&=b,g!==0&&(s=tc(g)))}else b=o&~c,b!==0?s=tc(b):g!==0&&(s=tc(g));if(s===0)return 0;if(i!==0&&i!==s&&!(i&c)&&(c=s&-s,g=i&-i,c>=g||c===16&&(g&4194240)!==0))return i;if(s&4&&(s|=o&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=s;0<i;)o=31-oc(i),c=1<<o,s|=e[o],i&=~c;return s}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var o=e.suspendedLanes,s=e.pingedLanes,c=e.expirationTimes,g=e.pendingLanes;0<g;){var b=31-oc(g),$=1<<b,_e=c[b];_e===-1?(!($&o)||$&s)&&(c[b]=vc($,i)):_e<=i&&(e.expiredLanes|=$),g&=~$}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],o=0;31>o;o++)i.push(e);return i}function Ac(e,i,o){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=o}function Bc(e,i){var o=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<o;){var c=31-oc(o),g=1<<c;i[c]=0,s[c]=-1,e[c]=-1,o&=~g}}function Cc(e,i){var o=e.entangledLanes|=i;for(e=e.entanglements;o;){var s=31-oc(o),c=1<<s;c&i|e[s]&i&&(e[s]|=i),o&=~c}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,o,s,c,g){return e===null||e.nativeEvent!==g?(e={blockedOn:i,domEventName:o,eventSystemFlags:s,nativeEvent:g,targetContainers:[c]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=s,i=e.targetContainers,c!==null&&i.indexOf(c)===-1&&i.push(c),e)}function Uc(e,i,o,s,c){switch(i){case"focusin":return Lc=Tc(Lc,e,i,o,s,c),!0;case"dragenter":return Mc=Tc(Mc,e,i,o,s,c),!0;case"mouseover":return Nc=Tc(Nc,e,i,o,s,c),!0;case"pointerover":var g=c.pointerId;return Oc.set(g,Tc(Oc.get(g)||null,e,i,o,s,c)),!0;case"gotpointercapture":return g=c.pointerId,Pc.set(g,Tc(Pc.get(g)||null,e,i,o,s,c)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var o=Vb(i);if(o!==null){if(i=o.tag,i===13){if(i=Wb(o),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){e.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var o=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(o===null){o=e.nativeEvent;var s=new o.constructor(o.type,o);wb=s,o.target.dispatchEvent(s),wb=null}else return i=Cb(o),i!==null&&Fc(i),e.blockedOn=o,!1;i.shift()}return!0}function Zc(e,i,o){Xc(e)&&o.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(c){return ad(c,e)}if(0<Kc.length){ad(Kc[0],e);for(var o=1;o<Kc.length;o++){var s=Kc[o];s.blockedOn===e&&(s.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),o=0;o<Qc.length;o++)s=Qc[o],s.blockedOn===e&&(s.blockedOn=null);for(;0<Qc.length&&(o=Qc[0],o.blockedOn===null);)Vc(o),o.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,o,s){var c=C,g=cd.transition;cd.transition=null;try{C=1,fd(e,i,o,s)}finally{C=c,cd.transition=g}}function gd(e,i,o,s){var c=C,g=cd.transition;cd.transition=null;try{C=4,fd(e,i,o,s)}finally{C=c,cd.transition=g}}function fd(e,i,o,s){if(dd){var c=Yc(e,i,o,s);if(c===null)hd(e,i,s,id,o),Sc(e,s);else if(Uc(c,e,i,o,s))s.stopPropagation();else if(Sc(e,s),i&4&&-1<Rc.indexOf(e)){for(;c!==null;){var g=Cb(c);if(g!==null&&Ec(g),g=Yc(e,i,o,s),g===null&&hd(e,i,s,id,o),g===c)break;c=g}c!==null&&s.stopPropagation()}else hd(e,i,s,null,o)}}var id=null;function Yc(e,i,o,s){if(id=null,e=xb(s),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(o=i.tag,o===13){if(e=Wb(i),e!==null)return e;e=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,o=i.length,s,c="value"in kd?kd.value:kd.textContent,g=c.length;for(e=0;e<o&&i[e]===c[e];e++);var b=o-e;for(s=1;s<=b&&i[o-s]===c[g-s];s++);return md=c.slice(e,1<s?1-s:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(o,s,c,g,b){this._reactName=o,this._targetInst=c,this.type=s,this.nativeEvent=g,this.target=b,this.currentTarget=null;for(var $ in e)e.hasOwnProperty($)&&(o=e[$],this[$]=o?o(g):g[$]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=String.fromCharCode(32),fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return e=i.data,e===ee&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne(e,i,o,s){Eb(s),i=oe(i,"onChange"),0<i.length&&(o=new td("onChange","change",null,o,s),e.push({event:o,listeners:i}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,o){e==="focusin"?(Ae(),pe=i,qe=o,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,i){if(e==="click")return te(i)}function Fe(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var o=Object.keys(e),s=Object.keys(i);if(o.length!==s.length)return!1;for(s=0;s<o.length;s++){var c=o[s];if(!ja.call(i,c)||!He(e[c],i[c]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var o=Je(e);e=0;for(var s;o;){if(o.nodeType===3){if(s=e+o.textContent.length,e<=i&&s>=i)return{node:o,offset:i-e};e=s}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Je(o)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),o=e.focusedElem,s=e.selectionRange;if(i!==o&&o&&o.ownerDocument&&Le(o.ownerDocument.documentElement,o)){if(s!==null&&Ne(o)){if(i=s.start,e=s.end,e===void 0&&(e=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(e,o.value.length);else if(e=(i=o.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var c=o.textContent.length,g=Math.min(s.start,c);s=s.end===void 0?g:Math.min(s.end,c),!e.extend&&g>s&&(c=s,s=g,g=c),c=Ke(o,g);var b=Ke(o,s);c&&b&&(e.rangeCount!==1||e.anchorNode!==c.node||e.anchorOffset!==c.offset||e.focusNode!==b.node||e.focusOffset!==b.offset)&&(i=i.createRange(),i.setStart(c.node,c.offset),e.removeAllRanges(),g>s?(e.addRange(i),e.extend(b.node,b.offset)):(i.setEnd(b.node,b.offset),e.addRange(i)))}}for(i=[],e=o;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)e=i[o],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,i,o){var s=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Te||Qe==null||Qe!==Xa(s)||(s=Qe,"selectionStart"in s&&Ne(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Se&&Ie(Se,s)||(Se=s,s=oe(Re,"onSelect"),0<s.length&&(i=new td("onSelect","select",null,i,o),e.push({event:i,listeners:s}),i.target=Qe)))}function Ve(e,i){var o={};return o[e.toLowerCase()]=i.toLowerCase(),o["Webkit"+e]="webkit"+i,o["Moz"+e]="moz"+i,o}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],o;for(o in i)if(i.hasOwnProperty(o)&&o in Ye)return Xe[e]=i[o];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf$1=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf$1,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,o){var s=e.type||"unknown-event";e.currentTarget=o,Ub(s,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var o=0;o<e.length;o++){var s=e[o],c=s.event;s=s.listeners;e:{var g=void 0;if(i)for(var b=s.length-1;0<=b;b--){var $=s[b],_e=$.instance,et=$.currentTarget;if($=$.listener,_e!==g&&c.isPropagationStopped())break e;nf(c,$,et),g=_e}else for(b=0;b<s.length;b++){if($=s[b],_e=$.instance,et=$.currentTarget,$=$.listener,_e!==g&&c.isPropagationStopped())break e;nf(c,$,et),g=_e}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,i){var o=i[of];o===void 0&&(o=i[of]=new Set);var s=e+"__bubble";o.has(s)||(pf(i,e,2,!1),o.add(s))}function qf(e,i,o){var s=0;i&&(s|=4),pf(o,e,s,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(o){o!=="selectionchange"&&(mf.has(o)||qf(o,!1,e),qf(o,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,o,s){switch(jd(i)){case 1:var c=ed;break;case 4:c=gd;break;default:c=fd}o=c.bind(null,i,o,e),c=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(c=!0),s?c!==void 0?e.addEventListener(i,o,{capture:!0,passive:c}):e.addEventListener(i,o,!0):c!==void 0?e.addEventListener(i,o,{passive:c}):e.addEventListener(i,o,!1)}function hd(e,i,o,s,c){var g=s;if(!(i&1)&&!(i&2)&&s!==null)e:for(;;){if(s===null)return;var b=s.tag;if(b===3||b===4){var $=s.stateNode.containerInfo;if($===c||$.nodeType===8&&$.parentNode===c)break;if(b===4)for(b=s.return;b!==null;){var _e=b.tag;if((_e===3||_e===4)&&(_e=b.stateNode.containerInfo,_e===c||_e.nodeType===8&&_e.parentNode===c))return;b=b.return}for(;$!==null;){if(b=Wc($),b===null)return;if(_e=b.tag,_e===5||_e===6){s=g=b;continue e}$=$.parentNode}}s=s.return}Jb(function(){var et=g,nt=xb(o),ot=[];e:{var ct=df.get(e);if(ct!==void 0){var at=td,lt=e;switch(e){case"keypress":if(od(o)===0)break e;case"keydown":case"keyup":at=Rd;break;case"focusin":lt="focus",at=Fd;break;case"focusout":lt="blur",at=Fd;break;case"beforeblur":case"afterblur":at=Fd;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Vd;break;case $e:case af:case bf$1:at=Hd;break;case cf:at=Xd;break;case"scroll":at=vd;break;case"wheel":at=Zd;break;case"copy":case"cut":case"paste":at=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Td}var gt=(i&4)!==0,wt=!gt&&e==="scroll",ft=gt?ct!==null?ct+"Capture":null:ct;gt=[];for(var ut=et,pt;ut!==null;){pt=ut;var vt=pt.stateNode;if(pt.tag===5&&vt!==null&&(pt=vt,ft!==null&&(vt=Kb(ut,ft),vt!=null&&gt.push(tf(ut,vt,pt)))),wt)break;ut=ut.return}0<gt.length&&(ct=new at(ct,lt,null,o,nt),ot.push({event:ct,listeners:gt}))}}if(!(i&7)){e:{if(ct=e==="mouseover"||e==="pointerover",at=e==="mouseout"||e==="pointerout",ct&&o!==wb&&(lt=o.relatedTarget||o.fromElement)&&(Wc(lt)||lt[uf]))break e;if((at||ct)&&(ct=nt.window===nt?nt:(ct=nt.ownerDocument)?ct.defaultView||ct.parentWindow:window,at?(lt=o.relatedTarget||o.toElement,at=et,lt=lt?Wc(lt):null,lt!==null&&(wt=Vb(lt),lt!==wt||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(at=null,lt=et),at!==lt)){if(gt=Bd,vt="onMouseLeave",ft="onMouseEnter",ut="mouse",(e==="pointerout"||e==="pointerover")&&(gt=Td,vt="onPointerLeave",ft="onPointerEnter",ut="pointer"),wt=at==null?ct:ue(at),pt=lt==null?ct:ue(lt),ct=new gt(vt,ut+"leave",at,o,nt),ct.target=wt,ct.relatedTarget=pt,vt=null,Wc(nt)===et&&(gt=new gt(ft,ut+"enter",lt,o,nt),gt.target=pt,gt.relatedTarget=wt,vt=gt),wt=vt,at&&lt)t:{for(gt=at,ft=lt,ut=0,pt=gt;pt;pt=vf(pt))ut++;for(pt=0,vt=ft;vt;vt=vf(vt))pt++;for(;0<ut-pt;)gt=vf(gt),ut--;for(;0<pt-ut;)ft=vf(ft),pt--;for(;ut--;){if(gt===ft||ft!==null&&gt===ft.alternate)break t;gt=vf(gt),ft=vf(ft)}gt=null}else gt=null;at!==null&&wf(ot,ct,at,gt,!1),lt!==null&&wt!==null&&wf(ot,wt,lt,gt,!0)}}e:{if(ct=et?ue(et):window,at=ct.nodeName&&ct.nodeName.toLowerCase(),at==="select"||at==="input"&&ct.type==="file")var bt=ve;else if(me(ct))if(we)bt=Fe;else{bt=De;var Ct=Ce}else(at=ct.nodeName)&&at.toLowerCase()==="input"&&(ct.type==="checkbox"||ct.type==="radio")&&(bt=Ee);if(bt&&(bt=bt(e,et))){ne(ot,bt,o,nt);break e}Ct&&Ct(e,ct,et),e==="focusout"&&(Ct=ct._wrapperState)&&Ct.controlled&&ct.type==="number"&&cb(ct,"number",ct.value)}switch(Ct=et?ue(et):window,e){case"focusin":(me(Ct)||Ct.contentEditable==="true")&&(Qe=Ct,Re=et,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ot,o,nt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ot,o,nt)}var At;if(ae)e:{switch(e){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else ie?ge(e,o)&&(Pt="onCompositionEnd"):e==="keydown"&&o.keyCode===229&&(Pt="onCompositionStart");Pt&&(de&&o.locale!=="ko"&&(ie||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&ie&&(At=nd()):(kd=nt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),Ct=oe(et,Pt),0<Ct.length&&(Pt=new Ld(Pt,e,null,o,nt),ot.push({event:Pt,listeners:Ct}),At?Pt.data=At:(At=he(o),At!==null&&(Pt.data=At)))),(At=ce?je(e,o):ke(e,o))&&(et=oe(et,"onBeforeInput"),0<et.length&&(nt=new Ld("onBeforeInput","beforeinput",null,o,nt),ot.push({event:nt,listeners:et}),nt.data=At))}se(ot,i)})}function tf(e,i,o){return{instance:e,listener:i,currentTarget:o}}function oe(e,i){for(var o=i+"Capture",s=[];e!==null;){var c=e,g=c.stateNode;c.tag===5&&g!==null&&(c=g,g=Kb(e,o),g!=null&&s.unshift(tf(e,g,c)),g=Kb(e,i),g!=null&&s.push(tf(e,g,c))),e=e.return}return s}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,o,s,c){for(var g=i._reactName,b=[];o!==null&&o!==s;){var $=o,_e=$.alternate,et=$.stateNode;if(_e!==null&&_e===s)break;$.tag===5&&et!==null&&($=et,c?(_e=Kb(o,g),_e!=null&&b.unshift(tf(o,_e,$))):c||(_e=Kb(o,g),_e!=null&&b.push(tf(o,_e,$)))),o=o.return}b.length!==0&&e.push({event:i,listeners:b})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,o){if(i=zf(i),zf(e)!==i&&o)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var o=i,s=0;do{var c=o.nextSibling;if(e.removeChild(o),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(s===0){e.removeChild(c),bd(i);return}s--}else o!=="$"&&o!=="$?"&&o!=="$!"||s++;o=c}while(o);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var o=e.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return e;i--}else o==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var o=e.parentNode;o;){if(i=o[uf]||o[Of]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(e=Mf(e);e!==null;){if(o=e[Of])return o;e=Mf(e)}return i}e=o,o=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var o=e.type.contextTypes;if(!o)return Vf;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===i)return s.__reactInternalMemoizedMaskedChildContext;var c={},g;for(g in o)c[g]=i[g];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=c),c}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,i,o){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,o)}function bg(e,i,o){var s=e.stateNode;if(i=i.childContextTypes,typeof s.getChildContext!="function")return o;s=s.getChildContext();for(var c in s)if(!(c in i))throw Error(p(108,Ra(e)||"Unknown",c));return A({},o,s)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,o){var s=e.stateNode;if(!s)throw Error(p(169));o?(e=bg(e,i,Xf),s.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,o)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var o=eg;for(C=1;e<o.length;e++){var s=o[e];do s=s(!0);while(s!==null)}eg=null,fg=!1}catch(c){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),c}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,o){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var s=rg;e=sg;var c=32-oc(s)-1;s&=~(1<<c),o+=1;var g=32-oc(i)+c;if(30<g){var b=c-c%5;g=(s&(1<<b)-1).toString(32),s>>=b,c-=b,rg=1<<32-oc(i)+c|o<<c|s,sg=g+e}else rg=1<<g|o<<c|s,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var o=Bg(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=e,i=e.deletions,i===null?(e.deletions=[o],e.flags|=16):i.push(o)}function Cg(e,i){switch(e.tag){case 5:var o=e.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Bg(18,null,null,0),o.stateNode=i,o.return=e,e.child=o,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var o=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf(o.nextSibling);var s=xg;i&&Cg(e,i)?Ag(s,o):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var o=e.data;if(o==="/$"){if(i===0){yg=Lf(e.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var o in e)i[o]===void 0&&(i[o]=e[o]);return i}return i}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(e){var i=Mg.current;E(Mg),e._currentValue=i}function Sg(e,i,o){for(;e!==null;){var s=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,s!==null&&(s.childLanes|=i)):s!==null&&(s.childLanes&i)!==i&&(s.childLanes|=i),e===o)break;e=e.return}}function Tg(e,i){Ng=e,Pg=Og=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(Ug=!0),e.firstContext=null)}function Vg(e){var i=e._currentValue;if(Pg!==e)if(e={context:e,memoizedValue:i,next:null},Og===null){if(Ng===null)throw Error(p(308));Og=e,Ng.dependencies={lanes:0,firstContext:e}}else Og=Og.next=e;return i}var Wg=null;function Xg(e){Wg===null?Wg=[e]:Wg.push(e)}function Yg(e,i,o,s){var c=i.interleaved;return c===null?(o.next=o,Xg(i)):(o.next=c.next,c.next=o),i.interleaved=o,Zg(e,s)}function Zg(e,i){e.lanes|=i;var o=e.alternate;for(o!==null&&(o.lanes|=i),o=e,e=e.return;e!==null;)e.childLanes|=i,o=e.alternate,o!==null&&(o.childLanes|=i),o=e,e=e.return;return o.tag===3?o.stateNode:null}var $g=!1;function ah(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ch(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function dh(e,i,o){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,K&2){var c=s.pending;return c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i,Zg(e,o)}return c=s.interleaved,c===null?(i.next=i,Xg(s)):(i.next=c.next,c.next=i),s.interleaved=i,Zg(e,o)}function eh(e,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var s=i.lanes;s&=e.pendingLanes,o|=s,i.lanes=o,Cc(e,o)}}function fh(e,i){var o=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,o===s)){var c=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var b={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};g===null?c=g=b:g=g.next=b,o=o.next}while(o!==null);g===null?c=g=i:g=g.next=i}else c=g=i;o={baseState:s.baseState,firstBaseUpdate:c,lastBaseUpdate:g,shared:s.shared,effects:s.effects},e.updateQueue=o;return}e=o.lastBaseUpdate,e===null?o.firstBaseUpdate=i:e.next=i,o.lastBaseUpdate=i}function gh(e,i,o,s){var c=e.updateQueue;$g=!1;var g=c.firstBaseUpdate,b=c.lastBaseUpdate,$=c.shared.pending;if($!==null){c.shared.pending=null;var _e=$,et=_e.next;_e.next=null,b===null?g=et:b.next=et,b=_e;var nt=e.alternate;nt!==null&&(nt=nt.updateQueue,$=nt.lastBaseUpdate,$!==b&&($===null?nt.firstBaseUpdate=et:$.next=et,nt.lastBaseUpdate=_e))}if(g!==null){var ot=c.baseState;b=0,nt=et=_e=null,$=g;do{var ct=$.lane,at=$.eventTime;if((s&ct)===ct){nt!==null&&(nt=nt.next={eventTime:at,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var lt=e,gt=$;switch(ct=i,at=o,gt.tag){case 1:if(lt=gt.payload,typeof lt=="function"){ot=lt.call(at,ot,ct);break e}ot=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=gt.payload,ct=typeof lt=="function"?lt.call(at,ot,ct):lt,ct==null)break e;ot=A({},ot,ct);break e;case 2:$g=!0}}$.callback!==null&&$.lane!==0&&(e.flags|=64,ct=c.effects,ct===null?c.effects=[$]:ct.push($))}else at={eventTime:at,lane:ct,tag:$.tag,payload:$.payload,callback:$.callback,next:null},nt===null?(et=nt=at,_e=ot):nt=nt.next=at,b|=ct;if($=$.next,$===null){if($=c.shared.pending,$===null)break;ct=$,$=ct.next,ct.next=null,c.lastBaseUpdate=ct,c.shared.pending=null}}while(1);if(nt===null&&(_e=ot),c.baseState=_e,c.firstBaseUpdate=et,c.lastBaseUpdate=nt,i=c.shared.interleaved,i!==null){c=i;do b|=c.lane,c=c.next;while(c!==i)}else g===null&&(c.shared.lanes=0);hh|=b,e.lanes=b,e.memoizedState=ot}}function ih(e,i,o){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var s=e[i],c=s.callback;if(c!==null){if(s.callback=null,s=o,typeof c!="function")throw Error(p(191,c));c.call(s)}}}var jh=new aa.Component().refs;function kh(e,i,o,s){i=e.memoizedState,o=o(s,i),o=o==null?i:A({},i,o),e.memoizedState=o,e.lanes===0&&(e.updateQueue.baseState=o)}var nh={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,o){e=e._reactInternals;var s=L(),c=lh(e),g=ch(s,c);g.payload=i,o!=null&&(g.callback=o),i=dh(e,g,c),i!==null&&(mh(i,e,c,s),eh(i,e,c))},enqueueReplaceState:function(e,i,o){e=e._reactInternals;var s=L(),c=lh(e),g=ch(s,c);g.tag=1,g.payload=i,o!=null&&(g.callback=o),i=dh(e,g,c),i!==null&&(mh(i,e,c,s),eh(i,e,c))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var o=L(),s=lh(e),c=ch(o,s);c.tag=2,i!=null&&(c.callback=i),i=dh(e,c,s),i!==null&&(mh(i,e,s,o),eh(i,e,s))}};function oh(e,i,o,s,c,g,b){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,g,b):i.prototype&&i.prototype.isPureReactComponent?!Ie(o,s)||!Ie(c,g):!0}function ph(e,i,o){var s=!1,c=Vf,g=i.contextType;return typeof g=="object"&&g!==null?g=Vg(g):(c=Zf(i)?Xf:H.current,s=i.contextTypes,g=(s=s!=null)?Yf(e,c):Vf),i=new i(o,g),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=nh,e.stateNode=i,i._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=c,e.__reactInternalMemoizedMaskedChildContext=g),i}function qh(e,i,o,s){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,s),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,s),i.state!==e&&nh.enqueueReplaceState(i,i.state,null)}function rh(e,i,o,s){var c=e.stateNode;c.props=o,c.state=e.memoizedState,c.refs=jh,ah(e);var g=i.contextType;typeof g=="object"&&g!==null?c.context=Vg(g):(g=Zf(i)?Xf:H.current,c.context=Yf(e,g)),c.state=e.memoizedState,g=i.getDerivedStateFromProps,typeof g=="function"&&(kh(e,i,g,o),c.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(i=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),i!==c.state&&nh.enqueueReplaceState(c,c.state,null),gh(e,o,c,s),c.state=e.memoizedState),typeof c.componentDidMount=="function"&&(e.flags|=4194308)}function sh(e,i,o){if(e=o.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(p(309));var s=o.stateNode}if(!s)throw Error(p(147,e));var c=s,g=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===g?i.ref:(i=function(b){var $=c.refs;$===jh&&($=c.refs={}),b===null?delete $[g]:$[g]=b},i._stringRef=g,i)}if(typeof e!="string")throw Error(p(284));if(!o._owner)throw Error(p(290,e))}return e}function th(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function uh(e){var i=e._init;return i(e._payload)}function vh(e){function i(ft,ut){if(e){var pt=ft.deletions;pt===null?(ft.deletions=[ut],ft.flags|=16):pt.push(ut)}}function o(ft,ut){if(!e)return null;for(;ut!==null;)i(ft,ut),ut=ut.sibling;return null}function s(ft,ut){for(ft=new Map;ut!==null;)ut.key!==null?ft.set(ut.key,ut):ft.set(ut.index,ut),ut=ut.sibling;return ft}function c(ft,ut){return ft=wh(ft,ut),ft.index=0,ft.sibling=null,ft}function g(ft,ut,pt){return ft.index=pt,e?(pt=ft.alternate,pt!==null?(pt=pt.index,pt<ut?(ft.flags|=2,ut):pt):(ft.flags|=2,ut)):(ft.flags|=1048576,ut)}function b(ft){return e&&ft.alternate===null&&(ft.flags|=2),ft}function $(ft,ut,pt,vt){return ut===null||ut.tag!==6?(ut=xh(pt,ft.mode,vt),ut.return=ft,ut):(ut=c(ut,pt),ut.return=ft,ut)}function _e(ft,ut,pt,vt){var bt=pt.type;return bt===ya?nt(ft,ut,pt.props.children,vt,pt.key):ut!==null&&(ut.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===Ha&&uh(bt)===ut.type)?(vt=c(ut,pt.props),vt.ref=sh(ft,ut,pt),vt.return=ft,vt):(vt=yh(pt.type,pt.key,pt.props,null,ft.mode,vt),vt.ref=sh(ft,ut,pt),vt.return=ft,vt)}function et(ft,ut,pt,vt){return ut===null||ut.tag!==4||ut.stateNode.containerInfo!==pt.containerInfo||ut.stateNode.implementation!==pt.implementation?(ut=zh(pt,ft.mode,vt),ut.return=ft,ut):(ut=c(ut,pt.children||[]),ut.return=ft,ut)}function nt(ft,ut,pt,vt,bt){return ut===null||ut.tag!==7?(ut=Ah(pt,ft.mode,vt,bt),ut.return=ft,ut):(ut=c(ut,pt),ut.return=ft,ut)}function ot(ft,ut,pt){if(typeof ut=="string"&&ut!==""||typeof ut=="number")return ut=xh(""+ut,ft.mode,pt),ut.return=ft,ut;if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case va:return pt=yh(ut.type,ut.key,ut.props,null,ft.mode,pt),pt.ref=sh(ft,null,ut),pt.return=ft,pt;case wa:return ut=zh(ut,ft.mode,pt),ut.return=ft,ut;case Ha:var vt=ut._init;return ot(ft,vt(ut._payload),pt)}if(eb(ut)||Ka(ut))return ut=Ah(ut,ft.mode,pt,null),ut.return=ft,ut;th(ft,ut)}return null}function ct(ft,ut,pt,vt){var bt=ut!==null?ut.key:null;if(typeof pt=="string"&&pt!==""||typeof pt=="number")return bt!==null?null:$(ft,ut,""+pt,vt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case va:return pt.key===bt?_e(ft,ut,pt,vt):null;case wa:return pt.key===bt?et(ft,ut,pt,vt):null;case Ha:return bt=pt._init,ct(ft,ut,bt(pt._payload),vt)}if(eb(pt)||Ka(pt))return bt!==null?null:nt(ft,ut,pt,vt,null);th(ft,pt)}return null}function at(ft,ut,pt,vt,bt){if(typeof vt=="string"&&vt!==""||typeof vt=="number")return ft=ft.get(pt)||null,$(ut,ft,""+vt,bt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case va:return ft=ft.get(vt.key===null?pt:vt.key)||null,_e(ut,ft,vt,bt);case wa:return ft=ft.get(vt.key===null?pt:vt.key)||null,et(ut,ft,vt,bt);case Ha:var Ct=vt._init;return at(ft,ut,pt,Ct(vt._payload),bt)}if(eb(vt)||Ka(vt))return ft=ft.get(pt)||null,nt(ut,ft,vt,bt,null);th(ut,vt)}return null}function lt(ft,ut,pt,vt){for(var bt=null,Ct=null,At=ut,Pt=ut=0,Rt=null;At!==null&&Pt<pt.length;Pt++){At.index>Pt?(Rt=At,At=null):Rt=At.sibling;var Wt=ct(ft,At,pt[Pt],vt);if(Wt===null){At===null&&(At=Rt);break}e&&At&&Wt.alternate===null&&i(ft,At),ut=g(Wt,ut,Pt),Ct===null?bt=Wt:Ct.sibling=Wt,Ct=Wt,At=Rt}if(Pt===pt.length)return o(ft,At),I&&tg(ft,Pt),bt;if(At===null){for(;Pt<pt.length;Pt++)At=ot(ft,pt[Pt],vt),At!==null&&(ut=g(At,ut,Pt),Ct===null?bt=At:Ct.sibling=At,Ct=At);return I&&tg(ft,Pt),bt}for(At=s(ft,At);Pt<pt.length;Pt++)Rt=at(At,ft,Pt,pt[Pt],vt),Rt!==null&&(e&&Rt.alternate!==null&&At.delete(Rt.key===null?Pt:Rt.key),ut=g(Rt,ut,Pt),Ct===null?bt=Rt:Ct.sibling=Rt,Ct=Rt);return e&&At.forEach(function(hr){return i(ft,hr)}),I&&tg(ft,Pt),bt}function gt(ft,ut,pt,vt){var bt=Ka(pt);if(typeof bt!="function")throw Error(p(150));if(pt=bt.call(pt),pt==null)throw Error(p(151));for(var Ct=bt=null,At=ut,Pt=ut=0,Rt=null,Wt=pt.next();At!==null&&!Wt.done;Pt++,Wt=pt.next()){At.index>Pt?(Rt=At,At=null):Rt=At.sibling;var hr=ct(ft,At,Wt.value,vt);if(hr===null){At===null&&(At=Rt);break}e&&At&&hr.alternate===null&&i(ft,At),ut=g(hr,ut,Pt),Ct===null?bt=hr:Ct.sibling=hr,Ct=hr,At=Rt}if(Wt.done)return o(ft,At),I&&tg(ft,Pt),bt;if(At===null){for(;!Wt.done;Pt++,Wt=pt.next())Wt=ot(ft,Wt.value,vt),Wt!==null&&(ut=g(Wt,ut,Pt),Ct===null?bt=Wt:Ct.sibling=Wt,Ct=Wt);return I&&tg(ft,Pt),bt}for(At=s(ft,At);!Wt.done;Pt++,Wt=pt.next())Wt=at(At,ft,Pt,Wt.value,vt),Wt!==null&&(e&&Wt.alternate!==null&&At.delete(Wt.key===null?Pt:Wt.key),ut=g(Wt,ut,Pt),Ct===null?bt=Wt:Ct.sibling=Wt,Ct=Wt);return e&&At.forEach(function(Sr){return i(ft,Sr)}),I&&tg(ft,Pt),bt}function wt(ft,ut,pt,vt){if(typeof pt=="object"&&pt!==null&&pt.type===ya&&pt.key===null&&(pt=pt.props.children),typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case va:e:{for(var bt=pt.key,Ct=ut;Ct!==null;){if(Ct.key===bt){if(bt=pt.type,bt===ya){if(Ct.tag===7){o(ft,Ct.sibling),ut=c(Ct,pt.props.children),ut.return=ft,ft=ut;break e}}else if(Ct.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===Ha&&uh(bt)===Ct.type){o(ft,Ct.sibling),ut=c(Ct,pt.props),ut.ref=sh(ft,Ct,pt),ut.return=ft,ft=ut;break e}o(ft,Ct);break}else i(ft,Ct);Ct=Ct.sibling}pt.type===ya?(ut=Ah(pt.props.children,ft.mode,vt,pt.key),ut.return=ft,ft=ut):(vt=yh(pt.type,pt.key,pt.props,null,ft.mode,vt),vt.ref=sh(ft,ut,pt),vt.return=ft,ft=vt)}return b(ft);case wa:e:{for(Ct=pt.key;ut!==null;){if(ut.key===Ct)if(ut.tag===4&&ut.stateNode.containerInfo===pt.containerInfo&&ut.stateNode.implementation===pt.implementation){o(ft,ut.sibling),ut=c(ut,pt.children||[]),ut.return=ft,ft=ut;break e}else{o(ft,ut);break}else i(ft,ut);ut=ut.sibling}ut=zh(pt,ft.mode,vt),ut.return=ft,ft=ut}return b(ft);case Ha:return Ct=pt._init,wt(ft,ut,Ct(pt._payload),vt)}if(eb(pt))return lt(ft,ut,pt,vt);if(Ka(pt))return gt(ft,ut,pt,vt);th(ft,pt)}return typeof pt=="string"&&pt!==""||typeof pt=="number"?(pt=""+pt,ut!==null&&ut.tag===6?(o(ft,ut.sibling),ut=c(ut,pt),ut.return=ft,ft=ut):(o(ft,ut),ut=xh(pt,ft.mode,vt),ut.return=ft,ft=ut),b(ft)):o(ft,ut)}return wt}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(e){if(e===Dh)throw Error(p(174));return e}function Ih(e,i){switch(G(Gh,i),G(Fh,e),G(Eh,Dh),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E(Eh),G(Eh,i)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(e){Hh(Gh.current);var i=Hh(Eh.current),o=lb(i,e.type);i!==o&&(G(Fh,e),G(Eh,o))}function Lh(e){Fh.current===e&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(e){for(var i=e;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Nh=[];function Oh(){for(var e=0;e<Nh.length;e++)Nh[e]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p(321))}function Wh(e,i){if(i===null)return!1;for(var o=0;o<i.length&&o<e.length;o++)if(!He(e[o],i[o]))return!1;return!0}function Xh(e,i,o,s,c,g){if(Rh=g,N=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ph.current=e===null||e.memoizedState===null?Yh:Zh,e=o(s,c),Th){g=0;do{if(Th=!1,Uh=0,25<=g)throw Error(p(301));g+=1,P=O=null,i.updateQueue=null,Ph.current=$h,e=o(s,c)}while(Th)}if(Ph.current=ai,i=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,i)throw Error(p(300));return e}function bi(){var e=Uh!==0;return Uh=0,e}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=e:P=P.next=e,P}function di(){if(O===null){var e=N.alternate;e=e!==null?e.memoizedState:null}else e=O.next;var i=P===null?N.memoizedState:P.next;if(i!==null)P=i,O=e;else{if(e===null)throw Error(p(310));O=e,e={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=e:P=P.next=e}return P}function ei(e,i){return typeof i=="function"?i(e):i}function fi(e){var i=di(),o=i.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=e;var s=O,c=s.baseQueue,g=o.pending;if(g!==null){if(c!==null){var b=c.next;c.next=g.next,g.next=b}s.baseQueue=c=g,o.pending=null}if(c!==null){g=c.next,s=s.baseState;var $=b=null,_e=null,et=g;do{var nt=et.lane;if((Rh&nt)===nt)_e!==null&&(_e=_e.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),s=et.hasEagerState?et.eagerState:e(s,et.action);else{var ot={lane:nt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};_e===null?($=_e=ot,b=s):_e=_e.next=ot,N.lanes|=nt,hh|=nt}et=et.next}while(et!==null&&et!==g);_e===null?b=s:_e.next=$,He(s,i.memoizedState)||(Ug=!0),i.memoizedState=s,i.baseState=b,i.baseQueue=_e,o.lastRenderedState=s}if(e=o.interleaved,e!==null){c=e;do g=c.lane,N.lanes|=g,hh|=g,c=c.next;while(c!==e)}else c===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function gi(e){var i=di(),o=i.queue;if(o===null)throw Error(p(311));o.lastRenderedReducer=e;var s=o.dispatch,c=o.pending,g=i.memoizedState;if(c!==null){o.pending=null;var b=c=c.next;do g=e(g,b.action),b=b.next;while(b!==c);He(g,i.memoizedState)||(Ug=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),o.lastRenderedState=g}return[g,s]}function hi(){}function ii(e,i){var o=N,s=di(),c=i(),g=!He(s.memoizedState,c);if(g&&(s.memoizedState=c,Ug=!0),s=s.queue,ji(ki.bind(null,o,s,e),[e]),s.getSnapshot!==i||g||P!==null&&P.memoizedState.tag&1){if(o.flags|=2048,li$4(9,mi.bind(null,o,s,c,i),void 0,null),R===null)throw Error(p(349));Rh&30||ni(o,i,c)}return c}function ni(e,i,o){e.flags|=16384,e={getSnapshot:i,value:o},i=N.updateQueue,i===null?(i={lastEffect:null,stores:null},N.updateQueue=i,i.stores=[e]):(o=i.stores,o===null?i.stores=[e]:o.push(e))}function mi(e,i,o,s){i.value=o,i.getSnapshot=s,oi(i)&&pi(e)}function ki(e,i,o){return o(function(){oi(i)&&pi(e)})}function oi(e){var i=e.getSnapshot;e=e.value;try{var o=i();return!He(e,o)}catch{return!0}}function pi(e){var i=Zg(e,1);i!==null&&mh(i,e,1,-1)}function qi(e){var i=ci();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:e},i.queue=e,e=e.dispatch=ri.bind(null,N,e),[i.memoizedState,e]}function li$4(e,i,o,s){return e={tag:e,create:i,destroy:o,deps:s,next:null},i=N.updateQueue,i===null?(i={lastEffect:null,stores:null},N.updateQueue=i,i.lastEffect=e.next=e):(o=i.lastEffect,o===null?i.lastEffect=e.next=e:(s=o.next,o.next=e,e.next=s,i.lastEffect=e)),e}function si(){return di().memoizedState}function ti(e,i,o,s){var c=ci();N.flags|=e,c.memoizedState=li$4(1|i,o,void 0,s===void 0?null:s)}function ui(e,i,o,s){var c=di();s=s===void 0?null:s;var g=void 0;if(O!==null){var b=O.memoizedState;if(g=b.destroy,s!==null&&Wh(s,b.deps)){c.memoizedState=li$4(i,o,g,s);return}}N.flags|=e,c.memoizedState=li$4(1|i,o,g,s)}function vi(e,i){return ti(8390656,8,e,i)}function ji(e,i){return ui(2048,8,e,i)}function wi(e,i){return ui(4,2,e,i)}function xi(e,i){return ui(4,4,e,i)}function yi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function zi(e,i,o){return o=o!=null?o.concat([e]):null,ui(4,4,yi.bind(null,i,e),o)}function Ai(){}function Bi(e,i){var o=di();i=i===void 0?null:i;var s=o.memoizedState;return s!==null&&i!==null&&Wh(i,s[1])?s[0]:(o.memoizedState=[e,i],e)}function Ci(e,i){var o=di();i=i===void 0?null:i;var s=o.memoizedState;return s!==null&&i!==null&&Wh(i,s[1])?s[0]:(e=e(),o.memoizedState=[e,i],e)}function Di(e,i,o){return Rh&21?(He(o,i)||(o=yc(),N.lanes|=o,hh|=o,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,Ug=!0),e.memoizedState=o)}function Ei(e,i){var o=C;C=o!==0&&4>o?o:4,e(!0);var s=Qh.transition;Qh.transition={};try{e(!1),i()}finally{C=o,Qh.transition=s}}function Fi(){return di().memoizedState}function Gi(e,i,o){var s=lh(e);if(o={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null},Hi(e))Ii(i,o);else if(o=Yg(e,i,o,s),o!==null){var c=L();mh(o,e,s,c),Ji(o,i,s)}}function ri(e,i,o){var s=lh(e),c={lane:s,action:o,hasEagerState:!1,eagerState:null,next:null};if(Hi(e))Ii(i,c);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var b=i.lastRenderedState,$=g(b,o);if(c.hasEagerState=!0,c.eagerState=$,He($,b)){var _e=i.interleaved;_e===null?(c.next=c,Xg(i)):(c.next=_e.next,_e.next=c),i.interleaved=c;return}}catch{}finally{}o=Yg(e,i,c,s),o!==null&&(c=L(),mh(o,e,s,c),Ji(o,i,s))}}function Hi(e){var i=e.alternate;return e===N||i!==null&&i===N}function Ii(e,i){Th=Sh=!0;var o=e.pending;o===null?i.next=i:(i.next=o.next,o.next=i),e.pending=i}function Ji(e,i,o){if(o&4194240){var s=i.lanes;s&=e.pendingLanes,o|=s,i.lanes=o,Cc(e,o)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(e,i){return ci().memoizedState=[e,i===void 0?null:i],e},useContext:Vg,useEffect:vi,useImperativeHandle:function(e,i,o){return o=o!=null?o.concat([e]):null,ti(4194308,4,yi.bind(null,i,e),o)},useLayoutEffect:function(e,i){return ti(4194308,4,e,i)},useInsertionEffect:function(e,i){return ti(4,2,e,i)},useMemo:function(e,i){var o=ci();return i=i===void 0?null:i,e=e(),o.memoizedState=[e,i],e},useReducer:function(e,i,o){var s=ci();return i=o!==void 0?o(i):i,s.memoizedState=s.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},s.queue=e,e=e.dispatch=Gi.bind(null,N,e),[s.memoizedState,e]},useRef:function(e){var i=ci();return e={current:e},i.memoizedState=e},useState:qi,useDebugValue:Ai,useDeferredValue:function(e){return ci().memoizedState=e},useTransition:function(){var e=qi(!1),i=e[0];return e=Ei.bind(null,e[1]),ci().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,o){var s=N,c=ci();if(I){if(o===void 0)throw Error(p(407));o=o()}else{if(o=i(),R===null)throw Error(p(349));Rh&30||ni(s,i,o)}c.memoizedState=o;var g={value:o,getSnapshot:i};return c.queue=g,vi(ki.bind(null,s,g,e),[e]),s.flags|=2048,li$4(9,mi.bind(null,s,g,o,i),void 0,null),o},useId:function(){var e=ci(),i=R.identifierPrefix;if(I){var o=sg,s=rg;o=(s&~(1<<32-oc(s)-1)).toString(32)+o,i=":"+i+"R"+o,o=Uh++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=Vh++,i=":"+i+"r"+o.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var i=di();return Di(i,O.memoizedState,e)},useTransition:function(){var e=fi(ei)[0],i=di().memoizedState;return[e,i]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var i=di();return O===null?i.memoizedState=e:Di(i,O.memoizedState,e)},useTransition:function(){var e=gi(ei)[0],i=di().memoizedState;return[e,i]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(e,i){try{var o="",s=i;do o+=Pa(s),s=s.return;while(s);var c=o}catch(g){c=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:i,stack:c,digest:null}}function Li(e,i,o){return{value:e,source:null,stack:o??null,digest:i??null}}function Mi(e,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(e,i,o){o=ch(-1,o),o.tag=3,o.payload={element:null};var s=i.value;return o.callback=function(){Pi||(Pi=!0,Qi=s),Mi(e,i)},o}function Ri(e,i,o){o=ch(-1,o),o.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var c=i.value;o.payload=function(){return s(c)},o.callback=function(){Mi(e,i)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(o.callback=function(){Mi(e,i),typeof s!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var b=i.stack;this.componentDidCatch(i.value,{componentStack:b!==null?b:""})}),o}function Ti(e,i,o){var s=e.pingCache;if(s===null){s=e.pingCache=new Ni;var c=new Set;s.set(i,c)}else c=s.get(i),c===void 0&&(c=new Set,s.set(i,c));c.has(o)||(c.add(o),e=Ui.bind(null,e,i,o),i.then(e,e))}function Vi(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Wi(e,i,o,s,c){return e.mode&1?(e.flags|=65536,e.lanes=c,e):(e===i?e.flags|=65536:(e.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=ch(-1,1),i.tag=2,dh(o,i,1))),o.lanes|=1),e)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(e,i,o,s){i.child=e===null?Ch(i,null,o,s):Bh(i,e.child,o,s)}function Zi(e,i,o,s,c){o=o.render;var g=i.ref;return Tg(i,c),s=Xh(e,i,o,s,g,c),o=bi(),e!==null&&!Ug?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,$i(e,i,c)):(I&&o&&vg(i),i.flags|=1,Yi(e,i,s,c),i.child)}function aj(e,i,o,s,c){if(e===null){var g=o.type;return typeof g=="function"&&!bj(g)&&g.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=g,cj(e,i,g,s,c)):(e=yh(o.type,null,s,i,i.mode,c),e.ref=i.ref,e.return=i,i.child=e)}if(g=e.child,!(e.lanes&c)){var b=g.memoizedProps;if(o=o.compare,o=o!==null?o:Ie,o(b,s)&&e.ref===i.ref)return $i(e,i,c)}return i.flags|=1,e=wh(g,s),e.ref=i.ref,e.return=i,i.child=e}function cj(e,i,o,s,c){if(e!==null){var g=e.memoizedProps;if(Ie(g,s)&&e.ref===i.ref)if(Ug=!1,i.pendingProps=s=g,(e.lanes&c)!==0)e.flags&131072&&(Ug=!0);else return i.lanes=e.lanes,$i(e,i,c)}return dj(e,i,o,s,c)}function ej(e,i,o){var s=i.pendingProps,c=s.children,g=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=o;else{if(!(o&1073741824))return e=g!==null?g.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(fj,gj),gj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=g!==null?g.baseLanes:o,G(fj,gj),gj|=s}else g!==null?(s=g.baseLanes|o,i.memoizedState=null):s=o,G(fj,gj),gj|=s;return Yi(e,i,c,o),i.child}function hj(e,i){var o=i.ref;(e===null&&o!==null||e!==null&&e.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function dj(e,i,o,s,c){var g=Zf(o)?Xf:H.current;return g=Yf(i,g),Tg(i,c),o=Xh(e,i,o,s,g,c),s=bi(),e!==null&&!Ug?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~c,$i(e,i,c)):(I&&s&&vg(i),i.flags|=1,Yi(e,i,o,c),i.child)}function ij(e,i,o,s,c){if(Zf(o)){var g=!0;cg(i)}else g=!1;if(Tg(i,c),i.stateNode===null)jj(e,i),ph(i,o,s),rh(i,o,s,c),s=!0;else if(e===null){var b=i.stateNode,$=i.memoizedProps;b.props=$;var _e=b.context,et=o.contextType;typeof et=="object"&&et!==null?et=Vg(et):(et=Zf(o)?Xf:H.current,et=Yf(i,et));var nt=o.getDerivedStateFromProps,ot=typeof nt=="function"||typeof b.getSnapshotBeforeUpdate=="function";ot||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||($!==s||_e!==et)&&qh(i,b,s,et),$g=!1;var ct=i.memoizedState;b.state=ct,gh(i,s,b,c),_e=i.memoizedState,$!==s||ct!==_e||Wf.current||$g?(typeof nt=="function"&&(kh(i,o,nt,s),_e=i.memoizedState),($=$g||oh(i,o,$,s,ct,_e,et))?(ot||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(i.flags|=4194308)):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=s,i.memoizedState=_e),b.props=s,b.state=_e,b.context=et,s=$):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),s=!1)}else{b=i.stateNode,bh(e,i),$=i.memoizedProps,et=i.type===i.elementType?$:Lg(i.type,$),b.props=et,ot=i.pendingProps,ct=b.context,_e=o.contextType,typeof _e=="object"&&_e!==null?_e=Vg(_e):(_e=Zf(o)?Xf:H.current,_e=Yf(i,_e));var at=o.getDerivedStateFromProps;(nt=typeof at=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||($!==ot||ct!==_e)&&qh(i,b,s,_e),$g=!1,ct=i.memoizedState,b.state=ct,gh(i,s,b,c);var lt=i.memoizedState;$!==ot||ct!==lt||Wf.current||$g?(typeof at=="function"&&(kh(i,o,at,s),lt=i.memoizedState),(et=$g||oh(i,o,et,s,ct,lt,_e)||!1)?(nt||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(s,lt,_e),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(s,lt,_e)),typeof b.componentDidUpdate=="function"&&(i.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof b.componentDidUpdate!="function"||$===e.memoizedProps&&ct===e.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||$===e.memoizedProps&&ct===e.memoizedState||(i.flags|=1024),i.memoizedProps=s,i.memoizedState=lt),b.props=s,b.state=lt,b.context=_e,s=et):(typeof b.componentDidUpdate!="function"||$===e.memoizedProps&&ct===e.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||$===e.memoizedProps&&ct===e.memoizedState||(i.flags|=1024),s=!1)}return kj(e,i,o,s,g,c)}function kj(e,i,o,s,c,g){hj(e,i);var b=(i.flags&128)!==0;if(!s&&!b)return c&&dg(i,o,!1),$i(e,i,g);s=i.stateNode,Xi.current=i;var $=b&&typeof o.getDerivedStateFromError!="function"?null:s.render();return i.flags|=1,e!==null&&b?(i.child=Bh(i,e.child,null,g),i.child=Bh(i,null,$,g)):Yi(e,i,$,g),i.memoizedState=s.state,c&&dg(i,o,!0),i.child}function lj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),Ih(e,i.containerInfo)}function mj(e,i,o,s,c){return Ig(),Jg(c),i.flags|=256,Yi(e,i,o,s),i.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(e){return{baseLanes:e,cachePool:null,transitions:null}}function pj(e,i,o){var s=i.pendingProps,c=M.current,g=!1,b=(i.flags&128)!==0,$;if(($=b)||($=e!==null&&e.memoizedState===null?!1:(c&2)!==0),$?(g=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(c|=1),G(M,c&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(b=s.children,e=s.fallback,g?(s=i.mode,g=i.child,b={mode:"hidden",children:b},!(s&1)&&g!==null?(g.childLanes=0,g.pendingProps=b):g=qj(b,s,0,null),e=Ah(e,s,o,null),g.return=i,e.return=i,g.sibling=e,i.child=g,i.child.memoizedState=oj(o),i.memoizedState=nj,e):rj(i,b));if(c=e.memoizedState,c!==null&&($=c.dehydrated,$!==null))return sj(e,i,b,s,$,c,o);if(g){g=s.fallback,b=i.mode,c=e.child,$=c.sibling;var _e={mode:"hidden",children:s.children};return!(b&1)&&i.child!==c?(s=i.child,s.childLanes=0,s.pendingProps=_e,i.deletions=null):(s=wh(c,_e),s.subtreeFlags=c.subtreeFlags&14680064),$!==null?g=wh($,g):(g=Ah(g,b,o,null),g.flags|=2),g.return=i,s.return=i,s.sibling=g,i.child=s,s=g,g=i.child,b=e.child.memoizedState,b=b===null?oj(o):{baseLanes:b.baseLanes|o,cachePool:null,transitions:b.transitions},g.memoizedState=b,g.childLanes=e.childLanes&~o,i.memoizedState=nj,s}return g=e.child,e=g.sibling,s=wh(g,{mode:"visible",children:s.children}),!(i.mode&1)&&(s.lanes=o),s.return=i,s.sibling=null,e!==null&&(o=i.deletions,o===null?(i.deletions=[e],i.flags|=16):o.push(e)),i.child=s,i.memoizedState=null,s}function rj(e,i){return i=qj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function tj(e,i,o,s){return s!==null&&Jg(s),Bh(i,e.child,null,o),e=rj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function sj(e,i,o,s,c,g,b){if(o)return i.flags&256?(i.flags&=-257,s=Li(Error(p(422))),tj(e,i,b,s)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(g=s.fallback,c=i.mode,s=qj({mode:"visible",children:s.children},c,0,null),g=Ah(g,c,b,null),g.flags|=2,s.return=i,g.return=i,s.sibling=g,i.child=s,i.mode&1&&Bh(i,e.child,null,b),i.child.memoizedState=oj(b),i.memoizedState=nj,g);if(!(i.mode&1))return tj(e,i,b,null);if(c.data==="$!"){if(s=c.nextSibling&&c.nextSibling.dataset,s)var $=s.dgst;return s=$,g=Error(p(419)),s=Li(g,s,void 0),tj(e,i,b,s)}if($=(b&e.childLanes)!==0,Ug||$){if(s=R,s!==null){switch(b&-b){case 4:c=2;break;case 16:c=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:c=32;break;case 536870912:c=268435456;break;default:c=0}c=c&(s.suspendedLanes|b)?0:c,c!==0&&c!==g.retryLane&&(g.retryLane=c,Zg(e,c),mh(s,e,c,-1))}return uj(),s=Li(Error(p(421))),tj(e,i,b,s)}return c.data==="$?"?(i.flags|=128,i.child=e.child,i=vj.bind(null,e),c._reactRetry=i,null):(e=g.treeContext,yg=Lf(c.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=rj(i,s.children),i.flags|=4096,i)}function wj(e,i,o){e.lanes|=i;var s=e.alternate;s!==null&&(s.lanes|=i),Sg(e.return,i,o)}function xj(e,i,o,s,c){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:s,tail:o,tailMode:c}:(g.isBackwards=i,g.rendering=null,g.renderingStartTime=0,g.last=s,g.tail=o,g.tailMode=c)}function yj(e,i,o){var s=i.pendingProps,c=s.revealOrder,g=s.tail;if(Yi(e,i,s.children,o),s=M.current,s&2)s=s&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wj(e,o,i);else if(e.tag===19)wj(e,o,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(G(M,s),!(i.mode&1))i.memoizedState=null;else switch(c){case"forwards":for(o=i.child,c=null;o!==null;)e=o.alternate,e!==null&&Mh(e)===null&&(c=o),o=o.sibling;o=c,o===null?(c=i.child,i.child=null):(c=o.sibling,o.sibling=null),xj(i,!1,c,o,g);break;case"backwards":for(o=null,c=i.child,i.child=null;c!==null;){if(e=c.alternate,e!==null&&Mh(e)===null){i.child=c;break}e=c.sibling,c.sibling=o,o=c,c=e}xj(i,!0,o,null,g);break;case"together":xj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function jj(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function $i(e,i,o){if(e!==null&&(i.dependencies=e.dependencies),hh|=i.lanes,!(o&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,o=wh(e,e.pendingProps),i.child=o,o.return=i;e.sibling!==null;)e=e.sibling,o=o.sibling=wh(e,e.pendingProps),o.return=i;o.sibling=null}return i.child}function zj(e,i,o){switch(i.tag){case 3:lj(i),Ig();break;case 5:Kh(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:Ih(i,i.stateNode.containerInfo);break;case 10:var s=i.type._context,c=i.memoizedProps.value;G(Mg,s._currentValue),s._currentValue=c;break;case 13:if(s=i.memoizedState,s!==null)return s.dehydrated!==null?(G(M,M.current&1),i.flags|=128,null):o&i.child.childLanes?pj(e,i,o):(G(M,M.current&1),e=$i(e,i,o),e!==null?e.sibling:null);G(M,M.current&1);break;case 19:if(s=(o&i.childLanes)!==0,e.flags&128){if(s)return yj(e,i,o);i.flags|=128}if(c=i.memoizedState,c!==null&&(c.rendering=null,c.tail=null,c.lastEffect=null),G(M,M.current),s)break;return null;case 22:case 23:return i.lanes=0,ej(e,i,o)}return $i(e,i,o)}var Aj,Bj,Cj,Dj;Aj=function(e,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}};Bj=function(){};Cj=function(e,i,o,s){var c=e.memoizedProps;if(c!==s){e=i.stateNode,Hh(Eh.current);var g=null;switch(o){case"input":c=Ya(e,c),s=Ya(e,s),g=[];break;case"select":c=A({},c,{value:void 0}),s=A({},s,{value:void 0}),g=[];break;case"textarea":c=gb(e,c),s=gb(e,s),g=[];break;default:typeof c.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Bf)}ub(o,s);var b;o=null;for(et in c)if(!s.hasOwnProperty(et)&&c.hasOwnProperty(et)&&c[et]!=null)if(et==="style"){var $=c[et];for(b in $)$.hasOwnProperty(b)&&(o||(o={}),o[b]="")}else et!=="dangerouslySetInnerHTML"&&et!=="children"&&et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&et!=="autoFocus"&&(ea.hasOwnProperty(et)?g||(g=[]):(g=g||[]).push(et,null));for(et in s){var _e=s[et];if($=c!=null?c[et]:void 0,s.hasOwnProperty(et)&&_e!==$&&(_e!=null||$!=null))if(et==="style")if($){for(b in $)!$.hasOwnProperty(b)||_e&&_e.hasOwnProperty(b)||(o||(o={}),o[b]="");for(b in _e)_e.hasOwnProperty(b)&&$[b]!==_e[b]&&(o||(o={}),o[b]=_e[b])}else o||(g||(g=[]),g.push(et,o)),o=_e;else et==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,$=$?$.__html:void 0,_e!=null&&$!==_e&&(g=g||[]).push(et,_e)):et==="children"?typeof _e!="string"&&typeof _e!="number"||(g=g||[]).push(et,""+_e):et!=="suppressContentEditableWarning"&&et!=="suppressHydrationWarning"&&(ea.hasOwnProperty(et)?(_e!=null&&et==="onScroll"&&D("scroll",e),g||$===_e||(g=[])):(g=g||[]).push(et,_e))}o&&(g=g||[]).push("style",o);var et=g;(i.updateQueue=et)&&(i.flags|=4)}};Dj=function(e,i,o,s){o!==s&&(i.flags|=4)};function Ej(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?e.tail=null:o.sibling=null;break;case"collapsed":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,o=0,s=0;if(i)for(var c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags&14680064,s|=c.flags&14680064,c.return=e,c=c.sibling;else for(c=e.child;c!==null;)o|=c.lanes|c.childLanes,s|=c.subtreeFlags,s|=c.flags,c.return=e,c=c.sibling;return e.subtreeFlags|=s,e.childLanes=o,i}function Fj(e,i,o){var s=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return s=i.stateNode,Jh(),E(Wf),E(H),Oh(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(e,i),S(i),null;case 5:Lh(i);var c=Hh(Gh.current);if(o=i.type,e!==null&&i.stateNode!=null)Cj(e,i,o,s,c),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!s){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=Hh(Eh.current),Gg(i)){s=i.stateNode,o=i.type;var g=i.memoizedProps;switch(s[Of]=i,s[Pf]=g,e=(i.mode&1)!==0,o){case"dialog":D("cancel",s),D("close",s);break;case"iframe":case"object":case"embed":D("load",s);break;case"video":case"audio":for(c=0;c<lf.length;c++)D(lf[c],s);break;case"source":D("error",s);break;case"img":case"image":case"link":D("error",s),D("load",s);break;case"details":D("toggle",s);break;case"input":Za(s,g),D("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!g.multiple},D("invalid",s);break;case"textarea":hb(s,g),D("invalid",s)}ub(o,g),c=null;for(var b in g)if(g.hasOwnProperty(b)){var $=g[b];b==="children"?typeof $=="string"?s.textContent!==$&&(g.suppressHydrationWarning!==!0&&Af(s.textContent,$,e),c=["children",$]):typeof $=="number"&&s.textContent!==""+$&&(g.suppressHydrationWarning!==!0&&Af(s.textContent,$,e),c=["children",""+$]):ea.hasOwnProperty(b)&&$!=null&&b==="onScroll"&&D("scroll",s)}switch(o){case"input":Va(s),db(s,g,!0);break;case"textarea":Va(s),jb(s);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(s.onclick=Bf)}s=c,i.updateQueue=s,s!==null&&(i.flags|=4)}else{b=c.nodeType===9?c:c.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(o)),e==="http://www.w3.org/1999/xhtml"?o==="script"?(e=b.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=b.createElement(o,{is:s.is}):(e=b.createElement(o),o==="select"&&(b=e,s.multiple?b.multiple=!0:s.size&&(b.size=s.size))):e=b.createElementNS(e,o),e[Of]=i,e[Pf]=s,Aj(e,i,!1,!1),i.stateNode=e;e:{switch(b=vb(o,s),o){case"dialog":D("cancel",e),D("close",e),c=s;break;case"iframe":case"object":case"embed":D("load",e),c=s;break;case"video":case"audio":for(c=0;c<lf.length;c++)D(lf[c],e);c=s;break;case"source":D("error",e),c=s;break;case"img":case"image":case"link":D("error",e),D("load",e),c=s;break;case"details":D("toggle",e),c=s;break;case"input":Za(e,s),c=Ya(e,s),D("invalid",e);break;case"option":c=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},c=A({},s,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,s),c=gb(e,s),D("invalid",e);break;default:c=s}ub(o,c),$=c;for(g in $)if($.hasOwnProperty(g)){var _e=$[g];g==="style"?sb(e,_e):g==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,_e!=null&&nb(e,_e)):g==="children"?typeof _e=="string"?(o!=="textarea"||_e!=="")&&ob(e,_e):typeof _e=="number"&&ob(e,""+_e):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(ea.hasOwnProperty(g)?_e!=null&&g==="onScroll"&&D("scroll",e):_e!=null&&ta(e,g,_e,b))}switch(o){case"input":Va(e),db(e,s,!1);break;case"textarea":Va(e),jb(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Sa(s.value));break;case"select":e.multiple=!!s.multiple,g=s.value,g!=null?fb(e,!!s.multiple,g,!1):s.defaultValue!=null&&fb(e,!!s.multiple,s.defaultValue,!0);break;default:typeof c.onClick=="function"&&(e.onclick=Bf)}switch(o){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Dj(e,i,e.memoizedProps,s);else{if(typeof s!="string"&&i.stateNode===null)throw Error(p(166));if(o=Hh(Gh.current),Hh(Eh.current),Gg(i)){if(s=i.stateNode,o=i.memoizedProps,s[Of]=i,(g=s.nodeValue!==o)&&(e=xg,e!==null))switch(e.tag){case 3:Af(s.nodeValue,o,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(s.nodeValue,o,(e.mode&1)!==0)}g&&(i.flags|=4)}else s=(o.nodeType===9?o:o.ownerDocument).createTextNode(s),s[Of]=i,i.stateNode=s}return S(i),null;case 13:if(E(M),s=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,g=!1;else if(g=Gg(i),s!==null&&s.dehydrated!==null){if(e===null){if(!g)throw Error(p(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(p(317));g[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),g=!1}else zg!==null&&(Gj(zg),zg=null),g=!0;if(!g)return i.flags&65536?i:null}return i.flags&128?(i.lanes=o,i):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(i.child.flags|=8192,i.mode&1&&(e===null||M.current&1?T===0&&(T=3):uj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return Jh(),Bj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return Rg(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(M),g=i.memoizedState,g===null)return S(i),null;if(s=(i.flags&128)!==0,b=g.rendering,b===null)if(s)Ej(g,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(b=Mh(e),b!==null){for(i.flags|=128,Ej(g,!1),s=b.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),i.subtreeFlags=0,s=o,o=i.child;o!==null;)g=o,e=s,g.flags&=14680066,b=g.alternate,b===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=b.childLanes,g.lanes=b.lanes,g.child=b.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=b.memoizedProps,g.memoizedState=b.memoizedState,g.updateQueue=b.updateQueue,g.type=b.type,e=b.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),o=o.sibling;return G(M,M.current&1|2),i.child}e=e.sibling}g.tail!==null&&B()>Hj&&(i.flags|=128,s=!0,Ej(g,!1),i.lanes=4194304)}else{if(!s)if(e=Mh(b),e!==null){if(i.flags|=128,s=!0,o=e.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),Ej(g,!0),g.tail===null&&g.tailMode==="hidden"&&!b.alternate&&!I)return S(i),null}else 2*B()-g.renderingStartTime>Hj&&o!==1073741824&&(i.flags|=128,s=!0,Ej(g,!1),i.lanes=4194304);g.isBackwards?(b.sibling=i.child,i.child=b):(o=g.last,o!==null?o.sibling=b:i.child=b,g.last=b)}return g.tail!==null?(i=g.tail,g.rendering=i,g.tail=i.sibling,g.renderingStartTime=B(),i.sibling=null,o=M.current,G(M,s?o&1|2:o&1),i):(S(i),null);case 22:case 23:return Ij(),s=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(i.flags|=8192),s&&i.mode&1?gj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Jj(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return Jh(),E(Wf),E(H),Oh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Lh(i),null;case 13:if(E(M),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(i.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(e,i){var o=e.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(s){W(e,i,s)}else o.current=null}function Nj(e,i,o){try{o()}catch(s){W(e,i,s)}}var Oj=!1;function Pj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var o={start:e.selectionStart,end:e.selectionEnd};else e:{o=(o=e.ownerDocument)&&o.defaultView||window;var s=o.getSelection&&o.getSelection();if(s&&s.rangeCount!==0){o=s.anchorNode;var c=s.anchorOffset,g=s.focusNode;s=s.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var b=0,$=-1,_e=-1,et=0,nt=0,ot=e,ct=null;t:for(;;){for(var at;ot!==o||c!==0&&ot.nodeType!==3||($=b+c),ot!==g||s!==0&&ot.nodeType!==3||(_e=b+s),ot.nodeType===3&&(b+=ot.nodeValue.length),(at=ot.firstChild)!==null;)ct=ot,ot=at;for(;;){if(ot===e)break t;if(ct===o&&++et===c&&($=b),ct===g&&++nt===s&&(_e=b),(at=ot.nextSibling)!==null)break;ot=ct,ct=ot.parentNode}ot=at}o=$===-1||_e===-1?null:{start:$,end:_e}}else o=null}o=o||{start:0,end:0}}else o=null;for(Df={focusedElem:e,selectionRange:o},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var lt=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var gt=lt.memoizedProps,wt=lt.memoizedState,ft=i.stateNode,ut=ft.getSnapshotBeforeUpdate(i.elementType===i.type?gt:Lg(i.type,gt),wt);ft.__reactInternalSnapshotBeforeUpdate=ut}break;case 3:var pt=i.stateNode.containerInfo;pt.nodeType===1?pt.textContent="":pt.nodeType===9&&pt.documentElement&&pt.removeChild(pt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(vt){W(i,i.return,vt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return lt=Oj,Oj=!1,lt}function Qj(e,i,o){var s=i.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&e)===e){var g=c.destroy;c.destroy=void 0,g!==void 0&&Nj(i,o,g)}c=c.next}while(c!==s)}}function Rj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var s=o.create;o.destroy=s()}o=o.next}while(o!==i)}}function Sj(e){var i=e.ref;if(i!==null){var o=e.stateNode;switch(e.tag){case 5:e=o;break;default:e=o}typeof i=="function"?i(e):i.current=e}}function Tj(e){var i=e.alternate;i!==null&&(e.alternate=null,Tj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Uj(e){return e.tag===5||e.tag===3||e.tag===4}function Vj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Uj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wj(e,i,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(e,i):o.insertBefore(e,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(e,o)):(i=o,i.appendChild(e)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Bf));else if(s!==4&&(e=e.child,e!==null))for(Wj(e,i,o),e=e.sibling;e!==null;)Wj(e,i,o),e=e.sibling}function Xj(e,i,o){var s=e.tag;if(s===5||s===6)e=e.stateNode,i?o.insertBefore(e,i):o.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Xj(e,i,o),e=e.sibling;e!==null;)Xj(e,i,o),e=e.sibling}var X=null,Yj=!1;function Zj(e,i,o){for(o=o.child;o!==null;)ak(e,i,o),o=o.sibling}function ak(e,i,o){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,o)}catch{}switch(o.tag){case 5:U||Mj(o,i);case 6:var s=X,c=Yj;X=null,Zj(e,i,o),X=s,Yj=c,X!==null&&(Yj?(e=X,o=o.stateNode,e.nodeType===8?e.parentNode.removeChild(o):e.removeChild(o)):X.removeChild(o.stateNode));break;case 18:X!==null&&(Yj?(e=X,o=o.stateNode,e.nodeType===8?Kf(e.parentNode,o):e.nodeType===1&&Kf(e,o),bd(e)):Kf(X,o.stateNode));break;case 4:s=X,c=Yj,X=o.stateNode.containerInfo,Yj=!0,Zj(e,i,o),X=s,Yj=c;break;case 0:case 11:case 14:case 15:if(!U&&(s=o.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){c=s=s.next;do{var g=c,b=g.destroy;g=g.tag,b!==void 0&&(g&2||g&4)&&Nj(o,i,b),c=c.next}while(c!==s)}Zj(e,i,o);break;case 1:if(!U&&(Mj(o,i),s=o.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=o.memoizedProps,s.state=o.memoizedState,s.componentWillUnmount()}catch($){W(o,i,$)}Zj(e,i,o);break;case 21:Zj(e,i,o);break;case 22:o.mode&1?(U=(s=U)||o.memoizedState!==null,Zj(e,i,o),U=s):Zj(e,i,o);break;default:Zj(e,i,o)}}function bk(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var o=e.stateNode;o===null&&(o=e.stateNode=new Lj),i.forEach(function(s){var c=ck.bind(null,e,s);o.has(s)||(o.add(s),s.then(c,c))})}}function dk(e,i){var o=i.deletions;if(o!==null)for(var s=0;s<o.length;s++){var c=o[s];try{var g=e,b=i,$=b;e:for(;$!==null;){switch($.tag){case 5:X=$.stateNode,Yj=!1;break e;case 3:X=$.stateNode.containerInfo,Yj=!0;break e;case 4:X=$.stateNode.containerInfo,Yj=!0;break e}$=$.return}if(X===null)throw Error(p(160));ak(g,b,c),X=null,Yj=!1;var _e=c.alternate;_e!==null&&(_e.return=null),c.return=null}catch(et){W(c,i,et)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)ek(i,e),i=i.sibling}function ek(e,i){var o=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dk(i,e),fk(e),s&4){try{Qj(3,e,e.return),Rj(3,e)}catch(gt){W(e,e.return,gt)}try{Qj(5,e,e.return)}catch(gt){W(e,e.return,gt)}}break;case 1:dk(i,e),fk(e),s&512&&o!==null&&Mj(o,o.return);break;case 5:if(dk(i,e),fk(e),s&512&&o!==null&&Mj(o,o.return),e.flags&32){var c=e.stateNode;try{ob(c,"")}catch(gt){W(e,e.return,gt)}}if(s&4&&(c=e.stateNode,c!=null)){var g=e.memoizedProps,b=o!==null?o.memoizedProps:g,$=e.type,_e=e.updateQueue;if(e.updateQueue=null,_e!==null)try{$==="input"&&g.type==="radio"&&g.name!=null&&ab(c,g),vb($,b);var et=vb($,g);for(b=0;b<_e.length;b+=2){var nt=_e[b],ot=_e[b+1];nt==="style"?sb(c,ot):nt==="dangerouslySetInnerHTML"?nb(c,ot):nt==="children"?ob(c,ot):ta(c,nt,ot,et)}switch($){case"input":bb(c,g);break;case"textarea":ib(c,g);break;case"select":var ct=c._wrapperState.wasMultiple;c._wrapperState.wasMultiple=!!g.multiple;var at=g.value;at!=null?fb(c,!!g.multiple,at,!1):ct!==!!g.multiple&&(g.defaultValue!=null?fb(c,!!g.multiple,g.defaultValue,!0):fb(c,!!g.multiple,g.multiple?[]:"",!1))}c[Pf]=g}catch(gt){W(e,e.return,gt)}}break;case 6:if(dk(i,e),fk(e),s&4){if(e.stateNode===null)throw Error(p(162));c=e.stateNode,g=e.memoizedProps;try{c.nodeValue=g}catch(gt){W(e,e.return,gt)}}break;case 3:if(dk(i,e),fk(e),s&4&&o!==null&&o.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(gt){W(e,e.return,gt)}break;case 4:dk(i,e),fk(e);break;case 13:dk(i,e),fk(e),c=e.child,c.flags&8192&&(g=c.memoizedState!==null,c.stateNode.isHidden=g,!g||c.alternate!==null&&c.alternate.memoizedState!==null||(gk=B())),s&4&&bk(e);break;case 22:if(nt=o!==null&&o.memoizedState!==null,e.mode&1?(U=(et=U)||nt,dk(i,e),U=et):dk(i,e),fk(e),s&8192){if(et=e.memoizedState!==null,(e.stateNode.isHidden=et)&&!nt&&e.mode&1)for(V=e,nt=e.child;nt!==null;){for(ot=V=nt;V!==null;){switch(ct=V,at=ct.child,ct.tag){case 0:case 11:case 14:case 15:Qj(4,ct,ct.return);break;case 1:Mj(ct,ct.return);var lt=ct.stateNode;if(typeof lt.componentWillUnmount=="function"){s=ct,o=ct.return;try{i=s,lt.props=i.memoizedProps,lt.state=i.memoizedState,lt.componentWillUnmount()}catch(gt){W(s,o,gt)}}break;case 5:Mj(ct,ct.return);break;case 22:if(ct.memoizedState!==null){hk(ot);continue}}at!==null?(at.return=ct,V=at):hk(ot)}nt=nt.sibling}e:for(nt=null,ot=e;;){if(ot.tag===5){if(nt===null){nt=ot;try{c=ot.stateNode,et?(g=c.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):($=ot.stateNode,_e=ot.memoizedProps.style,b=_e!=null&&_e.hasOwnProperty("display")?_e.display:null,$.style.display=rb("display",b))}catch(gt){W(e,e.return,gt)}}}else if(ot.tag===6){if(nt===null)try{ot.stateNode.nodeValue=et?"":ot.memoizedProps}catch(gt){W(e,e.return,gt)}}else if((ot.tag!==22&&ot.tag!==23||ot.memoizedState===null||ot===e)&&ot.child!==null){ot.child.return=ot,ot=ot.child;continue}if(ot===e)break e;for(;ot.sibling===null;){if(ot.return===null||ot.return===e)break e;nt===ot&&(nt=null),ot=ot.return}nt===ot&&(nt=null),ot.sibling.return=ot.return,ot=ot.sibling}}break;case 19:dk(i,e),fk(e),s&4&&bk(e);break;case 21:break;default:dk(i,e),fk(e)}}function fk(e){var i=e.flags;if(i&2){try{e:{for(var o=e.return;o!==null;){if(Uj(o)){var s=o;break e}o=o.return}throw Error(p(160))}switch(s.tag){case 5:var c=s.stateNode;s.flags&32&&(ob(c,""),s.flags&=-33);var g=Vj(e);Xj(e,g,c);break;case 3:case 4:var b=s.stateNode.containerInfo,$=Vj(e);Wj(e,$,b);break;default:throw Error(p(161))}}catch(_e){W(e,e.return,_e)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function ik(e,i,o){V=e,jk(e)}function jk(e,i,o){for(var s=(e.mode&1)!==0;V!==null;){var c=V,g=c.child;if(c.tag===22&&s){var b=c.memoizedState!==null||Kj;if(!b){var $=c.alternate,_e=$!==null&&$.memoizedState!==null||U;$=Kj;var et=U;if(Kj=b,(U=_e)&&!et)for(V=c;V!==null;)b=V,_e=b.child,b.tag===22&&b.memoizedState!==null?kk(c):_e!==null?(_e.return=b,V=_e):kk(c);for(;g!==null;)V=g,jk(g),g=g.sibling;V=c,Kj=$,U=et}lk(e)}else c.subtreeFlags&8772&&g!==null?(g.return=c,V=g):lk(e)}}function lk(e){for(;V!==null;){var i=V;if(i.flags&8772){var o=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Rj(5,i);break;case 1:var s=i.stateNode;if(i.flags&4&&!U)if(o===null)s.componentDidMount();else{var c=i.elementType===i.type?o.memoizedProps:Lg(i.type,o.memoizedProps);s.componentDidUpdate(c,o.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var g=i.updateQueue;g!==null&&ih(i,g,s);break;case 3:var b=i.updateQueue;if(b!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}ih(i,b,o)}break;case 5:var $=i.stateNode;if(o===null&&i.flags&4){o=$;var _e=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":_e.autoFocus&&o.focus();break;case"img":_e.src&&(o.src=_e.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var et=i.alternate;if(et!==null){var nt=et.memoizedState;if(nt!==null){var ot=nt.dehydrated;ot!==null&&bd(ot)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||i.flags&512&&Sj(i)}catch(ct){W(i,i.return,ct)}}if(i===e){V=null;break}if(o=i.sibling,o!==null){o.return=i.return,V=o;break}V=i.return}}function hk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var o=i.sibling;if(o!==null){o.return=i.return,V=o;break}V=i.return}}function kk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{Rj(4,i)}catch(_e){W(i,o,_e)}break;case 1:var s=i.stateNode;if(typeof s.componentDidMount=="function"){var c=i.return;try{s.componentDidMount()}catch(_e){W(i,c,_e)}}var g=i.return;try{Sj(i)}catch(_e){W(i,g,_e)}break;case 5:var b=i.return;try{Sj(i)}catch(_e){W(i,b,_e)}}}catch(_e){W(i,i.return,_e)}if(i===e){V=null;break}var $=i.sibling;if($!==null){$.return=i.return,V=$;break}V=i.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function mh(e,i,o,s){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac(e,o,s),(!(K&2)||e!==R)&&(e===R&&(!(K&2)&&(rk|=o),T===4&&Dk(e,Z)),Ek(e,s),o===1&&K===0&&!(i.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(e,i){var o=e.callbackNode;wc(e,i);var s=uc(e,e===R?Z:0);if(s===0)o!==null&&bc(o),e.callbackNode=null,e.callbackPriority=0;else if(i=s&-s,e.callbackPriority!==i){if(o!=null&&bc(o),i===1)e.tag===0?ig(Fk.bind(null,e)):hg(Fk.bind(null,e)),Jf(function(){!(K&6)&&jg()}),o=null;else{switch(Dc(s)){case 1:o=fc;break;case 4:o=gc;break;case 16:o=hc;break;case 536870912:o=jc;break;default:o=hc}o=Gk(o,Hk.bind(null,e))}e.callbackPriority=i,e.callbackNode=o}}function Hk(e,i){if(Bk=-1,Ck=0,K&6)throw Error(p(327));var o=e.callbackNode;if(Ik()&&e.callbackNode!==o)return null;var s=uc(e,e===R?Z:0);if(s===0)return null;if(s&30||s&e.expiredLanes||i)i=Jk(e,s);else{i=s;var c=K;K|=2;var g=Kk();(R!==e||Z!==i)&&(vk=null,Hj=B()+500,Lk(e,i));do try{Mk();break}catch($){Nk(e,$)}while(1);Qg(),nk.current=g,K=c,Y!==null?i=0:(R=null,Z=0,i=T)}if(i!==0){if(i===2&&(c=xc(e),c!==0&&(s=c,i=Ok(e,c))),i===1)throw o=qk,Lk(e,0),Dk(e,s),Ek(e,B()),o;if(i===6)Dk(e,s);else{if(c=e.current.alternate,!(s&30)&&!Pk(c)&&(i=Jk(e,s),i===2&&(g=xc(e),g!==0&&(s=g,i=Ok(e,g))),i===1))throw o=qk,Lk(e,0),Dk(e,s),Ek(e,B()),o;switch(e.finishedWork=c,e.finishedLanes=s,i){case 0:case 1:throw Error(p(345));case 2:Qk(e,uk,vk);break;case 3:if(Dk(e,s),(s&130023424)===s&&(i=gk+500-B(),10<i)){if(uc(e,0)!==0)break;if(c=e.suspendedLanes,(c&s)!==s){L(),e.pingedLanes|=e.suspendedLanes&c;break}e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),i);break}Qk(e,uk,vk);break;case 4:if(Dk(e,s),(s&4194240)===s)break;for(i=e.eventTimes,c=-1;0<s;){var b=31-oc(s);g=1<<b,b=i[b],b>c&&(c=b),s&=~g}if(s=c,s=B()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*mk(s/1960))-s,10<s){e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),s);break}Qk(e,uk,vk);break;case 5:Qk(e,uk,vk);break;default:throw Error(p(329))}}}return Ek(e,B()),e.callbackNode===o?Hk.bind(null,e):null}function Ok(e,i){var o=tk;return e.current.memoizedState.isDehydrated&&(Lk(e,i).flags|=256),e=Jk(e,i),e!==2&&(i=uk,uk=o,i!==null&&Gj(i)),e}function Gj(e){uk===null?uk=e:uk.push.apply(uk,e)}function Pk(e){for(var i=e;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var s=0;s<o.length;s++){var c=o[s],g=c.getSnapshot;c=c.value;try{if(!He(g(),c))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Dk(e,i){for(i&=~sk,i&=~rk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var o=31-oc(i),s=1<<o;e[o]=-1,i&=~s}}function Fk(e){if(K&6)throw Error(p(327));Ik();var i=uc(e,0);if(!(i&1))return Ek(e,B()),null;var o=Jk(e,i);if(e.tag!==0&&o===2){var s=xc(e);s!==0&&(i=s,o=Ok(e,s))}if(o===1)throw o=qk,Lk(e,0),Dk(e,i),Ek(e,B()),o;if(o===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Qk(e,uk,vk),Ek(e,B()),null}function Rk(e,i){var o=K;K|=1;try{return e(i)}finally{K=o,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(e){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var i=K;K|=1;var o=pk.transition,s=C;try{if(pk.transition=null,C=1,e)return e()}finally{C=s,pk.transition=o,K=i,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(e,i){e.finishedWork=null,e.finishedLanes=0;var o=e.timeoutHandle;if(o!==-1&&(e.timeoutHandle=-1,Gf(o)),Y!==null)for(o=Y.return;o!==null;){var s=o;switch(wg(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(s);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(s.type._context);break;case 22:case 23:Ij()}o=o.return}if(R=e,Y=e=wh(e.current,null),Z=gj=i,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(i=0;i<Wg.length;i++)if(o=Wg[i],s=o.interleaved,s!==null){o.interleaved=null;var c=s.next,g=o.pending;if(g!==null){var b=g.next;g.next=c,s.next=b}o.pending=s}Wg=null}return e}function Nk(e,i){do{var o=Y;try{if(Qg(),Ph.current=ai,Sh){for(var s=N.memoizedState;s!==null;){var c=s.queue;c!==null&&(c.pending=null),s=s.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,o===null||o.return===null){T=1,qk=i,Y=null;break}e:{var g=e,b=o.return,$=o,_e=i;if(i=Z,$.flags|=32768,_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var et=_e,nt=$,ot=nt.tag;if(!(nt.mode&1)&&(ot===0||ot===11||ot===15)){var ct=nt.alternate;ct?(nt.updateQueue=ct.updateQueue,nt.memoizedState=ct.memoizedState,nt.lanes=ct.lanes):(nt.updateQueue=null,nt.memoizedState=null)}var at=Vi(b);if(at!==null){at.flags&=-257,Wi(at,b,$,g,i),at.mode&1&&Ti(g,et,i),i=at,_e=et;var lt=i.updateQueue;if(lt===null){var gt=new Set;gt.add(_e),i.updateQueue=gt}else lt.add(_e);break e}else{if(!(i&1)){Ti(g,et,i),uj();break e}_e=Error(p(426))}}else if(I&&$.mode&1){var wt=Vi(b);if(wt!==null){!(wt.flags&65536)&&(wt.flags|=256),Wi(wt,b,$,g,i),Jg(Ki(_e,$));break e}}g=_e=Ki(_e,$),T!==4&&(T=2),tk===null?tk=[g]:tk.push(g),g=b;do{switch(g.tag){case 3:g.flags|=65536,i&=-i,g.lanes|=i;var ft=Oi(g,_e,i);fh(g,ft);break e;case 1:$=_e;var ut=g.type,pt=g.stateNode;if(!(g.flags&128)&&(typeof ut.getDerivedStateFromError=="function"||pt!==null&&typeof pt.componentDidCatch=="function"&&(Si===null||!Si.has(pt)))){g.flags|=65536,i&=-i,g.lanes|=i;var vt=Ri(g,$,i);fh(g,vt);break e}}g=g.return}while(g!==null)}Tk(o)}catch(bt){i=bt,Y===o&&o!==null&&(Y=o=o.return);continue}break}while(1)}function Kk(){var e=nk.current;return nk.current=ai,e===null?ai:e}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk(e,i){var o=K;K|=2;var s=Kk();(R!==e||Z!==i)&&(vk=null,Lk(e,i));do try{Uk();break}catch(c){Nk(e,c)}while(1);if(Qg(),K=o,nk.current=s,Y!==null)throw Error(p(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(e){var i=Wk(e.alternate,e,gj);e.memoizedProps=e.pendingProps,i===null?Tk(e):Y=i,ok.current=null}function Tk(e){var i=e;do{var o=i.alternate;if(e=i.return,i.flags&32768){if(o=Jj(o,i),o!==null){o.flags&=32767,Y=o;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(o=Fj(o,i,gj),o!==null){Y=o;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Qk(e,i,o){var s=C,c=pk.transition;try{pk.transition=null,C=1,Xk(e,i,o,s)}finally{pk.transition=c,C=s}return null}function Xk(e,i,o,s){do Ik();while(xk!==null);if(K&6)throw Error(p(327));o=e.finishedWork;var c=e.finishedLanes;if(o===null)return null;if(e.finishedWork=null,e.finishedLanes=0,o===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var g=o.lanes|o.childLanes;if(Bc(e,g),e===R&&(Y=R=null,Z=0),!(o.subtreeFlags&2064)&&!(o.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),g=(o.flags&15990)!==0,o.subtreeFlags&15990||g){g=pk.transition,pk.transition=null;var b=C;C=1;var $=K;K|=4,ok.current=null,Pj(e,o),ek(o,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=o,ik(o),dc(),K=$,C=b,pk.transition=g}else e.current=o;if(wk&&(wk=!1,xk=e,yk=c),g=e.pendingLanes,g===0&&(Si=null),mc(o.stateNode),Ek(e,B()),i!==null)for(s=e.onRecoverableError,o=0;o<i.length;o++)c=i[o],s(c.value,{componentStack:c.stack,digest:c.digest});if(Pi)throw Pi=!1,e=Qi,Qi=null,e;return yk&1&&e.tag!==0&&Ik(),g=e.pendingLanes,g&1?e===Ak?zk++:(zk=0,Ak=e):zk=0,jg(),null}function Ik(){if(xk!==null){var e=Dc(yk),i=pk.transition,o=C;try{if(pk.transition=null,C=16>e?16:e,xk===null)var s=!1;else{if(e=xk,xk=null,yk=0,K&6)throw Error(p(331));var c=K;for(K|=4,V=e.current;V!==null;){var g=V,b=g.child;if(V.flags&16){var $=g.deletions;if($!==null){for(var _e=0;_e<$.length;_e++){var et=$[_e];for(V=et;V!==null;){var nt=V;switch(nt.tag){case 0:case 11:case 15:Qj(8,nt,g)}var ot=nt.child;if(ot!==null)ot.return=nt,V=ot;else for(;V!==null;){nt=V;var ct=nt.sibling,at=nt.return;if(Tj(nt),nt===et){V=null;break}if(ct!==null){ct.return=at,V=ct;break}V=at}}}var lt=g.alternate;if(lt!==null){var gt=lt.child;if(gt!==null){lt.child=null;do{var wt=gt.sibling;gt.sibling=null,gt=wt}while(gt!==null)}}V=g}}if(g.subtreeFlags&2064&&b!==null)b.return=g,V=b;else e:for(;V!==null;){if(g=V,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Qj(9,g,g.return)}var ft=g.sibling;if(ft!==null){ft.return=g.return,V=ft;break e}V=g.return}}var ut=e.current;for(V=ut;V!==null;){b=V;var pt=b.child;if(b.subtreeFlags&2064&&pt!==null)pt.return=b,V=pt;else e:for(b=ut;V!==null;){if($=V,$.flags&2048)try{switch($.tag){case 0:case 11:case 15:Rj(9,$)}}catch(bt){W($,$.return,bt)}if($===b){V=null;break e}var vt=$.sibling;if(vt!==null){vt.return=$.return,V=vt;break e}V=$.return}}if(K=c,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}s=!0}return s}finally{C=o,pk.transition=i}}return!1}function Yk(e,i,o){i=Ki(o,i),i=Oi(e,i,1),e=dh(e,i,1),i=L(),e!==null&&(Ac(e,1,i),Ek(e,i))}function W(e,i,o){if(e.tag===3)Yk(e,e,o);else for(;i!==null;){if(i.tag===3){Yk(i,e,o);break}else if(i.tag===1){var s=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Si===null||!Si.has(s))){e=Ki(o,e),e=Ri(i,e,1),i=dh(i,e,1),e=L(),i!==null&&(Ac(i,1,e),Ek(i,e));break}}i=i.return}}function Ui(e,i,o){var s=e.pingCache;s!==null&&s.delete(i),i=L(),e.pingedLanes|=e.suspendedLanes&o,R===e&&(Z&o)===o&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(e,0):sk|=o),Ek(e,i)}function Zk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var o=L();e=Zg(e,i),e!==null&&(Ac(e,i,o),Ek(e,o))}function vj(e){var i=e.memoizedState,o=0;i!==null&&(o=i.retryLane),Zk(e,o)}function ck(e,i){var o=0;switch(e.tag){case 13:var s=e.stateNode,c=e.memoizedState;c!==null&&(o=c.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(p(314))}s!==null&&s.delete(i),Zk(e,o)}var Wk;Wk=function(e,i,o){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)Ug=!0;else{if(!(e.lanes&o)&&!(i.flags&128))return Ug=!1,zj(e,i,o);Ug=!!(e.flags&131072)}else Ug=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var s=i.type;jj(e,i),e=i.pendingProps;var c=Yf(i,H.current);Tg(i,o),c=Xh(null,i,s,e,c,o);var g=bi();return i.flags|=1,typeof c=="object"&&c!==null&&typeof c.render=="function"&&c.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(s)?(g=!0,cg(i)):g=!1,i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,ah(i),c.updater=nh,i.stateNode=c,c._reactInternals=i,rh(i,s,e,o),i=kj(null,i,s,!0,g,o)):(i.tag=0,I&&g&&vg(i),Yi(null,i,c,o),i=i.child),i;case 16:s=i.elementType;e:{switch(jj(e,i),e=i.pendingProps,c=s._init,s=c(s._payload),i.type=s,c=i.tag=$k(s),e=Lg(s,e),c){case 0:i=dj(null,i,s,e,o);break e;case 1:i=ij(null,i,s,e,o);break e;case 11:i=Zi(null,i,s,e,o);break e;case 14:i=aj(null,i,s,Lg(s.type,e),o);break e}throw Error(p(306,s,""))}return i;case 0:return s=i.type,c=i.pendingProps,c=i.elementType===s?c:Lg(s,c),dj(e,i,s,c,o);case 1:return s=i.type,c=i.pendingProps,c=i.elementType===s?c:Lg(s,c),ij(e,i,s,c,o);case 3:e:{if(lj(i),e===null)throw Error(p(387));s=i.pendingProps,g=i.memoizedState,c=g.element,bh(e,i),gh(i,s,null,o);var b=i.memoizedState;if(s=b.element,g.isDehydrated)if(g={element:s,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){c=Ki(Error(p(423)),i),i=mj(e,i,s,o,c);break e}else if(s!==c){c=Ki(Error(p(424)),i),i=mj(e,i,s,o,c);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,o=Ch(i,null,s,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ig(),s===c){i=$i(e,i,o);break e}Yi(e,i,s,o)}i=i.child}return i;case 5:return Kh(i),e===null&&Eg(i),s=i.type,c=i.pendingProps,g=e!==null?e.memoizedProps:null,b=c.children,Ef(s,c)?b=null:g!==null&&Ef(s,g)&&(i.flags|=32),hj(e,i),Yi(e,i,b,o),i.child;case 6:return e===null&&Eg(i),null;case 13:return pj(e,i,o);case 4:return Ih(i,i.stateNode.containerInfo),s=i.pendingProps,e===null?i.child=Bh(i,null,s,o):Yi(e,i,s,o),i.child;case 11:return s=i.type,c=i.pendingProps,c=i.elementType===s?c:Lg(s,c),Zi(e,i,s,c,o);case 7:return Yi(e,i,i.pendingProps,o),i.child;case 8:return Yi(e,i,i.pendingProps.children,o),i.child;case 12:return Yi(e,i,i.pendingProps.children,o),i.child;case 10:e:{if(s=i.type._context,c=i.pendingProps,g=i.memoizedProps,b=c.value,G(Mg,s._currentValue),s._currentValue=b,g!==null)if(He(g.value,b)){if(g.children===c.children&&!Wf.current){i=$i(e,i,o);break e}}else for(g=i.child,g!==null&&(g.return=i);g!==null;){var $=g.dependencies;if($!==null){b=g.child;for(var _e=$.firstContext;_e!==null;){if(_e.context===s){if(g.tag===1){_e=ch(-1,o&-o),_e.tag=2;var et=g.updateQueue;if(et!==null){et=et.shared;var nt=et.pending;nt===null?_e.next=_e:(_e.next=nt.next,nt.next=_e),et.pending=_e}}g.lanes|=o,_e=g.alternate,_e!==null&&(_e.lanes|=o),Sg(g.return,o,i),$.lanes|=o;break}_e=_e.next}}else if(g.tag===10)b=g.type===i.type?null:g.child;else if(g.tag===18){if(b=g.return,b===null)throw Error(p(341));b.lanes|=o,$=b.alternate,$!==null&&($.lanes|=o),Sg(b,o,i),b=g.sibling}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}Yi(e,i,c.children,o),i=i.child}return i;case 9:return c=i.type,s=i.pendingProps.children,Tg(i,o),c=Vg(c),s=s(c),i.flags|=1,Yi(e,i,s,o),i.child;case 14:return s=i.type,c=Lg(s,i.pendingProps),c=Lg(s.type,c),aj(e,i,s,c,o);case 15:return cj(e,i,i.type,i.pendingProps,o);case 17:return s=i.type,c=i.pendingProps,c=i.elementType===s?c:Lg(s,c),jj(e,i),i.tag=1,Zf(s)?(e=!0,cg(i)):e=!1,Tg(i,o),ph(i,s,c),rh(i,s,c,o),kj(null,i,s,!0,e,o);case 19:return yj(e,i,o);case 22:return ej(e,i,o)}throw Error(p(156,i.tag))};function Gk(e,i){return ac(e,i)}function al(e,i,o,s){this.tag=e,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,o,s){return new al(e,i,o,s)}function bj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $k(e){if(typeof e=="function")return bj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function wh(e,i){var o=e.alternate;return o===null?(o=Bg(e.tag,i,e.key,e.mode),o.elementType=e.elementType,o.type=e.type,o.stateNode=e.stateNode,o.alternate=e,e.alternate=o):(o.pendingProps=i,o.type=e.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=e.flags&14680064,o.childLanes=e.childLanes,o.lanes=e.lanes,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,i=e.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=e.sibling,o.index=e.index,o.ref=e.ref,o}function yh(e,i,o,s,c,g){var b=2;if(s=e,typeof e=="function")bj(e)&&(b=1);else if(typeof e=="string")b=5;else e:switch(e){case ya:return Ah(o.children,c,g,i);case za:b=8,c|=8;break;case Aa:return e=Bg(12,o,i,c|2),e.elementType=Aa,e.lanes=g,e;case Ea:return e=Bg(13,o,i,c),e.elementType=Ea,e.lanes=g,e;case Fa:return e=Bg(19,o,i,c),e.elementType=Fa,e.lanes=g,e;case Ia:return qj(o,c,g,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:b=10;break e;case Ca:b=9;break e;case Da:b=11;break e;case Ga:b=14;break e;case Ha:b=16,s=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(b,o,i,c),i.elementType=e,i.type=s,i.lanes=g,i}function Ah(e,i,o,s){return e=Bg(7,e,s,i),e.lanes=o,e}function qj(e,i,o,s){return e=Bg(22,e,s,i),e.elementType=Ia,e.lanes=o,e.stateNode={isHidden:!1},e}function xh(e,i,o){return e=Bg(6,e,null,i),e.lanes=o,e}function zh(e,i,o){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=o,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function bl(e,i,o,s,c){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=s,this.onRecoverableError=c,this.mutableSourceEagerHydrationData=null}function cl(e,i,o,s,c,g,b,$,_e){return e=new bl(e,i,o,$,_e),i===1?(i=1,g===!0&&(i|=8)):i=0,g=Bg(3,null,null,i),e.current=g,g.stateNode=e,g.memoizedState={element:s,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(g),e}function dl(e,i,o){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:s==null?null:""+s,children:e,containerInfo:i,implementation:o}}function el(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var o=e.type;if(Zf(o))return bg(e,o,i)}return i}function fl(e,i,o,s,c,g,b,$,_e){return e=cl(o,s,!0,e,c,g,b,$,_e),e.context=el(null),o=e.current,s=L(),c=lh(o),g=ch(s,c),g.callback=i??null,dh(o,g,c),e.current.lanes=c,Ac(e,c,s),Ek(e,s),e}function gl(e,i,o,s){var c=i.current,g=L(),b=lh(c);return o=el(o),i.context===null?i.context=o:i.pendingContext=o,i=ch(g,b),i.payload={element:e},s=s===void 0?null:s,s!==null&&(i.callback=s),e=dh(c,i,b),e!==null&&(mh(e,c,b,g),eh(e,c,b)),b}function hl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function il(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var o=e.retryLane;e.retryLane=o!==0&&o<i?o:i}}function jl(e,i){il(e,i),(e=e.alternate)&&il(e,i)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(e){console.error(e)};function ml(e){this._internalRoot=e}nl.prototype.render=ml.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));gl(e,i,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Sk(function(){gl(null,e,null,null)}),i[uf]=null}};function nl(e){this._internalRoot=e}nl.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var o=0;o<Qc.length&&i!==0&&i<Qc[o].priority;o++);Qc.splice(o,0,e),o===0&&Vc(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(e,i,o,s,c){if(c){if(typeof s=="function"){var g=s;s=function(){var et=hl(b);g.call(et)}}var b=fl(i,s,e,0,null,!1,!1,"",ql);return e._reactRootContainer=b,e[uf]=b.current,sf(e.nodeType===8?e.parentNode:e),Sk(),b}for(;c=e.lastChild;)e.removeChild(c);if(typeof s=="function"){var $=s;s=function(){var et=hl(_e);$.call(et)}}var _e=cl(e,0,!1,null,null,!1,!1,"",ql);return e._reactRootContainer=_e,e[uf]=_e.current,sf(e.nodeType===8?e.parentNode:e),Sk(function(){gl(i,_e,o,s)}),_e}function sl(e,i,o,s,c){var g=o._reactRootContainer;if(g){var b=g;if(typeof c=="function"){var $=c;c=function(){var _e=hl(b);$.call(_e)}}gl(i,b,e,c)}else b=rl(o,i,e,c,s);return hl(b)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var o=tc(i.pendingLanes);o!==0&&(Cc(i,o|1),Ek(i,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var s=Zg(e,1);if(s!==null){var c=L();mh(s,e,1,c)}}),jl(e,1)}};Fc=function(e){if(e.tag===13){var i=Zg(e,134217728);if(i!==null){var o=L();mh(i,e,134217728,o)}jl(e,134217728)}};Gc=function(e){if(e.tag===13){var i=lh(e),o=Zg(e,i);if(o!==null){var s=L();mh(o,e,i,s)}jl(e,i)}};Hc=function(){return C};Ic=function(e,i){var o=C;try{return C=e,i()}finally{C=o}};yb=function(e,i,o){switch(i){case"input":if(bb(e,o),i=o.name,o.type==="radio"&&i!=null){for(o=e;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var s=o[i];if(s!==e&&s.form===e.form){var c=Db(s);if(!c)throw Error(p(90));Wa(s),bb(s,c)}}}break;case"textarea":ib(e,o);break;case"select":i=o.value,i!=null&&fb(e,!!o.multiple,i,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(e,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(i))throw Error(p(200));return dl(e,i,null,o)};reactDom_production_min.createRoot=function(e,i){if(!ol(e))throw Error(p(299));var o=!1,s="",c=ll;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(c=i.onRecoverableError)),i=cl(e,1,!1,null,null,o,!1,s,c),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ml(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Sk(e)};reactDom_production_min.hydrate=function(e,i,o){if(!pl(i))throw Error(p(200));return sl(null,e,i,!0,o)};reactDom_production_min.hydrateRoot=function(e,i,o){if(!ol(e))throw Error(p(405));var s=o!=null&&o.hydratedSources||null,c=!1,g="",b=ll;if(o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),i=fl(i,null,e,1,o??null,c,!1,g,b),e[uf]=i.current,sf(e),s)for(e=0;e<s.length;e++)o=s[e],c=o._getVersion,c=c(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,c]:i.mutableSourceEagerHydrationData.push(o,c);return new nl(i)};reactDom_production_min.render=function(e,i,o){if(!pl(i))throw Error(p(200));return sl(null,e,i,!1,o)};reactDom_production_min.unmountComponentAtNode=function(e){if(!pl(e))throw Error(p(40));return e._reactRootContainer?(Sk(function(){sl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,o,s){if(!pl(o))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return sl(e,i,o,!1,s)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";(function(e){function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(o){console.error(o)}}i(),e.exports=reactDom_production_min})(reactDom);var m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;const App$1="";/**
 * @remix-run/router v1.3.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},_extends$2.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function i(s,c){let{pathname:g,search:b,hash:$}=s.location;return createLocation("",{pathname:g,search:b,hash:$},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function o(s,c){return typeof c=="string"?c:createPath(c)}return getUrlBasedHistory(i,o,null,e)}function invariant(e,i){if(e===!1||e===null||typeof e>"u")throw new Error(i)}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,i){return{usr:e.state,key:e.key,idx:i}}function createLocation(e,i,o,s){return o===void 0&&(o=null),_extends$2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof i=="string"?parsePath(i):i,{state:o,key:i&&i.key||s||createKey()})}function createPath(e){let{pathname:i="/",search:o="",hash:s=""}=e;return o&&o!=="?"&&(i+=o.charAt(0)==="?"?o:"?"+o),s&&s!=="#"&&(i+=s.charAt(0)==="#"?s:"#"+s),i}function parsePath(e){let i={};if(e){let o=e.indexOf("#");o>=0&&(i.hash=e.substr(o),e=e.substr(0,o));let s=e.indexOf("?");s>=0&&(i.search=e.substr(s),e=e.substr(0,s)),e&&(i.pathname=e)}return i}function getUrlBasedHistory(e,i,o,s){s===void 0&&(s={});let{window:c=document.defaultView,v5Compat:g=!1}=s,b=c.history,$=Action.Pop,_e=null,et=nt();et==null&&(et=0,b.replaceState(_extends$2({},b.state,{idx:et}),""));function nt(){return(b.state||{idx:null}).idx}function ot(){$=Action.Pop;let wt=nt(),ft=wt==null?null:wt-et;et=wt,_e&&_e({action:$,location:gt.location,delta:ft})}function ct(wt,ft){$=Action.Push;let ut=createLocation(gt.location,wt,ft);o&&o(ut,wt),et=nt()+1;let pt=getHistoryState(ut,et),vt=gt.createHref(ut);try{b.pushState(pt,"",vt)}catch{c.location.assign(vt)}g&&_e&&_e({action:$,location:gt.location,delta:1})}function at(wt,ft){$=Action.Replace;let ut=createLocation(gt.location,wt,ft);o&&o(ut,wt),et=nt();let pt=getHistoryState(ut,et),vt=gt.createHref(ut);b.replaceState(pt,"",vt),g&&_e&&_e({action:$,location:gt.location,delta:0})}function lt(wt){let ft=c.location.origin!=="null"?c.location.origin:c.location.href,ut=typeof wt=="string"?wt:createPath(wt);return invariant(ft,"No window.location.(origin|href) available to create URL for href: "+ut),new URL(ut,ft)}let gt={get action(){return $},get location(){return e(c,b)},listen(wt){if(_e)throw new Error("A history only accepts one active listener");return c.addEventListener(PopStateEventType,ot),_e=wt,()=>{c.removeEventListener(PopStateEventType,ot),_e=null}},createHref(wt){return i(c,wt)},createURL:lt,encodeLocation(wt){let ft=lt(wt);return{pathname:ft.pathname,search:ft.search,hash:ft.hash}},push:ct,replace:at,go(wt){return b.go(wt)}};return gt}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function isIndexRoute(e){return e.index===!0}function convertRoutesToDataRoutes(e,i,o){return i===void 0&&(i=[]),o===void 0&&(o=new Set),e.map((s,c)=>{let g=[...i,c],b=typeof s.id=="string"?s.id:g.join("-");return invariant(s.index!==!0||!s.children,"Cannot specify children on an index route"),invariant(!o.has(b),'Found a route id collision on id "'+b+`".  Route id's must be globally unique within Data Router usages`),o.add(b),isIndexRoute(s)?_extends$2({},s,{id:b}):_extends$2({},s,{id:b,children:s.children?convertRoutesToDataRoutes(s.children,g,o):void 0})})}function matchRoutes(e,i,o){o===void 0&&(o="/");let s=typeof i=="string"?parsePath(i):i,c=stripBasename(s.pathname||"/",o);if(c==null)return null;let g=flattenRoutes(e);rankRouteBranches(g);let b=null;for(let $=0;b==null&&$<g.length;++$)b=matchRouteBranch(g[$],safelyDecodeURI(c));return b}function flattenRoutes(e,i,o,s){i===void 0&&(i=[]),o===void 0&&(o=[]),s===void 0&&(s="");let c=(g,b,$)=>{let _e={relativePath:$===void 0?g.path||"":$,caseSensitive:g.caseSensitive===!0,childrenIndex:b,route:g};_e.relativePath.startsWith("/")&&(invariant(_e.relativePath.startsWith(s),'Absolute route path "'+_e.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_e.relativePath=_e.relativePath.slice(s.length));let et=joinPaths([s,_e.relativePath]),nt=o.concat(_e);g.children&&g.children.length>0&&(invariant(g.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+et+'".')),flattenRoutes(g.children,i,nt,et)),!(g.path==null&&!g.index)&&i.push({path:et,score:computeScore(et,g.index),routesMeta:nt})};return e.forEach((g,b)=>{var $;if(g.path===""||!(($=g.path)!=null&&$.includes("?")))c(g,b);else for(let _e of explodeOptionalSegments(g.path))c(g,b,_e)}),i}function explodeOptionalSegments(e){let i=e.split("/");if(i.length===0)return[];let[o,...s]=i,c=o.endsWith("?"),g=o.replace(/\?$/,"");if(s.length===0)return c?[g,""]:[g];let b=explodeOptionalSegments(s.join("/")),$=[];return $.push(...b.map(_e=>_e===""?g:[g,_e].join("/"))),c&&$.push(...b),$.map(_e=>e.startsWith("/")&&_e===""?"/":_e)}function rankRouteBranches(e){e.sort((i,o)=>i.score!==o.score?o.score-i.score:compareIndexes(i.routesMeta.map(s=>s.childrenIndex),o.routesMeta.map(s=>s.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,i){let o=e.split("/"),s=o.length;return o.some(isSplat)&&(s+=splatPenalty),i&&(s+=indexRouteValue),o.filter(c=>!isSplat(c)).reduce((c,g)=>c+(paramRe.test(g)?dynamicSegmentValue:g===""?emptySegmentValue:staticSegmentValue),s)}function compareIndexes(e,i){return e.length===i.length&&e.slice(0,-1).every((s,c)=>s===i[c])?e[e.length-1]-i[i.length-1]:0}function matchRouteBranch(e,i){let{routesMeta:o}=e,s={},c="/",g=[];for(let b=0;b<o.length;++b){let $=o[b],_e=b===o.length-1,et=c==="/"?i:i.slice(c.length)||"/",nt=matchPath({path:$.relativePath,caseSensitive:$.caseSensitive,end:_e},et);if(!nt)return null;Object.assign(s,nt.params);let ot=$.route;g.push({params:s,pathname:joinPaths([c,nt.pathname]),pathnameBase:normalizePathname(joinPaths([c,nt.pathnameBase])),route:ot}),nt.pathnameBase!=="/"&&(c=joinPaths([c,nt.pathnameBase]))}return g}function matchPath(e,i){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[o,s]=compilePath(e.path,e.caseSensitive,e.end),c=i.match(o);if(!c)return null;let g=c[0],b=g.replace(/(.)\/+$/,"$1"),$=c.slice(1);return{params:s.reduce((et,nt,ot)=>{if(nt==="*"){let ct=$[ot]||"";b=g.slice(0,g.length-ct.length).replace(/(.)\/+$/,"$1")}return et[nt]=safelyDecodeURIComponent($[ot]||"",nt),et},{}),pathname:g,pathnameBase:b,pattern:e}}function compilePath(e,i,o){i===void 0&&(i=!1),o===void 0&&(o=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],c="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(b,$)=>(s.push($),"/([^\\/]+)"));return e.endsWith("*")?(s.push("*"),c+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?c+="\\/*$":e!==""&&e!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,i?void 0:"i"),s]}function safelyDecodeURI(e){try{return decodeURI(e)}catch(i){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+i+").")),e}}function safelyDecodeURIComponent(e,i){try{return decodeURIComponent(e)}catch(o){return warning(!1,'The value for the URL param "'+i+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+o+").")),e}}function stripBasename(e,i){if(i==="/")return e;if(!e.toLowerCase().startsWith(i.toLowerCase()))return null;let o=i.endsWith("/")?i.length-1:i.length,s=e.charAt(o);return s&&s!=="/"?null:e.slice(o)||"/"}function warning(e,i){if(!e){typeof console<"u"&&console.warn(i);try{throw new Error(i)}catch{}}}function resolvePath(e,i){i===void 0&&(i="/");let{pathname:o,search:s="",hash:c=""}=typeof e=="string"?parsePath(e):e;return{pathname:o?o.startsWith("/")?o:resolvePathname(o,i):i,search:normalizeSearch(s),hash:normalizeHash(c)}}function resolvePathname(e,i){let o=i.replace(/\/+$/,"").split("/");return e.split("/").forEach(c=>{c===".."?o.length>1&&o.pop():c!=="."&&o.push(c)}),o.length>1?o.join("/"):"/"}function getInvalidPathError(e,i,o,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+i+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((i,o)=>o===0||i.route.path&&i.route.path.length>0)}function resolveTo(e,i,o,s){s===void 0&&(s=!1);let c;typeof e=="string"?c=parsePath(e):(c=_extends$2({},e),invariant(!c.pathname||!c.pathname.includes("?"),getInvalidPathError("?","pathname","search",c)),invariant(!c.pathname||!c.pathname.includes("#"),getInvalidPathError("#","pathname","hash",c)),invariant(!c.search||!c.search.includes("#"),getInvalidPathError("#","search","hash",c)));let g=e===""||c.pathname==="",b=g?"/":c.pathname,$;if(s||b==null)$=o;else{let ot=i.length-1;if(b.startsWith("..")){let ct=b.split("/");for(;ct[0]==="..";)ct.shift(),ot-=1;c.pathname=ct.join("/")}$=ot>=0?i[ot]:"/"}let _e=resolvePath(c,$),et=b&&b!=="/"&&b.endsWith("/"),nt=(g||b===".")&&o.endsWith("/");return!_e.pathname.endsWith("/")&&(et||nt)&&(_e.pathname+="/"),_e}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class AbortedDeferredError extends Error{}class DeferredData{constructor(i,o){this.pendingKeysSet=new Set,this.subscribers=new Set,this.deferredKeys=[],invariant(i&&typeof i=="object"&&!Array.isArray(i),"defer() only accepts plain objects");let s;this.abortPromise=new Promise((g,b)=>s=b),this.controller=new AbortController;let c=()=>s(new AbortedDeferredError("Deferred data aborted"));this.unlistenAbortSignal=()=>this.controller.signal.removeEventListener("abort",c),this.controller.signal.addEventListener("abort",c),this.data=Object.entries(i).reduce((g,b)=>{let[$,_e]=b;return Object.assign(g,{[$]:this.trackPromise($,_e)})},{}),this.done&&this.unlistenAbortSignal(),this.init=o}trackPromise(i,o){if(!(o instanceof Promise))return o;this.deferredKeys.push(i),this.pendingKeysSet.add(i);let s=Promise.race([o,this.abortPromise]).then(c=>this.onSettle(s,i,null,c),c=>this.onSettle(s,i,c));return s.catch(()=>{}),Object.defineProperty(s,"_tracked",{get:()=>!0}),s}onSettle(i,o,s,c){return this.controller.signal.aborted&&s instanceof AbortedDeferredError?(this.unlistenAbortSignal(),Object.defineProperty(i,"_error",{get:()=>s}),Promise.reject(s)):(this.pendingKeysSet.delete(o),this.done&&this.unlistenAbortSignal(),s?(Object.defineProperty(i,"_error",{get:()=>s}),this.emit(!1,o),Promise.reject(s)):(Object.defineProperty(i,"_data",{get:()=>c}),this.emit(!1,o),c))}emit(i,o){this.subscribers.forEach(s=>s(i,o))}subscribe(i){return this.subscribers.add(i),()=>this.subscribers.delete(i)}cancel(){this.controller.abort(),this.pendingKeysSet.forEach((i,o)=>this.pendingKeysSet.delete(o)),this.emit(!0)}async resolveData(i){let o=!1;if(!this.done){let s=()=>this.cancel();i.addEventListener("abort",s),o=await new Promise(c=>{this.subscribe(g=>{i.removeEventListener("abort",s),(g||this.done)&&c(g)})})}return o}get done(){return this.pendingKeysSet.size===0}get unwrappedData(){return invariant(this.data!==null&&this.done,"Can only unwrap data on initialized and settled deferreds"),Object.entries(this.data).reduce((i,o)=>{let[s,c]=o;return Object.assign(i,{[s]:unwrapTrackedPromise(c)})},{})}get pendingKeys(){return Array.from(this.pendingKeysSet)}}function isTrackedPromise(e){return e instanceof Promise&&e._tracked===!0}function unwrapTrackedPromise(e){if(!isTrackedPromise(e))return e;if(e._error)throw e._error;return e._data}class ErrorResponse{constructor(i,o,s,c){c===void 0&&(c=!1),this.status=i,this.statusText=o||"",this.internal=c,s instanceof Error?(this.data=s.toString(),this.error=s):this.data=s}}function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"],validMutationMethods=new Set(validMutationMethodsArr),validRequestMethodsArr=["get",...validMutationMethodsArr],validRequestMethods=new Set(validRequestMethodsArr),redirectStatusCodes=new Set([301,302,303,307,308]),redirectPreserveMethodStatusCodes=new Set([307,308]),IDLE_NAVIGATION={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},IDLE_FETCHER={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},IDLE_BLOCKER={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},ABSOLUTE_URL_REGEX$1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServer=!isBrowser$1;function createRouter(e){invariant(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let i=convertRoutesToDataRoutes(e.routes),o,s=null,c=new Set,g=null,b=null,$=null,_e=e.hydrationData!=null,et=matchRoutes(i,e.history.location,e.basename),nt=null;if(et==null){let Et=getInternalRouterError(404,{pathname:e.history.location.pathname}),{matches:xt,route:St}=getShortCircuitMatches(i);et=xt,nt={[St.id]:Et}}let ot=!et.some(Et=>Et.route.loader)||e.hydrationData!=null,ct,at={historyAction:e.history.action,location:e.history.location,matches:et,initialized:ot,navigation:IDLE_NAVIGATION,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||nt,fetchers:new Map,blockers:new Map},lt=Action.Pop,gt=!1,wt,ft=!1,ut=!1,pt=[],vt=[],bt=new Map,Ct=0,At=-1,Pt=new Map,Rt=new Set,Wt=new Map,hr=new Map,Sr=new Map,er=!1;function Qt(){return s=e.history.listen(Et=>{let{action:xt,location:St,delta:Bt}=Et;if(er){er=!1;return}warning(Sr.size===0||Bt!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let zt=yn({currentLocation:at.location,nextLocation:St,historyAction:xt});if(zt&&Bt!=null){er=!0,e.history.go(Bt*-1),Vt(zt,{state:"blocked",location:St,proceed(){Vt(zt,{state:"proceeding",proceed:void 0,reset:void 0,location:St}),e.history.go(Bt)},reset(){Bn(zt),ar({blockers:new Map(ct.state.blockers)})}});return}return dr(xt,St)}),at.initialized||dr(Action.Pop,at.location),ct}function ir(){s&&s(),c.clear(),wt&&wt.abort(),at.fetchers.forEach((Et,xt)=>Xn(xt)),at.blockers.forEach((Et,xt)=>Bn(xt))}function rr(Et){return c.add(Et),()=>c.delete(Et)}function ar(Et){at=_extends$2({},at,Et),c.forEach(xt=>xt(at))}function It(Et,xt){var St,Bt;let zt=at.actionData!=null&&at.navigation.formMethod!=null&&isMutationMethod(at.navigation.formMethod)&&at.navigation.state==="loading"&&((St=Et.state)==null?void 0:St._isRedirect)!==!0,Jt;xt.actionData?Object.keys(xt.actionData).length>0?Jt=xt.actionData:Jt=null:zt?Jt=at.actionData:Jt=null;let Kt=xt.loaderData?mergeLoaderData(at.loaderData,xt.loaderData,xt.matches||[],xt.errors):at.loaderData;for(let[Mt]of Sr)Bn(Mt);let nr=gt===!0||at.navigation.formMethod!=null&&isMutationMethod(at.navigation.formMethod)&&((Bt=Et.state)==null?void 0:Bt._isRedirect)!==!0;o&&(i=o,o=void 0),ar(_extends$2({},xt,{actionData:Jt,loaderData:Kt,historyAction:lt,location:Et,initialized:!0,navigation:IDLE_NAVIGATION,revalidation:"idle",restoreScrollPosition:mn(Et,xt.matches||at.matches),preventScrollReset:nr,blockers:new Map(at.blockers)})),ft||lt===Action.Pop||(lt===Action.Push?e.history.push(Et,Et.state):lt===Action.Replace&&e.history.replace(Et,Et.state)),lt=Action.Pop,gt=!1,ft=!1,ut=!1,pt=[],vt=[]}async function Ht(Et,xt){if(typeof Et=="number"){e.history.go(Et);return}let{path:St,submission:Bt,error:zt}=normalizeNavigateOptions(Et,xt),Jt=at.location,Kt=createLocation(at.location,St,xt&&xt.state);Kt=_extends$2({},Kt,e.history.encodeLocation(Kt));let nr=xt&&xt.replace!=null?xt.replace:void 0,Mt=Action.Push;nr===!0?Mt=Action.Replace:nr===!1||Bt!=null&&isMutationMethod(Bt.formMethod)&&Bt.formAction===at.location.pathname+at.location.search&&(Mt=Action.Replace);let Pr=xt&&"preventScrollReset"in xt?xt.preventScrollReset===!0:void 0,ur=yn({currentLocation:Jt,nextLocation:Kt,historyAction:Mt});if(ur){Vt(ur,{state:"blocked",location:Kt,proceed(){Vt(ur,{state:"proceeding",proceed:void 0,reset:void 0,location:Kt}),Ht(Et,xt)},reset(){Bn(ur),ar({blockers:new Map(at.blockers)})}});return}return await dr(Mt,Kt,{submission:Bt,pendingError:zt,preventScrollReset:Pr,replace:xt&&xt.replace})}function qt(){if(po(),ar({revalidation:"loading"}),at.navigation.state!=="submitting"){if(at.navigation.state==="idle"){dr(at.historyAction,at.location,{startUninterruptedRevalidation:!0});return}dr(lt||at.historyAction,at.navigation.location,{overrideNavigation:at.navigation})}}async function dr(Et,xt,St){wt&&wt.abort(),wt=null,lt=Et,ft=(St&&St.startUninterruptedRevalidation)===!0,Tn(at.location,at.matches),gt=(St&&St.preventScrollReset)===!0;let Bt=o||i,zt=St&&St.overrideNavigation,Jt=matchRoutes(Bt,xt,e.basename);if(!Jt){let Cr=getInternalRouterError(404,{pathname:xt.pathname}),{matches:Mr,route:en}=getShortCircuitMatches(Bt);gn(),It(xt,{matches:Mr,loaderData:{},errors:{[en.id]:Cr}});return}if(isHashChangeOnly(at.location,xt)&&!(St&&St.submission&&isMutationMethod(St.submission.formMethod))){It(xt,{matches:Jt});return}wt=new AbortController;let Kt=createClientSideRequest(e.history,xt,wt.signal,St&&St.submission),nr,Mt;if(St&&St.pendingError)Mt={[findNearestBoundary(Jt).route.id]:St.pendingError};else if(St&&St.submission&&isMutationMethod(St.submission.formMethod)){let Cr=await yt(Kt,xt,St.submission,Jt,{replace:St.replace});if(Cr.shortCircuited)return;nr=Cr.pendingActionData,Mt=Cr.pendingActionError,zt=_extends$2({state:"loading",location:xt},St.submission),Kt=new Request(Kt.url,{signal:Kt.signal})}let{shortCircuited:Pr,loaderData:ur,errors:Br}=await $t(Kt,xt,Jt,zt,St&&St.submission,St&&St.replace,nr,Mt);Pr||(wt=null,It(xt,_extends$2({matches:Jt},nr?{actionData:nr}:{},{loaderData:ur,errors:Br})))}async function yt(Et,xt,St,Bt,zt){po();let Jt=_extends$2({state:"submitting",location:xt},St);ar({navigation:Jt});let Kt,nr=getTargetMatch(Bt,xt);if(!nr.route.action)Kt={type:ResultType.error,error:getInternalRouterError(405,{method:Et.method,pathname:xt.pathname,routeId:nr.route.id})};else if(Kt=await callLoaderOrAction("action",Et,nr,Bt,ct.basename),Et.signal.aborted)return{shortCircuited:!0};if(isRedirectResult(Kt)){let Mt;return zt&&zt.replace!=null?Mt=zt.replace:Mt=Kt.location===at.location.pathname+at.location.search,await $n(at,Kt,{submission:St,replace:Mt}),{shortCircuited:!0}}if(isErrorResult(Kt)){let Mt=findNearestBoundary(Bt,nr.route.id);return(zt&&zt.replace)!==!0&&(lt=Action.Push),{pendingActionData:{},pendingActionError:{[Mt.route.id]:Kt.error}}}if(isDeferredResult(Kt))throw getInternalRouterError(400,{type:"defer-action"});return{pendingActionData:{[nr.route.id]:Kt.data}}}async function $t(Et,xt,St,Bt,zt,Jt,Kt,nr){let Mt=Bt;Mt||(Mt=_extends$2({state:"loading",location:xt,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},zt));let Pr=zt||(Mt.formMethod&&Mt.formAction&&Mt.formData&&Mt.formEncType?{formMethod:Mt.formMethod,formAction:Mt.formAction,formData:Mt.formData,formEncType:Mt.formEncType}:void 0),ur=o||i,[Br,Cr]=getMatchesToLoad(e.history,at,St,Pr,xt,ut,pt,vt,Wt,ur,e.basename,Kt,nr);if(gn(Ir=>!(St&&St.some(Jr=>Jr.route.id===Ir))||Br&&Br.some(Jr=>Jr.route.id===Ir)),Br.length===0&&Cr.length===0)return It(xt,_extends$2({matches:St,loaderData:{},errors:nr||null},Kt?{actionData:Kt}:{})),{shortCircuited:!0};if(!ft){Cr.forEach(Jr=>{let dn=at.fetchers.get(Jr.key),_i={state:"loading",data:dn&&dn.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};at.fetchers.set(Jr.key,_i)});let Ir=Kt||at.actionData;ar(_extends$2({navigation:Mt},Ir?Object.keys(Ir).length===0?{actionData:null}:{actionData:Ir}:{},Cr.length>0?{fetchers:new Map(at.fetchers)}:{}))}At=++Ct,Cr.forEach(Ir=>bt.set(Ir.key,wt));let{results:Mr,loaderResults:en,fetcherResults:Pn}=await Cs(at.matches,St,Br,Cr,Et);if(Et.signal.aborted)return{shortCircuited:!0};Cr.forEach(Ir=>bt.delete(Ir.key));let ln=findRedirect(Mr);if(ln)return await $n(at,ln,{replace:Jt}),{shortCircuited:!0};let{loaderData:go,errors:wn}=processLoaderData(at,St,Br,en,nr,Cr,Pn,hr);hr.forEach((Ir,Jr)=>{Ir.subscribe(dn=>{(dn||Ir.done)&&hr.delete(Jr)})}),As();let Uo=Mo(At);return _extends$2({loaderData:go,errors:wn},Uo||Cr.length>0?{fetchers:new Map(at.fetchers)}:{})}function jr(Et){return at.fetchers.get(Et)||IDLE_FETCHER}function Yn(Et,xt,St,Bt){if(isServer)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");bt.has(Et)&&yo(Et);let Jt=matchRoutes(o||i,St,e.basename);if(!Jt){Xr(Et,xt,getInternalRouterError(404,{pathname:St}));return}let{path:Kt,submission:nr}=normalizeNavigateOptions(St,Bt,!0),Mt=getTargetMatch(Jt,Kt);if(gt=(Bt&&Bt.preventScrollReset)===!0,nr&&isMutationMethod(nr.formMethod)){cn(Et,xt,Kt,Mt,Jt,nr);return}Wt.set(Et,{routeId:xt,path:Kt}),un(Et,xt,Kt,Mt,Jt,nr)}async function cn(Et,xt,St,Bt,zt,Jt){if(po(),Wt.delete(Et),!Bt.route.action){let rn=getInternalRouterError(405,{method:Jt.formMethod,pathname:St,routeId:xt});Xr(Et,xt,rn);return}let Kt=at.fetchers.get(Et),nr=_extends$2({state:"submitting"},Jt,{data:Kt&&Kt.data," _hasFetcherDoneAnything ":!0});at.fetchers.set(Et,nr),ar({fetchers:new Map(at.fetchers)});let Mt=new AbortController,Pr=createClientSideRequest(e.history,St,Mt.signal,Jt);bt.set(Et,Mt);let ur=await callLoaderOrAction("action",Pr,Bt,zt,ct.basename);if(Pr.signal.aborted){bt.get(Et)===Mt&&bt.delete(Et);return}if(isRedirectResult(ur)){bt.delete(Et),Rt.add(Et);let rn=_extends$2({state:"loading"},Jt,{data:void 0," _hasFetcherDoneAnything ":!0});return at.fetchers.set(Et,rn),ar({fetchers:new Map(at.fetchers)}),$n(at,ur,{isFetchActionRedirect:!0})}if(isErrorResult(ur)){Xr(Et,xt,ur.error);return}if(isDeferredResult(ur))throw getInternalRouterError(400,{type:"defer-action"});let Br=at.navigation.location||at.location,Cr=createClientSideRequest(e.history,Br,Mt.signal),Mr=o||i,en=at.navigation.state!=="idle"?matchRoutes(Mr,at.navigation.location,e.basename):at.matches;invariant(en,"Didn't find any matches after fetcher action");let Pn=++Ct;Pt.set(Et,Pn);let ln=_extends$2({state:"loading",data:ur.data},Jt,{" _hasFetcherDoneAnything ":!0});at.fetchers.set(Et,ln);let[go,wn]=getMatchesToLoad(e.history,at,en,Jt,Br,ut,pt,vt,Wt,Mr,e.basename,{[Bt.route.id]:ur.data},void 0);wn.filter(rn=>rn.key!==Et).forEach(rn=>{let mo=rn.key,wo=at.fetchers.get(mo),Ds={state:"loading",data:wo&&wo.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};at.fetchers.set(mo,Ds),bt.set(mo,Mt)}),ar({fetchers:new Map(at.fetchers)});let{results:Uo,loaderResults:Ir,fetcherResults:Jr}=await Cs(at.matches,en,go,wn,Cr);if(Mt.signal.aborted)return;Pt.delete(Et),bt.delete(Et),wn.forEach(rn=>bt.delete(rn.key));let dn=findRedirect(Uo);if(dn)return $n(at,dn);let{loaderData:_i,errors:Hr}=processLoaderData(at,at.matches,go,Ir,void 0,wn,Jr,hr),tn={state:"idle",data:ur.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};at.fetchers.set(Et,tn);let Ns=Mo(Pn);at.navigation.state==="loading"&&Pn>At?(invariant(lt,"Expected pending action"),wt&&wt.abort(),It(at.navigation.location,{matches:en,loaderData:_i,errors:Hr,fetchers:new Map(at.fetchers)})):(ar(_extends$2({errors:Hr,loaderData:mergeLoaderData(at.loaderData,_i,en,Hr)},Ns?{fetchers:new Map(at.fetchers)}:{})),ut=!1)}async function un(Et,xt,St,Bt,zt,Jt){let Kt=at.fetchers.get(Et),nr=_extends$2({state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0},Jt,{data:Kt&&Kt.data," _hasFetcherDoneAnything ":!0});at.fetchers.set(Et,nr),ar({fetchers:new Map(at.fetchers)});let Mt=new AbortController,Pr=createClientSideRequest(e.history,St,Mt.signal);bt.set(Et,Mt);let ur=await callLoaderOrAction("loader",Pr,Bt,zt,ct.basename);if(isDeferredResult(ur)&&(ur=await resolveDeferredData(ur,Pr.signal,!0)||ur),bt.get(Et)===Mt&&bt.delete(Et),Pr.signal.aborted)return;if(isRedirectResult(ur)){await $n(at,ur);return}if(isErrorResult(ur)){let Cr=findNearestBoundary(at.matches,xt);at.fetchers.delete(Et),ar({fetchers:new Map(at.fetchers),errors:{[Cr.route.id]:ur.error}});return}invariant(!isDeferredResult(ur),"Unhandled fetcher deferred data");let Br={state:"idle",data:ur.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};at.fetchers.set(Et,Br),ar({fetchers:new Map(at.fetchers)})}async function $n(Et,xt,St){var Bt;let{submission:zt,replace:Jt,isFetchActionRedirect:Kt}=St===void 0?{}:St;xt.revalidate&&(ut=!0);let nr=createLocation(Et.location,xt.location,_extends$2({_isRedirect:!0},Kt?{_isFetchActionRedirect:!0}:{}));if(invariant(nr,"Expected a location on the redirect navigation"),ABSOLUTE_URL_REGEX$1.test(xt.location)&&isBrowser$1&&typeof((Bt=window)==null?void 0:Bt.location)<"u"){let Mr=e.history.createURL(xt.location),en=stripBasename(Mr.pathname,e.basename||"/")==null;if(window.location.origin!==Mr.origin||en){Jt?window.location.replace(xt.location):window.location.assign(xt.location);return}}wt=null;let Mt=Jt===!0?Action.Replace:Action.Push,{formMethod:Pr,formAction:ur,formEncType:Br,formData:Cr}=Et.navigation;!zt&&Pr&&ur&&Cr&&Br&&(zt={formMethod:Pr,formAction:ur,formEncType:Br,formData:Cr}),redirectPreserveMethodStatusCodes.has(xt.status)&&zt&&isMutationMethod(zt.formMethod)?await dr(Mt,nr,{submission:_extends$2({},zt,{formAction:xt.location}),preventScrollReset:gt}):await dr(Mt,nr,{overrideNavigation:{state:"loading",location:nr,formMethod:zt?zt.formMethod:void 0,formAction:zt?zt.formAction:void 0,formEncType:zt?zt.formEncType:void 0,formData:zt?zt.formData:void 0},preventScrollReset:gt})}async function Cs(Et,xt,St,Bt,zt){let Jt=await Promise.all([...St.map(Mt=>callLoaderOrAction("loader",zt,Mt,xt,ct.basename)),...Bt.map(Mt=>Mt.matches&&Mt.match?callLoaderOrAction("loader",createClientSideRequest(e.history,Mt.path,zt.signal),Mt.match,Mt.matches,ct.basename):{type:ResultType.error,error:getInternalRouterError(404,{pathname:Mt.path})})]),Kt=Jt.slice(0,St.length),nr=Jt.slice(St.length);return await Promise.all([resolveDeferredResults(Et,St,Kt,zt.signal,!1,at.loaderData),resolveDeferredResults(Et,Bt.map(Mt=>Mt.match),nr,zt.signal,!0)]),{results:Jt,loaderResults:Kt,fetcherResults:nr}}function po(){ut=!0,pt.push(...gn()),Wt.forEach((Et,xt)=>{bt.has(xt)&&(vt.push(xt),yo(xt))})}function Xr(Et,xt,St){let Bt=findNearestBoundary(at.matches,xt);Xn(Et),ar({errors:{[Bt.route.id]:St},fetchers:new Map(at.fetchers)})}function Xn(Et){bt.has(Et)&&yo(Et),Wt.delete(Et),Pt.delete(Et),Rt.delete(Et),at.fetchers.delete(Et)}function yo(Et){let xt=bt.get(Et);invariant(xt,"Expected fetch controller: "+Et),xt.abort(),bt.delete(Et)}function Ps(Et){for(let xt of Et){let Bt={state:"idle",data:jr(xt).data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};at.fetchers.set(xt,Bt)}}function As(){let Et=[];for(let xt of Rt){let St=at.fetchers.get(xt);invariant(St,"Expected fetcher: "+xt),St.state==="loading"&&(Rt.delete(xt),Et.push(xt))}Ps(Et)}function Mo(Et){let xt=[];for(let[St,Bt]of Pt)if(Bt<Et){let zt=at.fetchers.get(St);invariant(zt,"Expected fetcher: "+St),zt.state==="loading"&&(yo(St),Pt.delete(St),xt.push(St))}return Ps(xt),xt.length>0}function Is(Et,xt){let St=at.blockers.get(Et)||IDLE_BLOCKER;return Sr.get(Et)!==xt&&Sr.set(Et,xt),St}function Bn(Et){at.blockers.delete(Et),Sr.delete(Et)}function Vt(Et,xt){let St=at.blockers.get(Et)||IDLE_BLOCKER;invariant(St.state==="unblocked"&&xt.state==="blocked"||St.state==="blocked"&&xt.state==="blocked"||St.state==="blocked"&&xt.state==="proceeding"||St.state==="blocked"&&xt.state==="unblocked"||St.state==="proceeding"&&xt.state==="unblocked","Invalid blocker state transition: "+St.state+" -> "+xt.state),at.blockers.set(Et,xt),ar({blockers:new Map(at.blockers)})}function yn(Et){let{currentLocation:xt,nextLocation:St,historyAction:Bt}=Et;if(Sr.size===0)return;Sr.size>1&&warning(!1,"A router only supports one blocker at a time");let zt=Array.from(Sr.entries()),[Jt,Kt]=zt[zt.length-1],nr=at.blockers.get(Jt);if(!(nr&&nr.state==="proceeding")&&Kt({currentLocation:xt,nextLocation:St,historyAction:Bt}))return Jt}function gn(Et){let xt=[];return hr.forEach((St,Bt)=>{(!Et||Et(Bt))&&(St.cancel(),xt.push(Bt),hr.delete(Bt))}),xt}function Dr(Et,xt,St){if(g=Et,$=xt,b=St||(Bt=>Bt.key),!_e&&at.navigation===IDLE_NAVIGATION){_e=!0;let Bt=mn(at.location,at.matches);Bt!=null&&ar({restoreScrollPosition:Bt})}return()=>{g=null,$=null,b=null}}function Tn(Et,xt){if(g&&b&&$){let St=xt.map(zt=>createUseMatchesMatch(zt,at.loaderData)),Bt=b(Et,St)||Et.key;g[Bt]=$()}}function mn(Et,xt){if(g&&b&&$){let St=xt.map(Jt=>createUseMatchesMatch(Jt,at.loaderData)),Bt=b(Et,St)||Et.key,zt=g[Bt];if(typeof zt=="number")return zt}return null}function Cn(Et){o=Et}return ct={get basename(){return e.basename},get state(){return at},get routes(){return i},initialize:Qt,subscribe:rr,enableScrollRestoration:Dr,navigate:Ht,fetch:Yn,revalidate:qt,createHref:Et=>e.history.createHref(Et),encodeLocation:Et=>e.history.encodeLocation(Et),getFetcher:jr,deleteFetcher:Xn,dispose:ir,getBlocker:Is,deleteBlocker:Bn,_internalFetchControllers:bt,_internalActiveDeferreds:hr,_internalSetRoutes:Cn},ct}function isSubmissionNavigation(e){return e!=null&&"formData"in e}function normalizeNavigateOptions(e,i,o){o===void 0&&(o=!1);let s=typeof e=="string"?e:createPath(e);if(!i||!isSubmissionNavigation(i))return{path:s};if(i.formMethod&&!isValidMethod(i.formMethod))return{path:s,error:getInternalRouterError(405,{method:i.formMethod})};let c;if(i.formData&&(c={formMethod:i.formMethod||"get",formAction:stripHashFromPath(s),formEncType:i&&i.formEncType||"application/x-www-form-urlencoded",formData:i.formData},isMutationMethod(c.formMethod)))return{path:s,submission:c};let g=parsePath(s),b=convertFormDataToSearchParams(i.formData);return o&&g.search&&hasNakedIndexQuery(g.search)&&b.append("index",""),g.search="?"+b,{path:createPath(g),submission:c}}function getLoaderMatchesUntilBoundary(e,i){let o=e;if(i){let s=e.findIndex(c=>c.route.id===i);s>=0&&(o=e.slice(0,s))}return o}function getMatchesToLoad(e,i,o,s,c,g,b,$,_e,et,nt,ot,ct){let at=ct?Object.values(ct)[0]:ot?Object.values(ot)[0]:void 0,lt=e.createURL(i.location),gt=e.createURL(c),wt=g||lt.toString()===gt.toString()||lt.search!==gt.search,ft=ct?Object.keys(ct)[0]:void 0,pt=getLoaderMatchesUntilBoundary(o,ft).filter((bt,Ct)=>{if(bt.route.loader==null)return!1;if(isNewLoader(i.loaderData,i.matches[Ct],bt)||b.some(Rt=>Rt===bt.route.id))return!0;let At=i.matches[Ct],Pt=bt;return shouldRevalidateLoader(bt,_extends$2({currentUrl:lt,currentParams:At.params,nextUrl:gt,nextParams:Pt.params},s,{actionResult:at,defaultShouldRevalidate:wt||isNewRouteInstance(At,Pt)}))}),vt=[];return _e.forEach((bt,Ct)=>{if(!o.some(Wt=>Wt.route.id===bt.routeId))return;let At=matchRoutes(et,bt.path,nt);if(!At){vt.push(_extends$2({key:Ct},bt,{matches:null,match:null}));return}let Pt=getTargetMatch(At,bt.path);if($.includes(Ct)){vt.push(_extends$2({key:Ct,matches:At,match:Pt},bt));return}shouldRevalidateLoader(Pt,_extends$2({currentUrl:lt,currentParams:i.matches[i.matches.length-1].params,nextUrl:gt,nextParams:o[o.length-1].params},s,{actionResult:at,defaultShouldRevalidate:wt}))&&vt.push(_extends$2({key:Ct,matches:At,match:Pt},bt))}),[pt,vt]}function isNewLoader(e,i,o){let s=!i||o.route.id!==i.route.id,c=e[o.route.id]===void 0;return s||c}function isNewRouteInstance(e,i){let o=e.route.path;return e.pathname!==i.pathname||o!=null&&o.endsWith("*")&&e.params["*"]!==i.params["*"]}function shouldRevalidateLoader(e,i){if(e.route.shouldRevalidate){let o=e.route.shouldRevalidate(i);if(typeof o=="boolean")return o}return i.defaultShouldRevalidate}async function callLoaderOrAction(e,i,o,s,c,g,b,$){c===void 0&&(c="/"),g===void 0&&(g=!1),b===void 0&&(b=!1);let _e,et,nt,ot=new Promise((gt,wt)=>nt=wt),ct=()=>nt();i.signal.addEventListener("abort",ct);try{let gt=o.route[e];invariant(gt,"Could not find the "+e+' to run on the "'+o.route.id+'" route'),et=await Promise.race([gt({request:i,params:o.params,context:$}),ot]),invariant(et!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+o.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(gt){_e=ResultType.error,et=gt}finally{i.signal.removeEventListener("abort",ct)}if(isResponse(et)){let gt=et.status;if(redirectStatusCodes.has(gt)){let ut=et.headers.get("Location");if(invariant(ut,"Redirects returned/thrown from loaders/actions must have a Location header"),ABSOLUTE_URL_REGEX$1.test(ut)){if(!g){let pt=new URL(i.url),vt=ut.startsWith("//")?new URL(pt.protocol+ut):new URL(ut),bt=stripBasename(vt.pathname,c)!=null;vt.origin===pt.origin&&bt&&(ut=vt.pathname+vt.search+vt.hash)}}else{let pt=s.slice(0,s.indexOf(o)+1),vt=getPathContributingMatches(pt).map(Ct=>Ct.pathnameBase),bt=resolveTo(ut,vt,new URL(i.url).pathname);if(invariant(createPath(bt),"Unable to resolve redirect location: "+ut),c){let Ct=bt.pathname;bt.pathname=Ct==="/"?c:joinPaths([c,Ct])}ut=createPath(bt)}if(g)throw et.headers.set("Location",ut),et;return{type:ResultType.redirect,status:gt,location:ut,revalidate:et.headers.get("X-Remix-Revalidate")!==null}}if(b)throw{type:_e||ResultType.data,response:et};let wt,ft=et.headers.get("Content-Type");return ft&&/\bapplication\/json\b/.test(ft)?wt=await et.json():wt=await et.text(),_e===ResultType.error?{type:_e,error:new ErrorResponse(gt,et.statusText,wt),headers:et.headers}:{type:ResultType.data,data:wt,statusCode:et.status,headers:et.headers}}if(_e===ResultType.error)return{type:_e,error:et};if(et instanceof DeferredData){var at,lt;return{type:ResultType.deferred,deferredData:et,statusCode:(at=et.init)==null?void 0:at.status,headers:((lt=et.init)==null?void 0:lt.headers)&&new Headers(et.init.headers)}}return{type:ResultType.data,data:et}}function createClientSideRequest(e,i,o,s){let c=e.createURL(stripHashFromPath(i)).toString(),g={signal:o};if(s&&isMutationMethod(s.formMethod)){let{formMethod:b,formEncType:$,formData:_e}=s;g.method=b.toUpperCase(),g.body=$==="application/x-www-form-urlencoded"?convertFormDataToSearchParams(_e):_e}return new Request(c,g)}function convertFormDataToSearchParams(e){let i=new URLSearchParams;for(let[o,s]of e.entries())i.append(o,s instanceof File?s.name:s);return i}function processRouteLoaderData(e,i,o,s,c){let g={},b=null,$,_e=!1,et={};return o.forEach((nt,ot)=>{let ct=i[ot].route.id;if(invariant(!isRedirectResult(nt),"Cannot handle redirect results in processLoaderData"),isErrorResult(nt)){let at=findNearestBoundary(e,ct),lt=nt.error;s&&(lt=Object.values(s)[0],s=void 0),b=b||{},b[at.route.id]==null&&(b[at.route.id]=lt),g[ct]=void 0,_e||(_e=!0,$=isRouteErrorResponse(nt.error)?nt.error.status:500),nt.headers&&(et[ct]=nt.headers)}else isDeferredResult(nt)?(c.set(ct,nt.deferredData),g[ct]=nt.deferredData.data):g[ct]=nt.data,nt.statusCode!=null&&nt.statusCode!==200&&!_e&&($=nt.statusCode),nt.headers&&(et[ct]=nt.headers)}),s&&(b=s,g[Object.keys(s)[0]]=void 0),{loaderData:g,errors:b,statusCode:$||200,loaderHeaders:et}}function processLoaderData(e,i,o,s,c,g,b,$){let{loaderData:_e,errors:et}=processRouteLoaderData(i,o,s,c,$);for(let nt=0;nt<g.length;nt++){let{key:ot,match:ct}=g[nt];invariant(b!==void 0&&b[nt]!==void 0,"Did not find corresponding fetcher result");let at=b[nt];if(isErrorResult(at)){let lt=findNearestBoundary(e.matches,ct==null?void 0:ct.route.id);et&&et[lt.route.id]||(et=_extends$2({},et,{[lt.route.id]:at.error})),e.fetchers.delete(ot)}else if(isRedirectResult(at))invariant(!1,"Unhandled fetcher revalidation redirect");else if(isDeferredResult(at))invariant(!1,"Unhandled fetcher deferred data");else{let lt={state:"idle",data:at.data,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0," _hasFetcherDoneAnything ":!0};e.fetchers.set(ot,lt)}}return{loaderData:_e,errors:et}}function mergeLoaderData(e,i,o,s){let c=_extends$2({},i);for(let g of o){let b=g.route.id;if(i.hasOwnProperty(b)?i[b]!==void 0&&(c[b]=i[b]):e[b]!==void 0&&g.route.loader&&(c[b]=e[b]),s&&s.hasOwnProperty(b))break}return c}function findNearestBoundary(e,i){return(i?e.slice(0,e.findIndex(s=>s.route.id===i)+1):[...e]).reverse().find(s=>s.route.hasErrorBoundary===!0)||e[0]}function getShortCircuitMatches(e){let i=e.find(o=>o.index||!o.path||o.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:i}],route:i}}function getInternalRouterError(e,i){let{pathname:o,routeId:s,method:c,type:g}=i===void 0?{}:i,b="Unknown Server Error",$="Unknown @remix-run/router error";return e===400?(b="Bad Request",c&&o&&s?$="You made a "+c+' request to "'+o+'" but '+('did not provide a `loader` for route "'+s+'", ')+"so there is no way to handle the request.":g==="defer-action"&&($="defer() is not supported in actions")):e===403?(b="Forbidden",$='Route "'+s+'" does not match URL "'+o+'"'):e===404?(b="Not Found",$='No route matches URL "'+o+'"'):e===405&&(b="Method Not Allowed",c&&o&&s?$="You made a "+c.toUpperCase()+' request to "'+o+'" but '+('did not provide an `action` for route "'+s+'", ')+"so there is no way to handle the request.":c&&($='Invalid request method "'+c.toUpperCase()+'"')),new ErrorResponse(e||500,b,new Error($),!0)}function findRedirect(e){for(let i=e.length-1;i>=0;i--){let o=e[i];if(isRedirectResult(o))return o}}function stripHashFromPath(e){let i=typeof e=="string"?parsePath(e):e;return createPath(_extends$2({},i,{hash:""}))}function isHashChangeOnly(e,i){return e.pathname===i.pathname&&e.search===i.search&&e.hash!==i.hash}function isDeferredResult(e){return e.type===ResultType.deferred}function isErrorResult(e){return e.type===ResultType.error}function isRedirectResult(e){return(e&&e.type)===ResultType.redirect}function isResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function isValidMethod(e){return validRequestMethods.has(e)}function isMutationMethod(e){return validMutationMethods.has(e)}async function resolveDeferredResults(e,i,o,s,c,g){for(let b=0;b<o.length;b++){let $=o[b],_e=i[b];if(!_e)continue;let et=e.find(ot=>ot.route.id===_e.route.id),nt=et!=null&&!isNewRouteInstance(et,_e)&&(g&&g[_e.route.id])!==void 0;isDeferredResult($)&&(c||nt)&&await resolveDeferredData($,s,c).then(ot=>{ot&&(o[b]=ot||o[b])})}}async function resolveDeferredData(e,i,o){if(o===void 0&&(o=!1),!await e.deferredData.resolveData(i)){if(o)try{return{type:ResultType.data,data:e.deferredData.unwrappedData}}catch(c){return{type:ResultType.error,error:c}}return{type:ResultType.data,data:e.deferredData.data}}}function hasNakedIndexQuery(e){return new URLSearchParams(e).getAll("index").some(i=>i==="")}function createUseMatchesMatch(e,i){let{route:o,pathname:s,params:c}=e;return{id:o.id,pathname:s,params:c,data:i[o.id],handle:o.handle}}function getTargetMatch(e,i){let o=typeof i=="string"?parsePath(i).search:i.search;if(e[e.length-1].route.index&&hasNakedIndexQuery(o||""))return e[e.length-1];let s=getPathContributingMatches(e);return s[s.length-1]}/**
 * React Router v6.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},_extends$1.apply(this,arguments)}function isPolyfill(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}const is$1=typeof Object.is=="function"?Object.is:isPolyfill,{useState,useEffect,useLayoutEffect,useDebugValue}=React$1;function useSyncExternalStore$2(e,i,o){const s=i(),[{inst:c},g]=useState({inst:{value:s,getSnapshot:i}});return useLayoutEffect(()=>{c.value=s,c.getSnapshot=i,checkIfSnapshotChanged(c)&&g({inst:c})},[e,s,i]),useEffect(()=>(checkIfSnapshotChanged(c)&&g({inst:c}),e(()=>{checkIfSnapshotChanged(c)&&g({inst:c})})),[e]),useDebugValue(s),s}function checkIfSnapshotChanged(e){const i=e.getSnapshot,o=e.value;try{const s=i();return!is$1(o,s)}catch{return!0}}function useSyncExternalStore$1(e,i,o){return i()}const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",isServerEnvironment=!canUseDOM,shim=isServerEnvironment?useSyncExternalStore$1:useSyncExternalStore$2,useSyncExternalStore="useSyncExternalStore"in React$1?(e=>e.useSyncExternalStore)(React$1):shim,DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[]}),RouteErrorContext=reactExports.createContext(null);function useHref(e,i){let{relative:o}=i===void 0?{}:i;useInRouterContext()||invariant(!1);let{basename:s,navigator:c}=reactExports.useContext(NavigationContext),{hash:g,pathname:b,search:$}=useResolvedPath(e,{relative:o}),_e=b;return s!=="/"&&(_e=b==="/"?s:joinPaths([s,b])),c.createHref({pathname:_e,search:$,hash:g})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useNavigate(){useInRouterContext()||invariant(!1);let{basename:e,navigator:i}=reactExports.useContext(NavigationContext),{matches:o}=reactExports.useContext(RouteContext),{pathname:s}=useLocation(),c=JSON.stringify(getPathContributingMatches(o).map($=>$.pathnameBase)),g=reactExports.useRef(!1);return reactExports.useEffect(()=>{g.current=!0}),reactExports.useCallback(function($,_e){if(_e===void 0&&(_e={}),!g.current)return;if(typeof $=="number"){i.go($);return}let et=resolveTo($,JSON.parse(c),s,_e.relative==="path");e!=="/"&&(et.pathname=et.pathname==="/"?e:joinPaths([e,et.pathname])),(_e.replace?i.replace:i.push)(et,_e.state,_e)},[e,i,c,s])}const OutletContext=reactExports.createContext(null);function useOutlet(e){let i=reactExports.useContext(RouteContext).outlet;return i&&reactExports.createElement(OutletContext.Provider,{value:e},i)}function useParams(){let{matches:e}=reactExports.useContext(RouteContext),i=e[e.length-1];return i?i.params:{}}function useResolvedPath(e,i){let{relative:o}=i===void 0?{}:i,{matches:s}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),g=JSON.stringify(getPathContributingMatches(s).map(b=>b.pathnameBase));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(g),c,o==="path"),[e,g,c,o])}function useRoutes(e,i){useInRouterContext()||invariant(!1);let{navigator:o}=reactExports.useContext(NavigationContext),s=reactExports.useContext(DataRouterStateContext),{matches:c}=reactExports.useContext(RouteContext),g=c[c.length-1],b=g?g.params:{};g&&g.pathname;let $=g?g.pathnameBase:"/";g&&g.route;let _e=useLocation(),et;if(i){var nt;let gt=typeof i=="string"?parsePath(i):i;$==="/"||(nt=gt.pathname)!=null&&nt.startsWith($)||invariant(!1),et=gt}else et=_e;let ot=et.pathname||"/",ct=$==="/"?ot:ot.slice($.length)||"/",at=matchRoutes(e,{pathname:ct}),lt=_renderMatches(at&&at.map(gt=>Object.assign({},gt,{params:Object.assign({},b,gt.params),pathname:joinPaths([$,o.encodeLocation?o.encodeLocation(gt.pathname).pathname:gt.pathname]),pathnameBase:gt.pathnameBase==="/"?$:joinPaths([$,o.encodeLocation?o.encodeLocation(gt.pathnameBase).pathname:gt.pathnameBase])})),c,s||void 0);return i&&lt?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},et),navigationType:Action.Pop}},lt):lt}function DefaultErrorElement(){let e=useRouteError(),i=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),o=e instanceof Error?e.stack:null,c={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},g=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},i),o?reactExports.createElement("pre",{style:c},o):null,g)}class RenderErrorBoundary extends reactExports.Component{constructor(i){super(i),this.state={location:i.location,error:i.error}}static getDerivedStateFromError(i){return{error:i}}static getDerivedStateFromProps(i,o){return o.location!==i.location?{error:i.error,location:i.location}:{error:i.error||o.error,location:o.location}}componentDidCatch(i,o){console.error("React Router caught the following error during render",i,o)}render(){return this.state.error?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:i,match:o,children:s}=e,c=reactExports.useContext(DataRouterContext);return c&&c.static&&c.staticContext&&o.route.errorElement&&(c.staticContext._deepestRenderedBoundaryId=o.route.id),reactExports.createElement(RouteContext.Provider,{value:i},s)}function _renderMatches(e,i,o){if(i===void 0&&(i=[]),e==null)if(o!=null&&o.errors)e=o.matches;else return null;let s=e,c=o==null?void 0:o.errors;if(c!=null){let g=s.findIndex(b=>b.route.id&&(c==null?void 0:c[b.route.id]));g>=0||invariant(!1),s=s.slice(0,Math.min(s.length,g+1))}return s.reduceRight((g,b,$)=>{let _e=b.route.id?c==null?void 0:c[b.route.id]:null,et=o?b.route.errorElement||reactExports.createElement(DefaultErrorElement,null):null,nt=i.concat(s.slice(0,$+1)),ot=()=>reactExports.createElement(RenderedRoute,{match:b,routeContext:{outlet:g,matches:nt}},_e?et:b.route.element!==void 0?b.route.element:g);return o&&(b.route.errorElement||$===0)?reactExports.createElement(RenderErrorBoundary,{location:o.location,component:et,error:_e,children:ot(),routeContext:{outlet:null,matches:nt}}):ot()},null)}var DataRouterHook$1;(function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"})(DataRouterHook$1||(DataRouterHook$1={}));var DataRouterStateHook$1;(function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"})(DataRouterStateHook$1||(DataRouterStateHook$1={}));function useDataRouterContext(e){let i=reactExports.useContext(DataRouterContext);return i||invariant(!1),i}function useDataRouterState(e){let i=reactExports.useContext(DataRouterStateContext);return i||invariant(!1),i}function useRouteContext(e){let i=reactExports.useContext(RouteContext);return i||invariant(!1),i}function useCurrentRouteId(e){let i=useRouteContext(),o=i.matches[i.matches.length-1];return o.route.id||invariant(!1),o.route.id}function useRevalidator(){let e=useDataRouterContext(DataRouterHook$1.UseRevalidator),i=useDataRouterState(DataRouterStateHook$1.UseRevalidator);return{revalidate:e.router.revalidate,state:i.revalidation}}function useLoaderData(){let e=useDataRouterState(DataRouterStateHook$1.UseLoaderData),i=useCurrentRouteId(DataRouterStateHook$1.UseLoaderData);if(e.errors&&e.errors[i]!=null){console.error("You cannot `useLoaderData` in an errorElement (routeId: "+i+")");return}return e.loaderData[i]}function useRouteError(){var e;let i=reactExports.useContext(RouteErrorContext),o=useDataRouterState(DataRouterStateHook$1.UseRouteError),s=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return i||((e=o.errors)==null?void 0:e[s])}function RouterProvider(e){let{fallbackElement:i,router:o}=e,s=useSyncExternalStore(o.subscribe,()=>o.state,()=>o.state),c=reactExports.useMemo(()=>({createHref:o.createHref,encodeLocation:o.encodeLocation,go:b=>o.navigate(b),push:(b,$,_e)=>o.navigate(b,{state:$,preventScrollReset:_e==null?void 0:_e.preventScrollReset}),replace:(b,$,_e)=>o.navigate(b,{replace:!0,state:$,preventScrollReset:_e==null?void 0:_e.preventScrollReset})}),[o]),g=o.basename||"/";return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(DataRouterContext.Provider,{value:{router:o,navigator:c,static:!1,basename:g}},reactExports.createElement(DataRouterStateContext.Provider,{value:s},reactExports.createElement(Router,{basename:o.basename,location:o.state.location,navigationType:o.state.historyAction,navigator:c},o.state.initialized?reactExports.createElement(Routes,null):i))),null)}function Outlet(e){return useOutlet(e.context)}function Route(e){invariant(!1)}function Router(e){let{basename:i="/",children:o=null,location:s,navigationType:c=Action.Pop,navigator:g,static:b=!1}=e;useInRouterContext()&&invariant(!1);let $=i.replace(/^\/*/,"/"),_e=reactExports.useMemo(()=>({basename:$,navigator:g,static:b}),[$,g,b]);typeof s=="string"&&(s=parsePath(s));let{pathname:et="/",search:nt="",hash:ot="",state:ct=null,key:at="default"}=s,lt=reactExports.useMemo(()=>{let gt=stripBasename(et,$);return gt==null?null:{pathname:gt,search:nt,hash:ot,state:ct,key:at}},[$,et,nt,ot,ct,at]);return lt==null?null:reactExports.createElement(NavigationContext.Provider,{value:_e},reactExports.createElement(LocationContext.Provider,{children:o,value:{location:lt,navigationType:c}}))}function Routes(e){let{children:i,location:o}=e,s=reactExports.useContext(DataRouterContext),c=s&&!i?s.router.routes:createRoutesFromChildren(i);return useRoutes(c,o)}var AwaitRenderStatus;(function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"})(AwaitRenderStatus||(AwaitRenderStatus={}));new Promise(()=>{});function createRoutesFromChildren(e,i){i===void 0&&(i=[]);let o=[];return reactExports.Children.forEach(e,(s,c)=>{if(!reactExports.isValidElement(s))return;if(s.type===reactExports.Fragment){o.push.apply(o,createRoutesFromChildren(s.props.children,i));return}s.type!==Route&&invariant(!1),!s.props.index||!s.props.children||invariant(!1);let g=[...i,c],b={id:s.props.id||g.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,hasErrorBoundary:s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle};s.props.children&&(b.children=createRoutesFromChildren(s.props.children,g)),o.push(b)}),o}function enhanceManualRouteObjects(e){return e.map(i=>{let o=_extends$1({},i);return o.hasErrorBoundary==null&&(o.hasErrorBoundary=o.errorElement!=null),o.children&&(o.children=enhanceManualRouteObjects(o.children)),o})}/**
 * React Router DOM v6.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var o=arguments[i];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(e,i){if(e==null)return{};var o={},s=Object.keys(e),c,g;for(g=0;g<s.length;g++)c=s[g],!(i.indexOf(c)>=0)&&(o[c]=e[c]);return o}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,i){return e.button===0&&(!i||i==="_self")&&!isModifiedEvent(e)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function createBrowserRouter(e,i){return createRouter({basename:i==null?void 0:i.basename,history:createBrowserHistory({window:i==null?void 0:i.window}),hydrationData:(i==null?void 0:i.hydrationData)||parseHydrationData(),routes:enhanceManualRouteObjects(e)}).initialize()}function parseHydrationData(){var e;let i=(e=window)==null?void 0:e.__staticRouterHydrationData;return i&&i.errors&&(i=_extends({},i,{errors:deserializeErrors(i.errors)})),i}function deserializeErrors(e){if(!e)return null;let i=Object.entries(e),o={};for(let[s,c]of i)if(c&&c.__type==="RouteErrorResponse")o[s]=new ErrorResponse(c.status,c.statusText,c.data,c.internal===!0);else if(c&&c.__type==="Error"){let g=new Error(c.message);g.stack="",o[s]=g}else o[s]=c;return o}const isBrowser=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link$2=reactExports.forwardRef(function(i,o){let{onClick:s,relative:c,reloadDocument:g,replace:b,state:$,target:_e,to:et,preventScrollReset:nt}=i,ot=_objectWithoutPropertiesLoose(i,_excluded),{basename:ct}=reactExports.useContext(NavigationContext),at,lt=!1;if(typeof et=="string"&&ABSOLUTE_URL_REGEX.test(et)&&(at=et,isBrowser)){let ut=new URL(window.location.href),pt=et.startsWith("//")?new URL(ut.protocol+et):new URL(et),vt=stripBasename(pt.pathname,ct);pt.origin===ut.origin&&vt!=null?et=vt+pt.search+pt.hash:lt=!0}let gt=useHref(et,{relative:c}),wt=useLinkClickHandler(et,{replace:b,state:$,target:_e,preventScrollReset:nt,relative:c});function ft(ut){s&&s(ut),ut.defaultPrevented||wt(ut)}return reactExports.createElement("a",_extends({},ot,{href:at||gt,onClick:lt||g?s:ft,ref:o,target:_e}))});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(e,i){let{target:o,replace:s,state:c,preventScrollReset:g,relative:b}=i===void 0?{}:i,$=useNavigate(),_e=useLocation(),et=useResolvedPath(e,{relative:b});return reactExports.useCallback(nt=>{if(shouldProcessLinkClick(nt,o)){nt.preventDefault();let ot=s!==void 0?s:createPath(_e)===createPath(et);$(e,{replace:ot,state:c,preventScrollReset:g,relative:b})}},[_e,$,et,s,c,o,e,g,b])}var index_productionExports={},index_production={get exports(){return index_productionExports},set exports(e){index_productionExports=e}};function noop$3(){}function shallowEqual(e,i){if(e===i)return!0;if(!e||!i||typeof e!="object"||typeof i!="object")return!1;const o=Object.keys(e),s=Object.keys(i),{length:c}=o;if(s.length!==c)return!1;for(const g of o)if(e[g]!==i[g])return!1;return!0}function applyState(e,i){if(isUpdater(e)){const o=isLazyValue(i)?i():i;return e(o)}return e}function isUpdater(e){return typeof e=="function"}function isLazyValue(e){return typeof e=="function"}function isObject(e){return typeof e=="object"&&e!=null}function isEmpty$1(e){return Array.isArray(e)?!e.length:isObject(e)?!Object.keys(e).length:e==null||e===""}function isPromise(e){return Boolean(e&&"then"in e&&typeof e.then=="function")}function isInteger(e){return typeof e=="number"?Math.floor(e)===e:String(Math.floor(Number(e)))===e}function hasOwnProperty(e,i){return Object.prototype.hasOwnProperty.call(e,i)}function chain(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return function(){for(const s of i)typeof s=="function"&&s(...arguments)}}function cx(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return i.filter(Boolean).join(" ")||void 0}function normalizeString(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function queueMicrotask$1(e){if(window.queueMicrotask)return window.queueMicrotask(e);Promise.resolve().then(e)}const misc=Object.freeze(Object.defineProperty({__proto__:null,applyState,chain,cx,hasOwnProperty,isEmpty:isEmpty$1,isInteger,isObject,isPromise,noop:noop$3,normalizeString,queueMicrotask:queueMicrotask$1,shallowEqual},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(misc);/**
 * react-keyring
 *
 * Copyright (c) Web3.Storage
 *
 * This source code is licensed under Apache-2.0 OR MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license Apache-2.0 OR MIT
 */(function(e,i){(function(o,s){s(i,reactExports,require$$1)})(commonjsGlobal,function(o,s){var On,Zn,_r,vs,lp,bs,dp,ks,Es,qn,jn,xs,No,Su;function c(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var g=c(s),b=0;function $(d){return"__private_"+b+++"_"+d}function _e(d,a){if(!Object.prototype.hasOwnProperty.call(d,a))throw new TypeError("attempted to use private field on non-instance");return d}const et=d=>{if(d instanceof Uint8Array&&d.constructor.name==="Uint8Array")return d;if(d instanceof ArrayBuffer)return new Uint8Array(d);if(ArrayBuffer.isView(d))return new Uint8Array(d.buffer,d.byteOffset,d.byteLength);throw new Error("Unknown type, must be binary type")};var nt=function d(a,h,_){h=h||[];for(var j=_=_||0;a>=ot;)h[_++]=255&a|128,a/=128;for(;-128&a;)h[_++]=255&a|128,a>>>=7;return h[_]=0|a,d.bytes=_-j+1,h},ot=Math.pow(2,31),ct=function d(a,h){var _,j=0,tt=0,rt=h=h||0,st=a.length;do{if(rt>=st)throw d.bytes=0,new RangeError("Could not decode varint");_=a[rt++],j+=tt<28?(127&_)<<tt:(127&_)*Math.pow(2,tt),tt+=7}while(_>=128);return d.bytes=rt-h,j},at=Math.pow(2,7),lt=Math.pow(2,14),gt=Math.pow(2,21),wt=Math.pow(2,28),ft=Math.pow(2,35),ut=Math.pow(2,42),pt=Math.pow(2,49),vt=Math.pow(2,56),bt=Math.pow(2,63),Ct={encode:nt,decode:ct,encodingLength:function(d){return d<at?1:d<lt?2:d<gt?3:d<wt?4:d<ft?5:d<ut?6:d<pt?7:d<vt?8:d<bt?9:10}};const At=(d,a=0)=>[Ct.decode(d,a),Ct.decode.bytes],Pt=(d,a,h=0)=>(Ct.encode(d,a,h),a),Rt=d=>Ct.encodingLength(d),Wt=(d,a)=>{const h=a.byteLength,_=Rt(d),j=_+Rt(h),tt=new Uint8Array(j+h);return Pt(d,tt,0),Pt(h,tt,_),tt.set(a,j),new Sr(d,h,a,tt)},hr=d=>{const a=et(d),[h,_]=At(a),[j,tt]=At(a.subarray(_)),rt=a.subarray(_+tt);if(rt.byteLength!==j)throw new Error("Incorrect length");return new Sr(h,j,rt,a)};class Sr{constructor(a,h,_,j){this.code=a,this.size=h,this.digest=_,this.bytes=j}}const er=({name:d,code:a,encode:h})=>new Qt(d,a,h);class Qt{constructor(a,h,_){this.name=a,this.code=h,this.encode=_}digest(a){if(a instanceof Uint8Array){const h=this.encode(a);return h instanceof Uint8Array?Wt(this.code,h):h.then(_=>Wt(this.code,_))}throw Error("Unknown type, must be binary type")}}const ir=d=>async a=>new Uint8Array(await crypto.subtle.digest(d,a)),rr=er({name:"sha2-256",code:18,encode:ir("SHA-256")});class ar{constructor(a){this.id=a.id,this.options=a,this.encoder=a.encoder,this.decoder=a.decoder,this.channel=a.channel,this.hasher=a.hasher||rr}execute(...a){return It(a,this)}}const It=async(d,a)=>{const h=await a.encoder.encode(d,a),_=await a.channel.request(h);return await a.decoder.decode(_)},Ht=["string","number","bigint","symbol"],qt=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function dr(d){if(d===null)return"null";if(d===void 0)return"undefined";if(d===!0||d===!1)return"boolean";const a=typeof d;return Ht.includes(a)?a:a==="function"?"Function":Array.isArray(d)?"Array":function(_){return _&&_.constructor&&_.constructor.isBuffer&&_.constructor.isBuffer.call(null,_)}(d)?"Buffer":function(_){const j=Object.prototype.toString.call(_).slice(8,-1);if(qt.includes(j))return j}(d)||"Object"}class yt{constructor(a,h,_){this.major=a,this.majorEncoded=a<<5,this.name=h,this.terminal=_}toString(){return`Type[${this.major}].${this.name}`}compare(a){return this.major<a.major?-1:this.major>a.major?1:0}}yt.uint=new yt(0,"uint",!0),yt.negint=new yt(1,"negint",!0),yt.bytes=new yt(2,"bytes",!0),yt.string=new yt(3,"string",!0),yt.array=new yt(4,"array",!1),yt.map=new yt(5,"map",!1),yt.tag=new yt(6,"tag",!1),yt.float=new yt(7,"float",!0),yt.false=new yt(7,"false",!0),yt.true=new yt(7,"true",!0),yt.null=new yt(7,"null",!0),yt.undefined=new yt(7,"undefined",!0),yt.break=new yt(7,"break",!0);class $t{constructor(a,h,_){this.type=a,this.value=h,this.encodedLength=_,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const jr=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Yn=new TextDecoder,cn=new TextEncoder;function un(d){return jr&&globalThis.Buffer.isBuffer(d)}function $n(d){return d instanceof Uint8Array?un(d)?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):d:Uint8Array.from(d)}const Cs=jr?(d,a,h)=>h-a>64?globalThis.Buffer.from(d.subarray(a,h)).toString("utf8"):Mo(d,a,h):(d,a,h)=>h-a>64?Yn.decode(d.subarray(a,h)):Mo(d,a,h),po=jr?d=>d.length>64?globalThis.Buffer.from(d):As(d):d=>d.length>64?cn.encode(d):As(d),Xr=d=>Uint8Array.from(d),Xn=jr?(d,a,h)=>un(d)?new Uint8Array(d.subarray(a,h)):d.slice(a,h):(d,a,h)=>d.slice(a,h),yo=jr?(d,a)=>(d=d.map(h=>h instanceof Uint8Array?h:globalThis.Buffer.from(h)),$n(globalThis.Buffer.concat(d,a))):(d,a)=>{const h=new Uint8Array(a);let _=0;for(let j of d)_+j.length>h.length&&(j=j.subarray(0,h.length-_)),h.set(j,_),_+=j.length;return h},Ps=jr?d=>globalThis.Buffer.allocUnsafe(d):d=>new Uint8Array(d);function As(d,a=1/0){let h;const _=d.length;let j=null;const tt=[];for(let rt=0;rt<_;++rt){if(h=d.charCodeAt(rt),h>55295&&h<57344){if(!j){if(h>56319){(a-=3)>-1&&tt.push(239,191,189);continue}if(rt+1===_){(a-=3)>-1&&tt.push(239,191,189);continue}j=h;continue}if(h<56320){(a-=3)>-1&&tt.push(239,191,189),j=h;continue}h=65536+(j-55296<<10|h-56320)}else j&&(a-=3)>-1&&tt.push(239,191,189);if(j=null,h<128){if((a-=1)<0)break;tt.push(h)}else if(h<2048){if((a-=2)<0)break;tt.push(h>>6|192,63&h|128)}else if(h<65536){if((a-=3)<0)break;tt.push(h>>12|224,h>>6&63|128,63&h|128)}else{if(!(h<1114112))throw new Error("Invalid code point");if((a-=4)<0)break;tt.push(h>>18|240,h>>12&63|128,h>>6&63|128,63&h|128)}}return tt}function Mo(d,a,h){const _=[];for(;a<h;){const j=d[a];let tt=null,rt=j>239?4:j>223?3:j>191?2:1;if(a+rt<=h){let st,dt,ht,mt;switch(rt){case 1:j<128&&(tt=j);break;case 2:st=d[a+1],(192&st)==128&&(mt=(31&j)<<6|63&st,mt>127&&(tt=mt));break;case 3:st=d[a+1],dt=d[a+2],(192&st)==128&&(192&dt)==128&&(mt=(15&j)<<12|(63&st)<<6|63&dt,mt>2047&&(mt<55296||mt>57343)&&(tt=mt));break;case 4:st=d[a+1],dt=d[a+2],ht=d[a+3],(192&st)==128&&(192&dt)==128&&(192&ht)==128&&(mt=(15&j)<<18|(63&st)<<12|(63&dt)<<6|63&ht,mt>65535&&mt<1114112&&(tt=mt))}}tt===null?(tt=65533,rt=1):tt>65535&&(tt-=65536,_.push(tt>>>10&1023|55296),tt=56320|1023&tt),_.push(tt),a+=rt}return Is(_)}function Is(d){const a=d.length;if(a<=4096)return String.fromCharCode.apply(String,d);let h="",_=0;for(;_<a;)h+=String.fromCharCode.apply(String,d.slice(_,_+=4096));return h}class Bn{constructor(a=256){this.chunkSize=a,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(a){let h=this.chunks[this.chunks.length-1];if(this.cursor+a.length<=this.maxCursor+1){const _=h.length-(this.maxCursor-this.cursor)-1;h.set(a,_)}else{if(h){const _=h.length-(this.maxCursor-this.cursor)-1;_<h.length&&(this.chunks[this.chunks.length-1]=h.subarray(0,_),this.maxCursor=this.cursor-1)}a.length<64&&a.length<this.chunkSize?(h=Ps(this.chunkSize),this.chunks.push(h),this.maxCursor+=h.length,this._initReuseChunk===null&&(this._initReuseChunk=h),h.set(a,0)):(this.chunks.push(a),this.maxCursor+=a.length)}this.cursor+=a.length}toBytes(a=!1){let h;if(this.chunks.length===1){const _=this.chunks[0];a&&this.cursor>_.length/2?(h=this.cursor===_.length?_:_.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):h=Xn(_,0,this.cursor)}else h=yo(this.chunks,this.cursor);return a&&this.reset(),h}}const Vt="CBOR decode error:",yn="CBOR encode error:";function gn(d,a,h){if(d.length-a<h)throw new Error(`${Vt} not enough data for type`)}const Dr=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Tn(d,a,h){gn(d,a,1);const _=d[a];if(h.strict===!0&&_<Dr[0])throw new Error(`${Vt} integer encoded in more bytes than necessary (strict decode)`);return _}function mn(d,a,h){gn(d,a,2);const _=d[a]<<8|d[a+1];if(h.strict===!0&&_<Dr[1])throw new Error(`${Vt} integer encoded in more bytes than necessary (strict decode)`);return _}function Cn(d,a,h){gn(d,a,4);const _=16777216*d[a]+(d[a+1]<<16)+(d[a+2]<<8)+d[a+3];if(h.strict===!0&&_<Dr[2])throw new Error(`${Vt} integer encoded in more bytes than necessary (strict decode)`);return _}function Et(d,a,h){gn(d,a,8);const _=16777216*d[a]+(d[a+1]<<16)+(d[a+2]<<8)+d[a+3],j=16777216*d[a+4]+(d[a+5]<<16)+(d[a+6]<<8)+d[a+7],tt=(BigInt(_)<<BigInt(32))+BigInt(j);if(h.strict===!0&&tt<Dr[3])throw new Error(`${Vt} integer encoded in more bytes than necessary (strict decode)`);if(tt<=Number.MAX_SAFE_INTEGER)return Number(tt);if(h.allowBigInt===!0)return tt;throw new Error(`${Vt} integers outside of the safe integer range are not supported`)}function xt(d,a){return St(d,0,a.value)}function St(d,a,h){if(h<Dr[0]){const _=Number(h);d.push([a|_])}else if(h<Dr[1]){const _=Number(h);d.push([24|a,_])}else if(h<Dr[2]){const _=Number(h);d.push([25|a,_>>>8,255&_])}else if(h<Dr[3]){const _=Number(h);d.push([26|a,_>>>24&255,_>>>16&255,_>>>8&255,255&_])}else{const _=BigInt(h);if(!(_<Dr[4]))throw new Error(`${Vt} encountered BigInt larger than allowable range`);{const j=[27|a,0,0,0,0,0,0,0];let tt=Number(_&BigInt(4294967295)),rt=Number(_>>BigInt(32)&BigInt(4294967295));j[8]=255&tt,tt>>=8,j[7]=255&tt,tt>>=8,j[6]=255&tt,tt>>=8,j[5]=255&tt,j[4]=255&rt,rt>>=8,j[3]=255&rt,rt>>=8,j[2]=255&rt,rt>>=8,j[1]=255&rt,d.push(j)}}}xt.encodedSize=function(d){return St.encodedSize(d.value)},St.encodedSize=function(d){return d<Dr[0]?1:d<Dr[1]?2:d<Dr[2]?3:d<Dr[3]?5:9},xt.compareTokens=function(d,a){return d.value<a.value?-1:d.value>a.value?1:0};const Bt=BigInt(-1),zt=BigInt(1);function Jt(d,a){const h=a.value,_=typeof h=="bigint"?h*Bt-zt:-1*h-1;St(d,a.type.majorEncoded,_)}function Kt(d,a,h,_){gn(d,a,h+_);const j=Xn(d,a+h,a+h+_);return new $t(yt.bytes,j,h+_)}function nr(d,a,h,_){return Kt(d,a,1,h)}function Mt(d){return d.encodedBytes===void 0&&(d.encodedBytes=d.type===yt.string?po(d.value):d.value),d.encodedBytes}function Pr(d,a){const h=Mt(a);St(d,a.type.majorEncoded,h.length),d.push(h)}function ur(d,a,h,_,j){const tt=h+_;gn(d,a,tt);const rt=new $t(yt.string,Cs(d,a+h,a+tt),tt);return j.retainStringBytes===!0&&(rt.byteValue=Xn(d,a+h,a+tt)),rt}function Br(d,a,h,_){return ur(d,a,1,h,_)}Jt.encodedSize=function(d){const a=d.value,h=typeof a=="bigint"?a*Bt-zt:-1*a-1;return h<Dr[0]?1:h<Dr[1]?2:h<Dr[2]?3:h<Dr[3]?5:9},Jt.compareTokens=function(d,a){return d.value<a.value?1:d.value>a.value?-1:0},Pr.encodedSize=function(d){const a=Mt(d);return St.encodedSize(a.length)+a.length},Pr.compareTokens=function(d,a){return h=Mt(d),_=Mt(a),h.length<_.length?-1:h.length>_.length?1:function(j,tt){if(un(j)&&un(tt))return j.compare(tt);for(let rt=0;rt<j.length;rt++)if(j[rt]!==tt[rt])return j[rt]<tt[rt]?-1:1;return 0}(h,_);var h,_};const Cr=Pr;function Mr(d,a,h,_){return new $t(yt.array,_,h)}function en(d,a,h,_){return Mr(0,0,1,h)}function Pn(d,a){St(d,yt.array.majorEncoded,a.value)}function ln(d,a,h,_){return new $t(yt.map,_,h)}function go(d,a,h,_){return ln(0,0,1,h)}function wn(d,a){St(d,yt.map.majorEncoded,a.value)}function Uo(d,a,h,_){return new $t(yt.tag,h,1)}function Ir(d,a){St(d,yt.tag.majorEncoded,a.value)}Pn.compareTokens=xt.compareTokens,Pn.encodedSize=function(d){return St.encodedSize(d.value)},wn.compareTokens=xt.compareTokens,wn.encodedSize=function(d){return St.encodedSize(d.value)},Ir.compareTokens=xt.compareTokens,Ir.encodedSize=function(d){return St.encodedSize(d.value)};function Jr(d,a,h){if(h){if(h.allowNaN===!1&&Number.isNaN(d))throw new Error(`${Vt} NaN values are not supported`);if(h.allowInfinity===!1&&(d===1/0||d===-1/0))throw new Error(`${Vt} Infinity values are not supported`)}return new $t(yt.float,d,a)}function dn(d,a,h){const _=a.value;if(_===!1)d.push([20|yt.float.majorEncoded]);else if(_===!0)d.push([21|yt.float.majorEncoded]);else if(_===null)d.push([22|yt.float.majorEncoded]);else if(_===void 0)d.push([23|yt.float.majorEncoded]);else{let tt,rt=!1;h&&h.float64===!0||(Ns(_),tt=rn(tn,1),_===tt||Number.isNaN(_)?(tn[0]=249,d.push(tn.slice(0,3)),rt=!0):(mo(_),tt=wo(tn,1),_===tt&&(tn[0]=250,d.push(tn.slice(0,5)),rt=!0))),rt||(j=_,Hr.setFloat64(0,j,!1),tt=Ds(tn,1),tn[0]=251,d.push(tn.slice(0,9)))}var j}dn.encodedSize=function(d,a){const h=d.value;if(h===!1||h===!0||h==null)return 1;if(!a||a.float64!==!0){Ns(h);let _=rn(tn,1);if(h===_||Number.isNaN(h))return 3;if(mo(h),_=wo(tn,1),h===_)return 5}return 9};const _i=new ArrayBuffer(9),Hr=new DataView(_i,1),tn=new Uint8Array(_i,0);function Ns(d){if(d===1/0)Hr.setUint16(0,31744,!1);else if(d===-1/0)Hr.setUint16(0,64512,!1);else if(Number.isNaN(d))Hr.setUint16(0,32256,!1);else{Hr.setFloat32(0,d);const a=Hr.getUint32(0),h=(2139095040&a)>>23,_=8388607&a;if(h===255)Hr.setUint16(0,31744,!1);else if(h===0)Hr.setUint16(0,(2147483648&d)>>16|_>>13,!1);else{const j=h-127;j<-24?Hr.setUint16(0,0):j<-14?Hr.setUint16(0,(2147483648&a)>>16|1<<24+j,!1):Hr.setUint16(0,(2147483648&a)>>16|j+15<<10|_>>13,!1)}}}function rn(d,a){if(d.length-a<2)throw new Error(`${Vt} not enough data for float16`);const h=(d[a]<<8)+d[a+1];if(h===31744)return 1/0;if(h===64512)return-1/0;if(h===32256)return NaN;const _=h>>10&31,j=1023&h;let tt;return tt=_===0?j*2**-24:_!==31?(j+1024)*2**(_-25):j===0?1/0:NaN,32768&h?-tt:tt}function mo(d){Hr.setFloat32(0,d,!1)}function wo(d,a){if(d.length-a<4)throw new Error(`${Vt} not enough data for float32`);const h=(d.byteOffset||0)+a;return new DataView(d.buffer,h,4).getFloat32(0,!1)}function Ds(d,a){if(d.length-a<8)throw new Error(`${Vt} not enough data for float64`);const h=(d.byteOffset||0)+a;return new DataView(d.buffer,h,8).getFloat64(0,!1)}function gr(d,a,h){throw new Error(`${Vt} encountered invalid minor (${h}) for major ${d[a]>>>5}`)}function Ls(d){return()=>{throw new Error(`${Vt} ${d}`)}}dn.compareTokens=xt.compareTokens;const Dt=[];for(let d=0;d<=23;d++)Dt[d]=gr;Dt[24]=function(d,a,h,_){return new $t(yt.uint,Tn(d,a+1,_),2)},Dt[25]=function(d,a,h,_){return new $t(yt.uint,mn(d,a+1,_),3)},Dt[26]=function(d,a,h,_){return new $t(yt.uint,Cn(d,a+1,_),5)},Dt[27]=function(d,a,h,_){return new $t(yt.uint,Et(d,a+1,_),9)},Dt[28]=gr,Dt[29]=gr,Dt[30]=gr,Dt[31]=gr;for(let d=32;d<=55;d++)Dt[d]=gr;Dt[56]=function(d,a,h,_){return new $t(yt.negint,-1-Tn(d,a+1,_),2)},Dt[57]=function(d,a,h,_){return new $t(yt.negint,-1-mn(d,a+1,_),3)},Dt[58]=function(d,a,h,_){return new $t(yt.negint,-1-Cn(d,a+1,_),5)},Dt[59]=function(d,a,h,_){const j=Et(d,a+1,_);if(typeof j!="bigint"){const tt=-1-j;if(tt>=Number.MIN_SAFE_INTEGER)return new $t(yt.negint,tt,9)}if(_.allowBigInt!==!0)throw new Error(`${Vt} integers outside of the safe integer range are not supported`);return new $t(yt.negint,Bt-BigInt(j),9)},Dt[60]=gr,Dt[61]=gr,Dt[62]=gr,Dt[63]=gr;for(let d=64;d<=87;d++)Dt[d]=nr;Dt[88]=function(d,a,h,_){return Kt(d,a,2,Tn(d,a+1,_))},Dt[89]=function(d,a,h,_){return Kt(d,a,3,mn(d,a+1,_))},Dt[90]=function(d,a,h,_){return Kt(d,a,5,Cn(d,a+1,_))},Dt[91]=function(d,a,h,_){const j=Et(d,a+1,_);if(typeof j=="bigint")throw new Error(`${Vt} 64-bit integer bytes lengths not supported`);return Kt(d,a,9,j)},Dt[92]=gr,Dt[93]=gr,Dt[94]=gr,Dt[95]=Ls("indefinite length bytes/strings are not supported");for(let d=96;d<=119;d++)Dt[d]=Br;Dt[120]=function(d,a,h,_){return ur(d,a,2,Tn(d,a+1,_),_)},Dt[121]=function(d,a,h,_){return ur(d,a,3,mn(d,a+1,_),_)},Dt[122]=function(d,a,h,_){return ur(d,a,5,Cn(d,a+1,_),_)},Dt[123]=function(d,a,h,_){const j=Et(d,a+1,_);if(typeof j=="bigint")throw new Error(`${Vt} 64-bit integer string lengths not supported`);return ur(d,a,9,j,_)},Dt[124]=gr,Dt[125]=gr,Dt[126]=gr,Dt[127]=Ls("indefinite length bytes/strings are not supported");for(let d=128;d<=151;d++)Dt[d]=en;Dt[152]=function(d,a,h,_){return Mr(0,0,2,Tn(d,a+1,_))},Dt[153]=function(d,a,h,_){return Mr(0,0,3,mn(d,a+1,_))},Dt[154]=function(d,a,h,_){return Mr(0,0,5,Cn(d,a+1,_))},Dt[155]=function(d,a,h,_){const j=Et(d,a+1,_);if(typeof j=="bigint")throw new Error(`${Vt} 64-bit integer array lengths not supported`);return Mr(0,0,9,j)},Dt[156]=gr,Dt[157]=gr,Dt[158]=gr,Dt[159]=function(d,a,h,_){if(_.allowIndefinite===!1)throw new Error(`${Vt} indefinite length items not allowed`);return Mr(0,0,1,1/0)};for(let d=160;d<=183;d++)Dt[d]=go;Dt[184]=function(d,a,h,_){return ln(0,0,2,Tn(d,a+1,_))},Dt[185]=function(d,a,h,_){return ln(0,0,3,mn(d,a+1,_))},Dt[186]=function(d,a,h,_){return ln(0,0,5,Cn(d,a+1,_))},Dt[187]=function(d,a,h,_){const j=Et(d,a+1,_);if(typeof j=="bigint")throw new Error(`${Vt} 64-bit integer map lengths not supported`);return ln(0,0,9,j)},Dt[188]=gr,Dt[189]=gr,Dt[190]=gr,Dt[191]=function(d,a,h,_){if(_.allowIndefinite===!1)throw new Error(`${Vt} indefinite length items not allowed`);return ln(0,0,1,1/0)};for(let d=192;d<=215;d++)Dt[d]=Uo;Dt[216]=function(d,a,h,_){return new $t(yt.tag,Tn(d,a+1,_),2)},Dt[217]=function(d,a,h,_){return new $t(yt.tag,mn(d,a+1,_),3)},Dt[218]=function(d,a,h,_){return new $t(yt.tag,Cn(d,a+1,_),5)},Dt[219]=function(d,a,h,_){return new $t(yt.tag,Et(d,a+1,_),9)},Dt[220]=gr,Dt[221]=gr,Dt[222]=gr,Dt[223]=gr;for(let d=224;d<=243;d++)Dt[d]=Ls("simple values are not supported");Dt[244]=gr,Dt[245]=gr,Dt[246]=gr,Dt[247]=function(d,a,h,_){if(_.allowUndefined===!1)throw new Error(`${Vt} undefined values are not supported`);return _.coerceUndefinedToNull===!0?new $t(yt.null,null,1):new $t(yt.undefined,void 0,1)},Dt[248]=Ls("simple values are not supported"),Dt[249]=function(d,a,h,_){return Jr(rn(d,a+1),3,_)},Dt[250]=function(d,a,h,_){return Jr(wo(d,a+1),5,_)},Dt[251]=function(d,a,h,_){return Jr(Ds(d,a+1),9,_)},Dt[252]=gr,Dt[253]=gr,Dt[254]=gr,Dt[255]=function(d,a,h,_){if(_.allowIndefinite===!1)throw new Error(`${Vt} indefinite length items not allowed`);return new $t(yt.break,void 0,1)};const vn=[];for(let d=0;d<24;d++)vn[d]=new $t(yt.uint,d,1);for(let d=-1;d>=-24;d--)vn[31-d]=new $t(yt.negint,d,1);function wp(d){switch(d.type){case yt.false:return Xr([244]);case yt.true:return Xr([245]);case yt.null:return Xr([246]);case yt.bytes:return d.value.length?void 0:Xr([64]);case yt.string:return d.value===""?Xr([96]):void 0;case yt.array:return d.value===0?Xr([128]):void 0;case yt.map:return d.value===0?Xr([160]):void 0;case yt.uint:return d.value<24?Xr([Number(d.value)]):void 0;case yt.negint:if(d.value>=-24)return Xr([31-Number(d.value)])}}vn[64]=new $t(yt.bytes,new Uint8Array(0),1),vn[96]=new $t(yt.string,"",1),vn[128]=new $t(yt.array,0,1),vn[160]=new $t(yt.map,0,1),vn[244]=new $t(yt.false,!1,1),vn[245]=new $t(yt.true,!0,1),vn[246]=new $t(yt.null,null,1);const mw={float64:!1,mapSorter:function(d,a){const h=Array.isArray(d[0])?d[0][0]:d[0],_=Array.isArray(a[0])?a[0][0]:a[0];if(h.type!==_.type)return h.type.compare(_.type);const j=h.type.major,tt=bp[j].compareTokens(h,_);return tt===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),tt},quickEncodeToken:wp};function vp(){const d=[];return d[yt.uint.major]=xt,d[yt.negint.major]=Jt,d[yt.bytes.major]=Pr,d[yt.string.major]=Cr,d[yt.array.major]=Pn,d[yt.map.major]=wn,d[yt.tag.major]=Ir,d[yt.float.major]=dn,d}const bp=vp(),Lu=new Bn;class Rs{constructor(a,h){this.obj=a,this.parent=h}includes(a){let h=this;do if(h.obj===a)return!0;while(h=h.parent);return!1}static createCheck(a,h){if(a&&a.includes(h))throw new Error(`${yn} object contains circular references`);return new Rs(h,a)}}const Mn={null:new $t(yt.null,null),undefined:new $t(yt.undefined,void 0),true:new $t(yt.true,!0),false:new $t(yt.false,!1),emptyArray:new $t(yt.array,0),emptyMap:new $t(yt.map,0)},Un={number:(d,a,h,_)=>Number.isInteger(d)&&Number.isSafeInteger(d)?new $t(d>=0?yt.uint:yt.negint,d):new $t(yt.float,d),bigint:(d,a,h,_)=>d>=BigInt(0)?new $t(yt.uint,d):new $t(yt.negint,d),Uint8Array:(d,a,h,_)=>new $t(yt.bytes,d),string:(d,a,h,_)=>new $t(yt.string,d),boolean:(d,a,h,_)=>d?Mn.true:Mn.false,null:(d,a,h,_)=>Mn.null,undefined:(d,a,h,_)=>Mn.undefined,ArrayBuffer:(d,a,h,_)=>new $t(yt.bytes,new Uint8Array(d)),DataView:(d,a,h,_)=>new $t(yt.bytes,new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),Array(d,a,h,_){if(!d.length)return h.addBreakTokens===!0?[Mn.emptyArray,new $t(yt.break)]:Mn.emptyArray;_=Rs.createCheck(_,d);const j=[];let tt=0;for(const rt of d)j[tt++]=Os(rt,h,_);return h.addBreakTokens?[new $t(yt.array,d.length),j,new $t(yt.break)]:[new $t(yt.array,d.length),j]},Object(d,a,h,_){const j=a!=="Object",tt=j?d.keys():Object.keys(d),rt=j?d.size:tt.length;if(!rt)return h.addBreakTokens===!0?[Mn.emptyMap,new $t(yt.break)]:Mn.emptyMap;_=Rs.createCheck(_,d);const st=[];let dt=0;for(const ht of tt)st[dt++]=[Os(ht,h,_),Os(j?d.get(ht):d[ht],h,_)];return function(ht,mt){mt.mapSorter&&ht.sort(mt.mapSorter)}(st,h),h.addBreakTokens?[new $t(yt.map,rt),st,new $t(yt.break)]:[new $t(yt.map,rt),st]}};Un.Map=Un.Object,Un.Buffer=Un.Uint8Array;for(const d of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Un[`${d}Array`]=Un.DataView;function Os(d,a={},h){const _=dr(d),j=a&&a.typeEncoders&&a.typeEncoders[_]||Un[_];if(typeof j=="function"){const rt=j(d,_,a,h);if(rt!=null)return rt}const tt=Un[_];if(!tt)throw new Error(`${yn} unsupported type: ${_}`);return tt(d,_,a,h)}function kp(d,a,h,_){if(Array.isArray(a))for(const j of a)kp(d,j,h,_);else h[a.type.major](d,a,_)}function Ep(d,a,h){const _=Os(d,h);if(!Array.isArray(_)&&h.quickEncodeToken){const j=h.quickEncodeToken(_);if(j)return j;const tt=a[_.type.major];if(tt.encodedSize){const rt=tt.encodedSize(_,h),st=new Bn(rt);if(tt(st,_,h),st.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${_} was wrong`);return $n(st.chunks[0])}}return Lu.reset(),kp(Lu,_,a,h),Lu.toBytes(!0)}const ww={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class vw{constructor(a,h={}){this.pos=0,this.data=a,this.options=h}done(){return this.pos>=this.data.length}next(){const a=this.data[this.pos];let h=vn[a];if(h===void 0){const _=Dt[a];if(!_)throw new Error(`${Vt} no decoder for major type ${a>>>5} (byte 0x${a.toString(16).padStart(2,"0")})`);const j=31&a;h=_(this.data,this.pos,j,this.options)}return this.pos+=h.encodedLength,h}}const zo=Symbol.for("DONE"),js=Symbol.for("BREAK");function Fo(d,a){if(d.done())return zo;const h=d.next();if(h.type===yt.break)return js;if(h.type.terminal)return h.value;if(h.type===yt.array)return function(_,j,tt){const rt=[];for(let st=0;st<_.value;st++){const dt=Fo(j,tt);if(dt===js){if(_.value===1/0)break;throw new Error(`${Vt} got unexpected break to lengthed array`)}if(dt===zo)throw new Error(`${Vt} found array but not enough entries (got ${st}, expected ${_.value})`);rt[st]=dt}return rt}(h,d,a);if(h.type===yt.map)return function(_,j,tt){const rt=tt.useMaps===!0,st=rt?void 0:{},dt=rt?new Map:void 0;for(let ht=0;ht<_.value;ht++){const mt=Fo(j,tt);if(mt===js){if(_.value===1/0)break;throw new Error(`${Vt} got unexpected break to lengthed map`)}if(mt===zo)throw new Error(`${Vt} found map but not enough entries (got ${ht} [no key], expected ${_.value})`);if(rt!==!0&&typeof mt!="string")throw new Error(`${Vt} non-string keys not supported (got ${typeof mt})`);if(tt.rejectDuplicateMapKeys===!0&&(rt&&dt.has(mt)||!rt&&mt in st))throw new Error(`${Vt} found repeat map key "${mt}"`);const kt=Fo(j,tt);if(kt===zo)throw new Error(`${Vt} found map but not enough entries (got ${ht} [no value], expected ${_.value})`);rt?dt.set(mt,kt):st[mt]=kt}return rt?dt:st}(h,d,a);if(h.type===yt.tag){if(a.tags&&typeof a.tags[h.value]=="function"){const _=Fo(d,a);return a.tags[h.value](_)}throw new Error(`${Vt} tag not supported (${h.value})`)}throw new Error("unsupported")}function xp(d,a){if(!(d instanceof Uint8Array))throw new Error(`${Vt} data to decode must be a Uint8Array`);const h=(a=Object.assign({},ww,a)).tokenizer||new vw(d,a),_=Fo(h,a);if(_===zo)throw new Error(`${Vt} did not find any content to decode`);if(_===js)throw new Error(`${Vt} got unexpected break`);if(!h.done())throw new Error(`${Vt} too many terminals, data makes no sense`);return _}var bw=function(d,a){if(d.length>=255)throw new TypeError("Alphabet too long");for(var h=new Uint8Array(256),_=0;_<h.length;_++)h[_]=255;for(var j=0;j<d.length;j++){var tt=d.charAt(j),rt=tt.charCodeAt(0);if(h[rt]!==255)throw new TypeError(tt+" is ambiguous");h[rt]=j}var st=d.length,dt=d.charAt(0),ht=Math.log(st)/Math.log(256),mt=Math.log(256)/Math.log(st);function kt(_t){if(typeof _t!="string")throw new TypeError("Expected String");if(_t.length===0)return new Uint8Array;var Lt=0;if(_t[Lt]!==" "){for(var Ut=0,Zt=0;_t[Lt]===dt;)Ut++,Lt++;for(var fr=(_t.length-Lt)*ht+1>>>0,Gt=new Uint8Array(fr);_t[Lt];){var tr=h[_t.charCodeAt(Lt)];if(tr===255)return;for(var wr=0,xr=fr-1;(tr!==0||wr<Zt)&&xr!==-1;xr--,wr++)tr+=st*Gt[xr]>>>0,Gt[xr]=tr%256>>>0,tr=tr/256>>>0;if(tr!==0)throw new Error("Non-zero carry");Zt=wr,Lt++}if(_t[Lt]!==" "){for(var Er=fr-Zt;Er!==fr&&Gt[Er]===0;)Er++;for(var Yr=new Uint8Array(Ut+(fr-Er)),ho=Ut;Er!==fr;)Yr[ho++]=Gt[Er++];return Yr}}}return{encode:function(_t){if(_t instanceof Uint8Array||(ArrayBuffer.isView(_t)?_t=new Uint8Array(_t.buffer,_t.byteOffset,_t.byteLength):Array.isArray(_t)&&(_t=Uint8Array.from(_t))),!(_t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(_t.length===0)return"";for(var Lt=0,Ut=0,Zt=0,fr=_t.length;Zt!==fr&&_t[Zt]===0;)Zt++,Lt++;for(var Gt=(fr-Zt)*mt+1>>>0,tr=new Uint8Array(Gt);Zt!==fr;){for(var wr=_t[Zt],xr=0,Er=Gt-1;(wr!==0||xr<Ut)&&Er!==-1;Er--,xr++)wr+=256*tr[Er]>>>0,tr[Er]=wr%st>>>0,wr=wr/st>>>0;if(wr!==0)throw new Error("Non-zero carry");Ut=xr,Zt++}for(var Yr=Gt-Ut;Yr!==Gt&&tr[Yr]===0;)Yr++;for(var ho=dt.repeat(Lt);Yr<Gt;++Yr)ho+=d.charAt(tr[Yr]);return ho},decodeUnsafe:kt,decode:function(_t){var Lt=kt(_t);if(Lt)return Lt;throw new Error(`Non-${a} character`)}}},kw=bw;class Ew{constructor(a,h,_){this.name=a,this.prefix=h,this.baseEncode=_}encode(a){if(a instanceof Uint8Array)return`${this.prefix}${this.baseEncode(a)}`;throw Error("Unknown type, must be binary type")}}class xw{constructor(a,h,_){if(this.name=a,this.prefix=h,h.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=h.codePointAt(0),this.baseDecode=_}decode(a){if(typeof a=="string"){if(a.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(a)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(a.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(a){return _p(this,a)}}class _w{constructor(a){this.decoders=a}or(a){return _p(this,a)}decode(a){const h=a[0],_=this.decoders[h];if(_)return _.decode(a);throw RangeError(`Unable to decode multibase string ${JSON.stringify(a)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const _p=(d,a)=>new _w({...d.decoders||{[d.prefix]:d},...a.decoders||{[a.prefix]:a}});class Sw{constructor(a,h,_,j){this.name=a,this.prefix=h,this.baseEncode=_,this.baseDecode=j,this.encoder=new Ew(a,h,_),this.decoder=new xw(a,h,j)}encode(a){return this.encoder.encode(a)}decode(a){return this.decoder.decode(a)}}const Bs=({name:d,prefix:a,encode:h,decode:_})=>new Sw(d,a,h,_),Wo=({prefix:d,name:a,alphabet:h})=>{const{encode:_,decode:j}=kw(h,a);return Bs({prefix:d,name:a,encode:_,decode:tt=>et(j(tt))})},Ur=({name:d,prefix:a,bitsPerChar:h,alphabet:_})=>Bs({prefix:a,name:d,encode:j=>((tt,rt,st)=>{const dt=rt[rt.length-1]==="=",ht=(1<<st)-1;let mt="",kt=0,_t=0;for(let Lt=0;Lt<tt.length;++Lt)for(_t=_t<<8|tt[Lt],kt+=8;kt>st;)kt-=st,mt+=rt[ht&_t>>kt];if(kt&&(mt+=rt[ht&_t<<st-kt]),dt)for(;mt.length*st&7;)mt+="=";return mt})(j,_,h),decode:j=>((tt,rt,st,dt)=>{const ht={};for(let Zt=0;Zt<rt.length;++Zt)ht[rt[Zt]]=Zt;let mt=tt.length;for(;tt[mt-1]==="=";)--mt;const kt=new Uint8Array(mt*st/8|0);let _t=0,Lt=0,Ut=0;for(let Zt=0;Zt<mt;++Zt){const fr=ht[tt[Zt]];if(fr===void 0)throw new SyntaxError(`Non-${dt} character`);Lt=Lt<<st|fr,_t+=st,_t>=8&&(_t-=8,kt[Ut++]=255&Lt>>_t)}if(_t>=st||255&Lt<<8-_t)throw new SyntaxError("Unexpected end of data");return kt})(j,_,h,d)}),nn=Wo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$w=Wo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Tw=Object.freeze({__proto__:null,base58btc:nn,base58flickr:$w});const eo=Ur({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Cw=Ur({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pw=Ur({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Aw=Ur({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Iw=Ur({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Nw=Ur({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dw=Ur({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lw=Ur({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Rw=Ur({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ow=Object.freeze({__proto__:null,base32:eo,base32upper:Cw,base32pad:Pw,base32padupper:Aw,base32hex:Iw,base32hexupper:Nw,base32hexpad:Dw,base32hexpadupper:Lw,base32z:Rw});const Sp=(d,a)=>{const{bytes:h,version:_}=d;return _===0?Bw(h,Ru(d),a||nn.encoder):Mw(h,Ru(d),a||eo.encoder)},$p=new WeakMap,Ru=d=>{const a=$p.get(d);if(a==null){const h=new Map;return $p.set(d,h),h}return a};class br{constructor(a,h,_,j){this.code=h,this.version=a,this.multihash=_,this.bytes=j,this["/"]=j}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:a,multihash:h}=this;if(a!==Vo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(h.code!==Uw)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return br.createV0(h)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:a,digest:h}=this.multihash,_=Wt(a,h);return br.createV1(this.code,_)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(a){return br.equals(this,a)}static equals(a,h){const _=h;return _&&a.code===_.code&&a.version===_.version&&((j,tt)=>{if(j===tt)return!0;{const rt=tt;return j.code===rt.code&&j.size===rt.size&&rt.bytes instanceof Uint8Array&&((st,dt)=>{if(st===dt)return!0;if(st.byteLength!==dt.byteLength)return!1;for(let ht=0;ht<st.byteLength;ht++)if(st[ht]!==dt[ht])return!1;return!0})(j.bytes,rt.bytes)}})(a.multihash,_.multihash)}toString(a){return Sp(this,a)}toJSON(){return{"/":Sp(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(a){if(a==null)return null;const h=a;if(h instanceof br)return h;if(h["/"]!=null&&h["/"]===h.bytes||h.asCID===h){const{version:_,code:j,multihash:tt,bytes:rt}=h;return new br(_,j,tt,rt||Tp(_,j,tt.bytes))}if(h[zw]===!0){const{version:_,multihash:j,code:tt}=h,rt=hr(j);return br.create(_,tt,rt)}return null}static create(a,h,_){if(typeof h!="number")throw new Error("String codecs are no longer supported");if(!(_.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(a){case 0:if(h!==Vo)throw new Error(`Version 0 CID must use dag-pb (code: ${Vo}) block encoding`);return new br(a,h,_,_.bytes);case 1:{const j=Tp(a,h,_.bytes);return new br(a,h,_,j)}default:throw new Error("Invalid version")}}static createV0(a){return br.create(0,Vo,a)}static createV1(a,h){return br.create(1,a,h)}static decode(a){const[h,_]=br.decodeFirst(a);if(_.length)throw new Error("Incorrect length");return h}static decodeFirst(a){const h=br.inspectBytes(a),_=h.size-h.multihashSize,j=et(a.subarray(_,_+h.multihashSize));if(j.byteLength!==h.multihashSize)throw new Error("Incorrect length");const tt=j.subarray(h.multihashSize-h.digestSize),rt=new Sr(h.multihashCode,h.digestSize,tt,j);return[h.version===0?br.createV0(rt):br.createV1(h.codec,rt),a.subarray(h.size)]}static inspectBytes(a){let h=0;const _=()=>{const[mt,kt]=At(a.subarray(h));return h+=kt,mt};let j=_(),tt=Vo;if(j===18?(j=0,h=0):tt=_(),j!==0&&j!==1)throw new RangeError(`Invalid CID version ${j}`);const rt=h,st=_(),dt=_(),ht=h+dt;return{version:j,codec:tt,multihashCode:st,digestSize:dt,multihashSize:ht-rt,size:ht}}static parse(a,h){const[_,j]=jw(a,h),tt=br.decode(j);if(tt.version===0&&a[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ru(tt).set(_,a),tt}}const jw=(d,a)=>{switch(d[0]){case"Q":{const h=a||nn;return[nn.prefix,h.decode(`${nn.prefix}${d}`)]}case nn.prefix:{const h=a||nn;return[nn.prefix,h.decode(d)]}case eo.prefix:{const h=a||eo;return[eo.prefix,h.decode(d)]}default:if(a==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[d[0],a.decode(d)]}},Bw=(d,a,h)=>{const{prefix:_}=h;if(_!==nn.prefix)throw Error(`Cannot string encode V0 in ${h.name} encoding`);const j=a.get(_);if(j==null){const tt=h.encode(d).slice(1);return a.set(_,tt),tt}return j},Mw=(d,a,h)=>{const{prefix:_}=h,j=a.get(_);if(j==null){const tt=h.encode(d);return a.set(_,tt),tt}return j},Vo=112,Uw=18,Tp=(d,a,h)=>{const _=Rt(d),j=_+Rt(a),tt=new Uint8Array(j+h.byteLength);return Pt(d,tt,0),Pt(a,tt,_),tt.set(h,j),tt},zw=Symbol.for("@ipld/js-cid/CID"),Fw={float64:!0,typeEncoders:{Object:function(d){if(d.asCID!==d&&d["/"]!==d.bytes)return null;const a=br.asCID(d);if(!a)return null;const h=new Uint8Array(a.bytes.byteLength+1);return h.set(a.bytes,1),[new $t(yt.tag,42),new $t(yt.bytes,h)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(d){if(Number.isNaN(d))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(d===1/0||d===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Cp={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Cp.tags[42]=function(d){if(d[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return br.decode(d.subarray(1))};const Ou=d=>{return a=d,h=Fw,h=Object.assign({},mw,h),Ep(a,bp,h);var a,h},Ho=d=>xp(d,Cp),Ww=new TextEncoder,Vw=new TextDecoder,Qo=d=>Ww.encode(d),Ms=d=>Vw.decode(d),Ko=(d,a)=>br.create(1,d,a),vo=d=>{if(d==null)return!1;const a=d;return a["/"]!=null&&a["/"]===a.bytes?!0:d.asCID===d},Pp=(d,a)=>br.parse(d,a),Ap=et,Hw={code:0,name:"identity",encode:Ap,digest:d=>Wt(0,Ap(d))},Ip="did:",Qw=Ip.length,Np="did:key:",Kw=Np.length,ju=3357,Bu=Rt(ju),bn=d=>{if(d.startsWith(Ip)){if(d.startsWith(Np)){const a=nn.decode(d.slice(Kw));return Mu(a)}{const a=Qo(d.slice(Qw)),h=new Uint8Array(a.byteLength+Bu);return Pt(ju,h),h.set(a,Bu),new Us(h)}}throw new RangeError(`Invalid DID "${d}", must start with 'did:'`)},Dp=d=>d.did(),Lp=d=>d instanceof Us?d:d instanceof Uint8Array?Mu(d):bn(typeof d=="string"?d:d.did()),Mu=d=>{const[a]=At(d),{buffer:h,byteOffset:_,byteLength:j}=d;switch(a){case 4608:if(d.length>35)throw new RangeError("Only p256-pub compressed is supported.");case 237:case 4613:case 4609:case 4610:return new Gw(h,_,j);case ju:return new Us(h,_,j);default:throw new RangeError(`Unsupported DID encoding, unknown multicode 0x${a.toString(16)}.`)}};class Us extends Uint8Array{did(){const a=new Uint8Array(this.buffer,this.byteOffset+Bu);return`did:${Ms(a)}`}toJSON(){return this.did()}}class Gw extends Us{did(){return`did:key:${nn.encode(this)}`}}const zs=Ur({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zw=Ur({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),to=Ur({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qw=Ur({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jw=Object.freeze({__proto__:null,base64:zs,base64pad:Zw,base64url:to,base64urlpad:qw});const Uu=53248,zu=53485,Rp=13636096,jp=13636097,Bp=13636098,Fu=13636101,Mp=d=>{switch(d){case 53479:return"ES256K";case 53482:return"BLS12381G1";case 53483:return"BLS12381G2";case zu:return"EdDSA";case Rp:return"ES256";case jp:return"ES384";case Bp:return"ES512";case Fu:return"RS256";case 53649:return"EIP191";default:throw new RangeError(`Unknown signature algorithm code 0x${d.toString(16)}`)}};class Wu extends Uint8Array{get code(){const[a]=At(this);return Object.defineProperties(this,{code:{value:a}}),a}get size(){const a=Xw(this);return Object.defineProperties(this,{size:{value:a}}),a}get algorithm(){const a=Yw(this);return Object.defineProperties(this,{algorithm:{value:a}}),a}get raw(){const{buffer:a,byteOffset:h,size:_,code:j}=this,tt=Rt(j),rt=Rt(_),st=new Uint8Array(a,h+tt+rt,_);return Object.defineProperties(this,{raw:{value:st}}),st}toJSON(){return rv(this)}}const Yw=d=>{const{code:a,raw:h,buffer:_,byteOffset:j}=d;if(a===Uu){const tt=h.byteLength+Rt(a)+Rt(h.byteLength),rt=new Uint8Array(_,j+tt);return Ms(rt)}return Mp(a)},Xw=d=>{const a=Rt(d.code),[h]=At(new Uint8Array(d.buffer,d.byteOffset+a));return h},Vu=(d,a)=>{Mp(d);const h=Rt(d),_=Rt(a.byteLength),j=new Wu(h+_+a.byteLength);return Pt(d,j),Pt(a.byteLength,j,h),j.set(a,h+_),Object.defineProperties(j,{code:{value:d},size:{value:a.byteLength}}),j},ev=(d,a)=>{const h=(_=>{switch(_){case"ES256K":return 53479;case"BLS12381G1":return 53482;case"BLS12381G2":return 53483;case"EdDSA":return zu;case"ES256":return Rp;case"ES384":return jp;case"ES512":return Bp;case"RS256":return Fu;case"EIP191":return 53649;default:return Uu}})(d);return h===Uu?tv(d,a):Vu(h,a)},tv=(d,a)=>{const h=Rt(53248),_=Rt(a.byteLength),j=Qo(d),tt=new Wu(h+_+a.byteLength+j.byteLength);return Pt(53248,tt),Pt(a.byteLength,tt,h),tt.set(a,h+_),tt.set(j,h+_+a.byteLength),tt},Hu=d=>{if(!(d instanceof Uint8Array))throw new TypeError(`Can only decode Uint8Array into a Signature, instead got ${JSON.stringify(d)}`);return(h=>new Wu(h.buffer,h.byteOffset,h.byteLength))(d)},rv=d=>({"/":{bytes:zs.baseEncode(d)}}),Qu=d=>Up(d,{readPrincipal:pv,readProof:dv}),Up=(d,{readPrincipal:a,readProof:h})=>({iss:a(d.iss,"iss"),aud:a(d.aud,"aud"),att:ov(d.att,"att"),prf:Wp(d.prf,h,"prf")||[],exp:gv(d.exp===1/0?null:d.exp,zp,"exp"),nbf:Hp(d.nbf,zp,"nbf"),fct:Wp(d.fct,lv,"fct")||[],nnc:Hp(d.nnc,Fs,"nnc")}),nv=d=>{if(d instanceof Uint8Array)return Hu(d);throw new TypeError(`Can only decode Uint8Array into a Signature, instead got ${JSON.stringify(d)}`)},zp=(d,a)=>Number.isInteger(d)?d:kn.throw(`Expected ${a} to be integer, instead got ${JSON.stringify(d)}`),iv=(d,a)=>Vp(d,sv,a),ov=(d,a)=>Fp(d,iv,a),sv=d=>({...d,can:av(d.can),with:cv(d.with)}),av=d=>typeof d!="string"?kn.throw(`Capability has invalid 'can: ${JSON.stringify(d)}', value must be a string`):d.slice(1,-1).includes("/")?d.toLocaleLowerCase():d==="*"?d:kn.throw(`Capability has invalid 'can: "${d}"', value must have at least one path segment`),cv=d=>typeof d!="string"?kn.throw(`Capability has invalid 'with: ${JSON.stringify(d)}', value must be a string`):uv(d)||kn.throw(`Capability has invalid 'with: "${d}"', value must be a valid URI string`),uv=d=>{try{return new URL(d),d}catch{return null}},Fp=(d,a,h)=>Array.isArray(d)?d.map((_,j)=>a(_,`${h}[${j}]`)):kn.throw(`${h} must be an array`),Wp=(d,a,h)=>d===void 0?d:Fp(d,a,h),Vp=(d,a,h)=>d!=null&&typeof d=="object"?a(d):kn.throw(`${h} must be of type object, instead got ${d}`),lv=(d,a)=>Vp(d,Object,a),dv=(d,a)=>vo(d)?d:Ws(`Expected ${a} to be IPLD link, instead got ${JSON.stringify(d)}`),fv=(d,a)=>hv(Fs(d,a)),hv=d=>{try{return Pp(d)}catch{return Ko(85,Hw.digest(Qo(d)))}},pv=(d,a)=>Mu(mv(d,a)),yv=(d,a)=>bn(Fs(d,a)),Hp=(d,a,h="Field")=>d!==void 0?a(d,h):void 0,gv=(d,a,h)=>d===null?null:a(d,h),Fs=(d,a="Field")=>typeof d=="string"?d:Ws(`${a} has invalid value ${d}`),mv=(d,a)=>d instanceof Uint8Array?d:Ws(`Expected ${a} to be Uint8Array, instead got ${JSON.stringify(d)}`),Ku=(d,a)=>/\d+\.\d+\.\d+/.test(d)?d:kn.throw(`Invalid version '${a}: ${JSON.stringify(d)}'`);class kn extends TypeError{get name(){return"ParseError"}static throw(a){throw new this(a)}}const Ws=d=>kn.throw(d);class wv extends Array{constructor(){super(),this.inRecursive=[]}prefix(a){const h=this.inRecursive[this.inRecursive.length-1];h&&(h.type===yt.array&&(h.elements++,h.elements!==1&&a.push([44])),h.type===yt.map&&(h.elements++,h.elements!==1&&(h.elements%2==1?a.push([44]):a.push([58]))))}[yt.uint.major](a,h){this.prefix(a);const _=String(h.value),j=[];for(let tt=0;tt<_.length;tt++)j[tt]=_.charCodeAt(tt);a.push(j)}[yt.negint.major](a,h){this[yt.uint.major](a,h)}[yt.bytes.major](a,h){throw new Error(`${yn} unsupported type: Uint8Array`)}[yt.string.major](a,h){this.prefix(a);const _=po(JSON.stringify(h.value));a.push(_.length>32?$n(_):_)}[yt.array.major](a,h){this.prefix(a),this.inRecursive.push({type:yt.array,elements:0}),a.push([91])}[yt.map.major](a,h){this.prefix(a),this.inRecursive.push({type:yt.map,elements:0}),a.push([123])}[yt.tag.major](a,h){}[yt.float.major](a,h){if(h.type.name==="break"){const rt=this.inRecursive.pop();if(rt){if(rt.type===yt.array)a.push([93]);else{if(rt.type!==yt.map)throw new Error("Unexpected recursive type; this should not happen!");a.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(h.value===void 0)throw new Error(`${yn} unsupported type: undefined`);if(this.prefix(a),h.type.name==="true")return void a.push([116,114,117,101]);if(h.type.name==="false")return void a.push([102,97,108,115,101]);if(h.type.name==="null")return void a.push([110,117,108,108]);const _=String(h.value),j=[];let tt=!1;for(let rt=0;rt<_.length;rt++)j[rt]=_.charCodeAt(rt),tt||j[rt]!==46&&j[rt]!==101&&j[rt]!==69||(tt=!0);tt||(j.push(46),j.push(48)),a.push(j)}}const vv={addBreakTokens:!0,mapSorter:function(d,a){if(Array.isArray(d[0])||Array.isArray(a[0]))throw new Error(`${yn} complex map keys are not supported`);const h=d[0],_=a[0];if(h.type!==yt.string||_.type!==yt.string)throw new Error(`${yn} non-string map keys are not supported`);if(h<_)return-1;if(h>_)return 1;throw new Error(`${yn} unexpected duplicate map keys, this is not supported`)}};class Qp{constructor(a,h={}){this.pos=0,this.data=a,this.options=h,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let a=this.ch();for(;a===32||a===9||a===13||a===10;)a=this.data[++this.pos]}expect(a){if(this.data.length-this.pos<a.length)throw new Error(`${Vt} unexpected end of input at position ${this.pos}`);for(let h=0;h<a.length;h++)if(this.data[this.pos++]!==a[h])throw new Error(`${Vt} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...a)}'`)}parseNumber(){const a=this.pos;let h=!1,_=!1;const j=st=>{for(;!this.done();){const dt=this.ch();if(!st.includes(dt))break;this.pos++}};if(this.ch()===45&&(h=!0,this.pos++),this.ch()===48){if(this.pos++,this.ch()!==46)return new $t(yt.uint,0,this.pos-a);this.pos++,_=!0}if(j([48,49,50,51,52,53,54,55,56,57]),h&&this.pos===a+1)throw new Error(`${Vt} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(_)throw new Error(`${Vt} unexpected token at position ${this.pos}`);_=!0,this.pos++,j([48,49,50,51,52,53,54,55,56,57])}this.done()||this.ch()!==101&&this.ch()!==69||(_=!0,this.pos++,this.done()||this.ch()!==43&&this.ch()!==45||this.pos++,j([48,49,50,51,52,53,54,55,56,57]));const tt=String.fromCharCode.apply(null,this.data.subarray(a,this.pos)),rt=parseFloat(tt);return _?new $t(yt.float,rt,this.pos-a):this.options.allowBigInt!==!0||Number.isSafeInteger(rt)?new $t(rt>=0?yt.uint:yt.negint,rt,this.pos-a):new $t(rt>=0?yt.uint:yt.negint,BigInt(tt),this.pos-a)}parseString(){if(this.ch()!==34)throw new Error(`${Vt} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let tt=this.pos,rt=0;tt<this.data.length&&rt<65536;tt++,rt++){const st=this.data[tt];if(st===92||st<32||st>=128)break;if(st===34){const dt=String.fromCharCode.apply(null,this.data.subarray(this.pos,tt));return this.pos=tt+1,new $t(yt.string,dt,rt)}}const a=this.pos,h=[],_=()=>{if(this.pos+4>=this.data.length)throw new Error(`${Vt} unexpected end of unicode escape sequence at position ${this.pos}`);let tt=0;for(let rt=0;rt<4;rt++){let st=this.ch();if(st>=48&&st<=57)st-=48;else if(st>=97&&st<=102)st=st-97+10;else{if(!(st>=65&&st<=70))throw new Error(`${Vt} unexpected unicode escape character at position ${this.pos}`);st=st-65+10}tt=16*tt+st,this.pos++}return tt},j=()=>{const tt=this.ch();let rt,st,dt,ht,mt=null,kt=tt>239?4:tt>223?3:tt>191?2:1;if(this.pos+kt>this.data.length)throw new Error(`${Vt} unexpected unicode sequence at position ${this.pos}`);switch(kt){case 1:tt<128&&(mt=tt);break;case 2:rt=this.data[this.pos+1],(192&rt)==128&&(ht=(31&tt)<<6|63&rt,ht>127&&(mt=ht));break;case 3:rt=this.data[this.pos+1],st=this.data[this.pos+2],(192&rt)==128&&(192&st)==128&&(ht=(15&tt)<<12|(63&rt)<<6|63&st,ht>2047&&(ht<55296||ht>57343)&&(mt=ht));break;case 4:rt=this.data[this.pos+1],st=this.data[this.pos+2],dt=this.data[this.pos+3],(192&rt)==128&&(192&st)==128&&(192&dt)==128&&(ht=(15&tt)<<18|(63&rt)<<12|(63&st)<<6|63&dt,ht>65535&&ht<1114112&&(mt=ht))}mt===null?(mt=65533,kt=1):mt>65535&&(mt-=65536,h.push(mt>>>10&1023|55296),mt=56320|1023&mt),h.push(mt),this.pos+=kt};for(;!this.done();){const tt=this.ch();let rt;switch(tt){case 92:if(this.pos++,this.done())throw new Error(`${Vt} unexpected string termination at position ${this.pos}`);switch(rt=this.ch(),this.pos++,rt){case 34:case 39:case 92:case 47:h.push(rt);break;case 98:h.push(8);break;case 116:h.push(9);break;case 110:h.push(10);break;case 102:h.push(12);break;case 114:h.push(13);break;case 117:h.push(_());break;default:throw new Error(`${Vt} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new $t(yt.string,Is(h),this.pos-a);default:if(tt<32)throw new Error(`${Vt} invalid control character at position ${this.pos}`);tt<128?(h.push(tt),this.pos++):j()}}throw new Error(`${Vt} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new $t(yt.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new $t(yt.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new $t(yt.null,null,4);case 102:return this.expect([102,97,108,115,101]),new $t(yt.false,!1,5);case 116:return this.expect([116,114,117,101]),new $t(yt.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${Vt} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new $t(yt.break,void 0,1);if(this.ch()!==44)throw new Error(`${Vt} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new $t(yt.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new $t(yt.break,void 0,1);if(this.ch()!==44)throw new Error(`${Vt} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new $t(yt.break,void 0,1);const a=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${Vt} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),a}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${Vt} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function Kp(d){const a=zs.encode(d).slice(1);return[new $t(yt.map,1/0,1),new $t(yt.string,"/",1),new $t(yt.map,1/0,1),new $t(yt.string,"bytes",5),new $t(yt.string,a,a.length),new $t(yt.break,void 0,1),new $t(yt.break,void 0,1)]}const bv={typeEncoders:{Object:function(d){if(d.asCID!==d&&d["/"]!==d.bytes)return null;const a=br.asCID(d);if(!a)return null;const h=a.toString();return[new $t(yt.map,1/0,1),new $t(yt.string,"/",1),new $t(yt.string,h,h.length),new $t(yt.break,void 0,1)]},Uint8Array:Kp,Buffer:Kp,undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(d){if(Number.isNaN(d))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(d===1/0||d===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class kv extends Qp{constructor(a,h){super(a,h),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const a=this._next();if(a.type===yt.map){const h=this._next();if(h.type===yt.string&&h.value==="/"){const _=this._next();if(_.type===yt.string){if(this._next().type!==yt.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(_),new $t(yt.tag,42,0)}if(_.type===yt.map){const j=this._next();if(j.type===yt.string&&j.value==="bytes"){const tt=this._next();if(tt.type===yt.string){for(let st=0;st<2;st++)if(this._next().type!==yt.break)throw new Error("Invalid encoded Bytes form");const rt=zs.decode(`m${tt.value}`);return new $t(yt.bytes,rt,tt.value.length)}this.tokenBuffer.push(tt)}this.tokenBuffer.push(j)}this.tokenBuffer.push(_)}this.tokenBuffer.push(h)}return a}}const Gu={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Gu.tags[42]=br.parse;const Zu=d=>{return a=d,h=bv,h=Object.assign({},vv,h),Ep(a,new wv,h);var a,h},Gp=d=>function(a,h){return xp(a,h=Object.assign({tokenizer:new Qp(a,h)},h))}(d,Object.assign(Gu,{tokenizer:new kv(d,Gu)}));new TextDecoder,new TextEncoder;const Zp=(d,a)=>to.baseEncode(xv(d,a)),qp=d=>to.baseEncode(_v(d)),Ev=d=>to.baseEncode(d.raw),xv=(d,a)=>Zu({alg:a,ucv:d,typ:"JWT"}),_v=d=>Zu({iss:Dp(d.iss),aud:Dp(d.aud),att:d.att,exp:d.exp,prf:d.prf.map(Sv),...d.fct.length>0&&{fct:d.fct},...d.nnc&&{nnc:d.nnc},...d.nbf&&{nbf:d.nbf}}),Sv=d=>d.toString();class Jp{constructor(a){this.model=a}get version(){return this.model.v}get issuer(){return Lp(this.model.iss)}get audience(){return Lp(this.model.aud)}get capabilities(){return this.model.att}get expiration(){const{exp:a}=this.model;return a===null?1/0:a}get notBefore(){return this.model.nbf}get nonce(){return this.model.nnc}get facts(){return this.model.fct}get proofs(){return this.model.prf}get signature(){return this.model.s}get jwt(){return this.model.jwt}get s(){return this.model.s}get v(){return this.model.v}get iss(){return this.model.iss}get aud(){return this.model.aud}get att(){return this.model.att}get exp(){return this.model.exp}get nbf(){return this.model.nbf}get nnc(){return this.model.nnc}get fct(){return this.model.fct}get prf(){return this.model.prf}toJSON(){const{v:a,iss:h,aud:_,s:j,att:tt,prf:rt,exp:st,fct:dt,nnc:ht,nbf:mt}=this.model;return{iss:h,aud:_,v:a,s:j,exp:st,...(kt={att:tt,prf:rt,...dt.length>0&&{fct:dt}},JSON.parse(Ms(Zu(kt)))),...ht!=null&&{nnc:ht},...mt&&{nbf:mt}};var kt}}const Yp=d=>{const{fct:a,nnc:h,nbf:_,...j}=Qu(d);return Ou({...a.length>0&&{fct:a},...h!=null&&{nnc:h},..._&&{nbf:_},...j,v:Ku(d.v,"v"),s:$v(d.s,"s")})},$v=(d,a)=>{try{return(h=>Hu(h))(d)}catch(h){throw new Error(`Expected signature ${a}, instead got ${JSON.stringify(d)}`,{cause:h})}};class Xp extends Jp{get code(){return 113}format(){return a=this.model,`${Zp(a.v,a.s.algorithm)}.${qp(a)}.${Ev(a.s)}`;var a}encode(){return Yp(this.model)}}const Tv=d=>{const a=d.split("."),[h,_,j]=a.length===3?a:Ws(`Can't parse UCAN: ${d}: Expected JWT format: 3 dot-separated base64url-encoded values.`),{ucv:tt,alg:rt}=Cv(h);return{...Pv(_),v:tt,s:ev(rt,to.baseDecode(j))}},Cv=d=>{const{ucv:a,alg:h,typ:_}=Gp(to.baseDecode(d));return{typ:(j=_,tt="JWT",rt="typ",j===tt?tt:kn.throw(`Expected ${rt} to be a ${JSON.stringify(tt)} instead got ${JSON.stringify(j)}`)),ucv:Ku(a,"ucv"),alg:Fs(h,"alg")};var j,tt,rt},Pv=d=>{const a=Gp(to.baseDecode(d));return Up(a,{readPrincipal:yv,readProof:fv})},ey=({jwt:d})=>Qo(d);class Av extends Jp{constructor(a){super(a),this.model=a}get code(){return 85}format(){return(({jwt:a})=>a)(this.model)}encode(){return ey(this.model)}}const Iv=rr,Nv=d=>{try{return(a=>{const h=Ho(a);return new Xp({...Qu(h),v:Ku(h.v,"v"),s:nv(h.s)})})(d)}catch{return(h=>{const _=Ms(h);return new Av({...Tv(_),jwt:_})})(d)}},ty=async({issuer:d,audience:a,capabilities:h,lifetimeInSeconds:_=30,expiration:j=Lv()+_,notBefore:tt,facts:rt=[],proofs:st=[],nonce:dt})=>{const ht="0.9.1",mt=Qu({iss:bn(d.did()),aud:bn(a.did()),att:h,fct:rt,exp:j,nbf:tt,prf:st,nnc:dt}),kt=Dv(mt,ht,d.signatureAlgorithm);return _t={...mt,v:ht,s:await d.sign(kt)},new Xp(_t);var _t},Dv=(d,a,h)=>Qo(((_,j,tt)=>`${Zp(j,tt)}.${qp(_)}`)(d,a,h)),Lv=()=>Math.floor(Date.now()/1e3),qu=d=>!vo(d);class Vs{constructor(a,h=new Map){this.root=a,this.blocks=h,Object.defineProperties(this,{blocks:{enumerable:!1}})}get version(){return this.data.version}get signature(){return this.data.signature}get cid(){return this.root.cid}get asCID(){return this.cid}get bytes(){return this.root.bytes}get data(){const a=Yu(this.root);return Object.defineProperties(this,{data:{value:a,enumerable:!1}}),a}export(){return ny(this.root,this.blocks)}get proofs(){return Ov(this)}get issuer(){return this.data.issuer}get audience(){return this.data.audience}get capabilities(){return this.data.capabilities}get expiration(){return this.data.expiration}get notBefore(){return this.data.notBefore}get nonce(){return this.data.nonce}get facts(){return this.data.facts}iterate(){return ry(this)}delegate(){return this}toJSON(){return{...this.data.toJSON(),"/":this.cid.toString(),prf:this.proofs.map(a=>qu(a)?a:{"/":a.toString()})}}}const ry=function*(d){for(const a of d.proofs)qu(a)&&(yield*ry(a),yield a)},Ju=new WeakMap,Yu=({bytes:d})=>{const a=Ju.get(d);if(!a){const h=Nv(d);return Ju.set(d,h),h}return a},Xu=async({issuer:d,audience:a,proofs:h=[],..._},j)=>{const tt=[],rt=new Map;for(const kt of h)if(qu(kt)){tt.push(kt.cid);for(const _t of kt.export())rt.set(_t.cid.toString(),_t)}else tt.push(kt);const st=await ty({..._,issuer:d,audience:a,proofs:tt}),{cid:dt,bytes:ht}=await(async(kt,{hasher:_t=Iv}={})=>{const[Lt,Ut]=kt.jwt?[85,ey(kt)]:[113,Yp(kt)],Zt=await _t.digest(Ut);return{bytes:Ut,cid:Ko(Lt,Zt),data:kt}})(st,j);Ju.set(dt,st);const mt=new Vs({cid:dt,bytes:ht},rt);return Object.defineProperties(mt,{proofs:{value:h}}),mt},ny=function*(d,a){for(const h of Yu(d).proofs){const _=a.get(h.toString());_&&(yield*ny(_,a))}yield d},Rv=d=>{let a=[];for(const _ of d)a.push([_.cid.toString(),_]);const h=a.pop();if(h){const[,_]=h;return new Vs(_,new Map(a))}throw new RangeError("Empty DAG can not be turned into a delegation")},iy=({root:d,blocks:a})=>new Vs(d,a),Ov=d=>{const a=[],{root:h,blocks:_}=d;for(const j of Yu(h).proofs){const tt=_.get(j.toString());a.push(tt?iy({root:tt,blocks:_}):j)}return Object.defineProperty(d,"proofs",{value:a}),a},oy=d=>new jv(d);class jv{constructor({issuer:a,audience:h,capability:_,proofs:j=[],expiration:tt,lifetimeInSeconds:rt,notBefore:st,nonce:dt,facts:ht=[]}){this.issuer=a,this.audience=h,this.proofs=j,this.capabilities=[_],this.expiration=tt,this.lifetimeInSeconds=rt,this.notBefore=st,this.nonce=dt,this.facts=ht}delegate(){return Xu(this)}async execute(a){const[h]=await a.execute(this);return h}}var Bv=function d(a,h,_){if(Number.MAX_SAFE_INTEGER&&a>Number.MAX_SAFE_INTEGER)throw d.bytes=0,new RangeError("Could not encode varint");h=h||[];for(var j=_=_||0;a>=Mv;)h[_++]=255&a|128,a/=128;for(;-128&a;)h[_++]=255&a|128,a>>>=7;return h[_]=0|a,d.bytes=_-j+1,h},Mv=Math.pow(2,31),Uv=function d(a,h){var _,j=0,tt=0,rt=h=h||0,st=a.length;do{if(rt>=st||tt>49)throw d.bytes=0,new RangeError("Could not decode varint");_=a[rt++],j+=tt<28?(127&_)<<tt:(127&_)*Math.pow(2,tt),tt+=7}while(_>=128);return d.bytes=rt-h,j},zv=Math.pow(2,7),Fv=Math.pow(2,14),Wv=Math.pow(2,21),Vv=Math.pow(2,28),Hv=Math.pow(2,35),Qv=Math.pow(2,42),Kv=Math.pow(2,49),Gv=Math.pow(2,56),Zv=Math.pow(2,63),Lr={encode:Bv,decode:Uv,encodingLength:function(d){return d<zv?1:d<Fv?2:d<Wv?3:d<Vv?4:d<Hv?5:d<Qv?6:d<Kv?7:d<Gv?8:d<Zv?9:10}};const qv=vp(),Jv={float64:!1,quickEncodeToken:wp};function sy(d,a=qv,h=Jv){if(Array.isArray(d)){let _=0;for(const j of d)_+=sy(j,a,h);return _}{const _=a[d.type.major];if(_.encodedSize===void 0||typeof _.encodedSize!="function")throw new Error(`Encoder for ${d.type.name} does not have an encodedSize()`);return _.encodedSize(d,h)}}class Yv{constructor(a,h){this.bytes=a,this.byteOffset=h,this.roots=[],this.headerSize=h}addRoot(a,h){return Xv(this,a,h),this}write(a){return e1(this,a),this}close(a){return t1(this,a)}}const Xv=(d,a,h={})=>{const{resize:_=!1}=h,{bytes:j,headerSize:tt,byteOffset:rt,roots:st}=d;d.roots.push(a);const dt=xl(d);if(dt>tt){if(!(dt-tt+rt<j.byteLength))throw st.pop(),new RangeError(`Buffer has no capacity for a new root ${a}`);if(!_)throw st.pop(),new RangeError(`Header of size ${tt} has no capacity for new root ${a}.
  However there is a space in the buffer and you could call addRoot(root, { resize: root }) to resize header to make a space for this root.`);ay(d,dt)}},yl=({cid:d,bytes:a})=>{const h=d.bytes.byteLength+a.byteLength;return Lr.encodingLength(h)+h},e1=(d,{cid:a,bytes:h})=>{const _=a.bytes.byteLength+h.byteLength,j=Lr.encode(_);if(d.byteOffset+j.length+_>d.bytes.byteLength)throw new RangeError("Buffer has no capacity for this block");El(d,j),El(d,a.bytes),El(d,h)},t1=(d,a={})=>{const{resize:h=!1}=a,{roots:_,bytes:j,byteOffset:tt,headerSize:rt}=d,st=Ou({version:1,roots:_}),dt=Lr.encode(st.length),ht=dt.length+st.byteLength;if(rt-ht===0)return cy(d,dt,st),j.subarray(0,tt);if(h)return ay(d,ht),cy(d,dt,st),j.subarray(0,d.byteOffset);throw new RangeError(`Header size was overestimated.
You can use close({ resize: true }) to resize header`)},ay=(d,a)=>{const{bytes:h,headerSize:_}=d;h.set(h.subarray(_,d.byteOffset),a),d.byteOffset+=a-_,d.headerSize=a},El=(d,a)=>{d.bytes.set(a,d.byteOffset),d.byteOffset+=a.length},cy=({bytes:d},a,h)=>{d.set(a),d.set(h,a.length)},r1=[new $t(yt.map,2),new $t(yt.string,"version"),new $t(yt.uint,1),new $t(yt.string,"roots")],n1=new $t(yt.tag,42),uy=d=>{const a=[...r1];a.push(new $t(yt.array,d.length));for(const _ of d)a.push(n1),a.push(new $t(yt.bytes,{length:_+1}));const h=sy(a);return Lr.encodingLength(h)+h},xl=({roots:d})=>uy(d.map(a=>a.bytes.byteLength)),ly=(d,a={})=>{const{roots:h=[],byteOffset:_=0,byteLength:j=d.byteLength,headerSize:tt=xl({roots:h})}=a,rt=new Uint8Array(d,_,j),st=new Yv(rt,tt);for(const dt of h)st.addRoot(dt);return st},zn={Null:d=>d===null,Int:d=>Number.isInteger(d),Float:d=>typeof d=="number"&&Number.isFinite(d),String:d=>typeof d=="string",Bool:d=>typeof d=="boolean",Bytes:d=>d instanceof Uint8Array,Link:d=>!zn.Null(d)&&typeof d=="object"&&d.asCID===d,List:d=>Array.isArray(d),Map:d=>!zn.Null(d)&&typeof d=="object"&&d.asCID!==d&&!zn.List(d)&&!zn.Bytes(d)},bo={Int:zn.Int,"CarHeader > version":d=>bo.Int(d),"CarHeader > roots (anon) > valueType (anon)":zn.Link,"CarHeader > roots (anon)":d=>zn.List(d)&&Array.prototype.every.call(d,bo["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":d=>bo["CarHeader > roots (anon)"](d),CarHeader:d=>{const a=d&&Object.keys(d);return zn.Map(d)&&["version"].every(h=>a.includes(h))&&Object.entries(d).every(([h,_])=>bo["CarHeader > "+h]&&bo["CarHeader > "+h](_))}},i1=bo.CarHeader,o1=18,s1=32,a1=112;function Hs(d,a){if(!d.length)throw new Error("Unexpected end of data");const h=Lr.decode(d);return a.seek(Lr.decode.bytes),h}async function dy(d,a){const h=Hs(await d.upTo(8),d);if(h===0)throw new Error("Invalid CAR header (zero length)");const _=await d.exactly(h,!0),j=Ho(_);if(!i1(j))throw new Error("Invalid CAR header format");if(j.version!==1&&j.version!==2||a!==void 0&&j.version!==a)throw new Error(`Invalid CAR version: ${j.version}${a!==void 0?` (expected ${a})`:""}`);const tt=Array.isArray(j.roots);if(j.version===1&&!tt||j.version===2&&tt)throw new Error("Invalid CAR header format");if(j.version===1)return j;const rt=function(dt){const ht=new DataView(dt.buffer,dt.byteOffset,dt.byteLength);let mt=0;return{version:2,characteristics:[ht.getBigUint64(mt,!0),ht.getBigUint64(mt+=8,!0)],dataOffset:Number(ht.getBigUint64(mt+=8,!0)),dataSize:Number(ht.getBigUint64(mt+=8,!0)),indexOffset:Number(ht.getBigUint64(mt+=8,!0))}}(await d.exactly(40,!0));d.seek(rt.dataOffset-d.pos);const st=await dy(d,1);return Object.assign(st,rt)}async function c1(d){const a=await d.exactly(2,!1);if(a[0]===o1&&a[1]===s1){const rt=await d.exactly(34,!0),st=hr(rt);return br.create(0,a1,st)}const h=Hs(await d.upTo(8),d);if(h!==1)throw new Error(`Unexpected CID version (${h})`);const _=Hs(await d.upTo(8),d),j=await d.exactly(function(rt){Lr.decode(rt);const st=Lr.decode.bytes,dt=Lr.decode(rt.subarray(Lr.decode.bytes));return st+Lr.decode.bytes+dt}(await d.upTo(8)),!0),tt=hr(j);return br.create(h,_,tt)}async function fy(d){const a=d.pos;let h=Hs(await d.upTo(8),d);if(h===0)throw new Error("Invalid CAR section (zero length)");return h+=d.pos-a,{cid:await c1(d),length:h,blockLength:h-Number(d.pos-a)}}async function u1(d){const{cid:a,blockLength:h}=await fy(d);return{bytes:await d.exactly(h,!0),cid:a}}async function l1(d){const a=d.pos,{cid:h,length:_,blockLength:j}=await fy(d),tt={cid:h,length:_,blockLength:j,offset:a,blockOffset:d.pos};return d.seek(tt.blockLength),tt}function d1(d){const a=(async()=>{const h=await dy(d);if(h.version===2){const _=d.pos-h.dataOffset;d=function(j,tt){let rt=0;return{async upTo(st){let dt=await j.upTo(st);return dt.length+rt>tt&&(dt=dt.subarray(0,tt-rt)),dt},async exactly(st,dt=!1){const ht=await j.exactly(st,dt);if(ht.length+rt>tt)throw new Error("Unexpected end of data");return dt&&(rt+=st),ht},seek(st){rt+=st,j.seek(st)},get pos(){return j.pos}}}(d,h.dataSize-_)}return h})();return{header:()=>a,async*blocks(){for(await a;(await d.upTo(8)).length>0;)yield await u1(d)},async*blocksIndex(){for(await a;(await d.upTo(8)).length>0;)yield await l1(d)}}}function f1(d){const a=d[Symbol.asyncIterator]();return function(h){let _=0,j=0,tt=0,rt=new Uint8Array(0);const st=async dt=>{j=rt.length-tt;const ht=[rt.subarray(tt)];for(;j<dt;){const kt=await h();if(kt==null)break;j<0?kt.length>j&&ht.push(kt.subarray(-j)):ht.push(kt),j+=kt.length}rt=new Uint8Array(ht.reduce((kt,_t)=>kt+_t.length,0));let mt=0;for(const kt of ht)rt.set(kt,mt),mt+=kt.length;tt=0};return{upTo:async dt=>(rt.length-tt<dt&&await st(dt),rt.subarray(tt,tt+Math.min(rt.length-tt,dt))),async exactly(dt,ht=!1){if(rt.length-tt<dt&&await st(dt),rt.length-tt<dt)throw new Error("Unexpected end of data");const mt=rt.subarray(tt,tt+dt);return ht&&(_+=dt,tt+=dt),mt},seek(dt){_+=dt,tt+=dt},get pos(){return _}}}(async function(){const h=await a.next();return h.done?null:h.value})}class hy{constructor(a,h){this._header=a,this._blocks=h,this._keys=h.map(_=>_.cid.toString())}get version(){return this._header.version}async getRoots(){return this._header.roots}async has(a){return this._keys.indexOf(a.toString())>-1}async get(a){const h=this._keys.indexOf(a.toString());return h>-1?this._blocks[h]:void 0}async*blocks(){for(const a of this._blocks)yield a}async*cids(){for(const a of this._blocks)yield a.cid}static async fromBytes(a){if(!(a instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return py(function(h){let _=0;return{upTo:async j=>h.subarray(_,_+Math.min(j,h.length-_)),async exactly(j,tt=!1){if(j>h.length-_)throw new Error("Unexpected end of data");const rt=h.subarray(_,_+j);return tt&&(_+=j),rt},seek(j){_+=j},get pos(){return _}}}(a))}static async fromIterable(a){if(!a||typeof a[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return py(f1(a))}}async function py(d){const a=d1(d),h=await a.header(),_=[];for await(const j of a.blocks())_.push(j);return new hy(h,_)}class yy{constructor(a=[],h=0){this.written=new Set,this.blocks=a,this.byteLength=h}write(...a){for(const h of a){const _=h.cid.toString(eo);this.written.has(_)||(this.blocks.push(h),this.byteLength+=yl(h),this.written.add(_))}return this}flush(...a){const h=[];for(const tt of a.reverse()){const rt=tt.cid.toString(eo);this.written.has(rt)||(this.blocks.unshift(tt),this.byteLength+=yl({cid:tt.cid,bytes:tt.bytes}),this.written.add(rt)),h.push(tt.cid)}this.byteLength+=xl({roots:h});const _=new ArrayBuffer(this.byteLength),j=ly(_,{roots:h});for(const tt of this.blocks)j.write(tt);return j.close()}}const _l=({roots:d=[],blocks:a})=>{const h=new yy;return a&&h.write(...a.values()),h.flush(...d)},gy=async d=>{const a=await hy.fromBytes(d),{_header:h,_blocks:_,_keys:j}=a,tt=[],rt=new Map,st=h.roots.map(dt=>j.indexOf(String(dt)));for(const[dt,ht]of _.entries())st.includes(dt)?tt.push(ht):rt.set(ht.cid.toString(),ht);return{roots:tt,blocks:rt}},my=async(d,{hasher:a=rr}={})=>Ko(514,await a.digest(d));var h1=Object.freeze({__proto__:null,code:514,createWriter:()=>new yy,encode:_l,decode:gy,link:my,write:async(d,a)=>{const h=_l(d);return{bytes:h,cid:await my(h,a)}}});const p1=Object.freeze({"content-type":"application/car"});var y1=Object.freeze({__proto__:null,codec:h1,encode:async(d,a)=>{const h=[],_=new Map;for(const tt of d){const rt=await tt.delegate();h.push(rt.root);for(const st of rt.export())_.set(st.cid.toString(),st);_.delete(rt.root.cid.toString())}const j=_l({roots:h,blocks:_});return{headers:p1,body:j}},decode:async({headers:d,body:a})=>{const h=d["content-type"]||d["Content-Type"];if(h!=="application/car")throw TypeError(`Only 'content-type: application/car' is supported, instead got '${h}'`);const{roots:_,blocks:j}=await gy(a),tt=[];for(const rt of _)tt.push(iy({root:rt,blocks:j}));return tt}});const Qs=(d,a)=>{if(a.has(d))throw new TypeError("Can not encode circular structure");if(d===void 0&&a.size===0||d===null||typeof d=="symbol"&&a.size===0)return null;if(vo(d)||ArrayBuffer.isView(d))return d;if(Array.isArray(d)){a.add(d);const h=[];for(const _ of d)h.push(_===void 0||typeof _=="symbol"?null:Qs(_,a));return h}if(typeof d.toJSON=="function"){a.add(d);const h=d.toJSON();return Qs(h,a)}if(typeof d=="object"){a.add(d);const h={};for(const[_,j]of Object.entries(d))j!==void 0&&typeof j!="symbol"&&(h[_]=Qs(j,a));return h}return d},Sl=d=>Ou(Qs(d,new Set)),wy=async(d,{hasher:a=rr}={})=>Ko(113,await a.digest(d));var g1=Object.freeze({__proto__:null,encode:Sl,link:wy,write:async(d,a)=>{const h=Sl(d);return{cid:await wy(h,a),bytes:h}},code:113,decode:Ho});const m1=Object.freeze({"content-type":"application/cbor"});var w1=Object.freeze({__proto__:null,codec:g1,encode:d=>({headers:m1,body:Sl(d)}),decode:async({headers:d,body:a})=>{const h=d["content-type"]||d["Content-Type"];if(h!=="application/cbor")throw TypeError(`Only 'content-type: application/cbor' is supported, intsead got '${h}'`);return Ho(a)}});const v1=({url:d,method:a="POST",fetch:h})=>{if(!h){if(globalThis.fetch===void 0)throw new TypeError("ucanto HTTP transport got undefined `fetch`. Try passing in a `fetch` implementation explicitly.");h=globalThis.fetch.bind(globalThis)}return new b1({url:d,method:a,fetch:h})};class b1{constructor({url:a,fetch:h,method:_}){this.fetch=h,this.method=_,this.url=a}async request({headers:a,body:h}){const _=await this.fetch(this.url.href,{headers:a,body:h,method:this.method}),j=_.ok?await _.arrayBuffer():k1.throw("HTTP Request failed",_);return{headers:_.headers.entries?Object.fromEntries(_.headers.entries()):{},body:new Uint8Array(j)}}}class k1 extends Error{static throw(a,h){throw new this(a,h)}constructor(a,{url:h,status:_=500,statusText:j="Server error"}){super(a),this.name="HTTPError",this.url=h,this.status=_,this.statusText=j}}const vy=d=>Object.entries(d),by=(d,a)=>{const[h,_]=d.length<a.length?[new Set(d),new Set(a)]:[new Set(a),new Set(d)];for(const j of h)_.has(j)||h.delete(j);return[...h]};class Gr extends Error{get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:a,name:h,message:_,stack:j}=this;return{error:a,name:h,message:_,stack:j}}}class ky extends Gr{constructor(a,h,_){super(),this.claimed=a,this.delegated=h,this.cause=_,this.name="EscalatedCapability"}describe(){return`Constraint violation: ${this.cause.message}`}}class ko extends Gr{constructor(a,h){super(),this.name="InvalidClaim",this.causes=a,this.context=h}describe(){return[`Can not derive ${this.context} from delegated capabilities:`,...this.causes.map(a=>Sy(a.message))].join(`
`)}get cause(){if(this.causes.length!==1)return this;{const[a]=this.causes,h=a.name==="InvalidClaim"?a.cause:a;return Object.defineProperties(this,{cause:{value:h}}),h}}}class Ey extends Gr{constructor(a,h){super(),this.name="MalformedCapability",this.capability=a,this.cause=h}describe(){return[`Encountered malformed '${this.capability.can}' capability: ${_y(this.capability)}`,Sy(this.cause.message)].join(`
`)}}class xy extends Gr{constructor(a){super(),this.name="UnknownCapability",this.capability=a}describe(){return`Encountered unknown capability: ${_y(this.capability)}`}}const _y=(d,a)=>JSON.stringify(d,(h,_)=>vo(_)?_.toString():_,a),Sy=d=>((a,h="  ")=>`${h}${a.split(`
`).join(`
${h}`)}`)(`- ${d}`),zr=d=>new E1(d);class $y{match(a){return new xy(a.capability)}select(a){return $1(this,a)}derive({derives:a,to:h}){return(({from:_,to:j,derives:tt})=>new _1(_,j,tt))({derives:a,to:h,from:this})}}class $l extends $y{or(a){return new x1(this,a)}and(a){return((...h)=>new Tl(h))(this,a)}}class E1 extends $l{constructor(a){super(),this.descriptor={derives:Py,...a}}create(a){const{descriptor:h,can:_}=this,j=h.nb,tt=a.nb||{},rt=h.with.read(a.with);if(rt.error)throw Object.assign(new Error(`Invalid 'with' - ${rt.message}`),{cause:rt});const st={can:_,with:rt};for(const[dt,ht]of Object.entries(j||{})){const mt=dt,kt=ht.read(tt[mt]);if(kt!=null&&kt.error)throw Object.assign(new Error(`Invalid 'nb.${mt}' - ${kt.message}`),{cause:kt});kt!==void 0&&((st.nb||(st.nb={}))[dt]=kt)}return st}invoke({with:a,nb:h,..._}){return oy({..._,capability:this.create({with:a,nb:h})})}async delegate({with:a,nb:h,..._}){const{descriptor:j,can:tt}=this,rt=j.nb,st=h||{},dt=j.with.read(a);if(dt.error)throw Object.assign(new Error(`Invalid 'with' - ${dt.message}`),{cause:dt});const ht={can:tt,with:dt};for(const[mt,kt]of Object.entries(rt||{})){const _t=mt,Lt=st[_t],Ut=Lt===void 0?Lt:kt.read(st[_t]);if(Ut!=null&&Ut.error)throw Object.assign(new Error(`Invalid 'nb.${_t}' - ${Ut.message}`),{cause:Ut});Ut!==void 0&&((ht.nb||(ht.nb={}))[mt]=Ut)}return await Xu({capabilities:[ht],..._})}get can(){return this.descriptor.can}match(a){const h=Ty(this,a);return h.error?h:new Cl(a,h,this.descriptor)}toString(){return JSON.stringify({can:this.descriptor.can})}}class x1 extends $l{constructor(a,h){super(),this.left=a,this.right=h}match(a){const h=this.left.match(a);if(h.error){const _=this.right.match(a);return _.error?_.name==="MalformedCapability"?_:h:_}return h}toString(){return`${this.left.toString()}|${this.right.toString()}`}}class Tl extends $y{constructor(a){super(),this.selectors=a}match(a){const h=[];for(const _ of this.selectors){const j=_.match(a);if(j.error)return j;h.push(j)}return new Gs(h)}select(a){return Cy(this,a)}and(a){return new Tl([...this.selectors,a])}toString(){return`[${this.selectors.map(String).join(", ")}]`}}class _1 extends $l{constructor(a,h,_){super(),this.from=a,this.to=h,this.derives=_}create(a){return this.to.create(a)}invoke(a){return this.to.invoke(a)}delegate(a){return this.to.delegate(a)}get can(){return this.to.can}match(a){const h=this.to.match(a);return h.error?h:new Ks(h,this.from,this.derives)}toString(){return this.to.toString()}}class Cl{constructor(a,h,_){this.source=[a],this.value=h,this.descriptor={derives:Py,..._}}get can(){return this.value.can}get proofs(){const a=[this.source[0].delegation];return Object.defineProperties(this,{proofs:{value:a}}),a}prune(a){return a.canIssue(this.value,this.source[0].delegation.issuer.did())?null:this}select(a){const h=[],_=[],j=[];for(const tt of a){const rt=Ty(this,tt,!0);if(rt.error)rt.name==="UnknownCapability"?h.push(rt.capability):_.push(new ko([rt],this));else{const st=this.descriptor.derives(this.value,rt);st.error?_.push(new ko([new ky(this.value,rt,st)],this)):j.push(new Cl(tt,rt,this.descriptor))}}return{matches:j,unknown:h,errors:_}}toString(){const{nb:a}=this.value;return JSON.stringify({can:this.descriptor.can,with:this.value.with,nb:a&&Object.keys(a).length>0?a:void 0})}}class Ks{constructor(a,h,_){this.selected=a,this.from=h,this.derives=_}get can(){return this.value.can}get source(){return this.selected.source}get proofs(){const a=[];for(const{delegation:h}of this.selected.source)a.push(h);return Object.defineProperties(this,{proofs:{value:a}}),a}get value(){return this.selected.value}prune(a){const h=this.selected.prune(a);return h?new Ks(h,this.from,this.derives):null}select(a){const{derives:h,selected:_,from:j}=this,{value:tt}=_,rt=_.select(a),st=j.select(a),dt=[],ht=[];for(const mt of st.matches){const kt=h(tt,mt.value);kt.error?ht.push(new ko([new ky(tt,mt.value,kt)],this)):dt.push(mt)}return{unknown:by(rt.unknown,st.unknown),errors:[...ht,...rt.errors,...st.errors.map(mt=>new ko([mt],this))],matches:[...rt.matches.map(mt=>new Ks(mt,j,h)),...dt]}}toString(){return this.selected.toString()}}class Gs{constructor(a){this.matches=a}get selectors(){return this.matches}get source(){const a=[];for(const h of this.matches)a.push(...h.source);return Object.defineProperties(this,{source:{value:a}}),a}prune(a){const h=[];for(const _ of this.matches){const j=_.prune(a);j&&h.push(j)}return h.length===0?null:new Gs(h)}get proofs(){const a=[];for(const{delegation:h}of this.source)a.push(h);return Object.defineProperties(this,{proofs:{value:a}}),a}get value(){const a=[];for(const h of this.matches)a.push(h.value);return Object.defineProperties(this,{value:{value:a}}),a}select(a){return Cy(this,a)}toString(){return`[${this.matches.map(a=>a.toString()).join(", ")}]`}}const Ty=(d,a,h=!1)=>{const{can:_,with:j,nb:tt}=d.descriptor,{delegation:rt}=a,st=a.capability;if(st.can!==_)return new xy(st);const dt=j.read(st.with);if(dt.error)return new Ey(st,dt);const ht={};if(tt){const mt=st.nb||{};for(const[kt,_t]of vy(tt)){const Lt=kt;if(Lt in mt||!h){const Ut=_t.read(mt[Lt]);if(Ut!=null&&Ut.error)return new Ey(st,Ut);Ut!=null&&(ht[Lt]=Ut)}}}return new S1(_,st.with,ht,rt)};class S1{constructor(a,h,_,j){this.can=a,this.with=h,this.delegation=j,this.nb=_}}const $1=(d,a)=>{const h=[],_=[],j=[];for(const tt of a){const rt=d.match(tt);rt.error?rt.name==="UnknownCapability"?h.push(rt.capability):j.push(new ko([rt],rt.capability)):_.push(rt)}return{matches:_,errors:j,unknown:h}},Cy=(d,a)=>{let h;const _=[],j=[];for(const tt of d.selectors){const rt=tt.select(a);h=h?by(h,rt.unknown):rt.unknown;for(const st of rt.errors)j.push(new ko([st],d));_.push(rt.matches)}return{unknown:h||[],errors:j,matches:(([tt,...rt])=>{const st=tt.map(dt=>[dt]);for(const dt of rt){const ht=st.splice(0);for(const mt of dt)for(const kt of ht)st.push([...kt,mt])}return st})(_).map(tt=>new Gs(tt))}},Py=(d,a)=>{if(a.with.endsWith("*")){if(!d.with.startsWith(a.with.slice(0,-1)))return new Gr(`Resource ${d.with} does not match delegated ${a.with} `)}else if(a.with!==d.with)return new Gr(`Resource ${d.with} is not contained by ${a.with}`);const h=a.nb||{},_=d.nb||{},j=vy(h);for(const[tt,rt]of j)if(_[tt]!=rt)return new Gr(`${String(tt)}: ${_[tt]} violates ${rt}`);return!0};class Fr{constructor(a){this.settings=a}toString(){return`new ${this.constructor.name}()`}readWith(a,h){throw new Error("Abstract method readWith must be implemented by subclass")}read(a){return this.readWith(a,this.settings)}is(a){var h;return!((h=this.read(a))!=null&&h.error)}from(a){const h=this.read(a);if(h!=null&&h.error)throw h;return h}optional(){return I1(this)}nullable(){return C1(this)}array(){return L1(this)}or(a){return O1(this,a)}and(a){return B1(this,a)}refine(a){return t0(this,a)}brand(a){return this}default(a){const h=this.from(a);if(h===void 0)throw new Error("Value of type undefined is not a vaild default");return new A1({reader:this,value:h})}}class T1 extends Fr{readWith(a,h){const _=h.read(a);return _!=null&&_.error?a===null?null:new Ly({causes:[_,ro({expect:"null",actual:a})]}):_}toString(){return`${this.settings}.nullable()`}}const C1=d=>new T1(d);class P1 extends Fr{optional(){return this}readWith(a,h){const _=h.read(a);return _!=null&&_.error&&a===void 0?void 0:_}toString(){return`${this.settings}.optional()`}}class A1 extends Fr{optional(){return this}readWith(a,{reader:h,value:_}){if(a===void 0)return _;{const j=h.read(a);return j===void 0?_:j}}toString(){return`${this.settings.reader}.default(${JSON.stringify(this.settings.value)})`}get value(){return this.settings.value}}const I1=d=>new P1(d);class D1 extends Fr{readWith(a,h){if(!Array.isArray(a))return ro({expect:"array",actual:a});const _=[];for(const[j,tt]of a.entries()){const rt=h.read(tt);if(rt!=null&&rt.error)return s0({at:j,cause:rt});_.push(rt)}return _}get element(){return this.settings}toString(){return`array(${this.element})`}}const L1=d=>new D1(d);class R1 extends Fr{readWith(a,h){const _=[];for(const j of h){const tt=j.read(a);if(!(tt!=null&&tt.error))return tt;_.push(tt)}return new Ly({causes:_})}get variants(){return this.settings}toString(){return`union([${this.variants.map(a=>a.toString()).join(", ")}])`}}const O1=(d,a)=>new R1([d,a]);class j1 extends Fr{readWith(a,h){const _=[];for(const j of h){const tt=j.read(a);tt!=null&&tt.error&&_.push(tt)}return _.length>0?new a0({causes:_}):a}toString(){return`intersection([${this.settings.map(a=>a.toString()).join(",")}])`}}const B1=(d,a)=>new j1([d,a]),M1=new class extends Fr{readWith(d){switch(d){case!0:case!1:return d;default:return ro({expect:"boolean",actual:d})}}toString(){return"boolean()"}},Ay=()=>M1;class Iy extends Fr{greaterThan(a){return this.refine(V1(a))}lessThan(a){return this.refine(F1(a))}refine(a){return new U1({base:this,schema:a})}}const Ny=new class extends Iy{readWith(d){return typeof d=="number"?d:ro({expect:"number",actual:d})}toString(){return"number()"}};class U1 extends Iy{readWith(a,{base:h,schema:_}){const j=h.read(a);return j!=null&&j.error?j:_.read(j)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}class z1 extends Fr{readWith(a,h){return a<h?a:on(`Expected ${a} < ${h}`)}toString(){return`lessThan(${this.settings})`}}const F1=d=>new z1(d);class W1 extends Fr{readWith(a,h){return a>h?a:on(`Expected ${a} > ${h}`)}toString(){return`greaterThan(${this.settings})`}}const V1=d=>new W1(d),H1={read:d=>Number.isInteger(d)?d:ro({expect:"integer",actual:d}),toString:()=>"Integer"},Q1=Ny.refine(H1),Pl=()=>Q1,K1={read:d=>Number.isFinite(d)?d:ro({expect:"Float",actual:d}),toString:()=>"Float"};Ny.refine(K1);class Dy extends Fr{refine(a){return new G1({base:this,schema:a})}startsWith(a){return this.refine(J1(a))}endsWith(a){return this.refine(X1(a))}toString(){return"string()"}}class G1 extends Dy{readWith(a,{base:h,schema:_}){const j=h.read(a);return j!=null&&j.error?j:_.read(j)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}const Z1=new class extends Dy{readWith(d){return typeof d=="string"?d:ro({expect:"string",actual:d})}},Zs=()=>Z1;class q1 extends Fr{readWith(a,h){return a.startsWith(h)?a:on(`Expect string to start with "${h}" instead got "${a}"`)}get prefix(){return this.settings}toString(){return`startsWith("${this.prefix}")`}}const J1=d=>new q1(d);class Y1 extends Fr{readWith(a,h){return a.endsWith(h)?a:on(`Expect string to end with "${h}" instead got "${a}"`)}get suffix(){return this.settings}toString(){return`endsWith("${this.suffix}")`}}const X1=d=>new Y1(d);class e0 extends Fr{readWith(a,{base:h,schema:_}){const j=h.read(a);return j!=null&&j.error?j:_.read(j)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}const t0=(d,a)=>new e0({base:d,schema:a}),on=d=>new Eo(d);class Eo extends Error{get name(){return"SchemaError"}get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:a,name:h,message:_,stack:j}=this;return{error:a,name:h,message:_,stack:j}}}class r0 extends Eo{constructor({expect:a,actual:h}){super(),this.expect=a,this.actual=h}get name(){return"TypeError"}describe(){return`Expected value of type ${this.expect} instead got ${n0(this.actual)}`}}const ro=d=>new r0(d),n0=d=>{const a=typeof d;switch(a){case"boolean":case"string":return JSON.stringify(d);case"bigint":return`${d}n`;case"number":case"symbol":case"undefined":return String(d);case"object":return d===null?"null":Array.isArray(d)?"array":"object";default:return a}};class i0 extends Eo{constructor({at:a,cause:h}){super(),this.at=a,this.cause=h}get name(){return"ElementError"}describe(){return[`Array contains invalid element at ${this.at}:`,qs(this.cause.message)].join(`
`)}}class o0 extends Eo{constructor({at:a,cause:h}){super(),this.at=a,this.cause=h}get name(){return"FieldError"}describe(){return[`Object contains invalid field "${this.at}":`,qs(this.cause.message)].join(`
`)}}const s0=({at:d,cause:a})=>typeof d=="string"?new o0({at:d,cause:a}):new i0({at:d,cause:a});class Ly extends Eo{constructor({causes:a}){super(),this.causes=a}get name(){return"UnionError"}describe(){const{causes:a}=this;return["Value does not match any type of the union:",...a.map(h=>qs(h.message))].join(`
`)}}class a0 extends Eo{constructor({causes:a}){super(),this.causes=a}get name(){return"IntersectionError"}describe(){const{causes:a}=this;return["Value does not match following types of the intersection:",...a.map(h=>qs(h.message))].join(`
`)}}const qs=d=>((a,h="  ")=>`${h}${a.split(`
`).join(`
${h}`)}`)(`- ${d}`);class Ry extends Fr{readWith(a,{protocol:h}={}){if(typeof a!="string"&&!(a instanceof URL))return on("Expected URI but got "+(a===null?"null":typeof a));try{const _=new URL(String(a));return h!=null&&_.protocol!==h?on(`Expected ${h} URI instead got ${_.href}`):_.href}catch{return on("Invalid URI")}}}const Oy=new Ry({}),Nr=d=>new Ry(d),xo=d=>Oy.from(d);class jy extends Fr{readWith(a,{code:h,algorithm:_,version:j}){return a==null?on(`Expected link but got ${a} instead`):vo(a)?h!=null&&a.code!==h?on(`Expected link to be CID with 0x${h.toString(16)} codec`):_!=null&&a.multihash.code!==_?on(`Expected link to be CID with 0x${_.toString(16)} hashing algorithm`):j!=null&&a.version!==j?on(`Expected link to be CID version ${j} instead of ${a.version}`):a:on(`Expected link to be a CID instead of ${a}`)}}const Js=new jy({}),By=(d={})=>new jy(d),My=()=>Js.optional();var Ys=Object.freeze({__proto__:null,create:Ko,createLegacy:d=>br.create(0,112,d),isLink:vo,parse:Pp,schema:Js,link:()=>Js,match:By,read:d=>Js.read(d),optional:My});class Uy extends Fr{readWith(a,h){const _=h?`did:${h}:`:"did:";return a.startsWith(_)?a:on(`Expected a ${_} but got "${a}" instead`)}}const zy=Zs().refine(new Uy),Al=d=>Zs().refine(new Uy(d.method));zr({can:"*",with:Object.freeze({__proto__:null,did:()=>zy,read:d=>zy.read(d),match:Al,from:d=>Al({}).from(d)})});var c0=Object.freeze({__proto__:null,default:{}});/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */const Wr=BigInt(0),pr=BigInt(1),_o=BigInt(2),Fy=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),$r=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Fy,n:Fy,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),Wy=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Go=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const u0=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),l0=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),d0=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),f0=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class mr{constructor(a,h,_,j){this.x=a,this.y=h,this.z=_,this.t=j}static fromAffine(a){if(!(a instanceof Ar))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return a.equals(Ar.ZERO)?mr.ZERO:new mr(a.x,a.y,pr,Tt(a.x*a.y))}static toAffineBatch(a){const h=function(_,j=$r.P){const tt=new Array(_.length),rt=Xs(_.reduce((st,dt,ht)=>dt===Wr?st:(tt[ht]=st,Tt(st*dt,j)),pr),j);return _.reduceRight((st,dt,ht)=>dt===Wr?st:(tt[ht]=Tt(st*tt[ht],j),Tt(st*dt,j)),rt),tt}(a.map(_=>_.z));return a.map((_,j)=>_.toAffine(h[j]))}static normalizeZ(a){return this.toAffineBatch(a).map(this.fromAffine)}equals(a){Vy(a);const{x:h,y:_,z:j}=this,{x:tt,y:rt,z:st}=a,dt=Tt(h*st),ht=Tt(tt*j),mt=Tt(_*st),kt=Tt(rt*j);return dt===ht&&mt===kt}negate(){return new mr(Tt(-this.x),this.y,this.z,Tt(-this.t))}double(){const{x:a,y:h,z:_}=this,{a:j}=$r,tt=Tt(a*a),rt=Tt(h*h),st=Tt(_o*Tt(_*_)),dt=Tt(j*tt),ht=a+h,mt=Tt(Tt(ht*ht)-tt-rt),kt=dt+rt,_t=kt-st,Lt=dt-rt,Ut=Tt(mt*_t),Zt=Tt(kt*Lt),fr=Tt(mt*Lt),Gt=Tt(_t*kt);return new mr(Ut,Zt,Gt,fr)}add(a){Vy(a);const{x:h,y:_,z:j,t:tt}=this,{x:rt,y:st,z:dt,t:ht}=a,mt=Tt((_-h)*(st+rt)),kt=Tt((_+h)*(st-rt)),_t=Tt(kt-mt);if(_t===Wr)return this.double();const Lt=Tt(j*_o*ht),Ut=Tt(tt*_o*dt),Zt=Ut+Lt,fr=kt+mt,Gt=Ut-Lt,tr=Tt(Zt*_t),wr=Tt(fr*Gt),xr=Tt(Zt*Gt),Er=Tt(_t*fr);return new mr(tr,wr,Er,xr)}subtract(a){return this.add(a.negate())}precomputeWindow(a){const h=1+256/a,_=[];let j=this,tt=j;for(let rt=0;rt<h;rt++){tt=j,_.push(tt);for(let st=1;st<2**(a-1);st++)tt=tt.add(j),_.push(tt);j=tt.double()}return _}wNAF(a,h){!h&&this.equals(mr.BASE)&&(h=Ar.BASE);const _=h&&h._WINDOW_SIZE||1;if(256%_)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let j=h&&Dl.get(h);j||(j=this.precomputeWindow(_),h&&_!==1&&(j=mr.normalizeZ(j),Dl.set(h,j)));let tt=mr.ZERO,rt=mr.ZERO;const st=1+256/_,dt=2**(_-1),ht=BigInt(2**_-1),mt=2**_,kt=BigInt(_);for(let _t=0;_t<st;_t++){const Lt=_t*dt;let Ut=Number(a&ht);if(a>>=kt,Ut>dt&&(Ut-=mt,a+=pr),Ut===0){let Zt=j[Lt];_t%2&&(Zt=Zt.negate()),rt=rt.add(Zt)}else{let Zt=j[Lt+Math.abs(Ut)-1];Ut<0&&(Zt=Zt.negate()),tt=tt.add(Zt)}}return mr.normalizeZ([tt,rt])[0]}multiply(a,h){return this.wNAF(ga(a,$r.l),h)}multiplyUnsafe(a){let h=ga(a,$r.l,!1);const _=mr.BASE,j=mr.ZERO;if(h===Wr)return j;if(this.equals(j)||h===pr)return this;if(this.equals(_))return this.wNAF(h);let tt=j,rt=this;for(;h>Wr;)h&pr&&(tt=tt.add(rt)),rt=rt.double(),h>>=pr;return tt}isSmallOrder(){return this.multiplyUnsafe($r.h).equals(mr.ZERO)}isTorsionFree(){return this.multiplyUnsafe($r.l).equals(mr.ZERO)}toAffine(a=Xs(this.z)){const{x:h,y:_,z:j}=this,tt=Tt(h*a),rt=Tt(_*a);if(Tt(j*a)!==pr)throw new Error("invZ was invalid");return new Ar(tt,rt)}fromRistrettoBytes(){Nl()}toRistrettoBytes(){Nl()}fromRistrettoHash(){Nl()}}function Vy(d){if(!(d instanceof mr))throw new TypeError("ExtendedPoint expected")}function Il(d){if(!(d instanceof sn))throw new TypeError("RistrettoPoint expected")}function Nl(){throw new Error("Legacy method: switch to RistrettoPoint")}mr.BASE=new mr($r.Gx,$r.Gy,pr,Tt($r.Gx*$r.Gy)),mr.ZERO=new mr(Wr,pr,pr,Wr);class sn{constructor(a){this.ep=a}static calcElligatorRistrettoMap(a){const{d:h}=$r,_=Tt(Go*a*a),j=Tt((_+pr)*d0);let tt=BigInt(-1);const rt=Tt((tt-h*_)*Tt(_+h));let{isValid:st,value:dt}=Ol(j,rt),ht=Tt(dt*a);Fn(ht)||(ht=Tt(-ht)),st||(dt=ht),st||(tt=_);const mt=Tt(tt*(_-pr)*f0-rt),kt=dt*dt,_t=Tt((dt+dt)*rt),Lt=Tt(mt*u0),Ut=Tt(pr-kt),Zt=Tt(pr+kt);return new mr(Tt(_t*Zt),Tt(Ut*Lt),Tt(Lt*Zt),Tt(_t*Ut))}static hashToCurve(a){const h=Rl((a=Wn(a,64)).slice(0,32)),_=this.calcElligatorRistrettoMap(h),j=Rl(a.slice(32,64)),tt=this.calcElligatorRistrettoMap(j);return new sn(_.add(tt))}static fromHex(a){a=Wn(a,32);const{a:h,d:_}=$r,j="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",tt=Rl(a);if(!function(wr,xr){if(wr.length!==xr.length)return!1;for(let Er=0;Er<wr.length;Er++)if(wr[Er]!==xr[Er])return!1;return!0}(Jo(tt),a)||Fn(tt))throw new Error(j);const rt=Tt(tt*tt),st=Tt(pr+h*rt),dt=Tt(pr-h*rt),ht=Tt(st*st),mt=Tt(dt*dt),kt=Tt(h*_*ht-mt),{isValid:_t,value:Lt}=Ky(Tt(kt*mt)),Ut=Tt(Lt*dt),Zt=Tt(Lt*Ut*kt);let fr=Tt((tt+tt)*Ut);Fn(fr)&&(fr=Tt(-fr));const Gt=Tt(st*Zt),tr=Tt(fr*Gt);if(!_t||Fn(tr)||Gt===Wr)throw new Error(j);return new sn(new mr(fr,Gt,pr,tr))}toRawBytes(){let{x:a,y:h,z:_,t:j}=this.ep;const tt=Tt(Tt(_+h)*Tt(_-h)),rt=Tt(a*h),st=Tt(rt*rt),{value:dt}=Ky(Tt(tt*st)),ht=Tt(dt*tt),mt=Tt(dt*rt),kt=Tt(ht*mt*j);let _t;if(Fn(j*kt)){let Ut=Tt(h*Go),Zt=Tt(a*Go);a=Ut,h=Zt,_t=Tt(ht*l0)}else _t=mt;Fn(a*kt)&&(h=Tt(-h));let Lt=Tt((_-h)*_t);return Fn(Lt)&&(Lt=Tt(-Lt)),Jo(Lt)}toHex(){return qo(this.toRawBytes())}toString(){return this.toHex()}equals(a){Il(a);const h=this.ep,_=a.ep,j=Tt(h.x*_.y)===Tt(h.y*_.x),tt=Tt(h.y*_.y)===Tt(h.x*_.x);return j||tt}add(a){return Il(a),new sn(this.ep.add(a.ep))}subtract(a){return Il(a),new sn(this.ep.subtract(a.ep))}multiply(a){return new sn(this.ep.multiply(a))}multiplyUnsafe(a){return new sn(this.ep.multiplyUnsafe(a))}}sn.BASE=new sn(mr.BASE),sn.ZERO=new sn(mr.ZERO);const Dl=new WeakMap;class Ar{constructor(a,h){this.x=a,this.y=h}_setWindowSize(a){this._WINDOW_SIZE=a,Dl.delete(this)}static fromHex(a,h=!0){const{d:_,P:j}=$r,tt=(a=Wn(a,32)).slice();tt[31]=-129&a[31];const rt=Yo(tt);if(h&&rt>=j)throw new Error("Expected 0 < hex < P");if(!h&&rt>=Wy)throw new Error("Expected 0 < hex < 2**256");const st=Tt(rt*rt),dt=Tt(st-pr),ht=Tt(_*st+pr);let{isValid:mt,value:kt}=Ol(dt,ht);if(!mt)throw new Error("Point.fromHex: invalid y coordinate");const _t=(kt&pr)===pr;return(128&a[31])!=0!==_t&&(kt=Tt(-kt)),new Ar(kt,rt)}static async fromPrivateKey(a){return(await ba(a)).point}toRawBytes(){const a=Jo(this.y);return a[31]|=this.x&pr?128:0,a}toHex(){return qo(this.toRawBytes())}toX25519(){const{y:a}=this;return Jo(Tt((pr+a)*Xs(pr-a)))}isTorsionFree(){return mr.fromAffine(this).isTorsionFree()}equals(a){return this.x===a.x&&this.y===a.y}negate(){return new Ar(Tt(-this.x),this.y)}add(a){return mr.fromAffine(this).add(mr.fromAffine(a)).toAffine()}subtract(a){return this.add(a.negate())}multiply(a){return mr.fromAffine(this).multiply(a,this).toAffine()}}Ar.BASE=new Ar($r.Gx,$r.Gy),Ar.ZERO=new Ar(Wr,pr);class Zo{constructor(a,h){this.r=a,this.s=h,this.assertValidity()}static fromHex(a){const h=Wn(a,64),_=Ar.fromHex(h.slice(0,32),!1),j=Yo(h.slice(32,64));return new Zo(_,j)}assertValidity(){const{r:a,s:h}=this;if(!(a instanceof Ar))throw new Error("Expected Point instance");return ga(h,$r.l,!1),this}toRawBytes(){const a=new Uint8Array(64);return a.set(this.r.toRawBytes()),a.set(Jo(this.s),32),a}toHex(){return qo(this.toRawBytes())}}function Hy(...d){if(!d.every(_=>_ instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(d.length===1)return d[0];const a=d.reduce((_,j)=>_+j.length,0),h=new Uint8Array(a);for(let _=0,j=0;_<d.length;_++){const tt=d[_];h.set(tt,j),j+=tt.length}return h}const h0=Array.from({length:256},(d,a)=>a.toString(16).padStart(2,"0"));function qo(d){if(!(d instanceof Uint8Array))throw new Error("Uint8Array expected");let a="";for(let h=0;h<d.length;h++)a+=h0[d[h]];return a}function Ll(d){if(typeof d!="string")throw new TypeError("hexToBytes: expected string, got "+typeof d);if(d.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const a=new Uint8Array(d.length/2);for(let h=0;h<a.length;h++){const _=2*h,j=d.slice(_,_+2),tt=Number.parseInt(j,16);if(Number.isNaN(tt)||tt<0)throw new Error("Invalid byte sequence");a[h]=tt}return a}function Qy(d){return Ll(d.toString(16).padStart(64,"0"))}function Jo(d){return Qy(d).reverse()}function Fn(d){return(Tt(d)&pr)===pr}function Yo(d){if(!(d instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+qo(Uint8Array.from(d).reverse()))}const p0=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Rl(d){return Tt(Yo(d)&p0)}function Tt(d,a=$r.P){const h=d%a;return h>=Wr?h:a+h}function Xs(d,a=$r.P){if(d===Wr||a<=Wr)throw new Error(`invert: expected positive integers, got n=${d} mod=${a}`);let h=Tt(d,a),_=a,j=Wr,tt=pr;for(;h!==Wr;){const rt=_%h,st=j-tt*(_/h);_=h,h=rt,j=tt,tt=st}if(_!==pr)throw new Error("invert: does not exist");return Tt(j,a)}function En(d,a){const{P:h}=$r;let _=d;for(;a-- >Wr;)_*=_,_%=h;return _}function Ol(d,a){const h=Tt(a*a*a),_=function(kt){const{P:_t}=$r,Lt=BigInt(5),Ut=BigInt(10),Zt=BigInt(20),fr=BigInt(40),Gt=BigInt(80),tr=kt*kt%_t*kt%_t,wr=En(tr,_o)*tr%_t,xr=En(wr,pr)*kt%_t,Er=En(xr,Lt)*xr%_t,Yr=En(Er,Ut)*Er%_t,ho=En(Yr,Zt)*Yr%_t,cp=En(ho,fr)*ho%_t,yx=En(cp,Gt)*cp%_t,gx=En(yx,Gt)*cp%_t,mx=En(gx,Ut)*Er%_t;return{pow_p_5_8:En(mx,_o)*kt%_t,b2:tr}}(d*Tt(h*h*a)).pow_p_5_8;let j=Tt(d*h*_);const tt=Tt(a*j*j),rt=j,st=Tt(j*Go),dt=tt===d,ht=tt===Tt(-d),mt=tt===Tt(-d*Go);return dt&&(j=rt),(ht||mt)&&(j=st),Fn(j)&&(j=Tt(-j)),{isValid:dt||ht,value:j}}function Ky(d){return Ol(pr,d)}function na(d){return Tt(Yo(d),$r.l)}function Wn(d,a){const h=d instanceof Uint8Array?Uint8Array.from(d):Ll(d);if(typeof a=="number"&&h.length!==a)throw new Error(`Expected ${a} bytes`);return h}function ga(d,a,h=!0){if(!a)throw new TypeError("Specify max value");if(typeof d=="number"&&Number.isSafeInteger(d)&&(d=BigInt(d)),typeof d=="bigint"&&d<a){if(h){if(Wr<d)return d}else if(Wr<=d)return d}throw new TypeError("Expected valid scalar: 0 < scalar < max")}let Ml;async function ba(d){return function(a){const h=((_=a.slice(0,32))[0]&=248,_[31]&=127,_[31]|=64,_);var _;const j=a.slice(32,64),tt=na(h),rt=Ar.BASE.multiply(tt),st=rt.toRawBytes();return{head:h,prefix:j,scalar:tt,point:rt,pointBytes:st}}(await no.sha512(function(a){if((a=typeof a=="bigint"||typeof a=="number"?Qy(ga(a,Wy)):Wn(a)).length!==32)throw new Error("Expected 32 bytes");return a}(d)))}async function y0(d,a,h){const{r:_,SB:j,msg:tt,pub:rt}=function(dt,ht,mt){ht=Wn(ht),mt instanceof Ar||(mt=Ar.fromHex(mt,!1));const{r:kt,s:_t}=dt instanceof Zo?dt.assertValidity():Zo.fromHex(dt);return{r:kt,s:_t,SB:mr.BASE.multiplyUnsafe(_t),pub:mt,msg:ht}}(d,a,h),st=await no.sha512(_.toRawBytes(),rt.toRawBytes(),tt);return function(dt,ht,mt,kt){const _t=na(kt),Lt=mr.fromAffine(dt).multiplyUnsafe(_t);return mr.fromAffine(ht).add(Lt).subtract(mt).multiplyUnsafe($r.h).equals(mr.ZERO)}(rt,_,j,st)}Ar.BASE._setWindowSize(8);const Vn={node:c0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},no={bytesToHex:qo,hexToBytes:Ll,concatBytes:Hy,getExtendedPublicKey:ba,mod:Tt,invert:Xs,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:d=>{if((d=Wn(d)).length<40||d.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Tt(Yo(d),$r.l-pr)+pr},randomBytes:(d=32)=>{if(Vn.web)return Vn.web.getRandomValues(new Uint8Array(d));if(Vn.node){const{randomBytes:a}=Vn.node;return new Uint8Array(a(d).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>no.randomBytes(32),sha512:async(...d)=>{const a=Hy(...d);if(Vn.web){const h=await Vn.web.subtle.digest("SHA-512",a.buffer);return new Uint8Array(h)}if(Vn.node)return Uint8Array.from(Vn.node.createHash("sha512").update(a).digest());throw new Error("The environment doesn't have sha512 function")},precompute(d=8,a=Ar.BASE){const h=a.equals(Ar.BASE)?a:new Ar(a.x,a.y);return h._setWindowSize(d),h.multiply(_o),h},sha512Sync:void 0};Object.defineProperties(no,{sha512Sync:{configurable:!1,get:()=>Ml,set(d){Ml||(Ml=d)}}});const Gy=(d,a)=>new Ul([d,a]);class Ul{constructor(a){this.variants=a}parse(a){return((h,_)=>{if(h.startsWith("did:")){for(const j of _)try{return j.parse(h)}catch{}throw new Error(`Unsupported did ${h}`)}throw new Error(`Expected did instead got ${h}`)})(a,this.variants)}or(a){return new Ul([...this.variants,a])}}const zl=(d,a)=>new g0(a,d);class g0{constructor(a,h){this.id=a,this.key=h}did(){return this.id}toDIDKey(){return this.key.toDIDKey()}verify(a,h){return this.key.verify(a,h)}withDID(a){return zl(this.key,a)}}const io=237,Zy="EdDSA",qy=Rt(io),Jy=32+qy,Yy=d=>Xy(bn(d)),Xy=d=>{const[a]=At(d);if(a!==io)throw new RangeError(`Unsupported key algorithm with multicode 0x${io.toString(16)}`);if(d.byteLength!==Jy)throw new RangeError(`Expected Uint8Array with byteLength ${Jy}, instead got Uint8Array with byteLength ${d.byteLength}`);return new m0(d.buffer,d.byteOffset,d.byteLength)};class m0 extends Uint8Array{get code(){return io}get signatureCode(){return 53485}get signatureAlgorithm(){return Zy}get publicKey(){const a=new Uint8Array(this.buffer,this.byteOffset+qy);return Object.defineProperties(this,{publicKey:{value:a}}),a}did(){return`did:key:${nn.encode(this)}`}verify(a,h){return h.code===53485&&y0(h.raw,a,this.publicKey)}withDID(a){return zl(this,a)}toDIDKey(){return this.did()}}const _g=(d,a)=>new Fl([d,a]);class Fl{constructor(a){this.variants=a,this.from=w0(a)}or(a){return new Fl([a,...this.variants])}}const w0=d=>a=>{if(a.id.startsWith("did:key:"))return em(a,d);for(const[h,_]of Object.entries(a.keys))return em({id:h,keys:{[h]:_}},d).withDID(a.id);throw new Error(`Archive ${a.id} contains no keys`)},em=(d,a)=>{for(const h of a)try{return h.from(d)}catch{}throw new Error("Unsupported signer")},xa=({signer:d,verifier:a},h)=>new v0(d,a.withDID(h));class v0{constructor(a,h){this.key=a,this.verifier=h}get signer(){return this}get signatureAlgorithm(){return this.key.signatureAlgorithm}get signatureCode(){return this.key.signatureCode}did(){return this.verifier.did()}toDIDKey(){return this.verifier.toDIDKey()}withDID(a){return xa(this.key,a)}sign(a){return this.key.sign(a)}verify(a,h){return this.verifier.verify(a,h)}toArchive(){const{keys:a}=this.key.toArchive();return{id:this.did(),keys:a}}}const _a=4864,b0=Zy,oo=Rt(_a),tm=Rt(io),Hn=32,Wl=oo+Hn+tm+Hn,k0=oo+Hn,rm=()=>E0(no.randomPrivateKey()),E0=async d=>{if(d.byteLength!==Hn)throw new Error(`Expected Uint8Array with byteLength of 32 instead not ${d.byteLength}`);const a=await async function(_){return(await ba(_)).pointBytes}(d),h=new nm(Wl);return Pt(_a,h,0),h.set(d,oo),Pt(io,h,oo+Hn),h.set(a,oo+Hn+tm),h},x0=({id:d,keys:a})=>{if(d.startsWith("did:key:")){const h=a[d];if(h instanceof Uint8Array)return _0(h)}throw new TypeError("Unsupported archive format")},_0=d=>{if(d.byteLength!==Wl)throw new Error(`Expected Uint8Array with byteLength of ${Wl} instead not ${d.byteLength}`);{const[a]=At(d);if(a!==_a)throw new Error("Given bytes must be a multiformat with 4864 tag")}{const[a]=At(d.subarray(k0));if(a!==io)throw new Error("Given bytes must contain public key in multiformats with 237 tag")}return new nm(d)};class nm extends Uint8Array{get code(){return _a}get signer(){return this}get verifier(){const a=new Uint8Array(this.buffer,oo+Hn),h=Xy(a);return Object.defineProperties(this,{verifier:{value:h}}),h}get secret(){const a=new Uint8Array(this.buffer,oo,Hn);return Object.defineProperties(this,{secret:{value:a}}),a}did(){return this.verifier.did()}toDIDKey(){return this.verifier.toDIDKey()}withDID(a){return xa(this,a)}async sign(a){const h=await async function(_,j){_=Wn(_);const{prefix:tt,scalar:rt,pointBytes:st}=await ba(j),dt=na(await no.sha512(tt,_)),ht=Ar.BASE.multiply(dt),mt=Tt(dt+na(await no.sha512(ht.toRawBytes(),st,_))*rt,$r.l);return new Zo(ht,mt).toRawBytes()}(a,this.secret);return Vu(this.signatureCode,h)}verify(a,h){return this.verifier.verify(a,h)}get signatureAlgorithm(){return b0}get signatureCode(){return zu}encode(){return this}toArchive(){const a=this.did();return{id:a,keys:{[a]:this.encode()}}}}function im(d){return globalThis.Buffer!=null?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):d}const S0=Bs({prefix:"\0",name:"identity",encode:d=>{return a=d,new TextDecoder().decode(a);var a},decode:d=>(a=>new TextEncoder().encode(a))(d)});var $0=Object.freeze({__proto__:null,identity:S0});const T0=Ur({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var C0=Object.freeze({__proto__:null,base2:T0});const P0=Ur({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var A0=Object.freeze({__proto__:null,base8:P0});const I0=Wo({prefix:"9",name:"base10",alphabet:"0123456789"});var N0=Object.freeze({__proto__:null,base10:I0});const D0=Ur({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),L0=Ur({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var R0=Object.freeze({__proto__:null,base16:D0,base16upper:L0});const O0=Wo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),j0=Wo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B0=Object.freeze({__proto__:null,base36:O0,base36upper:j0});const om=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),M0=om.reduce((d,a,h)=>(d[h]=a,d),[]),U0=om.reduce((d,a,h)=>(d[a.codePointAt(0)]=h,d),[]),z0=Bs({prefix:"🚀",name:"base256emoji",encode:function(d){return d.reduce((a,h)=>a+=M0[h],"")},decode:function(d){const a=[];for(const h of d){const _=U0[h.codePointAt(0)];if(_===void 0)throw new Error(`Non-base256emoji character: ${h}`);a.push(_)}return new Uint8Array(a)}});var F0=Object.freeze({__proto__:null,base256emoji:z0});new TextEncoder,new TextDecoder;const sm={...$0,...C0,...A0,...N0,...R0,...Ow,...B0,...Tw,...Jw,...F0};function am(d,a,h,_){return{name:d,prefix:a,encoder:{name:d,prefix:a,encode:h},decoder:{decode:_}}}const cm=am("utf8","u",d=>"u"+new TextDecoder("utf8").decode(d),d=>new TextEncoder().encode(d.substring(1))),Vl=am("ascii","a",d=>{let a="a";for(let h=0;h<d.length;h++)a+=String.fromCharCode(d[h]);return a},d=>{const a=function(h=0){var _;return((_=globalThis.Buffer)==null?void 0:_.allocUnsafe)!=null?im(globalThis.Buffer.allocUnsafe(h)):new Uint8Array(h)}((d=d.substring(1)).length);for(let h=0;h<d.length;h++)a[h]=d.charCodeAt(h);return a}),um={utf8:cm,"utf-8":cm,hex:sm.base16,latin1:Vl,ascii:Vl,binary:Vl,...sm};function $a(d,a="utf8"){const h=um[a];if(h==null)throw new Error(`Unsupported encoding "${a}"`);return a!=="utf8"&&a!=="utf-8"||globalThis.Buffer==null||globalThis.Buffer.from==null?h.decoder.decode(`${h.prefix}${d}`):im(globalThis.Buffer.from(d,"utf-8"))}function lm(d,a="utf8"){const h=um[a];if(h==null)throw new Error(`Unsupported encoding "${a}"`);return a!=="utf8"&&a!=="utf-8"||globalThis.Buffer==null||globalThis.Buffer.from==null?h.encoder.encode(d).substring(1):globalThis.Buffer.from(d.buffer,d.byteOffset,d.byteLength).toString("utf8")}const Qn={Null:d=>d===null,Int:d=>Number.isInteger(d),Float:d=>typeof d=="number"&&Number.isFinite(d),String:d=>typeof d=="string",Bool:d=>typeof d=="boolean",Bytes:d=>d instanceof Uint8Array,Link:d=>!Qn.Null(d)&&typeof d=="object"&&d.asCID===d,List:d=>Array.isArray(d),Map:d=>!Qn.Null(d)&&typeof d=="object"&&d.asCID!==d&&!Qn.List(d)&&!Qn.Bytes(d)},So={Int:Qn.Int,"CarHeader > version":d=>So.Int(d),"CarHeader > roots (anon) > valueType (anon)":Qn.Link,"CarHeader > roots (anon)":d=>Qn.List(d)&&Array.prototype.every.call(d,So["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":d=>So["CarHeader > roots (anon)"](d),CarHeader:d=>{const a=d&&Object.keys(d);return Qn.Map(d)&&["version"].every(h=>a.includes(h))&&Object.entries(d).every(([h,_])=>So["CarHeader > "+h]&&So["CarHeader > "+h](_))}},W0=So.CarHeader,V0=18,H0=32,Q0=112;function _c(d){const a=d.upTo(8);if(a.length===0)throw new Error("Unexpected end of data");const h=Lr.decode(a);return d.seek(Lr.decode.bytes),h}function K0(d){const a=d.exactly(2);if(a[0]===V0&&a[1]===H0){const rt=d.exactly(34);d.seek(34);const st=hr(rt);return br.create(0,Q0,st)}const h=_c(d);if(h!==1)throw new Error(`Unexpected CID version (${h})`);const _=_c(d),j=function(rt){const st=rt.upTo(8);Lr.decode(st);const dt=Lr.decode.bytes,ht=Lr.decode(st.subarray(Lr.decode.bytes)),mt=dt+Lr.decode.bytes+ht,kt=rt.exactly(mt);return rt.seek(mt),kt}(d),tt=hr(j);return br.create(h,_,tt)}function dm(d){const a=d.pos;let h=_c(d);if(h===0)throw new Error("Invalid CAR section (zero length)");return h+=d.pos-a,{cid:K0(d),length:h,blockLength:h-Number(d.pos-a)}}function G0(d){const{cid:a,blockLength:h}=dm(d),_=d.exactly(h);return d.seek(h),{bytes:_,cid:a}}function fm(d,a){const h=_c(d);if(h===0)throw new Error("Invalid CAR header (zero length)");const _=d.exactly(h);d.seek(h);const j=Ho(_);if(!W0(j))throw new Error("Invalid CAR header format");if(j.version!==1&&j.version!==2||a!==void 0&&j.version!==a)throw new Error(`Invalid CAR version: ${j.version}${a===void 0?"":` (expected ${a})`}`);const tt=Array.isArray(j.roots);if(j.version===1&&!tt||j.version===2&&tt)throw new Error("Invalid CAR header format");if(j.version===1)return j;const rt=function(dt){const ht=dt.exactly(40),mt=new DataView(ht.buffer,ht.byteOffset,ht.byteLength);let kt=0;const _t={version:2,characteristics:[mt.getBigUint64(kt,!0),mt.getBigUint64(kt+=8,!0)],dataOffset:Number(mt.getBigUint64(kt+=8,!0)),dataSize:Number(mt.getBigUint64(kt+=8,!0)),indexOffset:Number(mt.getBigUint64(kt+=8,!0))};return dt.seek(40),_t}(d);d.seek(rt.dataOffset-d.pos);const st=fm(d,1);return Object.assign(st,rt)}function Z0(d){const a=fm(d);if(a.version===2){const h=d.pos-a.dataOffset;d=function(_,j){let tt=0;return{upTo(rt){let st=_.upTo(rt);return st.length+tt>j&&(st=st.subarray(0,j-tt)),st},exactly(rt){const st=_.exactly(rt);if(st.length+tt>j)throw new Error("Unexpected end of data");return st},seek(rt){tt+=rt,_.seek(rt)},get pos(){return _.pos}}}(d,a.dataSize-h)}return{header:()=>a,*blocks(){for(;d.upTo(8).length>0;)yield G0(d)},*blocksIndex(){for(;d.upTo(8).length>0;)yield q0(d)}}}function q0(d){const a=d.pos,{cid:h,length:_,blockLength:j}=dm(d),tt={cid:h,length:_,blockLength:j,offset:a,blockOffset:d.pos};return d.seek(tt.blockLength),tt}class Hl{constructor(a,h){this._header=a,this._blocks=h,this._keys=h.map(_=>_.cid.toString())}get version(){return this._header.version}getRoots(){return this._header.roots}has(a){return this._keys.indexOf(a.toString())>-1}get(a){const h=this._keys.indexOf(a.toString());return h>-1?this._blocks[h]:void 0}*blocks(){for(const a of this._blocks)yield a}*cids(){for(const a of this._blocks)yield a.cid}static fromBytes(a){if(!(a instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return function(h){const _=Z0(h),j=_.header(),tt=[];for(const rt of _.blocks())tt.push(rt);return new Hl(j,tt)}(function(h){let _=0;return{upTo:j=>h.subarray(_,_+Math.min(j,h.length-_)),exactly(j){if(j>h.length-_)throw new Error("Unexpected end of data");return h.subarray(_,_+j)},seek(j){_+=j},get pos(){return _}}}(a))}}function J0(d){if(!Array.isArray(d)||d.length===0)throw new Error("Delegations required to be an non empty array.");const a=d.map(st=>st.root.cid),h=new Set,_=[];let j=0;for(const st of d)for(const dt of st.export()){const ht=dt.cid.toV1().toString();h.has(ht)||(j+=yl(dt),_.push(dt),h.add(ht))}const tt=((st,dt=36)=>uy(new Array(st).fill(dt)))(a.length),rt=ly(new ArrayBuffer(tt+j),{roots:a});for(const st of _)rt.write(st);return rt.close()}function Y0(d,a="base64url"){return lm(J0(d),a)}function hm(d,a="base64url"){return function(h){if(!(h instanceof Uint8Array)||h.length===0)throw new TypeError("Input should be a non-empty Uint8Array.");const _=Hl.fromBytes(h),j=_.getRoots(),tt=[];for(const rt of j){const st=_.get(rt);if(!st)throw new Error("Failed to find root from raw delegation.");{const dt=new Map;for(const ht of _.blocks())ht.cid.toString()!==rt.toString()&&dt.set(ht.cid.toString(),ht);tt.push(new Vs(st,dt))}}return tt}($a(d,a))}function pm(d,a){return hm(d,a)[0]}var yr;(function(d){d.assertEqual=a=>a,d.assertIs=function(a){},d.assertNever=function(a){throw new Error},d.arrayToEnum=a=>{const h={};for(const _ of a)h[_]=_;return h},d.getValidEnumValues=a=>{const h=d.objectKeys(a).filter(j=>typeof a[a[j]]!="number"),_={};for(const j of h)_[j]=a[j];return d.objectValues(_)},d.objectValues=a=>d.objectKeys(a).map(function(h){return a[h]}),d.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const h=[];for(const _ in a)Object.prototype.hasOwnProperty.call(a,_)&&h.push(_);return h},d.find=(a,h)=>{for(const _ of a)if(h(_))return _},d.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a,d.joinValues=function(a,h=" | "){return a.map(_=>typeof _=="string"?`'${_}'`:_).join(h)},d.jsonStringifyReplacer=(a,h)=>typeof h=="bigint"?h.toString():h})(yr||(yr={}));const Ot=yr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Kn=d=>{switch(typeof d){case"undefined":return Ot.undefined;case"string":return Ot.string;case"number":return isNaN(d)?Ot.nan:Ot.number;case"boolean":return Ot.boolean;case"function":return Ot.function;case"bigint":return Ot.bigint;case"symbol":return Ot.symbol;case"object":return Array.isArray(d)?Ot.array:d===null?Ot.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?Ot.promise:typeof Map<"u"&&d instanceof Map?Ot.map:typeof Set<"u"&&d instanceof Set?Ot.set:typeof Date<"u"&&d instanceof Date?Ot.date:Ot.object;default:return Ot.unknown}},Nt=yr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class An extends Error{constructor(a){super(),this.issues=[],this.addIssue=_=>{this.issues=[...this.issues,_]},this.addIssues=(_=[])=>{this.issues=[...this.issues,..._]};const h=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,h):this.__proto__=h,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const h=a||function(tt){return tt.message},_={_errors:[]},j=tt=>{for(const rt of tt.issues)if(rt.code==="invalid_union")rt.unionErrors.map(j);else if(rt.code==="invalid_return_type")j(rt.returnTypeError);else if(rt.code==="invalid_arguments")j(rt.argumentsError);else if(rt.path.length===0)_._errors.push(h(rt));else{let st=_,dt=0;for(;dt<rt.path.length;){const ht=rt.path[dt];dt===rt.path.length-1?(st[ht]=st[ht]||{_errors:[]},st[ht]._errors.push(h(rt))):st[ht]=st[ht]||{_errors:[]},st=st[ht],dt++}}};return j(this),_}toString(){return this.message}get message(){return JSON.stringify(this.issues,yr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=h=>h.message){const h={},_=[];for(const j of this.issues)j.path.length>0?(h[j.path[0]]=h[j.path[0]]||[],h[j.path[0]].push(a(j))):_.push(a(j));return{formErrors:_,fieldErrors:h}}get formErrors(){return this.flatten()}}An.create=d=>new An(d);const Xo=(d,a)=>{let h;switch(d.code){case Nt.invalid_type:h=d.received===Ot.undefined?"Required":`Expected ${d.expected}, received ${d.received}`;break;case Nt.invalid_literal:h=`Invalid literal value, expected ${JSON.stringify(d.expected,yr.jsonStringifyReplacer)}`;break;case Nt.unrecognized_keys:h=`Unrecognized key(s) in object: ${yr.joinValues(d.keys,", ")}`;break;case Nt.invalid_union:h="Invalid input";break;case Nt.invalid_union_discriminator:h=`Invalid discriminator value. Expected ${yr.joinValues(d.options)}`;break;case Nt.invalid_enum_value:h=`Invalid enum value. Expected ${yr.joinValues(d.options)}, received '${d.received}'`;break;case Nt.invalid_arguments:h="Invalid function arguments";break;case Nt.invalid_return_type:h="Invalid function return type";break;case Nt.invalid_date:h="Invalid date";break;case Nt.invalid_string:typeof d.validation=="object"?"startsWith"in d.validation?h=`Invalid input: must start with "${d.validation.startsWith}"`:"endsWith"in d.validation?h=`Invalid input: must end with "${d.validation.endsWith}"`:yr.assertNever(d.validation):h=d.validation!=="regex"?`Invalid ${d.validation}`:"Invalid";break;case Nt.too_small:h=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at least":"more than"} ${d.minimum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at least":"over"} ${d.minimum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${d.minimum}`:d.type==="date"?`Date must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${new Date(d.minimum)}`:"Invalid input";break;case Nt.too_big:h=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at most":"less than"} ${d.maximum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at most":"under"} ${d.maximum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="date"?`Date must be ${d.exact?"exactly":d.inclusive?"smaller than or equal to":"smaller than"} ${new Date(d.maximum)}`:"Invalid input";break;case Nt.custom:h="Invalid input";break;case Nt.invalid_intersection_types:h="Intersection results could not be merged";break;case Nt.not_multiple_of:h=`Number must be a multiple of ${d.multipleOf}`;break;case Nt.not_finite:h="Number must be finite";break;default:h=a.defaultError,yr.assertNever(d)}return{message:h}};let ym=Xo;function eu(){return ym}const tu=d=>{const{data:a,path:h,errorMaps:_,issueData:j}=d,tt=[...h,...j.path||[]],rt={...j,path:tt};let st="";const dt=_.filter(ht=>!!ht).slice().reverse();for(const ht of dt)st=ht(rt,{data:a,defaultError:st}).message;return{...j,path:tt,message:j.message||st}};function Ft(d,a){const h=tu({issueData:a,data:d.data,path:d.path,errorMaps:[d.common.contextualErrorMap,d.schemaErrorMap,eu(),Xo].filter(_=>!!_)});d.common.issues.push(h)}class Zr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(a,h){const _=[];for(const j of h){if(j.status==="aborted")return Xt;j.status==="dirty"&&a.dirty(),_.push(j.value)}return{status:a.value,value:_}}static async mergeObjectAsync(a,h){const _=[];for(const j of h)_.push({key:await j.key,value:await j.value});return Zr.mergeObjectSync(a,_)}static mergeObjectSync(a,h){const _={};for(const j of h){const{key:tt,value:rt}=j;if(tt.status==="aborted"||rt.status==="aborted")return Xt;tt.status==="dirty"&&a.dirty(),rt.status==="dirty"&&a.dirty(),(rt.value!==void 0||j.alwaysSet)&&(_[tt.value]=rt.value)}return{status:a.value,value:_}}}const Xt=Object.freeze({status:"aborted"}),gm=d=>({status:"dirty",value:d}),Qr=d=>({status:"valid",value:d}),Ql=d=>d.status==="aborted",Kl=d=>d.status==="dirty",ru=d=>d.status==="valid",nu=d=>typeof Promise!==void 0&&d instanceof Promise;var lr;(function(d){d.errToObj=a=>typeof a=="string"?{message:a}:a||{},d.toString=a=>typeof a=="string"?a:a==null?void 0:a.message})(lr||(lr={}));class xn{constructor(a,h,_,j){this.parent=a,this.data=h,this._path=_,this._key=j}get path(){return this._path.concat(this._key)}}const mm=(d,a)=>{if(ru(a))return{success:!0,data:a.value};if(!d.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,error:new An(d.common.issues)}};function cr(d){if(!d)return{};const{errorMap:a,invalid_type_error:h,required_error:_,description:j}=d;if(a&&(h||_))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return a?{errorMap:a,description:j}:{errorMap:(tt,rt)=>tt.code!=="invalid_type"?{message:rt.defaultError}:rt.data===void 0?{message:_??rt.defaultError}:{message:h??rt.defaultError},description:j}}class sr{constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(a){return Kn(a.data)}_getOrReturnCtx(a,h){return h||{common:a.parent.common,data:a.data,parsedType:Kn(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new Zr,ctx:{common:a.parent.common,data:a.data,parsedType:Kn(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){const h=this._parse(a);if(nu(h))throw new Error("Synchronous parse encountered promise.");return h}_parseAsync(a){const h=this._parse(a);return Promise.resolve(h)}parse(a,h){const _=this.safeParse(a,h);if(_.success)return _.data;throw _.error}safeParse(a,h){var _;const j={common:{issues:[],async:(_=h==null?void 0:h.async)!==null&&_!==void 0&&_,contextualErrorMap:h==null?void 0:h.errorMap},path:(h==null?void 0:h.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Kn(a)},tt=this._parseSync({data:a,path:j.path,parent:j});return mm(j,tt)}async parseAsync(a,h){const _=await this.safeParseAsync(a,h);if(_.success)return _.data;throw _.error}async safeParseAsync(a,h){const _={common:{issues:[],contextualErrorMap:h==null?void 0:h.errorMap,async:!0},path:(h==null?void 0:h.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:Kn(a)},j=this._parse({data:a,path:_.path,parent:_}),tt=await(nu(j)?j:Promise.resolve(j));return mm(_,tt)}refine(a,h){const _=j=>typeof h=="string"||h===void 0?{message:h}:typeof h=="function"?h(j):h;return this._refinement((j,tt)=>{const rt=a(j),st=()=>tt.addIssue({code:Nt.custom,..._(j)});return typeof Promise<"u"&&rt instanceof Promise?rt.then(dt=>!!dt||(st(),!1)):!!rt||(st(),!1)})}refinement(a,h){return this._refinement((_,j)=>!!a(_)||(j.addIssue(typeof h=="function"?h(_,j):h),!1))}_refinement(a){return new hn({schema:this,typeName:Yt.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}optional(){return Sn.create(this)}nullable(){return uo.create(this)}nullish(){return this.optional().nullable()}array(){return fn.create(this)}promise(){return Po.create(this)}or(a){return os.create([this,a])}and(a){return ss.create(this,a)}transform(a){return new hn({schema:this,typeName:Yt.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new ds({innerType:this,defaultValue:typeof a=="function"?a:()=>a,typeName:Yt.ZodDefault})}brand(){return new bm({typeName:Yt.ZodBranded,type:this,...cr(void 0)})}catch(a){return new du({innerType:this,defaultValue:typeof a=="function"?a:()=>a,typeName:Yt.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return fs.create(this,a)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const X0=/^c[^\s-]{8,}$/i,_b=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,_k=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;class In extends sr{constructor(){super(...arguments),this._regex=(a,h,_)=>this.refinement(j=>a.test(j),{validation:h,code:Nt.invalid_string,...lr.errToObj(_)}),this.nonempty=a=>this.min(1,lr.errToObj(a)),this.trim=()=>new In({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}_parse(a){if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==Ot.string){const tt=this._getOrReturnCtx(a);return Ft(tt,{code:Nt.invalid_type,expected:Ot.string,received:tt.parsedType}),Xt}const h=new Zr;let _;for(const tt of this._def.checks)if(tt.kind==="min")a.data.length<tt.value&&(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.too_small,minimum:tt.value,type:"string",inclusive:!0,exact:!1,message:tt.message}),h.dirty());else if(tt.kind==="max")a.data.length>tt.value&&(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.too_big,maximum:tt.value,type:"string",inclusive:!0,exact:!1,message:tt.message}),h.dirty());else if(tt.kind==="length"){const rt=a.data.length>tt.value,st=a.data.length<tt.value;(rt||st)&&(_=this._getOrReturnCtx(a,_),rt?Ft(_,{code:Nt.too_big,maximum:tt.value,type:"string",inclusive:!0,exact:!0,message:tt.message}):st&&Ft(_,{code:Nt.too_small,minimum:tt.value,type:"string",inclusive:!0,exact:!0,message:tt.message}),h.dirty())}else if(tt.kind==="email")_k.test(a.data)||(_=this._getOrReturnCtx(a,_),Ft(_,{validation:"email",code:Nt.invalid_string,message:tt.message}),h.dirty());else if(tt.kind==="uuid")_b.test(a.data)||(_=this._getOrReturnCtx(a,_),Ft(_,{validation:"uuid",code:Nt.invalid_string,message:tt.message}),h.dirty());else if(tt.kind==="cuid")X0.test(a.data)||(_=this._getOrReturnCtx(a,_),Ft(_,{validation:"cuid",code:Nt.invalid_string,message:tt.message}),h.dirty());else if(tt.kind==="url")try{new URL(a.data)}catch{_=this._getOrReturnCtx(a,_),Ft(_,{validation:"url",code:Nt.invalid_string,message:tt.message}),h.dirty()}else tt.kind==="regex"?(tt.regex.lastIndex=0,tt.regex.test(a.data)||(_=this._getOrReturnCtx(a,_),Ft(_,{validation:"regex",code:Nt.invalid_string,message:tt.message}),h.dirty())):tt.kind==="trim"?a.data=a.data.trim():tt.kind==="startsWith"?a.data.startsWith(tt.value)||(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.invalid_string,validation:{startsWith:tt.value},message:tt.message}),h.dirty()):tt.kind==="endsWith"?a.data.endsWith(tt.value)||(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.invalid_string,validation:{endsWith:tt.value},message:tt.message}),h.dirty()):tt.kind==="datetime"?((j=tt).precision?j.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${j.precision}}(([+-]\\d{2}:\\d{2})|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${j.precision}}Z$`):j.precision===0?j.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}:\\d{2})|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):j.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}:\\d{2})|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(a.data)||(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.invalid_string,validation:"datetime",message:tt.message}),h.dirty()):yr.assertNever(tt);var j;return{status:h.value,value:a.data}}_addCheck(a){return new In({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...lr.errToObj(a)})}url(a){return this._addCheck({kind:"url",...lr.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...lr.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...lr.errToObj(a)})}datetime(a){var h;return typeof a=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:a}):this._addCheck({kind:"datetime",precision:(a==null?void 0:a.precision)===void 0?null:a==null?void 0:a.precision,offset:(h=a==null?void 0:a.offset)!==null&&h!==void 0&&h,...lr.errToObj(a==null?void 0:a.message)})}regex(a,h){return this._addCheck({kind:"regex",regex:a,...lr.errToObj(h)})}startsWith(a,h){return this._addCheck({kind:"startsWith",value:a,...lr.errToObj(h)})}endsWith(a,h){return this._addCheck({kind:"endsWith",value:a,...lr.errToObj(h)})}min(a,h){return this._addCheck({kind:"min",value:a,...lr.errToObj(h)})}max(a,h){return this._addCheck({kind:"max",value:a,...lr.errToObj(h)})}length(a,h){return this._addCheck({kind:"length",value:a,...lr.errToObj(h)})}get isDatetime(){return!!this._def.checks.find(a=>a.kind==="datetime")}get isEmail(){return!!this._def.checks.find(a=>a.kind==="email")}get isURL(){return!!this._def.checks.find(a=>a.kind==="url")}get isUUID(){return!!this._def.checks.find(a=>a.kind==="uuid")}get isCUID(){return!!this._def.checks.find(a=>a.kind==="cuid")}get minLength(){let a=null;for(const h of this._def.checks)h.kind==="min"&&(a===null||h.value>a)&&(a=h.value);return a}get maxLength(){let a=null;for(const h of this._def.checks)h.kind==="max"&&(a===null||h.value<a)&&(a=h.value);return a}}function eE(d,a){const h=(d.toString().split(".")[1]||"").length,_=(a.toString().split(".")[1]||"").length,j=h>_?h:_;return parseInt(d.toFixed(j).replace(".",""))%parseInt(a.toFixed(j).replace(".",""))/Math.pow(10,j)}In.create=d=>{var a;return new In({checks:[],typeName:Yt.ZodString,coerce:(a=d==null?void 0:d.coerce)!==null&&a!==void 0&&a,...cr(d)})};class Gn extends sr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==Ot.number){const j=this._getOrReturnCtx(a);return Ft(j,{code:Nt.invalid_type,expected:Ot.number,received:j.parsedType}),Xt}let h;const _=new Zr;for(const j of this._def.checks)j.kind==="int"?yr.isInteger(a.data)||(h=this._getOrReturnCtx(a,h),Ft(h,{code:Nt.invalid_type,expected:"integer",received:"float",message:j.message}),_.dirty()):j.kind==="min"?(j.inclusive?a.data<j.value:a.data<=j.value)&&(h=this._getOrReturnCtx(a,h),Ft(h,{code:Nt.too_small,minimum:j.value,type:"number",inclusive:j.inclusive,exact:!1,message:j.message}),_.dirty()):j.kind==="max"?(j.inclusive?a.data>j.value:a.data>=j.value)&&(h=this._getOrReturnCtx(a,h),Ft(h,{code:Nt.too_big,maximum:j.value,type:"number",inclusive:j.inclusive,exact:!1,message:j.message}),_.dirty()):j.kind==="multipleOf"?eE(a.data,j.value)!==0&&(h=this._getOrReturnCtx(a,h),Ft(h,{code:Nt.not_multiple_of,multipleOf:j.value,message:j.message}),_.dirty()):j.kind==="finite"?Number.isFinite(a.data)||(h=this._getOrReturnCtx(a,h),Ft(h,{code:Nt.not_finite,message:j.message}),_.dirty()):yr.assertNever(j);return{status:_.value,value:a.data}}gte(a,h){return this.setLimit("min",a,!0,lr.toString(h))}gt(a,h){return this.setLimit("min",a,!1,lr.toString(h))}lte(a,h){return this.setLimit("max",a,!0,lr.toString(h))}lt(a,h){return this.setLimit("max",a,!1,lr.toString(h))}setLimit(a,h,_,j){return new Gn({...this._def,checks:[...this._def.checks,{kind:a,value:h,inclusive:_,message:lr.toString(j)}]})}_addCheck(a){return new Gn({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:lr.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:lr.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:lr.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:lr.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:lr.toString(a)})}multipleOf(a,h){return this._addCheck({kind:"multipleOf",value:a,message:lr.toString(h)})}finite(a){return this._addCheck({kind:"finite",message:lr.toString(a)})}get minValue(){let a=null;for(const h of this._def.checks)h.kind==="min"&&(a===null||h.value>a)&&(a=h.value);return a}get maxValue(){let a=null;for(const h of this._def.checks)h.kind==="max"&&(a===null||h.value<a)&&(a=h.value);return a}get isInt(){return!!this._def.checks.find(a=>a.kind==="int")}}Gn.create=d=>new Gn({checks:[],typeName:Yt.ZodNumber,coerce:(d==null?void 0:d.coerce)||!1,...cr(d)});class es extends sr{_parse(a){if(this._def.coerce&&(a.data=BigInt(a.data)),this._getType(a)!==Ot.bigint){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.bigint,received:h.parsedType}),Xt}return Qr(a.data)}}es.create=d=>{var a;return new es({typeName:Yt.ZodBigInt,coerce:(a=d==null?void 0:d.coerce)!==null&&a!==void 0&&a,...cr(d)})};class ts extends sr{_parse(a){if(this._def.coerce&&(a.data=Boolean(a.data)),this._getType(a)!==Ot.boolean){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.boolean,received:h.parsedType}),Xt}return Qr(a.data)}}ts.create=d=>new ts({typeName:Yt.ZodBoolean,coerce:(d==null?void 0:d.coerce)||!1,...cr(d)});class so extends sr{_parse(a){if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==Ot.date){const j=this._getOrReturnCtx(a);return Ft(j,{code:Nt.invalid_type,expected:Ot.date,received:j.parsedType}),Xt}if(isNaN(a.data.getTime()))return Ft(this._getOrReturnCtx(a),{code:Nt.invalid_date}),Xt;const h=new Zr;let _;for(const j of this._def.checks)j.kind==="min"?a.data.getTime()<j.value&&(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.too_small,message:j.message,inclusive:!0,exact:!1,minimum:j.value,type:"date"}),h.dirty()):j.kind==="max"?a.data.getTime()>j.value&&(_=this._getOrReturnCtx(a,_),Ft(_,{code:Nt.too_big,message:j.message,inclusive:!0,exact:!1,maximum:j.value,type:"date"}),h.dirty()):yr.assertNever(j);return{status:h.value,value:new Date(a.data.getTime())}}_addCheck(a){return new so({...this._def,checks:[...this._def.checks,a]})}min(a,h){return this._addCheck({kind:"min",value:a.getTime(),message:lr.toString(h)})}max(a,h){return this._addCheck({kind:"max",value:a.getTime(),message:lr.toString(h)})}get minDate(){let a=null;for(const h of this._def.checks)h.kind==="min"&&(a===null||h.value>a)&&(a=h.value);return a!=null?new Date(a):null}get maxDate(){let a=null;for(const h of this._def.checks)h.kind==="max"&&(a===null||h.value<a)&&(a=h.value);return a!=null?new Date(a):null}}so.create=d=>new so({checks:[],coerce:(d==null?void 0:d.coerce)||!1,typeName:Yt.ZodDate,...cr(d)});class iu extends sr{_parse(a){if(this._getType(a)!==Ot.symbol){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.symbol,received:h.parsedType}),Xt}return Qr(a.data)}}iu.create=d=>new iu({typeName:Yt.ZodSymbol,...cr(d)});class rs extends sr{_parse(a){if(this._getType(a)!==Ot.undefined){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.undefined,received:h.parsedType}),Xt}return Qr(a.data)}}rs.create=d=>new rs({typeName:Yt.ZodUndefined,...cr(d)});class ns extends sr{_parse(a){if(this._getType(a)!==Ot.null){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.null,received:h.parsedType}),Xt}return Qr(a.data)}}ns.create=d=>new ns({typeName:Yt.ZodNull,...cr(d)});class $o extends sr{constructor(){super(...arguments),this._any=!0}_parse(a){return Qr(a.data)}}$o.create=d=>new $o({typeName:Yt.ZodAny,...cr(d)});class ao extends sr{constructor(){super(...arguments),this._unknown=!0}_parse(a){return Qr(a.data)}}ao.create=d=>new ao({typeName:Yt.ZodUnknown,...cr(d)});class Nn extends sr{_parse(a){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.never,received:h.parsedType}),Xt}}Nn.create=d=>new Nn({typeName:Yt.ZodNever,...cr(d)});class ou extends sr{_parse(a){if(this._getType(a)!==Ot.undefined){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.void,received:h.parsedType}),Xt}return Qr(a.data)}}ou.create=d=>new ou({typeName:Yt.ZodVoid,...cr(d)});class fn extends sr{_parse(a){const{ctx:h,status:_}=this._processInputParams(a),j=this._def;if(h.parsedType!==Ot.array)return Ft(h,{code:Nt.invalid_type,expected:Ot.array,received:h.parsedType}),Xt;if(j.exactLength!==null){const rt=h.data.length>j.exactLength.value,st=h.data.length<j.exactLength.value;(rt||st)&&(Ft(h,{code:rt?Nt.too_big:Nt.too_small,minimum:st?j.exactLength.value:void 0,maximum:rt?j.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:j.exactLength.message}),_.dirty())}if(j.minLength!==null&&h.data.length<j.minLength.value&&(Ft(h,{code:Nt.too_small,minimum:j.minLength.value,type:"array",inclusive:!0,exact:!1,message:j.minLength.message}),_.dirty()),j.maxLength!==null&&h.data.length>j.maxLength.value&&(Ft(h,{code:Nt.too_big,maximum:j.maxLength.value,type:"array",inclusive:!0,exact:!1,message:j.maxLength.message}),_.dirty()),h.common.async)return Promise.all(h.data.map((rt,st)=>j.type._parseAsync(new xn(h,rt,h.path,st)))).then(rt=>Zr.mergeArray(_,rt));const tt=h.data.map((rt,st)=>j.type._parseSync(new xn(h,rt,h.path,st)));return Zr.mergeArray(_,tt)}get element(){return this._def.type}min(a,h){return new fn({...this._def,minLength:{value:a,message:lr.toString(h)}})}max(a,h){return new fn({...this._def,maxLength:{value:a,message:lr.toString(h)}})}length(a,h){return new fn({...this._def,exactLength:{value:a,message:lr.toString(h)}})}nonempty(a){return this.min(1,a)}}var su;fn.create=(d,a)=>new fn({type:d,minLength:null,maxLength:null,exactLength:null,typeName:Yt.ZodArray,...cr(a)}),function(d){d.mergeShapes=(a,h)=>({...a,...h})}(su||(su={}));const wm=d=>a=>new Tr({...d,shape:()=>({...d.shape(),...a})});function To(d){if(d instanceof Tr){const a={};for(const h in d.shape){const _=d.shape[h];a[h]=Sn.create(To(_))}return new Tr({...d._def,shape:()=>a})}return d instanceof fn?fn.create(To(d.element)):d instanceof Sn?Sn.create(To(d.unwrap())):d instanceof uo?uo.create(To(d.unwrap())):d instanceof _n?_n.create(d.items.map(a=>To(a))):d}class Tr extends sr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=wm(this._def),this.extend=wm(this._def)}_getCached(){if(this._cached!==null)return this._cached;const a=this._def.shape(),h=yr.objectKeys(a);return this._cached={shape:a,keys:h}}_parse(a){if(this._getType(a)!==Ot.object){const dt=this._getOrReturnCtx(a);return Ft(dt,{code:Nt.invalid_type,expected:Ot.object,received:dt.parsedType}),Xt}const{status:h,ctx:_}=this._processInputParams(a),{shape:j,keys:tt}=this._getCached(),rt=[];if(!(this._def.catchall instanceof Nn&&this._def.unknownKeys==="strip"))for(const dt in _.data)tt.includes(dt)||rt.push(dt);const st=[];for(const dt of tt){const ht=j[dt],mt=_.data[dt];st.push({key:{status:"valid",value:dt},value:ht._parse(new xn(_,mt,_.path,dt)),alwaysSet:dt in _.data})}if(this._def.catchall instanceof Nn){const dt=this._def.unknownKeys;if(dt==="passthrough")for(const ht of rt)st.push({key:{status:"valid",value:ht},value:{status:"valid",value:_.data[ht]}});else if(dt==="strict")rt.length>0&&(Ft(_,{code:Nt.unrecognized_keys,keys:rt}),h.dirty());else if(dt!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const dt=this._def.catchall;for(const ht of rt){const mt=_.data[ht];st.push({key:{status:"valid",value:ht},value:dt._parse(new xn(_,mt,_.path,ht)),alwaysSet:ht in _.data})}}return _.common.async?Promise.resolve().then(async()=>{const dt=[];for(const ht of st){const mt=await ht.key;dt.push({key:mt,value:await ht.value,alwaysSet:ht.alwaysSet})}return dt}).then(dt=>Zr.mergeObjectSync(h,dt)):Zr.mergeObjectSync(h,st)}get shape(){return this._def.shape()}strict(a){return lr.errToObj,new Tr({...this._def,unknownKeys:"strict",...a!==void 0?{errorMap:(h,_)=>{var j,tt,rt,st;const dt=(rt=(tt=(j=this._def).errorMap)===null||tt===void 0?void 0:tt.call(j,h,_).message)!==null&&rt!==void 0?rt:_.defaultError;return h.code==="unrecognized_keys"?{message:(st=lr.errToObj(a).message)!==null&&st!==void 0?st:dt}:{message:dt}}}:{}})}strip(){return new Tr({...this._def,unknownKeys:"strip"})}passthrough(){return new Tr({...this._def,unknownKeys:"passthrough"})}setKey(a,h){return this.augment({[a]:h})}merge(a){return new Tr({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>su.mergeShapes(this._def.shape(),a._def.shape()),typeName:Yt.ZodObject})}catchall(a){return new Tr({...this._def,catchall:a})}pick(a){const h={};return yr.objectKeys(a).map(_=>{this.shape[_]&&(h[_]=this.shape[_])}),new Tr({...this._def,shape:()=>h})}omit(a){const h={};return yr.objectKeys(this.shape).map(_=>{yr.objectKeys(a).indexOf(_)===-1&&(h[_]=this.shape[_])}),new Tr({...this._def,shape:()=>h})}deepPartial(){return To(this)}partial(a){const h={};if(a)return yr.objectKeys(this.shape).map(_=>{yr.objectKeys(a).indexOf(_)===-1?h[_]=this.shape[_]:h[_]=this.shape[_].optional()}),new Tr({...this._def,shape:()=>h});for(const _ in this.shape){const j=this.shape[_];h[_]=j.optional()}return new Tr({...this._def,shape:()=>h})}required(a){const h={};if(a)yr.objectKeys(this.shape).map(_=>{if(yr.objectKeys(a).indexOf(_)===-1)h[_]=this.shape[_];else{let j=this.shape[_];for(;j instanceof Sn;)j=j._def.innerType;h[_]=j}});else for(const _ in this.shape){let j=this.shape[_];for(;j instanceof Sn;)j=j._def.innerType;h[_]=j}return new Tr({...this._def,shape:()=>h})}keyof(){return vm(yr.objectKeys(this.shape))}}Tr.create=(d,a)=>new Tr({shape:()=>d,unknownKeys:"strip",catchall:Nn.create(),typeName:Yt.ZodObject,...cr(a)}),Tr.strictCreate=(d,a)=>new Tr({shape:()=>d,unknownKeys:"strict",catchall:Nn.create(),typeName:Yt.ZodObject,...cr(a)}),Tr.lazycreate=(d,a)=>new Tr({shape:d,unknownKeys:"strip",catchall:Nn.create(),typeName:Yt.ZodObject,...cr(a)});class os extends sr{_parse(a){const{ctx:h}=this._processInputParams(a),_=this._def.options;if(h.common.async)return Promise.all(_.map(async j=>{const tt={...h,common:{...h.common,issues:[]},parent:null};return{result:await j._parseAsync({data:h.data,path:h.path,parent:tt}),ctx:tt}})).then(function(j){for(const rt of j)if(rt.result.status==="valid")return rt.result;for(const rt of j)if(rt.result.status==="dirty")return h.common.issues.push(...rt.ctx.common.issues),rt.result;const tt=j.map(rt=>new An(rt.ctx.common.issues));return Ft(h,{code:Nt.invalid_union,unionErrors:tt}),Xt});{let j;const tt=[];for(const st of _){const dt={...h,common:{...h.common,issues:[]},parent:null},ht=st._parseSync({data:h.data,path:h.path,parent:dt});if(ht.status==="valid")return ht;ht.status!=="dirty"||j||(j={result:ht,ctx:dt}),dt.common.issues.length&&tt.push(dt.common.issues)}if(j)return h.common.issues.push(...j.ctx.common.issues),j.result;const rt=tt.map(st=>new An(st));return Ft(h,{code:Nt.invalid_union,unionErrors:rt}),Xt}}get options(){return this._def.options}}os.create=(d,a)=>new os({options:d,typeName:Yt.ZodUnion,...cr(a)});const au=d=>d instanceof as?au(d.schema):d instanceof hn?au(d.innerType()):d instanceof cs?[d.value]:d instanceof us?d.options:d instanceof ls?Object.keys(d.enum):d instanceof ds?au(d._def.innerType):d instanceof rs?[void 0]:d instanceof ns?[null]:null;class cu extends sr{_parse(a){const{ctx:h}=this._processInputParams(a);if(h.parsedType!==Ot.object)return Ft(h,{code:Nt.invalid_type,expected:Ot.object,received:h.parsedType}),Xt;const _=this.discriminator,j=h.data[_],tt=this.optionsMap.get(j);return tt?h.common.async?tt._parseAsync({data:h.data,path:h.path,parent:h}):tt._parseSync({data:h.data,path:h.path,parent:h}):(Ft(h,{code:Nt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[_]}),Xt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,h,_){const j=new Map;for(const tt of h){const rt=au(tt.shape[a]);if(!rt)throw new Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(const st of rt){if(j.has(st))throw new Error(`Discriminator property ${String(a)} has duplicate value ${String(st)}`);j.set(st,tt)}}return new cu({typeName:Yt.ZodDiscriminatedUnion,discriminator:a,options:h,optionsMap:j,...cr(_)})}}function Gl(d,a){const h=Kn(d),_=Kn(a);if(d===a)return{valid:!0,data:d};if(h===Ot.object&&_===Ot.object){const j=yr.objectKeys(a),tt=yr.objectKeys(d).filter(st=>j.indexOf(st)!==-1),rt={...d,...a};for(const st of tt){const dt=Gl(d[st],a[st]);if(!dt.valid)return{valid:!1};rt[st]=dt.data}return{valid:!0,data:rt}}if(h===Ot.array&&_===Ot.array){if(d.length!==a.length)return{valid:!1};const j=[];for(let tt=0;tt<d.length;tt++){const rt=Gl(d[tt],a[tt]);if(!rt.valid)return{valid:!1};j.push(rt.data)}return{valid:!0,data:j}}return h===Ot.date&&_===Ot.date&&+d==+a?{valid:!0,data:d}:{valid:!1}}class ss extends sr{_parse(a){const{status:h,ctx:_}=this._processInputParams(a),j=(tt,rt)=>{if(Ql(tt)||Ql(rt))return Xt;const st=Gl(tt.value,rt.value);return st.valid?((Kl(tt)||Kl(rt))&&h.dirty(),{status:h.value,value:st.data}):(Ft(_,{code:Nt.invalid_intersection_types}),Xt)};return _.common.async?Promise.all([this._def.left._parseAsync({data:_.data,path:_.path,parent:_}),this._def.right._parseAsync({data:_.data,path:_.path,parent:_})]).then(([tt,rt])=>j(tt,rt)):j(this._def.left._parseSync({data:_.data,path:_.path,parent:_}),this._def.right._parseSync({data:_.data,path:_.path,parent:_}))}}ss.create=(d,a,h)=>new ss({left:d,right:a,typeName:Yt.ZodIntersection,...cr(h)});class _n extends sr{_parse(a){const{status:h,ctx:_}=this._processInputParams(a);if(_.parsedType!==Ot.array)return Ft(_,{code:Nt.invalid_type,expected:Ot.array,received:_.parsedType}),Xt;if(_.data.length<this._def.items.length)return Ft(_,{code:Nt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Xt;!this._def.rest&&_.data.length>this._def.items.length&&(Ft(_,{code:Nt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),h.dirty());const j=_.data.map((tt,rt)=>{const st=this._def.items[rt]||this._def.rest;return st?st._parse(new xn(_,tt,_.path,rt)):null}).filter(tt=>!!tt);return _.common.async?Promise.all(j).then(tt=>Zr.mergeArray(h,tt)):Zr.mergeArray(h,j)}get items(){return this._def.items}rest(a){return new _n({...this._def,rest:a})}}_n.create=(d,a)=>{if(!Array.isArray(d))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new _n({items:d,typeName:Yt.ZodTuple,rest:null,...cr(a)})};class uu extends sr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){const{status:h,ctx:_}=this._processInputParams(a);if(_.parsedType!==Ot.object)return Ft(_,{code:Nt.invalid_type,expected:Ot.object,received:_.parsedType}),Xt;const j=[],tt=this._def.keyType,rt=this._def.valueType;for(const st in _.data)j.push({key:tt._parse(new xn(_,st,_.path,st)),value:rt._parse(new xn(_,_.data[st],_.path,st))});return _.common.async?Zr.mergeObjectAsync(h,j):Zr.mergeObjectSync(h,j)}get element(){return this._def.valueType}static create(a,h,_){return new uu(h instanceof sr?{keyType:a,valueType:h,typeName:Yt.ZodRecord,...cr(_)}:{keyType:In.create(),valueType:a,typeName:Yt.ZodRecord,...cr(h)})}}class lu extends sr{_parse(a){const{status:h,ctx:_}=this._processInputParams(a);if(_.parsedType!==Ot.map)return Ft(_,{code:Nt.invalid_type,expected:Ot.map,received:_.parsedType}),Xt;const j=this._def.keyType,tt=this._def.valueType,rt=[..._.data.entries()].map(([st,dt],ht)=>({key:j._parse(new xn(_,st,_.path,[ht,"key"])),value:tt._parse(new xn(_,dt,_.path,[ht,"value"]))}));if(_.common.async){const st=new Map;return Promise.resolve().then(async()=>{for(const dt of rt){const ht=await dt.key,mt=await dt.value;if(ht.status==="aborted"||mt.status==="aborted")return Xt;ht.status!=="dirty"&&mt.status!=="dirty"||h.dirty(),st.set(ht.value,mt.value)}return{status:h.value,value:st}})}{const st=new Map;for(const dt of rt){const ht=dt.key,mt=dt.value;if(ht.status==="aborted"||mt.status==="aborted")return Xt;ht.status!=="dirty"&&mt.status!=="dirty"||h.dirty(),st.set(ht.value,mt.value)}return{status:h.value,value:st}}}}lu.create=(d,a,h)=>new lu({valueType:a,keyType:d,typeName:Yt.ZodMap,...cr(h)});class co extends sr{_parse(a){const{status:h,ctx:_}=this._processInputParams(a);if(_.parsedType!==Ot.set)return Ft(_,{code:Nt.invalid_type,expected:Ot.set,received:_.parsedType}),Xt;const j=this._def;j.minSize!==null&&_.data.size<j.minSize.value&&(Ft(_,{code:Nt.too_small,minimum:j.minSize.value,type:"set",inclusive:!0,exact:!1,message:j.minSize.message}),h.dirty()),j.maxSize!==null&&_.data.size>j.maxSize.value&&(Ft(_,{code:Nt.too_big,maximum:j.maxSize.value,type:"set",inclusive:!0,exact:!1,message:j.maxSize.message}),h.dirty());const tt=this._def.valueType;function rt(dt){const ht=new Set;for(const mt of dt){if(mt.status==="aborted")return Xt;mt.status==="dirty"&&h.dirty(),ht.add(mt.value)}return{status:h.value,value:ht}}const st=[..._.data.values()].map((dt,ht)=>tt._parse(new xn(_,dt,_.path,ht)));return _.common.async?Promise.all(st).then(dt=>rt(dt)):rt(st)}min(a,h){return new co({...this._def,minSize:{value:a,message:lr.toString(h)}})}max(a,h){return new co({...this._def,maxSize:{value:a,message:lr.toString(h)}})}size(a,h){return this.min(a,h).max(a,h)}nonempty(a){return this.min(1,a)}}co.create=(d,a)=>new co({valueType:d,minSize:null,maxSize:null,typeName:Yt.ZodSet,...cr(a)});class Co extends sr{constructor(){super(...arguments),this.validate=this.implement}_parse(a){const{ctx:h}=this._processInputParams(a);if(h.parsedType!==Ot.function)return Ft(h,{code:Nt.invalid_type,expected:Ot.function,received:h.parsedType}),Xt;function _(st,dt){return tu({data:st,path:h.path,errorMaps:[h.common.contextualErrorMap,h.schemaErrorMap,eu(),Xo].filter(ht=>!!ht),issueData:{code:Nt.invalid_arguments,argumentsError:dt}})}function j(st,dt){return tu({data:st,path:h.path,errorMaps:[h.common.contextualErrorMap,h.schemaErrorMap,eu(),Xo].filter(ht=>!!ht),issueData:{code:Nt.invalid_return_type,returnTypeError:dt}})}const tt={errorMap:h.common.contextualErrorMap},rt=h.data;return this._def.returns instanceof Po?Qr(async(...st)=>{const dt=new An([]),ht=await this._def.args.parseAsync(st,tt).catch(kt=>{throw dt.addIssue(_(st,kt)),dt}),mt=await rt(...ht);return await this._def.returns._def.type.parseAsync(mt,tt).catch(kt=>{throw dt.addIssue(j(mt,kt)),dt})}):Qr((...st)=>{const dt=this._def.args.safeParse(st,tt);if(!dt.success)throw new An([_(st,dt.error)]);const ht=rt(...dt.data),mt=this._def.returns.safeParse(ht,tt);if(!mt.success)throw new An([j(ht,mt.error)]);return mt.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new Co({...this._def,args:_n.create(a).rest(ao.create())})}returns(a){return new Co({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,h,_){return new Co({args:a||_n.create([]).rest(ao.create()),returns:h||ao.create(),typeName:Yt.ZodFunction,...cr(_)})}}class as extends sr{get schema(){return this._def.getter()}_parse(a){const{ctx:h}=this._processInputParams(a);return this._def.getter()._parse({data:h.data,path:h.path,parent:h})}}as.create=(d,a)=>new as({getter:d,typeName:Yt.ZodLazy,...cr(a)});class cs extends sr{_parse(a){return a.data!==this._def.value?(Ft(this._getOrReturnCtx(a),{code:Nt.invalid_literal,expected:this._def.value}),Xt):{status:"valid",value:a.data}}get value(){return this._def.value}}function vm(d,a){return new us({values:d,typeName:Yt.ZodEnum,...cr(a)})}cs.create=(d,a)=>new cs({value:d,typeName:Yt.ZodLiteral,...cr(a)});class us extends sr{_parse(a){if(typeof a.data!="string"){const h=this._getOrReturnCtx(a),_=this._def.values;return Ft(h,{expected:yr.joinValues(_),received:h.parsedType,code:Nt.invalid_type}),Xt}if(this._def.values.indexOf(a.data)===-1){const h=this._getOrReturnCtx(a),_=this._def.values;return Ft(h,{received:h.data,code:Nt.invalid_enum_value,options:_}),Xt}return Qr(a.data)}get options(){return this._def.values}get enum(){const a={};for(const h of this._def.values)a[h]=h;return a}get Values(){const a={};for(const h of this._def.values)a[h]=h;return a}get Enum(){const a={};for(const h of this._def.values)a[h]=h;return a}}us.create=vm;class ls extends sr{_parse(a){const h=yr.getValidEnumValues(this._def.values),_=this._getOrReturnCtx(a);if(_.parsedType!==Ot.string&&_.parsedType!==Ot.number){const j=yr.objectValues(h);return Ft(_,{expected:yr.joinValues(j),received:_.parsedType,code:Nt.invalid_type}),Xt}if(h.indexOf(a.data)===-1){const j=yr.objectValues(h);return Ft(_,{received:_.data,code:Nt.invalid_enum_value,options:j}),Xt}return Qr(a.data)}get enum(){return this._def.values}}ls.create=(d,a)=>new ls({values:d,typeName:Yt.ZodNativeEnum,...cr(a)});class Po extends sr{_parse(a){const{ctx:h}=this._processInputParams(a);if(h.parsedType!==Ot.promise&&h.common.async===!1)return Ft(h,{code:Nt.invalid_type,expected:Ot.promise,received:h.parsedType}),Xt;const _=h.parsedType===Ot.promise?h.data:Promise.resolve(h.data);return Qr(_.then(j=>this._def.type.parseAsync(j,{path:h.path,errorMap:h.common.contextualErrorMap})))}}Po.create=(d,a)=>new Po({type:d,typeName:Yt.ZodPromise,...cr(a)});class hn extends sr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Yt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){const{status:h,ctx:_}=this._processInputParams(a),j=this._def.effect||null;if(j.type==="preprocess"){const rt=j.transform(_.data);return _.common.async?Promise.resolve(rt).then(st=>this._def.schema._parseAsync({data:st,path:_.path,parent:_})):this._def.schema._parseSync({data:rt,path:_.path,parent:_})}const tt={addIssue:rt=>{Ft(_,rt),rt.fatal?h.abort():h.dirty()},get path(){return _.path}};if(tt.addIssue=tt.addIssue.bind(tt),j.type==="refinement"){const rt=st=>{const dt=j.refinement(st,tt);if(_.common.async)return Promise.resolve(dt);if(dt instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return st};if(_.common.async===!1){const st=this._def.schema._parseSync({data:_.data,path:_.path,parent:_});return st.status==="aborted"?Xt:(st.status==="dirty"&&h.dirty(),rt(st.value),{status:h.value,value:st.value})}return this._def.schema._parseAsync({data:_.data,path:_.path,parent:_}).then(st=>st.status==="aborted"?Xt:(st.status==="dirty"&&h.dirty(),rt(st.value).then(()=>({status:h.value,value:st.value}))))}if(j.type==="transform"){if(_.common.async===!1){const rt=this._def.schema._parseSync({data:_.data,path:_.path,parent:_});if(!ru(rt))return rt;const st=j.transform(rt.value,tt);if(st instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:h.value,value:st}}return this._def.schema._parseAsync({data:_.data,path:_.path,parent:_}).then(rt=>ru(rt)?Promise.resolve(j.transform(rt.value,tt)).then(st=>({status:h.value,value:st})):rt)}yr.assertNever(j)}}hn.create=(d,a,h)=>new hn({schema:d,typeName:Yt.ZodEffects,effect:a,...cr(h)}),hn.createWithPreprocess=(d,a,h)=>new hn({schema:a,effect:{type:"preprocess",transform:d},typeName:Yt.ZodEffects,...cr(h)});class Sn extends sr{_parse(a){return this._getType(a)===Ot.undefined?Qr(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}Sn.create=(d,a)=>new Sn({innerType:d,typeName:Yt.ZodOptional,...cr(a)});class uo extends sr{_parse(a){return this._getType(a)===Ot.null?Qr(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}uo.create=(d,a)=>new uo({innerType:d,typeName:Yt.ZodNullable,...cr(a)});class ds extends sr{_parse(a){const{ctx:h}=this._processInputParams(a);let _=h.data;return h.parsedType===Ot.undefined&&(_=this._def.defaultValue()),this._def.innerType._parse({data:_,path:h.path,parent:h})}removeDefault(){return this._def.innerType}}ds.create=(d,a)=>new ds({innerType:d,typeName:Yt.ZodDefault,defaultValue:typeof a.default=="function"?a.default:()=>a.default,...cr(a)});class du extends sr{_parse(a){const{ctx:h}=this._processInputParams(a),_=this._def.innerType._parse({data:h.data,path:h.path,parent:h});return nu(_)?_.then(j=>({status:"valid",value:j.status==="valid"?j.value:this._def.defaultValue()})):{status:"valid",value:_.status==="valid"?_.value:this._def.defaultValue()}}removeDefault(){return this._def.innerType}}du.create=(d,a)=>new du({innerType:d,typeName:Yt.ZodCatch,defaultValue:typeof a.default=="function"?a.default:()=>a.default,...cr(a)});class fu extends sr{_parse(a){if(this._getType(a)!==Ot.nan){const h=this._getOrReturnCtx(a);return Ft(h,{code:Nt.invalid_type,expected:Ot.nan,received:h.parsedType}),Xt}return{status:"valid",value:a.data}}}fu.create=d=>new fu({typeName:Yt.ZodNaN,...cr(d)});const tE=Symbol("zod_brand");class bm extends sr{_parse(a){const{ctx:h}=this._processInputParams(a),_=h.data;return this._def.type._parse({data:_,path:h.path,parent:h})}unwrap(){return this._def.type}}class fs extends sr{_parse(a){const{status:h,ctx:_}=this._processInputParams(a);if(_.common.async)return(async()=>{const j=await this._def.in._parseAsync({data:_.data,path:_.path,parent:_});return j.status==="aborted"?Xt:j.status==="dirty"?(h.dirty(),gm(j.value)):this._def.out._parseAsync({data:j.value,path:_.path,parent:_})})();{const j=this._def.in._parseSync({data:_.data,path:_.path,parent:_});return j.status==="aborted"?Xt:j.status==="dirty"?(h.dirty(),{status:"dirty",value:j.value}):this._def.out._parseSync({data:j.value,path:_.path,parent:_})}}static create(a,h){return new fs({in:a,out:h,typeName:Yt.ZodPipeline})}}const km=(d,a={},h)=>d?$o.create().superRefine((_,j)=>{if(!d(_)){const tt=typeof a=="function"?a(_):a,rt=typeof tt=="string"?{message:tt}:tt;j.addIssue({code:"custom",...rt,fatal:h})}}):$o.create(),rE={object:Tr.lazycreate};var Yt;(function(d){d.ZodString="ZodString",d.ZodNumber="ZodNumber",d.ZodNaN="ZodNaN",d.ZodBigInt="ZodBigInt",d.ZodBoolean="ZodBoolean",d.ZodDate="ZodDate",d.ZodSymbol="ZodSymbol",d.ZodUndefined="ZodUndefined",d.ZodNull="ZodNull",d.ZodAny="ZodAny",d.ZodUnknown="ZodUnknown",d.ZodNever="ZodNever",d.ZodVoid="ZodVoid",d.ZodArray="ZodArray",d.ZodObject="ZodObject",d.ZodUnion="ZodUnion",d.ZodDiscriminatedUnion="ZodDiscriminatedUnion",d.ZodIntersection="ZodIntersection",d.ZodTuple="ZodTuple",d.ZodRecord="ZodRecord",d.ZodMap="ZodMap",d.ZodSet="ZodSet",d.ZodFunction="ZodFunction",d.ZodLazy="ZodLazy",d.ZodLiteral="ZodLiteral",d.ZodEnum="ZodEnum",d.ZodEffects="ZodEffects",d.ZodNativeEnum="ZodNativeEnum",d.ZodOptional="ZodOptional",d.ZodNullable="ZodNullable",d.ZodDefault="ZodDefault",d.ZodCatch="ZodCatch",d.ZodPromise="ZodPromise",d.ZodBranded="ZodBranded",d.ZodPipeline="ZodPipeline"})(Yt||(Yt={}));const Em=In.create,xm=Gn.create,nE=fu.create,iE=es.create,_m=ts.create,oE=so.create,sE=iu.create,aE=rs.create,cE=ns.create,uE=$o.create,lE=ao.create,dE=Nn.create,fE=ou.create,hE=fn.create,pE=Tr.create,yE=Tr.strictCreate,gE=os.create,mE=cu.create,wE=ss.create,vE=_n.create,bE=uu.create,kE=lu.create,EE=co.create,xE=Co.create,_E=as.create,SE=cs.create,$E=us.create,TE=ls.create,CE=Po.create,Sm=hn.create,PE=Sn.create,AE=uo.create,IE=hn.createWithPreprocess,NE=fs.create;var Vr=Object.freeze({__proto__:null,defaultErrorMap:Xo,setErrorMap:function(d){ym=d},getErrorMap:eu,makeIssue:tu,EMPTY_PATH:[],addIssueToContext:Ft,ParseStatus:Zr,INVALID:Xt,DIRTY:gm,OK:Qr,isAborted:Ql,isDirty:Kl,isValid:ru,isAsync:nu,get util(){return yr},ZodParsedType:Ot,getParsedType:Kn,ZodType:sr,ZodString:In,ZodNumber:Gn,ZodBigInt:es,ZodBoolean:ts,ZodDate:so,ZodSymbol:iu,ZodUndefined:rs,ZodNull:ns,ZodAny:$o,ZodUnknown:ao,ZodNever:Nn,ZodVoid:ou,ZodArray:fn,get objectUtil(){return su},ZodObject:Tr,ZodUnion:os,ZodDiscriminatedUnion:cu,ZodIntersection:ss,ZodTuple:_n,ZodRecord:uu,ZodMap:lu,ZodSet:co,ZodFunction:Co,ZodLazy:as,ZodLiteral:cs,ZodEnum:us,ZodNativeEnum:ls,ZodPromise:Po,ZodEffects:hn,ZodTransformer:hn,ZodOptional:Sn,ZodNullable:uo,ZodDefault:ds,ZodCatch:du,ZodNaN:fu,BRAND:tE,ZodBranded:bm,ZodPipeline:fs,custom:km,Schema:sr,ZodSchema:sr,late:rE,get ZodFirstPartyTypeKind(){return Yt},coerce:{string:d=>In.create({...d,coerce:!0}),number:d=>Gn.create({...d,coerce:!0}),boolean:d=>ts.create({...d,coerce:!0}),bigint:d=>es.create({...d,coerce:!0}),date:d=>so.create({...d,coerce:!0})},any:uE,array:hE,bigint:iE,boolean:_m,date:oE,discriminatedUnion:mE,effect:Sm,enum:$E,function:xE,instanceof:(d,a={message:`Input not instance of ${d.name}`})=>km(h=>h instanceof d,a,!0),intersection:wE,lazy:_E,literal:SE,map:kE,nan:nE,nativeEnum:TE,never:dE,null:cE,nullable:AE,number:xm,object:pE,oboolean:()=>_m().optional(),onumber:()=>xm().optional(),optional:PE,ostring:()=>Em().optional(),pipeline:NE,preprocess:IE,promise:CE,record:bE,set:EE,strictObject:yE,string:Em,symbol:sE,transformer:Sm,tuple:vE,undefined:aE,union:gE,unknown:lE,void:fE,NEVER:Xt,ZodIssueCode:Nt,quotelessJson:d=>JSON.stringify(d,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:An});const DE=Vr.enum(["awake/init","awake/res","awake/msg"]),$m=Vr.object({awv:Vr.literal("0.1.0"),type:DE}),LE=Vr.object({did:Vr.string().startsWith("did:",{message:"should be a DID `did:key:z...`"}),sig:Vr.string()}).strict(),RE=Vr.object({"awake/ack":Vr.string().startsWith("did:",{message:"should be a DID `did:key:z...`"})}).strict();$m.extend({type:Vr.literal("awake/init"),did:Vr.string().startsWith("did:",{message:"should be a DID `did:key:z...`"}),caps:Vr.array(Vr.object({with:Vr.string(),can:Vr.string()})).nonempty()}).strict();const Tm=Vr.string().startsWith("did:",{message:"should be a DID `did:key:z...`"});$m.extend({type:Vr.literal("awake/res"),iss:Tm,aud:Tm,msg:Vr.string().min(1)}).strict();class OE{constructor(a){this.channel=a.channel,this.agent=a.agent,this.did=a.agent.did(),this.challenge=void 0,this.nextdid=void 0,this.audience=void 0,this.pin=Math.floor(1e6*Math.random())}async bootstrap(a){this.channel.sendInit(a);const{ucan:h}=await this.channel.awaitRes(),_=Cm(h.facts,"awake/challenge");if(this.nextdid=bn(Cm(h.facts,"awake/nextdid")),_==="oob-pin")return await this.sendPinSignature(),this.pin.toString()}async awaitBootstrap(){const a=await this.channel.awaitInit();this.nextdid=a.did;const h=await ty({issuer:this.agent.issuer,audience:this.nextdid,capabilities:[{with:"awake:",can:"*"}],facts:[{"awake/challenge":"oob-pin"},{"awake/nextdid":this.channel.keypair.did}]});await this.channel.sendRes(this.nextdid,h);const _=await this.channel.awaitMsg(this.nextdid),{did:j,sig:tt}=LE.parse(_.msg);this.audience=bn(j),this.challenge=tt}async ack(a){if(!this.challenge||!this.nextdid||!this.audience)throw new Error("No challenge active.");const h=$a(this.challenge,"base64"),_=Yy(this.audience.did()),j=$a(this.channel.keypair.did+a),tt=await rr.encode(j);if(!await _.verify(tt,Hu(h)))throw new Error(`Challenge failed: ${a} is not valid for the current challenge.`);await this.channel.sendMsg(this.nextdid,{"awake/ack":this.did})}async awaitAck(){if(!this.nextdid)throw new Error("No session is active. await ack");const a=await this.channel.awaitMsg(this.nextdid),h=RE.parse(a.msg);this.audience=bn(h["awake/ack"])}async link(a){if(!this.nextdid||!this.audience)throw new Error("No session is active. request link");const h={type:"link",meta:a.meta,caps:a.caps};this.channel.sendMsg(this.nextdid,h);const _=await this.channel.awaitMsg(this.nextdid),j=hm(_.msg.delegation);return await this.channel.sendFin(this.nextdid),await this.agent.addProof(j[0]),{delegation:j[0],meta:_.msg.meta}}async awaitLink(){if(!this.nextdid||!this.audience)throw new Error("No challenge active.");const a=await this.channel.awaitMsg(this.nextdid),h=await this.agent.delegate({abilities:["*"],audience:this.audience,expiration:1/0,audienceMeta:a.msg.meta});this.channel.subscribe("awake/msg",_=>{this.channel.close()}),this.channel.sendMsg(this.nextdid,{meta:{name:this.agent.did(),type:"device"},delegation:Y0([h])})}async sendPinSignature(){if(!this.nextdid)throw new Error("No session is active.");const a=$a(this.nextdid.did()+this.pin.toString()),h=await this.agent.issuer.sign(await rr.encode(a));this.channel.sendMsg(this.nextdid,{did:this.did,sig:lm(h,"base64")})}}function Cm(d,a){for(const h of d)if(h[a])return h[a]}function kr(d,a){return d.with===a.with||new Gr(`Can not derive ${d.can} with ${d.with} from ${a.with}`)}function Dn(d,a,h){return a===void 0||a==="*"||String(d)===String(a)||new Gr(`Constrain violation: ${d} violates imposed ${h} constraint ${a}`)}const Pm=(d,a)=>d.with!==a.with?new Gr(`Expected 'with: "${a.with}"' instead got '${d.with}'`):!a.nb.link||`${a.nb.link}`==`${d.nb.link}`||new Gr(`Link ${d.nb.link?`${d.nb.link}`:""} violates imposed ${a.nb.link} constraint.`);function qr(d){return d===!0?void 0:d}function Am(d){const[a,...h]=d.split("/");return{namespace:a,segments:h}}function jE(d,a){const h=Am(d),_=Am(a);return h.namespace==="*"&&h.segments.length===0||(_.namespace!=="*"||_.segments.length!==0)&&h.namespace===_.namespace&&(h.segments[0]==="*"||h.segments.length===_.segments.length&&h.segments.reduce((j,tt,rt)=>j&&_.segments[rt]===tt,!0))}const Ln=zr({can:"*",with:Nr({protocol:"did:"}),derives:kr}),BE=Ln.derive({to:zr({can:"store/*",with:Nr({protocol:"did:"}),derives:kr}),derives:kr}),Zl=Ln.or(BE),Im=Zl.derive({to:zr({can:"store/add",with:Nr({protocol:"did:"}),nb:{link:Ys,size:Pl(),origin:My()},derives:(d,a)=>{const h=Pm(d,a);return h.error?h:d.nb.size===void 0||a.nb.size===void 0||!(d.nb.size>a.nb.size)||new Gr(`Size constraint violation: ${d.nb.size} > ${a.nb.size}`)}}),derives:kr}),Nm=Zl.derive({to:zr({can:"store/remove",with:Nr({protocol:"did:"}),nb:{link:Ys},derives:Pm}),derives:kr}),Dm=Zl.derive({to:zr({can:"store/list",with:Nr({protocol:"did:"}),nb:{cursor:Zs().optional(),size:Pl().optional(),pre:Ay().optional()},derives:(d,a)=>d.with===a.with||new Gr(`Expected 'with: "${a.with}"' instead got '${d.with}'`)}),derives:kr});Im.or(Nm).or(Dm);const ME=Ln.derive({to:zr({can:"upload/*",with:Nr({protocol:"did:"}),derives:kr}),derives:kr}),Jl=Ln.or(ME),UE=By({code:514,version:1}),Lm=Jl.derive({to:zr({can:"upload/add",with:Nr({protocol:"did:"}),nb:{root:Ys,shards:UE.array().optional()},derives:(d,a)=>qr(kr(d,a))||qr(Dn(d.nb.root,a.nb.root,"root"))||qr(Dn(d.nb.shards,a.nb.shards,"shards"))||!0}),derives:kr}),Rm=Jl.derive({to:zr({can:"upload/remove",with:Nr({protocol:"did:"}),nb:{root:Ys},derives:(d,a)=>qr(kr(d,a))||qr(Dn(d.nb.root,a.nb.root,"root"))||!0}),derives:kr}),Om=Jl.derive({to:zr({can:"upload/list",with:Nr({protocol:"did:"}),nb:{cursor:Zs().optional(),size:Pl().optional(),pre:Ay().optional()}}),derives:kr});Lm.or(Rm).or(Om);const zE=Ln.derive({to:zr({can:"space/*",with:Nr({protocol:"did:"}),derives:kr}),derives:kr}),Yl=Ln.or(zE),FE=Yl.or(Im).or(Dm).or(Nm).or(Lm).or(Om).or(Rm).derive({to:zr({can:"space/info",with:Nr({protocol:"did:"}),derives:kr}),derives:kr}),WE=Yl.derive({to:zr({can:"space/recover-validation",with:Nr({protocol:"did:"}),nb:{identity:Nr({protocol:"mailto:"})},derives:kr}),derives:kr}),VE=Yl.derive({to:zr({can:"space/recover",with:Nr({protocol:"did:"}),nb:{identity:Nr({protocol:"mailto:"})},derives:(d,a)=>qr(kr(d,a))||qr(function(h,_){return _===void 0||(h!==void 0&&_.endsWith("*")?!!h.startsWith(_.slice(0,-1))||new Gr(`${h} does not match ${_}`):h===_||new Gr(`${h} is different from ${_}`))}(d.nb.identity,a.nb.identity))||!0}),derives:kr}),jm=Oy,Bm=Nr({protocol:"mailto:"}),HE=Al({}),Mm=Ln.derive({to:zr({can:"voucher/*",with:Nr({protocol:"did:"}),derives:kr}),derives:kr}),QE=Ln.or(Mm).derive({to:zr({can:"voucher/claim",with:Nr({protocol:"did:"}),nb:{product:jm,identity:Bm,service:HE.optional()},derives:(d,a)=>qr(kr(d,a))||qr(Dn(d.nb.product,a.nb.product,"product"))||qr(Dn(d.nb.identity,a.nb.identity,"identity"))||qr(Dn(d.nb.service,a.nb.service,"service"))||!0}),derives:kr}),KE=Mm.derive({to:zr({can:"voucher/redeem",with:Nr({protocol:"did:"}),nb:{product:jm,identity:Bm,space:Nr({protocol:"did:"})},derives:(d,a)=>qr(kr(d,a))||qr(Dn(d.nb.product,a.nb.product,"product"))||qr(Dn(d.nb.identity,a.nb.identity,"identity"))||qr(Dn(d.nb.space,a.nb.space,"account"))||!0}),derives:kr});var Ao=null;typeof WebSocket<"u"?Ao=WebSocket:typeof MozWebSocket<"u"?Ao=MozWebSocket:typeof commonjsGlobal<"u"?Ao=commonjsGlobal.WebSocket||commonjsGlobal.MozWebSocket:typeof window<"u"?Ao=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Ao=self.WebSocket||self.MozWebSocket);var GE=Ao;class ZE extends Error{constructor(a){super(a),this.name="TimeoutError"}}class qE extends Error{constructor(a){super(),this.name="AbortError",this.message=a}}const Um=d=>globalThis.DOMException===void 0?new qE(d):new DOMException(d),zm=d=>{const a=d.reason===void 0?Um("This operation was aborted."):d.reason;return a instanceof Error?a:Um(a)},Xl=Symbol("resolveValue");async function _d(d,a={}){const{interval:h=20,timeout:_=Number.POSITIVE_INFINITY,before:j=!0}=a;let tt;const rt=new Promise((st,dt)=>{const ht=async()=>{try{const mt=await d();if(typeof mt=="object"&&mt[Xl])st(mt[Xl]);else{if(typeof mt!="boolean")throw new TypeError("Expected condition to return a boolean");mt===!0?st():tt=setTimeout(ht,h)}}catch(mt){dt(mt)}};j?ht():tt=setTimeout(ht,h)});if(_===Number.POSITIVE_INFINITY)return rt;try{return await function(st,dt){const{milliseconds:ht,fallback:mt,message:kt,customTimers:_t={setTimeout,clearTimeout}}=dt;let Lt;const Ut=new Promise((Zt,fr)=>{if(typeof ht!="number"||Math.sign(ht)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${ht}\``);if(ht!==Number.POSITIVE_INFINITY){if(dt.signal){const{signal:Gt}=dt;Gt.aborted&&fr(zm(Gt)),Gt.addEventListener("abort",()=>{fr(zm(Gt))})}Lt=_t.setTimeout.call(void 0,()=>{if(mt){try{Zt(mt())}catch(tr){fr(tr)}return}const Gt=kt instanceof Error?kt:new ZE(typeof kt=="string"?kt:`Promise timed out after ${ht} milliseconds`);typeof st.cancel=="function"&&st.cancel(),fr(Gt)},ht),(async()=>{try{Zt(await st)}catch(Gt){fr(Gt)}finally{_t.clearTimeout.call(void 0,Lt)}})()}else Zt(st)});return Ut.clear=()=>{_t.clearTimeout.call(void 0,Lt),Lt=void 0},Ut}(rt,typeof _=="number"?{milliseconds:_}:_)}finally{clearTimeout(tt)}}_d.resolveWith=d=>({[Xl]:d});class JE{constructor(a,h){vr(this,On,void 0);this.url=new URL(h,a),a.protocol==="http:"&&(this.url.protocol="ws:"),a.protocol==="https:"&&(this.url.protocol="wss:"),this.ws=void 0,an(this,On,new Map),this.attemps=0,this.onMessage=void 0,this.timeout=void 0,this.forceClose=!1}async open(){return this.ws=this.connect(),await _d(()=>{var a;return((a=this.ws)==null?void 0:a.readyState)===1}),this}connect(){if(this.attemps>10)return;const a=new GE(this.url);return this.ws=a,a.addEventListener("close",h=>{this.forceClose||this.timeout?(clearTimeout(this.timeout),this.timeout=void 0):(this.timeout=setTimeout(()=>{this.attemps++,this.connect()},1e3),console.log("WebSocket closed, reconnecting:",h.code,h.reason))}),a.addEventListener("error",h=>{}),a.addEventListener("open",h=>{clearTimeout(this.timeout),this.timeout=void 0}),a.addEventListener("message",h=>{const _=JSON.parse(h.data);_.error&&console.error(_.error),_.type&&this.publish(_),this.onMessage!==void 0&&_.type&&this.onMessage(_)}),a}async close(a,h){return this.ws&&(this.forceClose=!0,this.ws.close(a,h),await _d(()=>{var _;return((_=this.ws)==null?void 0:_.readyState)===3})),this}send(a){var h;if(((h=this.ws)==null?void 0:h.readyState)!==1)throw new Error("Websocket is not active.");this.ws.send(JSON.stringify(a))}subscribe(a,h,_){let j=jt(this,On).get(a),tt=h;return _&&(tt=rt=>{j==null||j.splice(j.indexOf(tt)>>>0,1),Reflect.apply(h,this,[rt])}),j?j.push(tt):(j=[tt],jt(this,On).set(a,j)),()=>{j==null||j.splice(j.indexOf(tt)>>>0,1)}}unsubscribe(a,h){const _=jt(this,On).get(a);_&&(h?_.splice(_.indexOf(h)>>>0,1):jt(this,On).set(a,[]))}publish(a){var j;const{type:h}=a,_=(j=jt(this,On).get(h))==null?void 0:j.slice();if(_)for(const tt of _)tt(a)}awaitMsg(a){return new Promise((h,_)=>{a!=null&&a.signal&&a.signal.addEventListener("abort",()=>{var j;this.onMessage=void 0,_(new hs("Await message cancelled.",{cause:(j=a.signal)==null?void 0:j.reason}))}),this.onMessage=j=>{try{this.onMessage=void 0,h(j)}catch(tt){_(tt)}}})}}On=new WeakMap;class hs extends Error{constructor(a,h){super(a,h),this.name="AbortError",this.message=a,this.code=hs.code}}hs.code="ERR_AWAIT_MSG_CANCEL";const lo=(globalThis||window||self).crypto,_f=(d,a)=>{const h=Rt(d),_=new Uint8Array(a.byteLength+h);return Pt(d,_,0),_.set(a,h),_},_h=(d,a,h=0)=>{const _=h!==0?a.subarray(h):a,[j,tt]=At(_);if(j!==d)throw new Error(`Expected multiformat with 0x${d.toString(16)} tag instead got 0x${j.toString(16)}`);return new Uint8Array(_.buffer,_.byteOffset+tt)},hu=d=>{if(d<=127)return new Uint8Array([d]);const a=[];for(;d!==0;)a.push(255&d),d>>>=8;return a.reverse(),new Uint8Array([128|255&a.length,...a])},Fm=(d,a,h)=>{const _=Io(d,a,h);return _.position+_.length},Io=(d,a,h)=>{const _=d[h];if(_!==a)throw new Error(`ASN parsing error: Expected tag 0x${a.toString(16)} at position ${h}, but got 0x${_.toString(16)}.`);const j=((tt,rt=0)=>{if(!(128&tt[rt]))return{number:tt[rt],consumed:1};const st=127&tt[rt];if(tt.length<st+1)throw new Error(`ASN parsing error: Too few bytes. Expected encoded length's length to be at least ${st}`);let dt=0;for(let ht=0;ht<st;ht++)dt<<=8,dt|=tt[rt+ht+1];return{number:dt,consumed:st+1}})(d,h+1);return{position:h+1+j.consumed,length:j.number}},YE=d=>{const a=hu(d.byteLength+1),h=new Uint8Array(1+a.byteLength+1+d.byteLength);let _=0;return h[_]=3,_+=1,h.set(a,_),_+=a.byteLength,h[_]=0,_+=1,h.set(d,_),h},XE=d=>{const a=hu(d.byteLength),h=new Uint8Array(1+a.byteLength+d.byteLength);let _=0;return h[_]=4,_+=1,h.set(a,_),_+=a.byteLength,h.set(d,_),h},ep=d=>{let a=0;for(const tt of d)a+=tt.byteLength;const h=hu(a),_=new Uint8Array(1+h.byteLength+a);let j=0;_[j]=48,j+=1,_.set(h,j),j+=h.byteLength;for(const tt of d)_.set(tt,j),j+=tt.byteLength;return _},Wm=d=>{const a=d.byteLength===0||128&d[0]?1:0,h=hu(d.byteLength+a),_=new Uint8Array(1+h.byteLength+d.byteLength+a);let j=0;return _[j]=2,j+=1,_.set(h,j),j+=h.byteLength,a>0&&(_[j]=0,j+=a),_.set(d,j),_},Vm=(d,a=0)=>Io(d,48,a).position,Hm=(d,a=0)=>Fm(d,48,a),Rn=(d,a=0)=>{const{position:h,length:_}=Io(d,2,a);let j=0;for(;d[h+j]===0;)j++;return new Uint8Array(d.buffer,d.byteOffset+h+j,_-j)},ex=(d,a,h=0)=>{const _=[],j=((rt,st=0)=>{const{position:dt,length:ht}=Io(rt,48,st);return new Uint8Array(rt.buffer,rt.byteOffset+dt,ht)})(a,h);let tt=0;for(const rt of d){const st=rt(j,tt);_.push(st),tt=st.byteOffset+st.byteLength-j.byteOffset}return _},tx=new Uint8Array([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]),rx=d=>{const a=Vm(d,0);return((h,_=0)=>{const{position:j,length:tt}=Io(h,3,_),rt=h[j];if(rt!==0)throw new Error(`Can not read bitstring, expected length to be multiple of 8, but got ${rt} unused bits in last byte.`);return new Uint8Array(h.buffer,h.byteOffset+j+1,tt-1)})(d,Hm(d,a))},nx=new Uint8Array([2,1,0,48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]),ix=d=>{let a=0;return a=Vm(d,a),a=((h,_=0)=>Fm(h,2,_))(d,a),a=Hm(d,a),((h,_=0)=>{const{position:j,length:tt}=Io(h,4,_);return new Uint8Array(h.buffer,h.byteOffset+j,tt)})(d,a)},ps=4869,pu=4613,ys=Fu,tp="RS256",yu="RSASSA-PKCS1-v1_5",rp="SHA-256",Qm={name:yu,hash:{name:rp}},Km=async({size:d=2048,extractable:a=!1}={})=>{const{publicKey:h,privateKey:_}=await lo.subtle.generateKey({name:yu,modulusLength:d,publicExponent:new Uint8Array([1,0,1]),hash:{name:rp}},a,["sign","verify"]),j=await lo.subtle.exportKey("spki",h),tt=_f(pu,rx(new Uint8Array(j))),rt=new fo({bytes:tt,publicKey:h});if(a){const st=await lo.subtle.exportKey("pkcs8",_),dt=_f(ps,ix(new Uint8Array(st)));return new Jm({privateKey:_,bytes:dt,verifier:rt})}return new Ym({privateKey:_,verifier:rt})},Gm=({id:d,keys:a})=>{if(d.startsWith("did:key:")){const h=d,_=a[h];return _ instanceof Uint8Array?Zm(_):new Ym({privateKey:_,verifier:fo.parse(h)})}throw new TypeError(`RSA can not import from ${d} archive, try generic Signer instead`)},Zm=d=>{const a=((j,tt=0)=>{const[rt,st,dt,ht,mt,kt,_t,Lt,Ut]=ex([Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn,Rn],j,tt);return{v:rt,n:st,e:dt,d:ht,p:mt,q:kt,dp:_t,dq:Lt,qi:Ut}})(_h(ps,d)),h=_f(pu,(({n:j,e:tt})=>ep([Wm(j),Wm(tt)]))(a));return new Jm({bytes:d,privateKey:lo.subtle.importKey("pkcs8",(_=_h(ps,d),ep([nx,XE(_)])),Qm,!0,["sign"]),verifier:fo.decode(h)});var _};class fo{constructor({publicKey:a,bytes:h}){this.publicKey=a,this.bytes=h}withDID(a){return zl(this,a)}toDIDKey(){return this.did()}static decode(a){return new this({bytes:a,publicKey:lo.subtle.importKey("spki",(h=_h(pu,a),ep([tx,YE(h)])),Qm,!0,["verify"])});var h}static parse(a){return fo.decode(bn(a))}static or(a){return Gy(this,a)}get code(){return pu}get signatureCode(){return ys}get signatureAlgorithm(){return tp}did(){return`did:key:${nn.encode(this.bytes)}`}async verify(a,h){return h.code===ys&&lo.subtle.verify({name:yu,hash:{name:rp}},await this.publicKey,h.raw,a)}}class qm{constructor({privateKey:a,verifier:h}){this.verifier=h,this.privateKey=a}get signer(){return this}get code(){return ps}get signatureCode(){return ys}get signatureAlgorithm(){return tp}did(){return this.verifier.did()}toDIDKey(){return this.verifier.toDIDKey()}verify(a,h){return this.verifier.verify(a,h)}async sign(a){const h=await lo.subtle.sign({name:yu,saltLength:128},await this.privateKey,a);return Vu(ys,new Uint8Array(h))}}class Jm extends qm{constructor(a){super(a),this.bytes=a.bytes}withDID(a){return xa(this,a)}toArchive(){const a=this.did();return{id:a,keys:{[a]:this.bytes}}}}class Ym extends qm{constructor(a){super(a),this.privateKey=a.privateKey}withDID(a){return xa(this,a)}toArchive(){const a=this.did();return{id:a,keys:{[a]:this.privateKey}}}}var ox=Object.freeze({__proto__:null,name:"RSA",code:ps,signatureCode:ys,signatureAlgorithm:tp,generate:Km,from:Gm,or:d=>_g({from:Gm},d),decode:Zm,Verifier:fo});const sx=Gy({parse:Yy},fo),ax=(d=>_g({from:x0},d))(ox);function np(d){return d.expiration===void 0||d.expiration<=Math.floor(Date.now()/1e3)}function Xm(d){return!!d.notBefore&&d.notBefore>Math.floor(Date.now()/1e3)}function ux(d,a){for(const h of d.capabilities)if(h.with===a.with&&jE(h.can,a.can))return!0;return!1}const xu=class{constructor(a,h={}){vr(this,Zn,void 0);this.meta=a.meta,this.principal=a.principal,this.spaces=a.spaces,this.delegations=a.delegations,this.currentSpace=a.currentSpace,an(this,Zn,_=>h.store?h.store.save(_):void 0)}static async create(a={},h={}){const _=new xu({meta:{name:"agent",type:"device",...a.meta},principal:a.principal??await rm(),spaces:a.spaces??new Map,delegations:a.delegations??new Map,currentSpace:a.currentSpace},h);return h.store&&await h.store.save(_.export()),_}static fromExport(a,h){const _=new Map;for(const[j,tt]of a.delegations)_.set(j,{delegation:Rv(tt.delegation.map(rt=>({cid:br.parse(rt.cid),bytes:rt.bytes}))),meta:tt.meta});return new xu({meta:a.meta,principal:ax.from(a.principal),currentSpace:a.currentSpace,spaces:a.spaces,delegations:_},h)}export(){const a={meta:this.meta,principal:this.principal.toArchive(),currentSpace:this.currentSpace,spaces:this.spaces,delegations:new Map};for(const[h,_]of this.delegations)a.delegations.set(h,{meta:_.meta,delegation:[..._.delegation.export()].map(j=>({cid:j.cid.toString(),bytes:j.bytes}))});return a}async addSpace(a,h,_){this.spaces.set(a,h),await(_?this.addDelegation(_):jt(this,Zn).call(this,this.export()))}async setCurrentSpace(a){this.currentSpace=a,await jt(this,Zn).call(this,this.export())}async addDelegation(a,h){this.delegations.set(a.cid.toString(),{delegation:a,meta:h??{}}),await jt(this,Zn).call(this,this.export())}async removeDelegation(a){this.delegations.delete(a.toString()),await jt(this,Zn).call(this,this.export())}};let gu=xu;Zn=new WeakMap;const ew="https://access.web3.storage",lx=bn("did:web:web3.storage");function dx(d={}){return(a=>new ar(a))({id:d.principal??lx,encoder:y1,decoder:w1,channel:d.channel??v1({url:d.url??new URL(ew),method:"POST",fetch:d.fetch??globalThis.fetch.bind(globalThis)})})}const _u=class{constructor(a,h={}){vr(this,vs);vr(this,bs);vr(this,_r,void 0);var j;const _=(j=h.connection)==null?void 0:j.channel;this.url=h.url??(_==null?void 0:_.url)??new URL(ew),this.connection=h.connection??dx({principal:h.servicePrincipal,url:this.url}),an(this,_r,a)}static async create(a,h={}){const _=await gu.create(a,h);return new _u(_,h)}static from(a,h={}){const _=gu.fromExport(a,h);return new _u(_,h)}get issuer(){return jt(this,_r).principal}get meta(){return jt(this,_r).meta}get spaces(){return jt(this,_r).spaces}did(){return jt(this,_r).principal.did()}async addProof(a){(function(h,_){const{checkAudience:j,checkIsExpired:tt=!0,checkIsTooEarly:rt=!0}=_??{};if(j&&h.audience.did()!==j.did())throw new Error("Delegation audience does not match required DID.");if(tt&&np(h))throw new Error("Delegation expired.");if(rt&&Xm(h))throw new Error("Delegation is not active yet (too early).")})(a,{checkAudience:this.issuer,checkIsExpired:!0}),await jt(this,_r).addDelegation(a,{audience:this.meta}),await this.removeExpiredDelegations()}async removeExpiredDelegations(){for(const[,a]of jt(this,_r).delegations)np(a.delegation)&&await jt(this,_r).removeDelegation(a.delegation.cid)}proofs(a){const h=[];for(const _ of Rr(this,vs,lp).call(this,a))_.delegation.audience.did()===this.issuer.did()&&h.push(_.delegation);return h}delegations(a){const h=[];for(const{delegation:_}of this.delegationsWithMeta(a))h.push(_);return h}delegationsWithMeta(a){const h=[];for(const _ of Rr(this,vs,lp).call(this,a))_.delegation.audience.did()!==this.issuer.did()&&h.push(_);return h}async createSpace(a){const h=await rm(),_=await Ln.delegate({issuer:h,audience:this.issuer,with:h.did(),expiration:1/0}),j={isRegistered:!1};if(a!=null){if(typeof a!="string")throw new TypeError("invalid name");j.name=a}return await jt(this,_r).addSpace(h.did(),j,_),{did:h.did(),meta:j,proof:_}}async importSpaceFromDelegation(a){if(a.capabilities[0].can!=="*")throw new Error("Space can only be import with full capabilities delegation.");const h=a.facts[0].space,_=a,j=sx.parse(_.capabilities[0].with).did();return jt(this,_r).spaces.set(j,h),await this.addProof(_),{did:j,meta:h,proof:_}}async recover(a,h){const _=await this.invokeAndExecute(WE,{with:xo(this.did()),nb:{identity:xo(`mailto:${a}`)}});if(_&&_.error)throw new Error("Recover validation failed",{cause:_});const j=await Rr(this,bs,dp).call(this,h);await this.addProof(j);const tt=await this.invokeAndExecute(VE,{with:xo(this.connection.id.did()),nb:{identity:xo(`mailto:${a}`)}});if(tt&&tt.error)throw new Error("Spaces recover failed",{cause:tt});const rt=[];for(const st of tt)rt.push(pm(st));return rt}async setCurrentSpace(a){if(this.proofs([{can:"space/info",with:a}]).length===0)throw new Error(`Agent has no proofs for ${a}.`);return await jt(this,_r).setCurrentSpace(a),a}currentSpace(){return jt(this,_r).currentSpace}currentSpaceWithMeta(){if(!jt(this,_r).currentSpace)return;const a=this.proofs([{can:"space/info",with:jt(this,_r).currentSpace}]),h=new Set;for(const _ of a)for(const j of _.capabilities)h.add(j.can);return{did:jt(this,_r).currentSpace,proofs:a,capabilities:[...h],meta:jt(this,_r).spaces.get(jt(this,_r).currentSpace)}}async registerSpace(a,h){const _=this.currentSpace(),j=this.connection.id,tt=_?jt(this,_r).spaces.get(_):void 0;if(!_||!tt)throw new Error("No space selected");if(tt&&tt.isRegistered)throw new Error("Space already registered with web3.storage.");const rt=await this.invokeAndExecute(QE,{nb:{identity:xo(`mailto:${a}`),product:"product:free",service:j.did()}});if(rt&&rt.error)throw new Error("Voucher claim failed",{cause:rt});const st=await Rr(this,bs,dp).call(this,h);await this.addProof(st);const dt=await this.delegate({abilities:["*"],audience:j,expiration:1/0,audienceMeta:{name:"w3access",type:"service"}}),ht=await this.invokeAndExecute(KE,{with:xo(j.did()),nb:{space:_,identity:st.capabilities[0].nb.identity,product:st.capabilities[0].nb.product},proofs:[dt],facts:[{space:tt,agent:this.meta}]});if(ht&&ht.error)throw new Error("Space registration failed",{cause:ht});tt.isRegistered=!0,jt(this,_r).addSpace(_,tt),jt(this,_r).removeDelegation(st.cid)}async delegate(a){const h=this.currentSpaceWithMeta();if(!h)throw new Error("there no space selected.");const _=a.abilities.map(tt=>({with:h.did,can:tt})),j=await Xu({issuer:this.issuer,capabilities:_,proofs:this.proofs(_),facts:[{space:h.meta}],...a});return await jt(this,_r).addDelegation(j,{audience:a.audienceMeta}),await this.removeExpiredDelegations(),j}async invokeAndExecute(a,h){return(await this.invoke(a,h)).execute(this.connection)}execute(...a){return this.connection.execute(...a)}async invoke(a,h){const _=h.with||this.currentSpace();if(!_)throw new Error("No space selected, you need pass a resource.");const j=this.proofs([{with:_,can:a.can}]);if(j.length===0&&h.with!==this.did())throw new Error(`no proofs available for resource ${_} and ability ${a.can}`);const tt=h.proofs||[];return oy({...h,audience:h.audience||this.connection.id,capability:a.create({with:_,nb:h.nb}),issuer:this.issuer,proofs:[...j,...tt]})}peer(a){return new OE({agent:this,channel:a})}async getSpaceInfo(a){const h=a||this.currentSpace();if(!h)throw new Error("No space selected, you need pass a resource.");const _=await this.invokeAndExecute(FE,{with:h});if(_.error)throw _;return _}};let mu=_u;_r=new WeakMap,vs=new WeakSet,lp=function(a){const h=new Set(a),_=[];for(const[,j]of jt(this,_r).delegations)if(!np(j.delegation)&&!Xm(j.delegation))if(Array.isArray(a)&&a.length>0)for(const tt of h)ux(j.delegation,tt)&&(h.delete(tt),_.push(j));else _.push(j);return _},bs=new WeakSet,dp=async function(a){const h=new JE(this.url,"validate-ws");await h.open(),h.send({did:this.did()});try{const _=await h.awaitMsg(a);if(_.type==="timeout")throw await h.close(),new Error("Email validation timed out.");if(_.type==="delegation"){const j=pm(_.delegation);return h.close(),j}}catch(_){if(_ instanceof hs)throw await h.close(),new TypeError("Failed to get delegation",{cause:_})}throw new TypeError("Failed to get delegation")};function gs(){const d={};return d.promise=new Promise((a,h)=>{d.resolve=a,d.reject=h}),d}class fx{constructor(a,h={}){vr(this,No);vr(this,ks,void 0);vr(this,Es,void 0);vr(this,qn,void 0);vr(this,jn,void 0);vr(this,xs,void 0);an(this,ks,a),an(this,Es,h.dbVersion),an(this,qn,h.dbStoreName??"AccessStore"),an(this,xs,h.autoOpen??!0)}async open(){if(jt(this,jn))return;const{resolve:a,reject:h,promise:_}=gs(),j=indexedDB.open(jt(this,ks),jt(this,Es));return j.addEventListener("upgradeneeded",()=>{j.result.createObjectStore(jt(this,qn),{keyPath:"id"})}),j.addEventListener("success",()=>{an(this,jn,j.result),a()}),j.addEventListener("error",()=>h(j.error)),_}async close(){const a=jt(this,jn);if(!a)throw new Error("Store is not open");a.close(),an(this,jn,void 0)}async save(a){return await ip(await Rr(this,No,Su).call(this),"readwrite",jt(this,qn),async _=>{const{resolve:j,reject:tt,promise:rt}=gs(),st=_.put({id:1,...a});return st.addEventListener("success",()=>j()),st.addEventListener("error",()=>tt(new Error("failed to query DB",{cause:st.error}))),rt})()}async load(){return await ip(await Rr(this,No,Su).call(this),"readonly",jt(this,qn),async h=>{const{resolve:_,reject:j,promise:tt}=gs(),rt=h.get(1);return rt.addEventListener("success",()=>_(rt.result)),rt.addEventListener("error",()=>j(new Error("failed to query DB",{cause:rt.error}))),tt})()}async reset(){ip(await Rr(this,No,Su).call(this),"readwrite",jt(this,qn),a=>{const{resolve:h,reject:_,promise:j}=gs(),tt=a.clear();return tt.addEventListener("success",()=>{h()}),tt.addEventListener("error",()=>_(new Error("failed to query DB",{cause:tt.error}))),j})}}ks=new WeakMap,Es=new WeakMap,qn=new WeakMap,jn=new WeakMap,xs=new WeakMap,No=new WeakSet,Su=async function(){if(!jt(this,jn)){if(!jt(this,xs))throw new Error("Store is not open");await this.open()}return jt(this,jn)};function ip(d,a,h,_){return async()=>{const j=d.transaction(h,a),{resolve:tt,reject:rt,promise:st}=gs();let dt;j.addEventListener("complete",()=>tt(dt)),j.addEventListener("abort",()=>rt(j.error||new Error("transaction aborted"))),j.addEventListener("error",()=>rt(new Error("transaction error",{cause:j.error})));try{dt=await _(j.objectStore(h)),j.commit()}catch(ht){rt(ht),j.abort()}return st}}class hx extends fx{}var ms=$("did"),pn=$("meta");class tw{constructor(a,h={}){Object.defineProperty(this,ms,{writable:!0,value:void 0}),Object.defineProperty(this,pn,{writable:!0,value:void 0}),_e(this,ms)[ms]=a,_e(this,pn)[pn]=h}name(){return _e(this,pn)[pn].name!=null?String(_e(this,pn)[pn].name):void 0}did(){return _e(this,ms)[ms]}registered(){return Boolean(_e(this,pn)[pn].isRegistered)}meta(){return _e(this,pn)[pn]}sameAs(a){return this.did()===(a==null?void 0:a.did())}}function wu(d){const a=d.currentSpace();if(a==null)return;const h=d.spaces.get(a);return new tw(a,h)}function rw(d){const a=[];for(const[h,_]of d.spaces.entries())a.push(new tw(h,_));return a}const nw=[{space:void 0,spaces:[],agent:void 0},{loadAgent:async()=>{},unloadAgent:async()=>{},resetAgent:async()=>{},createSpace:async()=>{throw new Error("missing keyring context provider")},setCurrentSpace:async()=>{},registerSpace:async()=>{},cancelRegisterSpace:()=>{},getProofs:async()=>[],createDelegation:async()=>{throw new Error("missing keyring context provider")},addSpace:async()=>{}}],op=s.createContext(nw);function sp(){return s.useContext(op)}var iw,vu={exports:{}},ws={};function bu(d){const a=(h,_)=>d({ref:_,...h});return s.forwardRef(a)}function ku(d,a){const{as:h,wrapElement:_,...j}=a;let tt;if(h&&typeof h!="string")tt=vu.exports.jsx(h,{...j});else if(typeof a.children=="function"){const{children:rt,...st}=j;tt=a.children(st)}else tt=h?vu.exports.jsx(h,{...j}):vu.exports.jsx(d,{...j});return _?_(tt):tt}(function(d){d.exports=function(){if(iw)return ws;iw=1;var a=g.default,h=Symbol.for("react.element"),_=Symbol.for("react.fragment"),j=Object.prototype.hasOwnProperty,tt=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rt={key:!0,ref:!0,__self:!0,__source:!0};function st(dt,ht,mt){var kt,_t={},Lt=null,Ut=null;for(kt in mt!==void 0&&(Lt=""+mt),ht.key!==void 0&&(Lt=""+ht.key),ht.ref!==void 0&&(Ut=ht.ref),ht)j.call(ht,kt)&&!rt.hasOwnProperty(kt)&&(_t[kt]=ht[kt]);if(dt&&dt.defaultProps)for(kt in ht=dt.defaultProps)_t[kt]===void 0&&(_t[kt]=ht[kt]);return{$$typeof:h,type:dt,key:Lt,ref:Ut,props:_t,_owner:tt.current}}return ws.Fragment=_,ws.jsx=st,ws.jsxs=st,ws}()})(vu);const ap=s.createContext([{spaces:[],submitted:!1},{setEmail:()=>{throw new Error("missing set email function")},loadAgent:async()=>{},unloadAgent:async()=>{},resetAgent:async()=>{},createSpace:async()=>{throw new Error("missing keyring context provider")},setCurrentSpace:async()=>{},registerSpace:async()=>{},cancelRegisterSpace:()=>{},getProofs:async()=>[],createDelegation:async()=>{throw new Error("missing keyring context provider")},addSpace:async()=>{}}]),ow=({children:d})=>{const[,{loadAgent:a}]=sp();return s.useEffect(()=>{a()},[]),d},sw=bu(d=>{const[a,h]=sp(),{createSpace:_,registerSpace:j}=h,[tt,rt]=s.useState(""),[st,dt]=s.useState(!1),ht=s.useCallback(async kt=>{kt.preventDefault(),dt(!0);try{await _(),await j(tt)}catch(_t){throw new Error("failed to register",{cause:_t})}finally{dt(!1)}},[tt,dt,_,j]),mt=s.useMemo(()=>[{...a,email:tt,submitted:st,handleRegisterSubmit:ht},{...h,setEmail:rt}],[a,h,tt,st,ht]);return g.default.createElement(ow,null,g.default.createElement(ap.Provider,{value:mt},ku(s.Fragment,d)))}),aw=bu(d=>{const[{handleRegisterSubmit:a}]=Eu();return ku("form",{...d,onSubmit:a})}),cw=bu(d=>{const[{email:a},{setEmail:h}]=Eu();return ku("input",{...d,type:"email",value:a,onChange:s.useCallback(_=>{h(_.target.value)},[])})}),uw=bu(d=>{const[,{cancelRegisterSpace:a}]=Eu();return ku("button",{...d,onClick:a})});function Eu(){return s.useContext(ap)}const px=Object.assign(sw,{Form:aw,EmailInput:cw,CancelButton:uw});o.AgentLoader=ow,o.Authenticator=px,o.AuthenticatorContext=ap,o.AuthenticatorRoot=sw,o.CancelButton=uw,o.EmailInput=cw,o.Form=aw,o.KeyringContext=op,o.KeyringProvider=function({children:d,servicePrincipal:a,connection:h}){const[_,j]=s.useState(),[tt,rt]=s.useState(),[st,dt]=s.useState([]),[ht,mt]=s.useState(),[kt,_t]=s.useState(),Lt=async()=>{if(_==null){const Gt=await async function(tr={}){const wr="w3ui"+(tr.servicePrincipal!=null?"@"+tr.servicePrincipal.did():""),xr=new hx(wr,{dbVersion:1,dbStoreName:"keyring"}),Er=await xr.load();if(Er!=null)return Object.assign(mu.from(Er,{...tr,store:xr}),{store:xr});const Yr=await Km();return Object.assign(await mu.create({principal:Yr},{...tr,store:xr}),{store:xr})}({servicePrincipal:a,connection:h});return j(Gt),mt(Gt.issuer),rt(wu(Gt)),dt(rw(Gt)),Gt}return _},Ut=async()=>{rt(void 0),dt([]),mt(void 0),j(void 0)},Zt={space:tt,spaces:st,agent:ht},fr={loadAgent:async()=>{_==null&&await Lt()},unloadAgent:Ut,resetAgent:async()=>{const Gt=await Lt();await Promise.all([Gt.store.reset(),Ut()])},createSpace:async Gt=>{const tr=await Lt(),{did:wr}=await tr.createSpace(Gt);return await tr.setCurrentSpace(wr),rt(wu(tr)),wr},registerSpace:async Gt=>{const tr=await Lt(),wr=new AbortController;_t(wr);try{await tr.registerSpace(Gt,{signal:wr.signal}),rt(wu(tr)),dt(rw(tr))}catch(xr){if(!wr.signal.aborted)throw xr}},cancelRegisterSpace:()=>{kt!=null&&kt.abort()},setCurrentSpace:async Gt=>{const tr=await Lt();await tr.setCurrentSpace(Gt),rt(wu(tr))},getProofs:async Gt=>(await Lt()).proofs(Gt),createDelegation:async(Gt,tr,wr)=>{const xr=await Lt(),Er=wr.audienceMeta??{name:"agent",type:"device"};return await xr.delegate({...wr,abilities:tr,audience:Gt,audienceMeta:Er})},addSpace:async Gt=>{await(await Lt()).importSpaceFromDelegation(Gt)}};return g.default.createElement(op.Provider,{value:[Zt,fr]},d)},o.keyringContextDefaultValue=nw,o.useAuthenticator=Eu,o.useKeyring=sp,Object.defineProperty(o,"__esModule",{value:!0})})})(index_production,index_productionExports);var encode_1$1=encode$k,MSB$2=128,REST$2=127,MSBALL$1=~REST$2,INT$1=Math.pow(2,31);function encode$k(e,i,o){i=i||[],o=o||0;for(var s=o;e>=INT$1;)i[o++]=e&255|MSB$2,e/=128;for(;e&MSBALL$1;)i[o++]=e&255|MSB$2,e>>>=7;return i[o]=e|0,encode$k.bytes=o-s+1,i}var decode$n=read$4,MSB$1$1=128,REST$1$1=127;function read$4(e,s){var o=0,s=s||0,c=0,g=s,b,$=e.length;do{if(g>=$)throw read$4.bytes=0,new RangeError("Could not decode varint");b=e[g++],o+=c<28?(b&REST$1$1)<<c:(b&REST$1$1)*Math.pow(2,c),c+=7}while(b>=MSB$1$1);return read$4.bytes=g-s,o}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$1=function(e){return e<N1$1?1:e<N2$1?2:e<N3$1?3:e<N4$1?4:e<N5$1?5:e<N6$1?6:e<N7$1?7:e<N8$1?8:e<N9$1?9:10},varint$1={encode:encode_1$1,decode:decode$n,encodingLength:length$1},_brrp_varint=varint$1;const decode$m=(e,i=0)=>[_brrp_varint.decode(e,i),_brrp_varint.decode.bytes],encodeTo=(e,i,o=0)=>(_brrp_varint.encode(e,i,o),i),encodingLength=e=>_brrp_varint.encodingLength(e),equals$1=(e,i)=>{if(e===i)return!0;if(e.byteLength!==i.byteLength)return!1;for(let o=0;o<e.byteLength;o++)if(e[o]!==i[o])return!1;return!0},coerce=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},create$b=(e,i)=>{const o=i.byteLength,s=encodingLength(e),c=s+encodingLength(o),g=new Uint8Array(c+o);return encodeTo(e,g,0),encodeTo(o,g,s),g.set(i,c),new Digest(e,o,i,g)},decode$l=e=>{const i=coerce(e),[o,s]=decode$m(i),[c,g]=decode$m(i.subarray(s)),b=i.subarray(s+g);if(b.byteLength!==c)throw new Error("Incorrect length");return new Digest(o,c,b,i)},equals=(e,i)=>{if(e===i)return!0;{const o=i;return e.code===o.code&&e.size===o.size&&o.bytes instanceof Uint8Array&&equals$1(e.bytes,o.bytes)}};class Digest{constructor(i,o,s,c){this.code=i,this.size=o,this.digest=s,this.bytes=c}}function base$3(e,i){if(e.length>=255)throw new TypeError("Alphabet too long");for(var o=new Uint8Array(256),s=0;s<o.length;s++)o[s]=255;for(var c=0;c<e.length;c++){var g=e.charAt(c),b=g.charCodeAt(0);if(o[b]!==255)throw new TypeError(g+" is ambiguous");o[b]=c}var $=e.length,_e=e.charAt(0),et=Math.log($)/Math.log(256),nt=Math.log(256)/Math.log($);function ot(lt){if(lt instanceof Uint8Array||(ArrayBuffer.isView(lt)?lt=new Uint8Array(lt.buffer,lt.byteOffset,lt.byteLength):Array.isArray(lt)&&(lt=Uint8Array.from(lt))),!(lt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(lt.length===0)return"";for(var gt=0,wt=0,ft=0,ut=lt.length;ft!==ut&&lt[ft]===0;)ft++,gt++;for(var pt=(ut-ft)*nt+1>>>0,vt=new Uint8Array(pt);ft!==ut;){for(var bt=lt[ft],Ct=0,At=pt-1;(bt!==0||Ct<wt)&&At!==-1;At--,Ct++)bt+=256*vt[At]>>>0,vt[At]=bt%$>>>0,bt=bt/$>>>0;if(bt!==0)throw new Error("Non-zero carry");wt=Ct,ft++}for(var Pt=pt-wt;Pt!==pt&&vt[Pt]===0;)Pt++;for(var Rt=_e.repeat(gt);Pt<pt;++Pt)Rt+=e.charAt(vt[Pt]);return Rt}function ct(lt){if(typeof lt!="string")throw new TypeError("Expected String");if(lt.length===0)return new Uint8Array;var gt=0;if(lt[gt]!==" "){for(var wt=0,ft=0;lt[gt]===_e;)wt++,gt++;for(var ut=(lt.length-gt)*et+1>>>0,pt=new Uint8Array(ut);lt[gt];){var vt=o[lt.charCodeAt(gt)];if(vt===255)return;for(var bt=0,Ct=ut-1;(vt!==0||bt<ft)&&Ct!==-1;Ct--,bt++)vt+=$*pt[Ct]>>>0,pt[Ct]=vt%256>>>0,vt=vt/256>>>0;if(vt!==0)throw new Error("Non-zero carry");ft=bt,gt++}if(lt[gt]!==" "){for(var At=ut-ft;At!==ut&&pt[At]===0;)At++;for(var Pt=new Uint8Array(wt+(ut-At)),Rt=wt;At!==ut;)Pt[Rt++]=pt[At++];return Pt}}}function at(lt){var gt=ct(lt);if(gt)return gt;throw new Error(`Non-${i} character`)}return{encode:ot,decodeUnsafe:ct,decode:at}}var src=base$3,_brrp__multiformats_scope_baseX=src;class Encoder{constructor(i,o,s){this.name=i,this.prefix=o,this.baseEncode=s}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(i,o,s){if(this.name=i,this.prefix=o,o.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o.codePointAt(0),this.baseDecode=s}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return or$4(this,i)}}class ComposedDecoder{constructor(i){this.decoders=i}or(i){return or$4(this,i)}decode(i){const o=i[0],s=this.decoders[o];if(s)return s.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$4=(e,i)=>new ComposedDecoder({...e.decoders||{[e.prefix]:e},...i.decoders||{[i.prefix]:i}});class Codec{constructor(i,o,s,c){this.name=i,this.prefix=o,this.baseEncode=s,this.baseDecode=c,this.encoder=new Encoder(i,o,s),this.decoder=new Decoder(i,o,c)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const from$4=({name:e,prefix:i,encode:o,decode:s})=>new Codec(e,i,o,s),baseX=({prefix:e,name:i,alphabet:o})=>{const{encode:s,decode:c}=_brrp__multiformats_scope_baseX(o,i);return from$4({prefix:e,name:i,encode:s,decode:g=>coerce(c(g))})},decode$k=(e,i,o,s)=>{const c={};for(let nt=0;nt<i.length;++nt)c[i[nt]]=nt;let g=e.length;for(;e[g-1]==="=";)--g;const b=new Uint8Array(g*o/8|0);let $=0,_e=0,et=0;for(let nt=0;nt<g;++nt){const ot=c[e[nt]];if(ot===void 0)throw new SyntaxError(`Non-${s} character`);_e=_e<<o|ot,$+=o,$>=8&&($-=8,b[et++]=255&_e>>$)}if($>=o||255&_e<<8-$)throw new SyntaxError("Unexpected end of data");return b},encode$j=(e,i,o)=>{const s=i[i.length-1]==="=",c=(1<<o)-1;let g="",b=0,$=0;for(let _e=0;_e<e.length;++_e)for($=$<<8|e[_e],b+=8;b>o;)b-=o,g+=i[c&$>>b];if(b&&(g+=i[c&$<<o-b]),s)for(;g.length*o&7;)g+="=";return g},rfc4648=({name:e,prefix:i,bitsPerChar:o,alphabet:s})=>from$4({prefix:i,name:e,encode(c){return encode$j(c,s,o)},decode(c){return decode$k(c,s,o,e)}}),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});const base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const format$5=(e,i)=>{const{bytes:o,version:s}=e;switch(s){case 0:return toStringV0(o,baseCache(e),i||base58btc.encoder);default:return toStringV1(o,baseCache(e),i||base32.encoder)}},cache=new WeakMap,baseCache=e=>{const i=cache.get(e);if(i==null){const o=new Map;return cache.set(e,o),o}return i};class CID{constructor(i,o,s,c){this.code=o,this.version=i,this.multihash=s,this.bytes=c,this["/"]=c}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:i,multihash:o}=this;if(i!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(o.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(o)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:i,digest:o}=this.multihash,s=create$b(i,o);return CID.createV1(this.code,s)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(i){return CID.equals(this,i)}static equals(i,o){const s=o;return s&&i.code===s.code&&i.version===s.version&&equals(i.multihash,s.multihash)}toString(i){return format$5(this,i)}toJSON(){return{"/":format$5(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(i){if(i==null)return null;const o=i;if(o instanceof CID)return o;if(o["/"]!=null&&o["/"]===o.bytes||o.asCID===o){const{version:s,code:c,multihash:g,bytes:b}=o;return new CID(s,c,g,b||encodeCID(s,c,g.bytes))}else if(o[cidSymbol]===!0){const{version:s,multihash:c,code:g}=o,b=decode$l(c);return CID.create(s,g,b)}else return null}static create(i,o,s){if(typeof o!="number")throw new Error("String codecs are no longer supported");if(!(s.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(i){case 0:{if(o!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new CID(i,o,s,s.bytes)}case 1:{const c=encodeCID(i,o,s.bytes);return new CID(i,o,s,c)}default:throw new Error("Invalid version")}}static createV0(i){return CID.create(0,DAG_PB_CODE$1,i)}static createV1(i,o){return CID.create(1,i,o)}static decode(i){const[o,s]=CID.decodeFirst(i);if(s.length)throw new Error("Incorrect length");return o}static decodeFirst(i){const o=CID.inspectBytes(i),s=o.size-o.multihashSize,c=coerce(i.subarray(s,s+o.multihashSize));if(c.byteLength!==o.multihashSize)throw new Error("Incorrect length");const g=c.subarray(o.multihashSize-o.digestSize),b=new Digest(o.multihashCode,o.digestSize,g,c);return[o.version===0?CID.createV0(b):CID.createV1(o.codec,b),i.subarray(o.size)]}static inspectBytes(i){let o=0;const s=()=>{const[ot,ct]=decode$m(i.subarray(o));return o+=ct,ot};let c=s(),g=DAG_PB_CODE$1;if(c===18?(c=0,o=0):g=s(),c!==0&&c!==1)throw new RangeError(`Invalid CID version ${c}`);const b=o,$=s(),_e=s(),et=o+_e,nt=et-b;return{version:c,codec:g,multihashCode:$,digestSize:_e,multihashSize:nt,size:et}}static parse(i,o){const[s,c]=parseCIDtoBytes(i,o),g=CID.decode(c);if(g.version===0&&i[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(g).set(s,i),g}}const parseCIDtoBytes=(e,i)=>{switch(e[0]){case"Q":{const o=i||base58btc;return[base58btc.prefix,o.decode(`${base58btc.prefix}${e}`)]}case base58btc.prefix:{const o=i||base58btc;return[base58btc.prefix,o.decode(e)]}case base32.prefix:{const o=i||base32;return[base32.prefix,o.decode(e)]}default:{if(i==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],i.decode(e)]}}},toStringV0=(e,i,o)=>{const{prefix:s}=o;if(s!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${o.name} encoding`);const c=i.get(s);if(c==null){const g=o.encode(e).slice(1);return i.set(s,g),g}else return c},toStringV1=(e,i,o)=>{const{prefix:s}=o,c=i.get(s);if(c==null){const g=o.encode(e);return i.set(s,g),g}else return c},DAG_PB_CODE$1=112,SHA_256_CODE=18,encodeCID=(e,i,o)=>{const s=encodingLength(e),c=s+encodingLength(i),g=new Uint8Array(c+o.byteLength);return encodeTo(e,g,0),encodeTo(i,g,s),g.set(o,c),g},cidSymbol=Symbol.for("@ipld/js-cid/CID"),from$3=({name:e,code:i,encode:o})=>new Hasher(e,i,o);class Hasher{constructor(i,o,s){this.name=i,this.code=o,this.encode=s}digest(i){if(i instanceof Uint8Array){const o=this.encode(i);return o instanceof Uint8Array?create$b(this.code,o):o.then(s=>create$b(this.code,s))}else throw Error("Unknown type, must be binary type")}}function readonly({enumerable:e=!0,configurable:i=!1}={}){return{enumerable:e,configurable:i,writable:!1}}function*linksWithin(e,i){if(i!=null&&typeof i=="object")if(Array.isArray(i))for(const[o,s]of i.entries()){const c=[...e,o],g=CID.asCID(s);g?yield[c.join("/"),g]:typeof s=="object"&&(yield*links(s,c))}else{const o=CID.asCID(i);o?yield[e.join("/"),o]:yield*links(i,e)}}function*links(e,i){if(e==null||e instanceof Uint8Array)return;const o=CID.asCID(e);o&&(yield[i.join("/"),o]);for(const[s,c]of Object.entries(e)){const g=[...i,s];yield*linksWithin(g,c)}}function*treeWithin(e,i){if(Array.isArray(i))for(const[o,s]of i.entries()){const c=[...e,o];yield c.join("/"),typeof s=="object"&&!CID.asCID(s)&&(yield*tree(s,c))}else yield*tree(i,e)}function*tree(e,i){if(!(e==null||typeof e!="object"))for(const[o,s]of Object.entries(e)){const c=[...i,o];yield c.join("/"),s!=null&&!(s instanceof Uint8Array)&&typeof s=="object"&&!CID.asCID(s)&&(yield*treeWithin(c,s))}}function get$1(e,i){let o=e;for(const[s,c]of i.entries()){if(o=o[c],o==null)throw new Error(`Object has no property at ${i.slice(0,s+1).map(b=>`[${JSON.stringify(b)}]`).join("")}`);const g=CID.asCID(o);if(g)return{value:g,remaining:i.slice(s+1).join("/")}}return{value:o}}class Block{constructor({cid:i,bytes:o,value:s}){if(!i||!o||typeof s>"u")throw new Error("Missing required argument");this.cid=i,this.bytes=o,this.value=s,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links(this.value,[])}tree(){return tree(this.value,[])}get(i="/"){return get$1(this.value,i.split("/").filter(Boolean))}}async function encode$i({value:e,codec:i,hasher:o}){if(typeof e>"u")throw new Error('Missing required argument "value"');if(!i||!o)throw new Error("Missing required argument: codec or hasher");const s=i.encode(e),c=await o.digest(s),g=CID.create(1,i.code,c);return new Block({value:e,bytes:s,cid:g})}async function decode$j({bytes:e,codec:i,hasher:o}){if(!e)throw new Error('Missing required argument "bytes"');if(!i||!o)throw new Error("Missing required argument: codec or hasher");const s=i.decode(e),c=await o.digest(e),g=CID.create(1,i.code,c);return new Block({value:s,bytes:e,cid:g})}function createUnsafe({bytes:e,cid:i,value:o,codec:s}){const c=o!==void 0?o:s&&s.decode(e);if(c===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block({cid:i,bytes:e,value:c})}async function create$a({bytes:e,cid:i,hasher:o,codec:s}){if(!e)throw new Error('Missing required argument "bytes"');if(!o)throw new Error('Missing required argument "hasher"');const c=s.decode(e),g=await o.digest(e);if(!equals$1(i.multihash.bytes,g.bytes))throw new Error("CID hash does not match bytes");return createUnsafe({bytes:e,cid:i,value:c,codec:s})}const sha=e=>async i=>new Uint8Array(await crypto.subtle.digest(e,i)),sha256=from$3({name:"sha2-256",code:18,encode:sha("SHA-256")}),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const i=typeof e;if(typeofs.includes(i))return i;if(i==="function")return"Function";if(Array.isArray(e))return"Array";if(isBuffer$1(e))return"Buffer";const o=getObjectType(e);return o||"Object"}function isBuffer$1(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function getObjectType(e){const i=Object.prototype.toString.call(e).slice(8,-1);if(objectTypeNames.includes(i))return i}class Type{constructor(i,o,s){this.major=i,this.majorEncoded=i<<5,this.name=o,this.terminal=s}toString(){return`Type[${this.major}].${this.name}`}compare(i){return this.major<i.major?-1:this.major>i.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(i,o,s){this.type=i,this.value=o,this.encodedLength=s,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$1=new TextDecoder,textEncoder$2=new TextEncoder;function isBuffer(e){return useBuffer&&globalThis.Buffer.isBuffer(e)}function asU8A(e){return e instanceof Uint8Array?isBuffer(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const toString=useBuffer?(e,i,o)=>o-i>64?globalThis.Buffer.from(e.subarray(i,o)).toString("utf8"):utf8Slice(e,i,o):(e,i,o)=>o-i>64?textDecoder$1.decode(e.subarray(i,o)):utf8Slice(e,i,o),fromString=useBuffer?e=>e.length>64?globalThis.Buffer.from(e):utf8ToBytes(e):e=>e.length>64?textEncoder$2.encode(e):utf8ToBytes(e),fromArray=e=>Uint8Array.from(e),slice=useBuffer?(e,i,o)=>isBuffer(e)?new Uint8Array(e.subarray(i,o)):e.slice(i,o):(e,i,o)=>e.slice(i,o),concat=useBuffer?(e,i)=>(e=e.map(o=>o instanceof Uint8Array?o:globalThis.Buffer.from(o)),asU8A(globalThis.Buffer.concat(e,i))):(e,i)=>{const o=new Uint8Array(i);let s=0;for(let c of e)s+c.length>o.length&&(c=c.subarray(0,o.length-s)),o.set(c,s),s+=c.length;return o},alloc=useBuffer?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function compare$2(e,i){if(isBuffer(e)&&isBuffer(i))return e.compare(i);for(let o=0;o<e.length;o++)if(e[o]!==i[o])return e[o]<i[o]?-1:1;return 0}function utf8ToBytes(e,i=1/0){let o;const s=e.length;let c=null;const g=[];for(let b=0;b<s;++b){if(o=e.charCodeAt(b),o>55295&&o<57344){if(!c){if(o>56319){(i-=3)>-1&&g.push(239,191,189);continue}else if(b+1===s){(i-=3)>-1&&g.push(239,191,189);continue}c=o;continue}if(o<56320){(i-=3)>-1&&g.push(239,191,189),c=o;continue}o=(c-55296<<10|o-56320)+65536}else c&&(i-=3)>-1&&g.push(239,191,189);if(c=null,o<128){if((i-=1)<0)break;g.push(o)}else if(o<2048){if((i-=2)<0)break;g.push(o>>6|192,o&63|128)}else if(o<65536){if((i-=3)<0)break;g.push(o>>12|224,o>>6&63|128,o&63|128)}else if(o<1114112){if((i-=4)<0)break;g.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else throw new Error("Invalid code point")}return g}function utf8Slice(e,i,o){const s=[];for(;i<o;){const c=e[i];let g=null,b=c>239?4:c>223?3:c>191?2:1;if(i+b<=o){let $,_e,et,nt;switch(b){case 1:c<128&&(g=c);break;case 2:$=e[i+1],($&192)===128&&(nt=(c&31)<<6|$&63,nt>127&&(g=nt));break;case 3:$=e[i+1],_e=e[i+2],($&192)===128&&(_e&192)===128&&(nt=(c&15)<<12|($&63)<<6|_e&63,nt>2047&&(nt<55296||nt>57343)&&(g=nt));break;case 4:$=e[i+1],_e=e[i+2],et=e[i+3],($&192)===128&&(_e&192)===128&&(et&192)===128&&(nt=(c&15)<<18|($&63)<<12|(_e&63)<<6|et&63,nt>65535&&nt<1114112&&(g=nt))}}g===null?(g=65533,b=1):g>65535&&(g-=65536,s.push(g>>>10&1023|55296),g=56320|g&1023),s.push(g),i+=b}return decodeCodePointsArray(s)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){const i=e.length;if(i<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);let o="",s=0;for(;s<i;)o+=String.fromCharCode.apply(String,e.slice(s,s+=MAX_ARGUMENTS_LENGTH));return o}const defaultChunkSize=256;class Bl{constructor(i=defaultChunkSize){this.chunkSize=i,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(i){let o=this.chunks[this.chunks.length-1];if(this.cursor+i.length<=this.maxCursor+1){const c=o.length-(this.maxCursor-this.cursor)-1;o.set(i,c)}else{if(o){const c=o.length-(this.maxCursor-this.cursor)-1;c<o.length&&(this.chunks[this.chunks.length-1]=o.subarray(0,c),this.maxCursor=this.cursor-1)}i.length<64&&i.length<this.chunkSize?(o=alloc(this.chunkSize),this.chunks.push(o),this.maxCursor+=o.length,this._initReuseChunk===null&&(this._initReuseChunk=o),o.set(i,0)):(this.chunks.push(i),this.maxCursor+=i.length)}this.cursor+=i.length}toBytes(i=!1){let o;if(this.chunks.length===1){const s=this.chunks[0];i&&this.cursor>s.length/2?(o=this.cursor===s.length?s:s.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):o=slice(s,0,this.cursor)}else o=concat(this.chunks,this.cursor);return i&&this.reset(),o}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(e,i,o){if(e.length-i<o)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(e,i,o){assertEnoughData(e,i,1);const s=e[i];if(o.strict===!0&&s<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint16(e,i,o){assertEnoughData(e,i,2);const s=e[i]<<8|e[i+1];if(o.strict===!0&&s<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint32(e,i,o){assertEnoughData(e,i,4);const s=e[i]*16777216+(e[i+1]<<16)+(e[i+2]<<8)+e[i+3];if(o.strict===!0&&s<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return s}function readUint64(e,i,o){assertEnoughData(e,i,8);const s=e[i]*16777216+(e[i+1]<<16)+(e[i+2]<<8)+e[i+3],c=e[i+4]*16777216+(e[i+5]<<16)+(e[i+6]<<8)+e[i+7],g=(BigInt(s)<<BigInt(32))+BigInt(c);if(o.strict===!0&&g<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(g<=Number.MAX_SAFE_INTEGER)return Number(g);if(o.allowBigInt===!0)return g;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(e,i,o,s){return new Token(Type.uint,readUint8(e,i+1,s),2)}function decodeUint16(e,i,o,s){return new Token(Type.uint,readUint16(e,i+1,s),3)}function decodeUint32(e,i,o,s){return new Token(Type.uint,readUint32(e,i+1,s),5)}function decodeUint64(e,i,o,s){return new Token(Type.uint,readUint64(e,i+1,s),9)}function encodeUint(e,i){return encodeUintValue(e,0,i.value)}function encodeUintValue(e,i,o){if(o<uintBoundaries[0]){const s=Number(o);e.push([i|s])}else if(o<uintBoundaries[1]){const s=Number(o);e.push([i|24,s])}else if(o<uintBoundaries[2]){const s=Number(o);e.push([i|25,s>>>8,s&255])}else if(o<uintBoundaries[3]){const s=Number(o);e.push([i|26,s>>>24&255,s>>>16&255,s>>>8&255,s&255])}else{const s=BigInt(o);if(s<uintBoundaries[4]){const c=[i|27,0,0,0,0,0,0,0];let g=Number(s&BigInt(4294967295)),b=Number(s>>BigInt(32)&BigInt(4294967295));c[8]=g&255,g=g>>8,c[7]=g&255,g=g>>8,c[6]=g&255,g=g>>8,c[5]=g&255,c[4]=b&255,b=b>>8,c[3]=b&255,b=b>>8,c[2]=b&255,b=b>>8,c[1]=b&255,e.push(c)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(i){return encodeUintValue.encodedSize(i.value)};encodeUintValue.encodedSize=function(i){return i<uintBoundaries[0]?1:i<uintBoundaries[1]?2:i<uintBoundaries[2]?3:i<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(i,o){return i.value<o.value?-1:i.value>o.value?1:0};function decodeNegint8(e,i,o,s){return new Token(Type.negint,-1-readUint8(e,i+1,s),2)}function decodeNegint16(e,i,o,s){return new Token(Type.negint,-1-readUint16(e,i+1,s),3)}function decodeNegint32(e,i,o,s){return new Token(Type.negint,-1-readUint32(e,i+1,s),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(e,i,o,s){const c=readUint64(e,i+1,s);if(typeof c!="bigint"){const g=-1-c;if(g>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,g,9)}if(s.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(c),9)}function encodeNegint(e,i){const o=i.value,s=typeof o=="bigint"?o*neg1b-pos1b:o*-1-1;encodeUintValue(e,i.type.majorEncoded,s)}encodeNegint.encodedSize=function(i){const o=i.value,s=typeof o=="bigint"?o*neg1b-pos1b:o*-1-1;return s<uintBoundaries[0]?1:s<uintBoundaries[1]?2:s<uintBoundaries[2]?3:s<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(i,o){return i.value<o.value?1:i.value>o.value?-1:0};function toToken$3(e,i,o,s){assertEnoughData(e,i,o+s);const c=slice(e,i+o,i+o+s);return new Token(Type.bytes,c,o+s)}function decodeBytesCompact(e,i,o,s){return toToken$3(e,i,1,o)}function decodeBytes8(e,i,o,s){return toToken$3(e,i,2,readUint8(e,i+1,s))}function decodeBytes16(e,i,o,s){return toToken$3(e,i,3,readUint16(e,i+1,s))}function decodeBytes32(e,i,o,s){return toToken$3(e,i,5,readUint32(e,i+1,s))}function decodeBytes64(e,i,o,s){const c=readUint64(e,i+1,s);if(typeof c=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(e,i,9,c)}function tokenBytes(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===Type.string?fromString(e.value):e.value),e.encodedBytes}function encodeBytes(e,i){const o=tokenBytes(i);encodeUintValue(e,i.type.majorEncoded,o.length),e.push(o)}encodeBytes.encodedSize=function(i){const o=tokenBytes(i);return encodeUintValue.encodedSize(o.length)+o.length};encodeBytes.compareTokens=function(i,o){return compareBytes(tokenBytes(i),tokenBytes(o))};function compareBytes(e,i){return e.length<i.length?-1:e.length>i.length?1:compare$2(e,i)}function toToken$2(e,i,o,s,c){const g=o+s;assertEnoughData(e,i,g);const b=new Token(Type.string,toString(e,i+o,i+g),g);return c.retainStringBytes===!0&&(b.byteValue=slice(e,i+o,i+g)),b}function decodeStringCompact(e,i,o,s){return toToken$2(e,i,1,o,s)}function decodeString8(e,i,o,s){return toToken$2(e,i,2,readUint8(e,i+1,s),s)}function decodeString16(e,i,o,s){return toToken$2(e,i,3,readUint16(e,i+1,s),s)}function decodeString32(e,i,o,s){return toToken$2(e,i,5,readUint32(e,i+1,s),s)}function decodeString64(e,i,o,s){const c=readUint64(e,i+1,s);if(typeof c=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(e,i,9,c,s)}const encodeString=encodeBytes;function toToken$1(e,i,o,s){return new Token(Type.array,s,o)}function decodeArrayCompact(e,i,o,s){return toToken$1(e,i,1,o)}function decodeArray8(e,i,o,s){return toToken$1(e,i,2,readUint8(e,i+1,s))}function decodeArray16(e,i,o,s){return toToken$1(e,i,3,readUint16(e,i+1,s))}function decodeArray32(e,i,o,s){return toToken$1(e,i,5,readUint32(e,i+1,s))}function decodeArray64(e,i,o,s){const c=readUint64(e,i+1,s);if(typeof c=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(e,i,9,c)}function decodeArrayIndefinite(e,i,o,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(e,i,1,1/0)}function encodeArray(e,i){encodeUintValue(e,Type.array.majorEncoded,i.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(i){return encodeUintValue.encodedSize(i.value)};function toToken(e,i,o,s){return new Token(Type.map,s,o)}function decodeMapCompact(e,i,o,s){return toToken(e,i,1,o)}function decodeMap8(e,i,o,s){return toToken(e,i,2,readUint8(e,i+1,s))}function decodeMap16(e,i,o,s){return toToken(e,i,3,readUint16(e,i+1,s))}function decodeMap32(e,i,o,s){return toToken(e,i,5,readUint32(e,i+1,s))}function decodeMap64(e,i,o,s){const c=readUint64(e,i+1,s);if(typeof c=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(e,i,9,c)}function decodeMapIndefinite(e,i,o,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(e,i,1,1/0)}function encodeMap(e,i){encodeUintValue(e,Type.map.majorEncoded,i.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(i){return encodeUintValue.encodedSize(i.value)};function decodeTagCompact(e,i,o,s){return new Token(Type.tag,o,1)}function decodeTag8(e,i,o,s){return new Token(Type.tag,readUint8(e,i+1,s),2)}function decodeTag16(e,i,o,s){return new Token(Type.tag,readUint16(e,i+1,s),3)}function decodeTag32(e,i,o,s){return new Token(Type.tag,readUint32(e,i+1,s),5)}function decodeTag64(e,i,o,s){return new Token(Type.tag,readUint64(e,i+1,s),9)}function encodeTag(e,i){encodeUintValue(e,Type.tag.majorEncoded,i.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(i){return encodeUintValue.encodedSize(i.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(e,i,o,s){if(s.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return s.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(e,i,o,s){if(s.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(e,i,o){if(o){if(o.allowNaN===!1&&Number.isNaN(e))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(o.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,e,i)}function decodeFloat16(e,i,o,s){return createToken(readFloat16(e,i+1),3,s)}function decodeFloat32(e,i,o,s){return createToken(readFloat32(e,i+1),5,s)}function decodeFloat64(e,i,o,s){return createToken(readFloat64(e,i+1),9,s)}function encodeFloat(e,i,o){const s=i.value;if(s===!1)e.push([Type.float.majorEncoded|MINOR_FALSE]);else if(s===!0)e.push([Type.float.majorEncoded|MINOR_TRUE]);else if(s===null)e.push([Type.float.majorEncoded|MINOR_NULL]);else if(s===void 0)e.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let c,g=!1;(!o||o.float64!==!0)&&(encodeFloat16(s),c=readFloat16(ui8a,1),s===c||Number.isNaN(s)?(ui8a[0]=249,e.push(ui8a.slice(0,3)),g=!0):(encodeFloat32(s),c=readFloat32(ui8a,1),s===c&&(ui8a[0]=250,e.push(ui8a.slice(0,5)),g=!0))),g||(encodeFloat64(s),c=readFloat64(ui8a,1),ui8a[0]=251,e.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(i,o){const s=i.value;if(s===!1||s===!0||s===null||s===void 0)return 1;if(!o||o.float64!==!0){encodeFloat16(s);let c=readFloat16(ui8a,1);if(s===c||Number.isNaN(s))return 3;if(encodeFloat32(s),c=readFloat32(ui8a,1),s===c)return 5}return 9};const buffer=new ArrayBuffer(9),dataView=new DataView(buffer,1),ui8a=new Uint8Array(buffer,0);function encodeFloat16(e){if(e===1/0)dataView.setUint16(0,31744,!1);else if(e===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(e))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,e);const i=dataView.getUint32(0),o=(i&2139095040)>>23,s=i&8388607;if(o===255)dataView.setUint16(0,31744,!1);else if(o===0)dataView.setUint16(0,(e&2147483648)>>16|s>>13,!1);else{const c=o-127;c<-24?dataView.setUint16(0,0):c<-14?dataView.setUint16(0,(i&2147483648)>>16|1<<24+c,!1):dataView.setUint16(0,(i&2147483648)>>16|c+15<<10|s>>13,!1)}}}function readFloat16(e,i){if(e.length-i<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const o=(e[i]<<8)+e[i+1];if(o===31744)return 1/0;if(o===64512)return-1/0;if(o===32256)return NaN;const s=o>>10&31,c=o&1023;let g;return s===0?g=c*2**-24:s!==31?g=(c+1024)*2**(s-25):g=c===0?1/0:NaN,o&32768?-g:g}function encodeFloat32(e){dataView.setFloat32(0,e,!1)}function readFloat32(e,i){if(e.length-i<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const o=(e.byteOffset||0)+i;return new DataView(e.buffer,o,4).getFloat32(0,!1)}function encodeFloat64(e){dataView.setFloat64(0,e,!1)}function readFloat64(e,i){if(e.length-i<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const o=(e.byteOffset||0)+i;return new DataView(e.buffer,o,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(e,i,o){throw new Error(`${decodeErrPrefix} encountered invalid minor (${o}) for major ${e[i]>>>5}`)}function errorer(e){return()=>{throw new Error(`${decodeErrPrefix} ${e}`)}}const jump=[];for(let e=0;e<=23;e++)jump[e]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let e=32;e<=55;e++)jump[e]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let e=64;e<=87;e++)jump[e]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)jump[e]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)jump[e]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let e=160;e<=183;e++)jump[e]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let e=192;e<=215;e++)jump[e]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let e=224;e<=243;e++)jump[e]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let e=0;e<24;e++)quick[e]=new Token(Type.uint,e,1);for(let e=-1;e>=-24;e--)quick[31-e]=new Token(Type.negint,e,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(e){switch(e.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return e.value.length?void 0:fromArray([64]);case Type.string:return e.value===""?fromArray([96]):void 0;case Type.array:return e.value===0?fromArray([128]):void 0;case Type.map:return e.value===0?fromArray([160]):void 0;case Type.uint:return e.value<24?fromArray([Number(e.value)]):void 0;case Type.negint:if(e.value>=-24)return fromArray([31-Number(e.value)])}}const defaultEncodeOptions$2={float64:!1,mapSorter:mapSorter$1,quickEncodeToken};function makeCborEncoders(){const e=[];return e[Type.uint.major]=encodeUint,e[Type.negint.major]=encodeNegint,e[Type.bytes.major]=encodeBytes,e[Type.string.major]=encodeString,e[Type.array.major]=encodeArray,e[Type.map.major]=encodeMap,e[Type.tag.major]=encodeTag,e[Type.float.major]=encodeFloat,e}const cborEncoders$1=makeCborEncoders(),buf=new Bl;class Ref{constructor(i,o){this.obj=i,this.parent=o}includes(i){let o=this;do if(o.obj===i)return!0;while(o=o.parent);return!1}static createCheck(i,o){if(i&&i.includes(o))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(o,i)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(e,i,o,s){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new Token(Type.float,e):e>=0?new Token(Type.uint,e):new Token(Type.negint,e)},bigint(e,i,o,s){return e>=BigInt(0)?new Token(Type.uint,e):new Token(Type.negint,e)},Uint8Array(e,i,o,s){return new Token(Type.bytes,e)},string(e,i,o,s){return new Token(Type.string,e)},boolean(e,i,o,s){return e?simpleTokens.true:simpleTokens.false},null(e,i,o,s){return simpleTokens.null},undefined(e,i,o,s){return simpleTokens.undefined},ArrayBuffer(e,i,o,s){return new Token(Type.bytes,new Uint8Array(e))},DataView(e,i,o,s){return new Token(Type.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,i,o,s){if(!e.length)return o.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;s=Ref.createCheck(s,e);const c=[];let g=0;for(const b of e)c[g++]=objectToTokens(b,o,s);return o.addBreakTokens?[new Token(Type.array,e.length),c,new Token(Type.break)]:[new Token(Type.array,e.length),c]},Object(e,i,o,s){const c=i!=="Object",g=c?e.keys():Object.keys(e),b=c?e.size:g.length;if(!b)return o.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;s=Ref.createCheck(s,e);const $=[];let _e=0;for(const et of g)$[_e++]=[objectToTokens(et,o,s),objectToTokens(c?e.get(et):e[et],o,s)];return sortMapEntries($,o),o.addBreakTokens?[new Token(Type.map,b),$,new Token(Type.break)]:[new Token(Type.map,b),$]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${e}Array`]=typeEncoders.DataView;function objectToTokens(e,i={},o){const s=is(e),c=i&&i.typeEncoders&&i.typeEncoders[s]||typeEncoders[s];if(typeof c=="function"){const b=c(e,s,i,o);if(b!=null)return b}const g=typeEncoders[s];if(!g)throw new Error(`${encodeErrPrefix} unsupported type: ${s}`);return g(e,s,i,o)}function sortMapEntries(e,i){i.mapSorter&&e.sort(i.mapSorter)}function mapSorter$1(e,i){const o=Array.isArray(e[0])?e[0][0]:e[0],s=Array.isArray(i[0])?i[0][0]:i[0];if(o.type!==s.type)return o.type.compare(s.type);const c=o.type.major,g=cborEncoders$1[c].compareTokens(o,s);return g===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),g}function tokensToEncoded(e,i,o,s){if(Array.isArray(i))for(const c of i)tokensToEncoded(e,c,o,s);else o[i.type.major](e,i,s)}function encodeCustom(e,i,o){const s=objectToTokens(e,o);if(!Array.isArray(s)&&o.quickEncodeToken){const c=o.quickEncodeToken(s);if(c)return c;const g=i[s.type.major];if(g.encodedSize){const b=g.encodedSize(s,o),$=new Bl(b);if(g($,s,o),$.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${s} was wrong`);return asU8A($.chunks[0])}}return buf.reset(),tokensToEncoded(buf,s,i,o),buf.toBytes(!0)}function encode$h(e,i){return i=Object.assign({},defaultEncodeOptions$2,i),encodeCustom(e,cborEncoders$1,i)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(i,o={}){this.pos=0,this.data=i,this.options=o}done(){return this.pos>=this.data.length}next(){const i=this.data[this.pos];let o=quick[i];if(o===void 0){const s=jump[i];if(!s)throw new Error(`${decodeErrPrefix} no decoder for major type ${i>>>5} (byte 0x${i.toString(16).padStart(2,"0")})`);const c=i&31;o=s(this.data,this.pos,c,this.options)}return this.pos+=o.encodedLength,o}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(e,i,o){const s=[];for(let c=0;c<e.value;c++){const g=tokensToObject(i,o);if(g===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(g===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${c}, expected ${e.value})`);s[c]=g}return s}function tokenToMap(e,i,o){const s=o.useMaps===!0,c=s?void 0:{},g=s?new Map:void 0;for(let b=0;b<e.value;b++){const $=tokensToObject(i,o);if($===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if($===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${b} [no key], expected ${e.value})`);if(s!==!0&&typeof $!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof $})`);if(o.rejectDuplicateMapKeys===!0&&(s&&g.has($)||!s&&$ in c))throw new Error(`${decodeErrPrefix} found repeat map key "${$}"`);const _e=tokensToObject(i,o);if(_e===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${b} [no value], expected ${e.value})`);s?g.set($,_e):c[$]=_e}return s?g:c}function tokensToObject(e,i){if(e.done())return DONE;const o=e.next();if(o.type===Type.break)return BREAK;if(o.type.terminal)return o.value;if(o.type===Type.array)return tokenToArray(o,e,i);if(o.type===Type.map)return tokenToMap(o,e,i);if(o.type===Type.tag){if(i.tags&&typeof i.tags[o.value]=="function"){const s=tokensToObject(e,i);return i.tags[o.value](s)}throw new Error(`${decodeErrPrefix} tag not supported (${o.value})`)}throw new Error("unsupported")}function decode$i(e,i){if(!(e instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);i=Object.assign({},defaultDecodeOptions,i);const o=i.tokenizer||new Tokeniser(e,i),s=tokensToObject(o,i);if(s===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(s===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!o.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return s}const CID_CBOR_TAG=42;function cidEncoder$1(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const i=CID.asCID(e);if(!i)return null;const o=new Uint8Array(i.bytes.byteLength+1);return o.set(i.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,o)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions$1={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}};function cidDecoder(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID.decode(e.subarray(1))}const decodeOptions$1={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions$1.tags[CID_CBOR_TAG]=cidDecoder;const name$4="dag-cbor",code$6=113,encode$g=e=>encode$h(e,encodeOptions$1),decode$h=e=>decode$i(e,decodeOptions$1),codec$2=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,decode:decode$h,encode:encode$g,name:name$4},Symbol.toStringTag,{value:"Module"})),readUInt32LE=e=>{const i=e.byteLength-4;return(e[i]|e[i+1]<<8|e[i+2]<<16)+e[i+3]*16777216},MAX_UINT32=4294967295,bf=e=>{const i=Math.floor(MAX_UINT32/e);return async o=>{const s=await o.identity();if(typeof s!="number")throw new Error("Identity must be a number");return s<=i}},simpleCompare=(e,i)=>e===i?0:e>i?1:-1;class CIDCounter{constructor(){this._cids=new Set}add(i){if(!i.address)throw new Error("Cannot add node without address");if(i.address.then){const o=i.address.then(s=>this._cids.add(s.toString()));this._cids.add(o),o.then(()=>this._cids.delete(o))}else this._cids.add(i.address.toString())}async all(){return await Promise.all([...this._cids]),this._cids}}async function advance(e,i,o){const s=new EventFetcher(e),c=new Map(i.map(b=>[b.toString(),b]));if(c.has(o.toString()))return{head:i,cids:s.cids};let g=!1;for(const b of i)await contains(s,o,b)&&(c.delete(b.toString()),c.set(o.toString(),o),g=!0);if(g)return{head:[...c.values()],cids:s.cids};for(const b of i)if(await contains(s,b,o))return{head:i,cids:s.cids};return{head:i.concat(o),cids:s.cids}}class EventBlock extends Block{constructor({cid:i,value:o,bytes:s}){super({cid:i,value:o,bytes:s})}static create(i,o){return encodeEventBlock({data:i,parents:o??[]})}}class EventFetcher{constructor(i){this._blocks=i,this._cids=new CIDCounter,this._cache=new Map}async get(i){const o=i.toString();if(this._cache.has(o))return this._cache.get(o);const s=await this._blocks.get(i);if(this._cids.add({address:i}),!s)throw new Error(`missing block: ${i}`);const c=decodeEventBlock(s.bytes);return this._cache.set(o,c),c}async all(){return await Promise.all([...this._cids]),this._cids}}async function encodeEventBlock(e){const{cid:i,bytes:o}=await encode$i({value:e,codec:codec$2,hasher:sha256});return new Block({cid:i,value:e,bytes:o})}async function decodeEventBlock(e){const{cid:i,value:o}=await decode$j({bytes:e,codec:codec$2,hasher:sha256});return new Block({cid:i,value:o,bytes:e})}async function contains(e,i,o){if(i.toString()===o.toString())return!0;const[{value:s},{value:c}]=await Promise.all([e.get(i),e.get(o)]),g=[...s.parents];for(;g.length;){const b=g.shift();if(!b)break;if(b.toString()===o.toString())return!0;if(c.parents.some(_e=>b.toString()===_e.toString()))continue;const{value:$}=await e.get(b);g.push(...$.parents)}return!1}async function findEventsToSync(e,i){const o=new EventFetcher(e),{ancestor:s,sorted:c}=await findCommonAncestorWithSortedEvents(o,i),g=await asyncFilter(c,async b=>!await contains(o,s,b.cid));return{cids:o.cids,events:g}}const asyncFilter=async(e,i)=>Promise.all(e.map(i)).then(o=>e.filter((s,c)=>o[c]));async function findCommonAncestorWithSortedEvents(e,i){const o=await findCommonAncestor(e,i);if(!o)throw new Error("failed to find common ancestor event");const s=await findSortedEvents(e,i,o);return{ancestor:o,sorted:s}}async function findCommonAncestor(e,i){if(!i.length)return;const o=i.map(s=>[s]);for(;;){let s=!1;for(const c of o){const g=await findAncestorCandidate(e,c[c.length-1]);if(!g)continue;s=!0,c.push(g);const b=findCommonString(o);if(b)return b}if(!s)return}}async function findAncestorCandidate(e,i){const{value:o}=await e.get(i);return o.parents.length?o.parents.length===1?o.parents[0]:findCommonAncestor(e,o.parents):i}function findCommonString(e){e=e.map(i=>[...i]);for(const i of e)for(const o of i){let s=!0;for(const c of e)if(i!==c&&(s=c.some(g=>String(g)===String(o)),!s))break;if(s)return o}}async function findSortedEvents(e,i,o){const s=new Map,c=await Promise.all(i.map($=>findEvents(e,$,o)));for(const $ of c)for(const{event:_e,depth:et}of $){const nt=s.get(_e.cid.toString());nt?nt.weight+=et:s.set(_e.cid.toString(),{event:_e,weight:et})}const g=new Map;for(const{event:$,weight:_e}of s.values()){const et=g.get(_e);et?et.push($):g.set(_e,[$])}return Array.from(g).sort(($,_e)=>_e[0]-$[0]).flatMap(([,$])=>$.sort((_e,et)=>String(_e.cid)<String(et.cid)?-1:1))}async function findEvents(e,i,o,s=0){const c=await e.get(i),g=[{event:c,depth:s}],{parents:b}=c.value;if(b.length===1&&String(b[0])===String(o))return g;const $=await Promise.all(b.map(_e=>findEvents(e,_e,o,s+1)));return g.concat(...$)}class Entry{constructor({key:i,address:o},s={}){this.key=i,this.address=o,this.codec=s.codec,this.hasher=s.hasher}get isEntry(){return!0}}class EntryList{constructor({entries:i,closed:o}){if(typeof o!="boolean")throw new Error('Missing required argument "closed"');this.entries=i,this.closed=o,this.startKey=i[0].key}find(i,o){const{entries:s}=this;for(let c=s.length-1;c>-1;c--){const g=s[c];if(o(i,g.key)>-1)return[c,g]}return null}findMany(i,o,s=!1,c=!1){const{entries:g}=this,b=new Map;s?i=[...i]:i=i.sort(o);for(let $=g.length-1;$>-1&&i.length;$--){const _e=g[$],et=[];for(;i.length;){let nt=i[i.length-1];nt=nt.key?nt.key:nt;const ot=o(nt,_e.key);if(c)if(ot===0)et.push(i.pop());else if(ot>0)i.pop();else break;else if(ot>-1)et.push(i.pop());else break}et.length&&b.set($,[_e,et])}return b}findRange(i,o,s){const{entries:c}=this;let g,b=0;for(let $=c.length-1;$>-1;$--){const _e=c[$];if(s(o,_e.key)>0){g=$;break}}for(let $=0;$<c.length;$++){const _e=c[$],et=s(i,_e.key);if(et===0){b=$;break}else if(et<0)break;b=$}return{first:b,last:g,entries:c.slice(b,g+1)}}}const stringKey=e=>typeof e=="string"?e:JSON.stringify(e);function sortBulk(e,i){return e.sort(({key:o},{key:s})=>i.compare(o,s))}async function filterLeftmostInserts(e,i,o){const s=[];for(const c of i){const{key:g,del:b}=c;if(o(g,e)<0)b||s.push(c);else break}return s}async function generateNewLeaves(e,i,{chunker:o,compare:s}){return await Node$1.from({entries:e.map(c=>new i.LeafEntryClass(c,i)).sort((c,g)=>s(c.key,g.key)),chunker:o,NodeClass:i.LeafClass,distance:0,opts:i})}async function generateBranchEntries(e,i,o,s){return await Promise.all(i.map(async c=>{const g=await c.encode();return o.blocks.push({block:g,node:c}),e.cache.set(c),new s.BranchEntryClass({key:c.key,address:await c.address},s)}))}async function processRoot(e,i,o,s){const c=i.root;i.blocks.push({block:await c.encode(),node:c}),e.cache.set(c);const g=s.opts,b=c.distance,$=c.entryList.startKey,_e=await filterLeftmostInserts($,o,e.compare);if(_e.length){const et=await generateNewLeaves(_e,g,e),nt=await generateBranchEntries(e,et,i,g),ct=[new g.BranchEntryClass({key:c.entryList.startKey,address:await c.address},g),...nt].sort(({key:gt},{key:wt})=>g.compare(gt,wt));let at=await Node$1.from({...s,entries:ct,chunker:e.chunker,NodeClass:g.BranchClass,distance:b+1}),lt=[...at];for(;at.length>1;){const gt=await Promise.all(at.map(async wt=>new g.BranchEntryClass({key:wt.key,address:await wt.address},g)));at=await Node$1.from({...s,entries:gt.sort(({key:wt},{key:ft})=>g.compare(wt,ft)),chunker:e.chunker,NodeClass:g.BranchClass,distance:b+1}),lt=[...lt,...at]}await Promise.all(lt.map(async gt=>{const wt=await gt.encode();e.cache.set(gt),i.blocks.push({block:wt,node:gt})})),i.root=at[0],i.nodes=[...i.nodes,...lt]}}let Node$1=class Jn{constructor({entryList:i,chunker:o,distance:s,getNode:c,compare:g,cache:b}){this.entryList=i,this.chunker=o,this.distance=s,this.getNode=c,this.compare=g,this.cache=b}get closed(){return this.entryList.closed}get key(){return this.entryList.startKey}async getEntry(i,o=new CIDCounter){return{result:await this._getEntry(i,o),cids:o}}async _getEntry(i,o){o.add(this);let s=this;for(;!s.isLeaf;){const b=s.entryList.find(i,this.compare);if(b===null)throw new Error("Not found");const[,$]=b;s=await this.getNode(await $.address),o.add(s)}const c=s.entryList.find(i,this.compare);if(c===null||c[1].key.toString()!==i.toString())throw new Error("Not found");const[,g]=c;return g}async getAllEntries(i=new CIDCounter){return{result:await this._getAllEntries(i),cids:i}}_getAllEntries(i){if(i.add(this),this.isLeaf)return this.entryList.entries;{const{entries:o}=this.entryList,s=async c=>this.getNode(await c.address).then(g=>g._getAllEntries(i)).catch(async g=>{throw g});return Promise.all(o.map(s)).then(c=>c.flat())}}async*vis(i=new Set){const o=async g=>g.isLeaf?`Leaf [${g.entryList.entries.map($=>`[${$.key},${JSON.stringify($.value).replace(/"/g,"'")}]`).join(", ")}]`:`Branch [${g.entryList.entries.map($=>`[${$.key}]`).join(", ")}]`,s=g=>g.toString().slice(0,4)+g.toString().slice(-4),c=async function*(g,b,$){const _e=await g.address;if(!$.has(_e)){$.add(_e);const et=await o(g);yield`  node [shape=ellipse fontname="Courier"]; ${s(_e)} [label="${et}"];`,yield`  ${s(b)} -> ${s(_e)};`;for(const nt of g.entryList.entries)if(nt.address){const ot=await nt.address;try{const ct=await g.getNode(ot);yield*await c(ct,_e,$)}catch(ct){yield`  ${s(_e)} -> ${s(ot)};`,yield`  node [shape=ellipse fontname="Courier"]; ${s(ot)} [label="Error: ${ct.message}"];`}}}};yield"digraph tree {",yield'  node [shape=ellipse fontname="Courier"]; rootnode;';for await(const g of c(this,"rootnode",i))yield g;yield"}"}async getEntries(i,o=!1,s=new CIDCounter){return{result:await this._getEntries(i,o,s),cids:s}}async _getEntries(i,o,s){s.add(this),o||(i=i.sort(this.compare));const c=this.entryList.findMany(i,this.compare,!0,this.isLeaf);if(this.isLeaf)return[...c.values()].map(([b])=>b);let g=[];for(const[b,$]of[...c.values()].reverse()){const _e=this.getNode(await b.address);g.push(_e.then(et=>et._getEntries($.reverse(),!0,s)))}return g=await Promise.all(g),g.flat()}async getRangeEntries(i,o,s=new CIDCounter){return{result:await this._getRangeEntries(i,o,s),cids:s}}_getRangeEntries(i,o,s){s.add(this);const{entries:c}=this.entryList.findRange(i,o,this.compare);if(this.isLeaf)return c.filter(_e=>{const et=this.compare(i,_e.key),nt=this.compare(o,_e.key);return et<=0&&nt>=0});if(!c.length)return[];const g=async _e=>this.getNode(await _e.address).then(et=>et._getRangeEntries(i,o,s)),b=[g(c.shift())];if(!c.length)return b[0];const $=g(c.pop());for(;c.length;){const _e=async et=>this.getNode(await et.address).then(async nt=>nt._getAllEntries(s));b.push(_e(c.shift()))}return b.push($),Promise.all(b).then(_e=>_e.flat())}async transaction(i,o={}){o={codec:this.codec,hasher:this.hasher,getNode:this.getNode,compare:this.compare,cache:this.cache,...o};const s={chunker:this.chunker,opts:o},c=this.entryList.findMany(i,o.compare,!0,this.isLeaf);return this.isLeaf?await this.transactionLeaf(i,o,s,c):await this.transactionBranch(i,o,s,c)}async transactionLeaf(i,o,s,c){const{LeafClass:g,LeafEntryClass:b}=o,{entries:$,previous:_e}=this.processLeafEntries(i,c,b,o),et={...s,entries:$,NodeClass:g,distance:0},nt=await Jn.from(et);return{nodes:nt,previous:_e,blocks:await Promise.all(nt.map(async ot=>{const ct=await ot.encode();return this.cache.set(ot),{block:ct,node:ot}})),distance:0}}processLeafEntries(i,o,s,c){const g=[];let b=[];const $={},_e=new Map;for(const{key:ot,del:ct,value:at}of i){const lt=stringKey(ot);ct?typeof $[lt]>"u"&&_e.set(lt,null):($[lt]={key:ot,value:at},_e.delete(lt))}b=[...this.entryList.entries];for(const[ot,[ct]]of o){g.push(ct);const at=stringKey(ct.key);_e.has(at)?_e.set(at,ot):(b[ot]=new s($[at],c),delete $[at])}let et=0;for(const[,ot]of _e)b.splice(ot-et++,1);const nt=Object.values($).map(ot=>new s(ot,c));return b=b.concat(nt).sort(({key:ot},{key:ct})=>c.compare(ot,ct)),{entries:b,previous:g}}async transactionBranch(i,o,s,c){const{BranchClass:g,BranchEntryClass:b}=o;let $=0;for(const[lt,[gt,wt]]of c){const ft=this.getNode(await gt.address).then(ut=>ut.transaction(wt.reverse(),{...o,sorted:!0})).then(ut=>({entry:gt,keys:wt,distance:$,...ut}));c.set(lt,ft)}let _e=[...this.entryList.entries];const et={previous:[],blocks:[],nodes:[]};for(const[lt,gt]of c){const{nodes:wt,previous:ft,blocks:ut,distance:pt}=await gt;$=pt,_e[lt]=wt,ft.length&&(et.previous=et.previous.concat(ft)),ut.length&&(et.blocks=et.blocks.concat(ut)),wt.length&&(et.nodes=et.nodes.concat(wt))}_e=_e.flat();const nt=await this.handlePrepend(_e,o,s,et,$);$++;const ot=async lt=>{if(lt.isEntry)return lt;const gt=await lt.encode();return et.blocks.push({block:gt,node:lt}),this.cache.set(lt),new b(lt,o)};_e=await Promise.all(nt.map(ot));const ct={...s,entries:_e,NodeClass:g,distance:$},at=await Jn.from(ct);return await Promise.all(at.map(async lt=>{const gt=await lt.encode();et.blocks.push({block:gt,node:lt}),this.cache.set(lt)})),et.nodes=at,{...et,distance:$}}async handlePrepend(i,o,s,c,g){const{BranchClass:b,LeafClass:$}=o;let _e=[],et=null;for(const nt of i)if(et){const ot=await this.mergeFirstLeftEntries(nt,et,s,c,g);et=null;const ct=ot[0].address?b:$,at={...s,entries:ot.sort(({key:gt},{key:wt})=>o.compare(gt,wt)),NodeClass:ct,distance:g},lt=await Jn.from(at);lt[lt.length-1].closed||(et=lt.pop()),lt.length&&(_e=_e.concat(lt))}else!nt.isEntry&&!nt.closed?et=nt:_e.push(nt);return et&&_e.push(et),_e}async getNodeFirstFromBlocks(i,o){for(const{block:s,node:c}of i)if(await s.cid===o)return c;return await this.getNode(o)}async mergeFirstLeftEntries(i,o,s,c,g){const b=s.opts,{LeafClass:$,BranchClass:_e,BranchEntryClass:et}=b;if(i.isEntry){const at=await i.address;i=await this.getNodeFirstFromBlocks(c.blocks,at)}const nt=i.entryList.entries;if(!nt.length)throw new Error("unreachable no entries");const ot=(at,lt)=>at.concat(lt),ct=async(at,lt,gt)=>await Promise.all(at.map(async wt=>(lt.blocks.push({block:await wt.encode(),node:wt}),this.cache.set(wt),new et({key:wt.key,address:await wt.address},gt))));if(nt[0].constructor.name===o.entryList.entries[0].constructor.name)return await ot(o.entryList.entries,nt);{const at=nt.shift();if(!at)throw new Error("unreachable no left entry");if(!at.address)throw new Error("unreachable existing leaf, no leftEntry.address");const lt=await this.mergeFirstLeftEntries(at,o,s,c,g-1),gt=nt.shift();if(!gt)return lt;if(!gt.address)throw new Error("unreachable existing leaf, no esf.address");const wt=await this.getNodeFirstFromBlocks(c.blocks,await gt.address);if(wt.entryList.entries[0].address){if(lt[0].address)return lt.concat(wt.entryList.entries);{const ft=await Jn.from({...s,entries:lt.sort(({key:bt},{key:Ct})=>b.compare(bt,Ct)),NodeClass:$,distance:g}),ut=await ct(ft,c,b),pt=await Jn.from({...s,entries:[...wt.entryList.entries,...ut,...nt].sort(({key:bt},{key:Ct})=>b.compare(bt,Ct)),NodeClass:_e,distance:g});return await ct(pt,c,b)}}else{const ft=await ot(lt,wt.entryList.entries),ut=await Jn.from({...s,entries:ft.sort(({key:vt},{key:bt})=>b.compare(vt,bt)),NodeClass:$,distance:g}),pt=await ct(ut,c,b);return await ot(pt,nt)}}}async bulk(i,o={},s=!0){const{BranchClass:c}=o;o={codec:this.codec,hasher:this.hasher,getNode:this.getNode,compare:this.compare,cache:this.cache,...o},o.sorted||(i=sortBulk(i,o),o.sorted=!0);const g={chunker:this.chunker,opts:o},b=await this.transaction(i,o);for(;b.nodes.length>1;){const $=b.nodes[0].distance+1,_e=await Promise.all(b.nodes.map(async nt=>{const ot=await nt.encode();return b.blocks.push({block:ot,node:nt}),this.cache.set(nt),new o.BranchEntryClass(nt,o)})),et=await Jn.from({...g,entries:_e,NodeClass:c,distance:$});await Promise.all(et.map(async nt=>{const ot=await nt.encode();this.cache.set(nt),b.blocks.push({block:ot,node:nt})})),b.nodes=et}return b.root=b.nodes[0],s&&await processRoot(this,b,i,g),b.blocks=b.blocks.map(({block:$})=>$),b}static async from({entries:i,chunker:o,NodeClass:s,distance:c,opts:g}){if(!i.every(_e=>_e.constructor.name===i[0].constructor.name))throw new Error("all entries must be of the same type");const b=[];let $=[];for(const _e of i)$.push(_e),await o(_e,c)&&(b.push(new EntryList({entries:$,closed:!0})),$=[]);return $.length&&b.push(new EntryList({entries:$,closed:!1})),b.map(_e=>new s({entryList:_e,chunker:o,distance:c,...g}))}};class IPLDNode extends Node$1{constructor({codec:i,hasher:o,block:s,...c}){super(c),this.codec=i,this.hasher=o,s?(this.block=s,this.address=s.cid):(this.block=this.encode(),this.address=this.block.then(g=>g.cid))}async get(i){const{result:o,cids:s}=await this.getEntry(i);return{result:o.key,cids:s}}async encode(){if(this.block)return this.block;const i=await this.encodeNode(),o={codec:this.codec,hasher:this.hasher,value:i};return this.block=await encode$i(o),this.block}}class IPLDBranch extends IPLDNode{async encodeNode(){const{entries:i}=this.entryList,o=async c=>{if(!c.address)throw new Error("entry.address required");return[c.key,await c.address]},s=await Promise.all(i.map(o));return{branch:[this.distance,s],closed:this.closed}}get isBranch(){return!0}}class IPLDLeaf extends IPLDNode{async encodeNode(){return{leaf:await Promise.all(this.entryList.entries.map(async o=>await o.encodeNode())),closed:this.closed}}get isLeaf(){return!0}}const create$9=async function*(e){let{LeafClass:i,LeafEntryClass:o,BranchClass:s,BranchEntryClass:c,list:g,chunker:b,compare:$,..._e}=e;g=g.map(ot=>new o(ot,_e)),_e.compare=$;let et=await Node$1.from({entries:g,chunker:b,NodeClass:i,distance:0,opts:_e});yield*et;let nt=1;for(;et.length>1;){const ot=async at=>new c({key:at.key,address:await at.address},_e),ct=await Promise.all(et.map(ot));et=await Node$1.from({entries:ct,chunker:b,NodeClass:s,distance:nt,opts:_e}),yield*et,nt++}};class MapEntry extends Entry{async identity(){const i=await this.codec.encode(await this.encodeNode()),o=await this.hasher.encode(i);return readUInt32LE(o)}}class MapLeafEntry extends MapEntry{constructor(i,o){super(i,o),this.value=i.value}encodeNode(){return[this.key,this.value]}}class MapBranchEntry extends MapEntry{constructor(i,o){if(!i.address)throw new Error("Cannot create MapBranchEntry without address");super(i,o)}async encodeNode(){return[this.key,await this.address]}}const getValue=async(e,i)=>{const{result:o,cids:s}=await e.getEntry(i);return{result:o.value,cids:s}},getManyValues=async(e,i)=>{const{result:o,cids:s}=await e.getEntries(i);return{result:o.map(c=>c.value),cids:s}};class MapLeaf extends IPLDLeaf{get(i){return getValue(this,i)}getMany(i){return getManyValues(this,i)}bulk(i,o={},s=!0){return super.bulk(i,{...classes$1,...o},s)}}class MapBranch extends IPLDBranch{get(i){return getValue(this,i)}getMany(i){return getManyValues(this,i)}bulk(i,o={},s=!0){return super.bulk(i,{...classes$1,...o},s)}}const classes$1={LeafClass:MapLeaf,LeafEntryClass:MapLeafEntry,BranchClass:MapBranch,BranchEntryClass:MapBranchEntry},createGetNode=(e,i,o,s,c,g,b)=>{const $=b.LeafClass||MapLeaf,_e=b.LeafEntryClass||MapLeafEntry,et=b.BranchClass||MapBranch,nt=b.BranchEntryClass||MapBranchEntry,ot=async at=>i.has(at)?i.get(at):e(at).then(lt=>ct(lt)),ct=makeDecoder({chunker:o,cache:i,getNode:ot,codec:s,hasher:c,compare:g,LeafEntryClass:_e,LeafClass:$,BranchEntryClass:nt,BranchClass:et});return ot},create$8=({get:e,cache:i,chunker:o,list:s,codec:c,hasher:g,sorted:b,compare:$,..._e})=>{b||(s=s.sort(({key:ot},{key:ct})=>$(ot,ct)));const et=createGetNode(e,i,o,c,g,$,_e),nt={list:s,codec:c,hasher:g,chunker:o,getNode:et,sorted:b,compare:$,cache:i,LeafClass:_e.LeafClass||MapLeaf,LeafEntryClass:_e.LeafEntryClass||MapLeafEntry,BranchClass:_e.BranchClass||MapBranch,BranchEntryClass:_e.BranchEntryClass||MapBranchEntry};return create$9(nt)},load$1=({cid:e,get:i,cache:o,chunker:s,codec:c,hasher:g,compare:b,...$})=>createGetNode(i,o,s,c,g,b,$)(e);function makeDecoder({chunker:e,cache:i,getNode:o,codec:s,hasher:c,compare:g,LeafEntryClass:b,LeafClass:$,BranchEntryClass:_e,BranchClass:et}){const nt={codec:s,hasher:c};return ot=>{const{value:ct}=ot,at={chunker:e,cache:i,block:ot,getNode:o,codec:s,hasher:c,compare:g};let lt,gt;if(ct.leaf)lt=ct.leaf.map(([ut,pt])=>new b({key:ut,value:pt},nt)),gt=$;else if(ct.branch){const[ut,pt]=ct.branch;at.distance=ut,lt=pt.map(([vt,bt])=>new _e({key:vt,address:bt},nt)),gt=et}else throw new Error("Unknown block data, does not match schema");const wt=new EntryList({entries:lt,closed:ct.closed}),ft=new gt({entryList:wt,...at});return i.set(ft),ft}}const nocache={has:()=>!1,get:()=>{throw new Error("Cannot ask for entries from nocache")},set:()=>{}},DAG_PB_CODE=112,createLegacy=e=>CID.create(0,DAG_PB_CODE,e),create$7=(e,i)=>CID.create(1,e,i),isLink=e=>{if(e==null)return!1;const i=e;return i["/"]!=null&&i["/"]===i.bytes||e.asCID===e},parse$3=(e,i)=>CID.parse(e,i),name$3="raw",code$5=85,encode$f=e=>coerce(e),decode$g=e=>coerce(e),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$g,encode:encode$f,name:name$3},Symbol.toStringTag,{value:"Module"}));var encode_1=encode$e,MSB$1=128,REST$1=127,MSBALL=~REST$1,INT=Math.pow(2,31);function encode$e(e,i,o){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw encode$e.bytes=0,new RangeError("Could not encode varint");i=i||[],o=o||0;for(var s=o;e>=INT;)i[o++]=e&255|MSB$1,e/=128;for(;e&MSBALL;)i[o++]=e&255|MSB$1,e>>>=7;return i[o]=e|0,encode$e.bytes=o-s+1,i}var decode$f=read$3,MSB=128,REST=127;function read$3(e,s){var o=0,s=s||0,c=0,g=s,b,$=e.length;do{if(g>=$||c>49)throw read$3.bytes=0,new RangeError("Could not decode varint");b=e[g++],o+=c<28?(b&REST)<<c:(b&REST)*Math.pow(2,c),c+=7}while(b>=MSB);return read$3.bytes=g-s,o}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(e){return e<N1?1:e<N2?2:e<N3?3:e<N4?4:e<N5?5:e<N6?6:e<N7?7:e<N8?8:e<N9?9:10},varint={encode:encode_1,decode:decode$f,encodingLength:length};const cborEncoders=makeCborEncoders(),defaultEncodeOptions$1={float64:!1,quickEncodeToken};function tokensToLength(e,i=cborEncoders,o=defaultEncodeOptions$1){if(Array.isArray(e)){let s=0;for(const c of e)s+=tokensToLength(c,i,o);return s}else{const s=i[e.type.major];if(s.encodedSize===void 0||typeof s.encodedSize!="function")throw new Error(`Encoder for ${e.type.name} does not have an encodedSize()`);return s.encodedSize(e,o)}}class CarBufferWriter{constructor(i,o){this.bytes=i,this.byteOffset=o,this.roots=[],this.headerSize=o}addRoot(i,o){return addRoot(this,i,o),this}write(i){return addBlock(this,i),this}close(i){return close$1(this,i)}}const addRoot=(e,i,o={})=>{const{resize:s=!1}=o,{bytes:c,headerSize:g,byteOffset:b,roots:$}=e;e.roots.push(i);const _e=headerLength(e);if(_e>g)if(_e-g+b<c.byteLength)if(s)resizeHeader(e,_e);else throw $.pop(),new RangeError(`Header of size ${g} has no capacity for new root ${i}.
  However there is a space in the buffer and you could call addRoot(root, { resize: root }) to resize header to make a space for this root.`);else throw $.pop(),new RangeError(`Buffer has no capacity for a new root ${i}`)},blockLength=({cid:e,bytes:i})=>{const o=e.bytes.byteLength+i.byteLength;return varint.encodingLength(o)+o},addBlock=(e,{cid:i,bytes:o})=>{const s=i.bytes.byteLength+o.byteLength,c=varint.encode(s);if(e.byteOffset+c.length+s>e.bytes.byteLength)throw new RangeError("Buffer has no capacity for this block");writeBytes$1(e,c),writeBytes$1(e,i.bytes),writeBytes$1(e,o)},close$1=(e,i={})=>{const{resize:o=!1}=i,{roots:s,bytes:c,byteOffset:g,headerSize:b}=e,$=encode$g({version:1,roots:s}),_e=varint.encode($.length),et=_e.length+$.byteLength;if(b-et===0)return writeHeader(e,_e,$),c.subarray(0,g);if(o)return resizeHeader(e,et),writeHeader(e,_e,$),c.subarray(0,e.byteOffset);throw new RangeError(`Header size was overestimated.
You can use close({ resize: true }) to resize header`)},resizeHeader=(e,i)=>{const{bytes:o,headerSize:s}=e;o.set(o.subarray(s,e.byteOffset),i),e.byteOffset+=i-s,e.headerSize=i},writeBytes$1=(e,i)=>{e.bytes.set(i,e.byteOffset),e.byteOffset+=i.length},writeHeader=({bytes:e},i,o)=>{e.set(i),e.set(o,i.length)},headerPreludeTokens=[new Token(Type.map,2),new Token(Type.string,"version"),new Token(Type.uint,1),new Token(Type.string,"roots")],CID_TAG=new Token(Type.tag,42),calculateHeaderLength=e=>{const i=[...headerPreludeTokens];i.push(new Token(Type.array,e.length));for(const s of e)i.push(CID_TAG),i.push(new Token(Type.bytes,{length:s+1}));const o=tokensToLength(i);return varint.encodingLength(o)+o},headerLength=({roots:e})=>calculateHeaderLength(e.map(i=>i.bytes.byteLength)),createWriter$1=(e,i={})=>{const{roots:o=[],byteOffset:s=0,byteLength:c=e.byteLength,headerSize:g=headerLength({roots:o})}=i,b=new Uint8Array(e,s,c),$=new CarBufferWriter(b,g);for(const _e of o)$.addRoot(_e);return $},Kinds={Null:e=>e===null,Int:e=>Number.isInteger(e),Float:e=>typeof e=="number"&&Number.isFinite(e),String:e=>typeof e=="string",Bool:e=>typeof e=="boolean",Bytes:e=>e instanceof Uint8Array,Link:e=>!Kinds.Null(e)&&typeof e=="object"&&e.asCID===e,List:e=>Array.isArray(e),Map:e=>!Kinds.Null(e)&&typeof e=="object"&&e.asCID!==e&&!Kinds.List(e)&&!Kinds.Bytes(e)},Types={Int:Kinds.Int,"CarHeader > version":e=>Types.Int(e),"CarHeader > roots (anon) > valueType (anon)":Kinds.Link,"CarHeader > roots (anon)":e=>Kinds.List(e)&&Array.prototype.every.call(e,Types["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":e=>Types["CarHeader > roots (anon)"](e),CarHeader:e=>{const i=e&&Object.keys(e);return Kinds.Map(e)&&["version"].every(o=>i.includes(o))&&Object.entries(e).every(([o,s])=>Types["CarHeader > "+o]&&Types["CarHeader > "+o](s))}},CarHeader=Types.CarHeader,CIDV0_BYTES={SHA2_256:18,LENGTH:32,DAG_PB:112},V2_HEADER_LENGTH=16+8+8+8;function decodeVarint$1(e,i){if(!e.length)throw new Error("Unexpected end of data");const o=varint.decode(e);return i.seek(varint.decode.bytes),o}function decodeV2Header(e){const i=new DataView(e.buffer,e.byteOffset,e.byteLength);let o=0;return{version:2,characteristics:[i.getBigUint64(o,!0),i.getBigUint64(o+=8,!0)],dataOffset:Number(i.getBigUint64(o+=8,!0)),dataSize:Number(i.getBigUint64(o+=8,!0)),indexOffset:Number(i.getBigUint64(o+=8,!0))}}function getMultihashLength(e){varint.decode(e);const i=varint.decode.bytes,o=varint.decode(e.subarray(varint.decode.bytes)),s=varint.decode.bytes;return i+s+o}async function readHeader(e,i){const o=decodeVarint$1(await e.upTo(8),e);if(o===0)throw new Error("Invalid CAR header (zero length)");const s=await e.exactly(o,!0),c=decode$h(s);if(!CarHeader(c))throw new Error("Invalid CAR header format");if(c.version!==1&&c.version!==2||i!==void 0&&c.version!==i)throw new Error(`Invalid CAR version: ${c.version}${i!==void 0?` (expected ${i})`:""}`);const g=Array.isArray(c.roots);if(c.version===1&&!g||c.version===2&&g)throw new Error("Invalid CAR header format");if(c.version===1)return c;const b=decodeV2Header(await e.exactly(V2_HEADER_LENGTH,!0));e.seek(b.dataOffset-e.pos);const $=await readHeader(e,1);return Object.assign($,b)}async function readCid(e){const i=await e.exactly(2,!1);if(i[0]===CIDV0_BYTES.SHA2_256&&i[1]===CIDV0_BYTES.LENGTH){const b=await e.exactly(34,!0),$=decode$l(b);return CID.create(0,CIDV0_BYTES.DAG_PB,$)}const o=decodeVarint$1(await e.upTo(8),e);if(o!==1)throw new Error(`Unexpected CID version (${o})`);const s=decodeVarint$1(await e.upTo(8),e),c=await e.exactly(getMultihashLength(await e.upTo(8)),!0),g=decode$l(c);return CID.create(o,s,g)}async function readBlockHead(e){const i=e.pos;let o=decodeVarint$1(await e.upTo(8),e);if(o===0)throw new Error("Invalid CAR section (zero length)");o+=e.pos-i;const s=await readCid(e),c=o-Number(e.pos-i);return{cid:s,length:o,blockLength:c}}async function readBlock(e){const{cid:i,blockLength:o}=await readBlockHead(e);return{bytes:await e.exactly(o,!0),cid:i}}async function readBlockIndex(e){const i=e.pos,{cid:o,length:s,blockLength:c}=await readBlockHead(e),g={cid:o,length:s,blockLength:c,offset:i,blockOffset:e.pos};return e.seek(g.blockLength),g}function createDecoder(e){const i=(async()=>{const o=await readHeader(e);if(o.version===2){const s=e.pos-o.dataOffset;e=limitReader(e,o.dataSize-s)}return o})();return{header:()=>i,async*blocks(){for(await i;(await e.upTo(8)).length>0;)yield await readBlock(e)},async*blocksIndex(){for(await i;(await e.upTo(8)).length>0;)yield await readBlockIndex(e)}}}function bytesReader(e){let i=0;return{async upTo(o){return e.subarray(i,i+Math.min(o,e.length-i))},async exactly(o,s=!1){if(o>e.length-i)throw new Error("Unexpected end of data");const c=e.subarray(i,i+o);return s&&(i+=o),c},seek(o){i+=o},get pos(){return i}}}function chunkReader(e){let i=0,o=0,s=0,c=new Uint8Array(0);const g=async b=>{o=c.length-s;const $=[c.subarray(s)];for(;o<b;){const et=await e();if(et==null)break;o<0?et.length>o&&$.push(et.subarray(-o)):$.push(et),o+=et.length}c=new Uint8Array($.reduce((et,nt)=>et+nt.length,0));let _e=0;for(const et of $)c.set(et,_e),_e+=et.length;s=0};return{async upTo(b){return c.length-s<b&&await g(b),c.subarray(s,s+Math.min(c.length-s,b))},async exactly(b,$=!1){if(c.length-s<b&&await g(b),c.length-s<b)throw new Error("Unexpected end of data");const _e=c.subarray(s,s+b);return $&&(i+=b,s+=b),_e},seek(b){i+=b,s+=b},get pos(){return i}}}function asyncIterableReader(e){const i=e[Symbol.asyncIterator]();async function o(){const s=await i.next();return s.done?null:s.value}return chunkReader(o)}function limitReader(e,i){let o=0;return{async upTo(s){let c=await e.upTo(s);return c.length+o>i&&(c=c.subarray(0,i-o)),c},async exactly(s,c=!1){const g=await e.exactly(s,c);if(g.length+o>i)throw new Error("Unexpected end of data");return c&&(o+=s),g},seek(s){o+=s,e.seek(s)},get pos(){return e.pos}}}class CarReader{constructor(i,o){this._header=i,this._blocks=o,this._keys=o.map(s=>s.cid.toString())}get version(){return this._header.version}async getRoots(){return this._header.roots}async has(i){return this._keys.indexOf(i.toString())>-1}async get(i){const o=this._keys.indexOf(i.toString());return o>-1?this._blocks[o]:void 0}async*blocks(){for(const i of this._blocks)yield i}async*cids(){for(const i of this._blocks)yield i.cid}static async fromBytes(i){if(!(i instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return decodeReaderComplete(bytesReader(i))}static async fromIterable(i){if(!i||typeof i[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return decodeReaderComplete(asyncIterableReader(i))}}async function decodeReaderComplete(e){const i=createDecoder(e),o=await i.header(),s=[];for await(const c of i.blocks())s.push(c);return new CarReader(o,s)}function createHeader(e){const i=encode$g({version:1,roots:e}),o=varint.encode(i.length),s=new Uint8Array(o.length+i.length);return s.set(o,0),s.set(i,o.length),s}function createEncoder(e){return{async setRoots(i){const o=createHeader(i);await e.write(o)},async writeBlock(i){const{cid:o,bytes:s}=i;await e.write(new Uint8Array(varint.encode(o.bytes.length+s.length))),await e.write(o.bytes),s.length&&await e.write(s)},async close(){await e.end()}}}function noop$2(){}function create$6(){const e=[];let i=null,o=noop$2,s=!1,c=null,g=noop$2;const b=()=>(i||(i=new Promise(et=>{o=()=>{i=null,o=noop$2,et()}})),i),$={write(et){e.push(et);const nt=b();return g(),nt},async end(){s=!0;const et=b();g(),await et}},_e={async next(){const et=e.shift();return et?(e.length===0&&o(),{done:!1,value:et}):s?(o(),{done:!0,value:void 0}):(c||(c=new Promise(nt=>{g=()=>(c=null,g=noop$2,nt(_e.next()))})),c)}};return{writer:$,iterator:_e}}class CarWriter{constructor(i,o){this._encoder=o,this._mutex=o.setRoots(i),this._ended=!1}async put(i){if(!(i.bytes instanceof Uint8Array)||!i.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");const o=CID.asCID(i.cid);if(!o)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:o,bytes:i.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(i){i=toRoots(i);const{encoder:o,iterator:s}=encodeWriter(),c=new CarWriter(i,o),g=new CarWriterOut(s);return{writer:c,out:g}}static createAppender(){const{encoder:i,iterator:o}=encodeWriter();i.setRoots=()=>Promise.resolve();const s=new CarWriter([],i),c=new CarWriterOut(o);return{writer:s,out:c}}static async updateRootsInBytes(i,o){const s=bytesReader(i);await readHeader(s);const c=createHeader(o);if(Number(s.pos)!==c.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${s.pos} bytes, new header is ${c.length} bytes)`);return i.set(c,0),i}}class CarWriterOut{constructor(i){this._iterator=i}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}}function encodeWriter(){const e=create$6(),{writer:i,iterator:o}=e;return{encoder:createEncoder(i),iterator:o}}function toRoots(e){if(e===void 0)return[];if(!Array.isArray(e)){const o=CID.asCID(e);if(!o)throw new TypeError("roots must be a single CID or an array of CIDs");return[o]}const i=[];for(const o of e){const s=CID.asCID(o);if(!s)throw new TypeError("roots must be a single CID or an array of CIDs");i.push(s)}return i}const instanceOfAny=(e,i)=>i.some(o=>e instanceof o);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(e){const i=new Promise((o,s)=>{const c=()=>{e.removeEventListener("success",g),e.removeEventListener("error",b)},g=()=>{o(wrap$1(e.result)),c()},b=()=>{s(e.error),c()};e.addEventListener("success",g),e.addEventListener("error",b)});return i.then(o=>{o instanceof IDBCursor&&cursorRequestMap.set(o,e)}).catch(()=>{}),reverseTransformCache.set(i,e),i}function cacheDonePromiseForTransaction(e){if(transactionDoneMap.has(e))return;const i=new Promise((o,s)=>{const c=()=>{e.removeEventListener("complete",g),e.removeEventListener("error",b),e.removeEventListener("abort",b)},g=()=>{o(),c()},b=()=>{s(e.error||new DOMException("AbortError","AbortError")),c()};e.addEventListener("complete",g),e.addEventListener("error",b),e.addEventListener("abort",b)});transactionDoneMap.set(e,i)}let idbProxyTraps={get(e,i,o){if(e instanceof IDBTransaction){if(i==="done")return transactionDoneMap.get(e);if(i==="objectStoreNames")return e.objectStoreNames||transactionStoreNamesMap.get(e);if(i==="store")return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return wrap$1(e[i])},set(e,i,o){return e[i]=o,!0},has(e,i){return e instanceof IDBTransaction&&(i==="done"||i==="store")?!0:i in e}};function replaceTraps(e){idbProxyTraps=e(idbProxyTraps)}function wrapFunction(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(i,...o){const s=e.call(unwrap(this),i,...o);return transactionStoreNamesMap.set(s,i.sort?i.sort():[i]),wrap$1(s)}:getCursorAdvanceMethods().includes(e)?function(...i){return e.apply(unwrap(this),i),wrap$1(cursorRequestMap.get(this))}:function(...i){return wrap$1(e.apply(unwrap(this),i))}}function transformCachableValue(e){return typeof e=="function"?wrapFunction(e):(e instanceof IDBTransaction&&cacheDonePromiseForTransaction(e),instanceOfAny(e,getIdbProxyableTypes())?new Proxy(e,idbProxyTraps):e)}function wrap$1(e){if(e instanceof IDBRequest)return promisifyRequest(e);if(transformCache.has(e))return transformCache.get(e);const i=transformCachableValue(e);return i!==e&&(transformCache.set(e,i),reverseTransformCache.set(i,e)),i}const unwrap=e=>reverseTransformCache.get(e);function openDB(e,i,{blocked:o,upgrade:s,blocking:c,terminated:g}={}){const b=indexedDB.open(e,i),$=wrap$1(b);return s&&b.addEventListener("upgradeneeded",_e=>{s(wrap$1(b.result),_e.oldVersion,_e.newVersion,wrap$1(b.transaction),_e)}),o&&b.addEventListener("blocked",_e=>o(_e.oldVersion,_e.newVersion,_e)),$.then(_e=>{g&&_e.addEventListener("close",()=>g()),c&&_e.addEventListener("versionchange",et=>c(et.oldVersion,et.newVersion,et))}).catch(()=>{}),$}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(e,i){if(!(e instanceof IDBDatabase&&!(i in e)&&typeof i=="string"))return;if(cachedMethods.get(i))return cachedMethods.get(i);const o=i.replace(/FromIndex$/,""),s=i!==o,c=writeMethods.includes(o);if(!(o in(s?IDBIndex:IDBObjectStore).prototype)||!(c||readMethods.includes(o)))return;const g=async function(b,...$){const _e=this.transaction(b,c?"readwrite":"readonly");let et=_e.store;return s&&(et=et.index($.shift())),(await Promise.all([et[o](...$),c&&_e.done]))[0]};return cachedMethods.set(i,g),g}replaceTraps(e=>({...e,get:(i,o,s)=>getMethod(i,o)||e.get(i,o,s),has:(i,o)=>!!getMethod(i,o)||e.has(i,o)}));var cargoQueueExports={},cargoQueue$1={get exports(){return cargoQueueExports},set exports(e){cargoQueueExports=e}},queueExports={},queue={get exports(){return queueExports},set exports(e){queueExports=e}},onlyOnceExports={},onlyOnce={get exports(){return onlyOnceExports},set exports(e){onlyOnceExports=e}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=o;function o(s){return function(...c){if(s===null)throw new Error("Callback was already called.");var g=s;s=null,g.apply(this,c)}}e.exports=i.default})(onlyOnce,onlyOnceExports);var setImmediate$1={};Object.defineProperty(setImmediate$1,"__esModule",{value:!0});setImmediate$1.fallback=fallback;setImmediate$1.wrap=wrap;var hasQueueMicrotask=setImmediate$1.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,hasSetImmediate=setImmediate$1.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,hasNextTick=setImmediate$1.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function fallback(e){setTimeout(e,0)}function wrap(e){return(i,...o)=>e(()=>i(...o))}var _defer;hasQueueMicrotask?_defer=queueMicrotask:hasSetImmediate?_defer=setImmediate:hasNextTick?_defer=process.nextTick:_defer=fallback;setImmediate$1.default=wrap(_defer);var DoublyLinkedListExports={},DoublyLinkedList={get exports(){return DoublyLinkedListExports},set exports(e){DoublyLinkedListExports=e}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});class o{constructor(){this.head=this.tail=null,this.length=0}removeLink(g){return g.prev?g.prev.next=g.next:this.head=g.next,g.next?g.next.prev=g.prev:this.tail=g.prev,g.prev=g.next=null,this.length-=1,g}empty(){for(;this.head;)this.shift();return this}insertAfter(g,b){b.prev=g,b.next=g.next,g.next?g.next.prev=b:this.tail=b,g.next=b,this.length+=1}insertBefore(g,b){b.prev=g.prev,b.next=g,g.prev?g.prev.next=b:this.head=b,g.prev=b,this.length+=1}unshift(g){this.head?this.insertBefore(this.head,g):s(this,g)}push(g){this.tail?this.insertAfter(this.tail,g):s(this,g)}shift(){return this.head&&this.removeLink(this.head)}pop(){return this.tail&&this.removeLink(this.tail)}toArray(){return[...this]}*[Symbol.iterator](){for(var g=this.head;g;)yield g.data,g=g.next}remove(g){for(var b=this.head;b;){var{next:$}=b;g(b)&&this.removeLink(b),b=$}return this}}i.default=o;function s(c,g){c.length=1,c.head=c.tail=g}e.exports=i.default})(DoublyLinkedList,DoublyLinkedListExports);var wrapAsync={},asyncifyExports={},asyncify={get exports(){return asyncifyExports},set exports(e){asyncifyExports=e}},initialParamsExports={},initialParams={get exports(){return initialParamsExports},set exports(e){initialParamsExports=e}};(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(o){return function(...s){var c=s.pop();return o.call(this,s,c)}},e.exports=i.default})(initialParams,initialParamsExports);var hasRequiredAsyncify;function requireAsyncify(){return hasRequiredAsyncify||(hasRequiredAsyncify=1,function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=_e;var o=initialParamsExports,s=$(o),c=setImmediate$1,g=$(c),b=requireWrapAsync();function $(ot){return ot&&ot.__esModule?ot:{default:ot}}function _e(ot){return(0,b.isAsync)(ot)?function(...ct){const at=ct.pop(),lt=ot.apply(this,ct);return et(lt,at)}:(0,s.default)(function(ct,at){var lt;try{lt=ot.apply(this,ct)}catch(gt){return at(gt)}if(lt&&typeof lt.then=="function")return et(lt,at);at(null,lt)})}function et(ot,ct){return ot.then(at=>{nt(ct,null,at)},at=>{nt(ct,at&&at.message?at:new Error(at))})}function nt(ot,ct,at){try{ot(ct,at)}catch(lt){(0,g.default)(gt=>{throw gt},lt)}}e.exports=i.default}(asyncify,asyncifyExports)),asyncifyExports}var hasRequiredWrapAsync;function requireWrapAsync(){if(hasRequiredWrapAsync)return wrapAsync;hasRequiredWrapAsync=1,Object.defineProperty(wrapAsync,"__esModule",{value:!0}),wrapAsync.isAsyncIterable=wrapAsync.isAsyncGenerator=wrapAsync.isAsync=void 0;var e=requireAsyncify(),i=o(e);function o($){return $&&$.__esModule?$:{default:$}}function s($){return $[Symbol.toStringTag]==="AsyncFunction"}function c($){return $[Symbol.toStringTag]==="AsyncGenerator"}function g($){return typeof $[Symbol.asyncIterator]=="function"}function b($){if(typeof $!="function")throw new Error("expected a function");return s($)?(0,i.default)($):$}return wrapAsync.default=b,wrapAsync.isAsync=s,wrapAsync.isAsyncGenerator=c,wrapAsync.isAsyncIterable=g,wrapAsync}(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=ot;var o=onlyOnceExports,s=nt(o),c=setImmediate$1,g=nt(c),b=DoublyLinkedListExports,$=nt(b),_e=requireWrapAsync(),et=nt(_e);function nt(ct){return ct&&ct.__esModule?ct:{default:ct}}function ot(ct,at,lt){if(at==null)at=1;else if(at===0)throw new RangeError("Concurrency must not be zero");var gt=(0,et.default)(ct),wt=0,ft=[];const ut={error:[],drain:[],saturated:[],unsaturated:[],empty:[]};function pt(Qt,ir){ut[Qt].push(ir)}function vt(Qt,ir){const rr=(...ar)=>{bt(Qt,rr),ir(...ar)};ut[Qt].push(rr)}function bt(Qt,ir){if(!Qt)return Object.keys(ut).forEach(rr=>ut[rr]=[]);if(!ir)return ut[Qt]=[];ut[Qt]=ut[Qt].filter(rr=>rr!==ir)}function Ct(Qt,...ir){ut[Qt].forEach(rr=>rr(...ir))}var At=!1;function Pt(Qt,ir,rr,ar){if(ar!=null&&typeof ar!="function")throw new Error("task callback must be a function");er.started=!0;var It,Ht;function qt(yt,...$t){if(yt)return rr?Ht(yt):It();if($t.length<=1)return It($t[0]);It($t)}var dr=er._createTaskItem(Qt,rr?qt:ar||qt);if(ir?er._tasks.unshift(dr):er._tasks.push(dr),At||(At=!0,(0,g.default)(()=>{At=!1,er.process()})),rr||!ar)return new Promise((yt,$t)=>{It=yt,Ht=$t})}function Rt(Qt){return function(ir,...rr){wt-=1;for(var ar=0,It=Qt.length;ar<It;ar++){var Ht=Qt[ar],qt=ft.indexOf(Ht);qt===0?ft.shift():qt>0&&ft.splice(qt,1),Ht.callback(ir,...rr),ir!=null&&Ct("error",ir,Ht.data)}wt<=er.concurrency-er.buffer&&Ct("unsaturated"),er.idle()&&Ct("drain"),er.process()}}function Wt(Qt){return Qt.length===0&&er.idle()?((0,g.default)(()=>Ct("drain")),!0):!1}const hr=Qt=>ir=>{if(!ir)return new Promise((rr,ar)=>{vt(Qt,(It,Ht)=>{if(It)return ar(It);rr(Ht)})});bt(Qt),pt(Qt,ir)};var Sr=!1,er={_tasks:new $.default,_createTaskItem(Qt,ir){return{data:Qt,callback:ir}},*[Symbol.iterator](){yield*er._tasks[Symbol.iterator]()},concurrency:at,payload:lt,buffer:at/4,started:!1,paused:!1,push(Qt,ir){return Array.isArray(Qt)?Wt(Qt)?void 0:Qt.map(rr=>Pt(rr,!1,!1,ir)):Pt(Qt,!1,!1,ir)},pushAsync(Qt,ir){return Array.isArray(Qt)?Wt(Qt)?void 0:Qt.map(rr=>Pt(rr,!1,!0,ir)):Pt(Qt,!1,!0,ir)},kill(){bt(),er._tasks.empty()},unshift(Qt,ir){return Array.isArray(Qt)?Wt(Qt)?void 0:Qt.map(rr=>Pt(rr,!0,!1,ir)):Pt(Qt,!0,!1,ir)},unshiftAsync(Qt,ir){return Array.isArray(Qt)?Wt(Qt)?void 0:Qt.map(rr=>Pt(rr,!0,!0,ir)):Pt(Qt,!0,!0,ir)},remove(Qt){er._tasks.remove(Qt)},process(){if(!Sr){for(Sr=!0;!er.paused&&wt<er.concurrency&&er._tasks.length;){var Qt=[],ir=[],rr=er._tasks.length;er.payload&&(rr=Math.min(rr,er.payload));for(var ar=0;ar<rr;ar++){var It=er._tasks.shift();Qt.push(It),ft.push(It),ir.push(It.data)}wt+=1,er._tasks.length===0&&Ct("empty"),wt===er.concurrency&&Ct("saturated");var Ht=(0,s.default)(Rt(Qt));gt(ir,Ht)}Sr=!1}},length(){return er._tasks.length},running(){return wt},workersList(){return ft},idle(){return er._tasks.length+wt===0},pause(){er.paused=!0},resume(){er.paused!==!1&&(er.paused=!1,(0,g.default)(er.process))}};return Object.defineProperties(er,{saturated:{writable:!1,value:hr("saturated")},unsaturated:{writable:!1,value:hr("unsaturated")},empty:{writable:!1,value:hr("empty")},drain:{writable:!1,value:hr("drain")},error:{writable:!1,value:hr("error")}}),er}e.exports=i.default})(queue,queueExports);(function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=g;var o=queueExports,s=c(o);function c(b){return b&&b.__esModule?b:{default:b}}function g(b,$,_e){return(0,s.default)(b,$,_e)}e.exports=i.default})(cargoQueue$1,cargoQueueExports);const cargoQueue=getDefaultExportFromCjs(cargoQueueExports);var Do,_s;class Valet{constructor(i="default"){Kr(this,"idb",null);vr(this,Do,null);vr(this,_s,new Set);Kr(this,"uploadFunction",null);Kr(this,"withDB",async i=>(this.idb||(this.idb=await openDB(`fp.${this.name}.valet`,2,{upgrade(o,s,c,g){s<1&&(o.createObjectStore("cars"),o.createObjectStore("cidToCar",{keyPath:"car"}).createIndex("cids","cids",{multiEntry:!0})),s<2&&g.objectStore("cidToCar").createIndex("pending","pending")}})),await i(this.idb)));Kr(this,"remoteBlockFunction",null);this.name=i,an(this,Do,cargoQueue(async(o,s)=>{if(console.log("queue worker",o.length,o.reduce((c,g)=>c+g.value.length,0)),this.uploadFunction)return await this.withDB(async c=>{for(const g of o){await this.uploadFunction(g.carCid,g.value);const b=await c.get("cidToCar",g.carCid);delete b.pending,await c.put("cidToCar",b)}});s()})),jt(this,Do).drain(async()=>await this.withDB(async o=>{const s=(await o.getAllFromIndex("cidToCar","pending")).map(c=>c.car);for(const c of s){await this.uploadFunction(c,await o.get("cars",c));const g=await o.get("cidToCar",c);delete g.pending,await o.put("cidToCar",g)}}))}async parkCar(i,o,s){if(await this.withDB(async c=>{const g=c.transaction(["cars","cidToCar"],"readwrite");return await g.objectStore("cars").put(o,i),await g.objectStore("cidToCar").put({pending:"y",car:i,cids:Array.from(s)}),await g.done}),this.uploadFunction){if(jt(this,_s).has(i))return;jt(this,Do).push({carCid:i,value:o}),jt(this,_s).add(i)}}async getBlock(i){return await this.withDB(async o=>{const s=o.transaction(["cars","cidToCar"],"readonly"),c=await s.objectStore("cidToCar").index("cids").get(i),g=c==null?void 0:c.car;if(!g)throw new Error("Missing block: "+i);const b=await s.objectStore("cars").get(g),_e=await(await CarReader.fromBytes(b)).get(CID.parse(i));if(_e)return _e.bytes})}}Do=new WeakMap,_s=new WeakMap;const husherMap$1=new Map,husher$1=(e,i)=>(husherMap$1.has(e)||husherMap$1.set(e,i().finally(()=>setTimeout(()=>husherMap$1.delete(e),100))),husherMap$1.get(e));var Lo,gp,Ro,$u,lw,Tu,Cu;class TransactionBlockstore{constructor(i){vr(this,$u);vr(this,Lo,new Map);Kr(this,"valet",null);vr(this,gp,"blkz."+Math.random().toString(36).substring(2,4));vr(this,Ro,new Set);vr(this,Tu,async i=>{const o=new Set;for(const{cid:s,bytes:c}of i.entries()){const g=s.toString();jt(this,Lo).has(g)||(jt(this,Lo).set(g,c),o.add(g))}o.size>0&&await jt(this,Cu).call(this,i,o)});vr(this,Cu,async(i,o)=>{if(i.lastCid){const s=await blocksToCarBlock(i.lastCid,i);await this.valet.parkCar(s.cid.toString(),s.bytes,o)}});this.valet=new Valet(i)}async get(i){const o=i.toString(),s=await Promise.any([Rr(this,$u,lw).call(this,o),this.commitedGet(o)]).catch(c=>this.networkGet(o));if(!s)throw new Error("Missing block: "+o);return{cid:i,bytes:s}}async commitedGet(i){const o=jt(this,Lo).get(i);return o||await this.valet.getBlock(i)}async networkGet(i){if(this.valet.remoteBlockFunction){const o=await husher$1(i,async()=>await this.valet.remoteBlockFunction(i));if(o)return doTransaction("networkGot: "+i,this,async s=>{await s.put(CID.parse(i),o)}),o}else return!1}put(i,o){throw new Error("use a transaction to put")}begin(i=""){const o=new InnerBlockstore(i,this);return jt(this,Ro).add(o),o}async commit(i){await jt(this,Tu).call(this,i)}retire(i){jt(this,Ro).delete(i)}}Lo=new WeakMap,gp=new WeakMap,Ro=new WeakMap,$u=new WeakSet,lw=async function(i){for(const o of jt(this,Ro)){const s=await o.get(i);if(s&&s.bytes)return s.bytes}throw new Error("Missing block: "+i)},Tu=new WeakMap,Cu=new WeakMap;const doTransaction=async(e,i,o)=>{if(!i.commit)return await o(i);const s=i.begin(e);try{const c=await o(s);return await i.commit(s),c}catch(c){throw console.error(`Transaction ${e} failed`,c,c.stack),c}finally{i.retire(s)}},blocksToCarBlock=async(e,i)=>{let o=0;const s=headerLength({roots:[e]});o+=s;for(const{cid:b,bytes:$}of i.entries())o+=blockLength({cid:b,bytes:$});const c=new Uint8Array(o),g=await createWriter$1(c,{headerSize:s});g.addRoot(e);for(const{cid:b,bytes:$}of i.entries())g.write({cid:b,bytes:$});return await g.close(),await encode$i({value:g.bytes,hasher:sha256,codec:raw})};var Oo;class InnerBlockstore{constructor(i,o){vr(this,Oo,new Map);Kr(this,"lastCid",null);Kr(this,"label","");Kr(this,"parentBlockstore",null);this.label=i,this.parentBlockstore=o}async get(i){const o=i.toString();let s=jt(this,Oo).get(o);if(s)return{cid:i,bytes:s};if(s=await this.parentBlockstore.commitedGet(o),s)return{cid:i,bytes:s}}put(i,o){jt(this,Oo).set(i.toString(),o),this.lastCid=i}*entries(){for(const[i,o]of jt(this,Oo))yield{cid:parse$3(i),bytes:o}}}Oo=new WeakMap;const opts={cache:nocache,chunker:bf(3),codec:codec$2,hasher:sha256,compare:simpleCompare},withLog=async(e,i)=>await i(),makeGetBlock=e=>({getBlock:async o=>{const{cid:s,bytes:c}=await withLog(o,()=>e.get(o));return create$a({cid:s,bytes:c,hasher:sha256,codec:codec$2})}});async function createAndSaveNewEvent({inBlocks:e,bigPut:i,root:o,event:s,head:c,additions:g,removals:b=[]}){let $;const{key:_e,value:et,del:nt}=s,ot={type:"put",root:{cid:o.cid,bytes:o.bytes,value:o.value},key:_e};nt?(ot.value=null,ot.type="del"):ot.value=et;const ct=await EventBlock.create(ot,c);return i(ct),{head:c,cids:$}=await advance(e,c,ct.cid),{root:o,additions:g,removals:b,head:c,clockCIDs:$,event:ct}}const makeGetAndPutBlock=e=>{const{getBlock:i,cids:o}=makeGetBlock(e),s=e.put.bind(e);return{getBlock:i,bigPut:async(g,b)=>{const{cid:$,bytes:_e}=g;s($,_e),b&&b.set($.toString(),g)},blocks:e,cids:o}},bulkFromEvents=e=>e.map(({value:i})=>{const{data:{type:o,value:s,key:c}}=i;return o==="put"?{key:c,value:s}:{key:c,del:!0}}),prollyRootFromAncestor=async(e,i,o)=>{const s=await e.get(i),{root:c}=s.value.data;return load$1({cid:c.cid,get:o,...opts})};async function put(e,i,o,s){const{getBlock:c,bigPut:g,blocks:b}=makeGetAndPutBlock(e);if(!i.length){const wt=new Map;let ft;for await(const ut of create$8({get:c,list:[o],...opts}))ft=await ut.block,g(ft,wt);return createAndSaveNewEvent({inBlocks:e,bigPut:g,root:ft,event:o,head:i,additions:Array.from(wt.values())})}const $=new EventFetcher(b),{ancestor:_e,sorted:et}=await findCommonAncestorWithSortedEvents($,i),nt=await prollyRootFromAncestor($,_e,c),ot=bulkFromEvents(et),{root:ct,blocks:at}=await nt.bulk([...ot,o]),lt=await ct.block,gt=new Map;g(lt,gt);for(const wt of at)g(wt,gt);return createAndSaveNewEvent({inBlocks:e,bigPut:g,root:lt,event:o,head:i,additions:Array.from(gt.values())})}async function root(e,i){if(!i.length)throw new Error("no head");const{getBlock:o,blocks:s}=makeGetAndPutBlock(e),c=new EventFetcher(s),{ancestor:g,sorted:b}=await findCommonAncestorWithSortedEvents(c,i),$=await prollyRootFromAncestor(c,g,o),_e=bulkFromEvents(b),{root:et,blocks:nt}=await $.bulk(_e);return await doTransaction("root",e,async ot=>{const{bigPut:ct}=makeGetAndPutBlock(ot);for(const at of nt)ct(at)}),{cids:c.cids,node:et}}async function eventsSince(e,i,o){if(!i.length)throw new Error("no head");const s=[...o,...i],{cids:c,events:g}=await findEventsToSync(e,s);return{clockCIDs:c,result:g.map(({value:{data:b}})=>b)}}async function getAll(e,i){if(!i.length)return{clockCIDs:new CIDCounter,cids:new CIDCounter,result:[]};const{node:o,cids:s}=await root(e,i),{result:c,cids:g}=await o.getAllEntries();return{clockCIDs:s,cids:g,result:c.map(({key:b,value:$})=>({key:b,value:$}))}}async function get(e,i,o){if(!i.length)return{cids:new CIDCounter,result:null};const{node:s,cids:c}=await root(e,i),{result:g,cids:b}=await s.get(o);return{result:g,cids:b,clockCIDs:c}}async function*vis(e,i){if(!i.length)return{cids:new CIDCounter,result:null};const{node:o,cids:s}=await root(e,i),c=[];for await(const g of o.vis())yield g;return{vis:c.join(`
`),cids:s}}var charwise={},number={};number.encode=function(e){if(isNaN(e))return"DaN";if(e===0)return"FE  0M0";if(e===1/0)return"FF";if(e===-1/0)return"DD";var i=e.toExponential().split("e"),o=Number(i[1])+500,s=i[0]+(i[0].indexOf(".")===-1?".":"")+"0".repeat(20),c="E"+padStart(String(o),3)+"M"+String(s);return e>0?"F"+c:"D"+flip(c)};number.decode=function(e){if(e==="DaN")return NaN;if(e==="FF")return 1/0;if(e==="DD")return-1/0;var i=e[0]==="D",o=(i?flip(e):e).slice(2).split("M");return Number((i?"-":"")+o[1]+"e"+String(Number(o[0])-500))};function flip(e){for(var i="",o=0;o<e.length;o++){var s=e[o];isNaN(Number(s))||s===" "?s!=="-"&&(i+=s):i+=String(9-Number(s))}return i}function padStart(e,i){return" ".repeat(i-e.length).substr(0,i)+e}var object={},dictEscape={"?":"?@","!":"??",'"':"?%"};function escape(e){return/[!"]/.test(e)?e.replace(/[\?!"]/g,function(i){return dictEscape[i]}):e}var dictUnescape={"?@":"?","??":"!","?%":'"'};function unescape(e){return/\?[%\?@]/.test(e)?e.replace(/\?[%\?@]/g,function(i){return dictUnescape[i]}):e}object.factory=function(e){return{encode:i,decode:s};function i(c){if(c===null)return"A";if(!Array.isArray(c))throw new Error("can only encode arrays");var g=c.length;if(g==0)return"K!";for(var b=o(c[0]),$=1;$<g;$++)b+='"'+o(c[$]);return"K"+b+"!"}function o(c){return typeof c=="object"?i(c):escape(e.encode(c))}function s(c){if(c==="A")return null;if(c==="K!")return[];for(var g=c.split('"'),b=[[]],$,_e=0,et=g.length,nt=0;nt<et;nt++){for(var ot=g[nt],ct=ot.length,at=0;ot[at]=="K";)at++;for(var lt=0;ot[ct-lt-1]=="!";)lt++;for(var gt=ot.slice(at,ct-lt),ft=_e+at,wt=_e;wt<ft;wt++)b[wt+1]=[],b[wt].push(b[wt+1]),_e=ft,$=b[_e];gt.length!==0&&$.push(e.decode(unescape(gt)));for(var ft=_e-lt,wt=ft;wt<_e;wt++)b[wt+1]=[],_e=ft,$=b[_e]}return b[0][0]}};(function(e){var i=number,o=object;e.flip=function(c){var g=c.toString(),b="";for(var $ in g)b+=g[$]=="."?".":9-+g[$];return b},e.number=i,e.string={encode:function(c){return/\x00|\x01/.test(c)?"J"+c.replace(/\x01/g,"").replace(/\x00/g,""):"J"+c},decode:function(c){if(c[0]==="J")return c.substring(1)}},e.encode=function(c){return e[typeof c].encode(c)},e.decode=function(c){if(c==="")return c;if(!s[c[0]])throw new Error("no decoder for:"+JSON.stringify(c));return s[c[0]](c)},e.object=o.factory(e),e.boolean={encode:function(c){return c?"C":"B"},decode:function(c){return c==="C"}},e.undefined={encode:function(c){return"L"},decode:function(){}};var s={A:e.object.decode,B:e.boolean.decode,C:e.boolean.decode,D:e.number.decode,F:e.number.decode,J:e.string.decode,K:e.object.decode,L:e.undefined.decode};e.buffer=!1,e.type="charwise"})(charwise);var jo,Ss,fp,$s,hp,Ts,pp;const mp=class{constructor(i,o,s,c={}){vr(this,Ss);vr(this,$s);vr(this,Ts);vr(this,jo,new Set);this.name=(s==null?void 0:s.name)||"global",this.instanceId=`fp.${this.name}.${Math.random().toString(36).substring(2,7)}`,this.blocks=i,this.clock=o,this.config=s,this.authCtx=c,this.indexes=new Map}toJSON(){return{clock:this.clockToJSON(),name:this.name,indexes:[...this.indexes.values()].map(i=>i.toJSON())}}clockToJSON(){return this.clock.map(i=>i.toString())}hydrate({clock:i,name:o}){this.name=o,this.clock=i}async notifyReset(){await Rr(this,Ss,fp).call(this,{reset:!0,clock:this.clock})}async changesSince(i){let o,s,c;if(i){const g=await eventsSince(this.blocks,this.clock,i),b=new Map;for(const{key:$,type:_e,value:et}of g.result.map(decodeEvent))_e==="del"?b.set($,{key:$,del:!0}):b.set($,{key:$,value:et});o=Array.from(b.values()),c=g.cids}else{const g=await getAll(this.blocks,this.clock);o=g.result.map(({key:b,value:$})=>decodeEvent({key:b,value:$})),s=g.cids}return{rows:o,clock:this.clock,proof:{data:await cidsToProof(s),clock:await cidsToProof(c)}}}async allDocuments(){const i=await getAll(this.blocks,this.clock);return{rows:i.result.map(({key:s,value:c})=>decodeEvent({key:s,value:c})).map(({key:s,value:c})=>({key:s,value:{_id:s,...c}})),clock:this.clock,proof:await cidsToProof(i.cids)}}registerListener(i){return jt(this,jo).add(i),()=>{jt(this,jo).delete(i)}}async put({_id:i,_proof:o,...s}){const c=i||"f"+Math.random().toString(36).slice(2);return await Rr(this,$s,hp).call(this,{_id:c,...s}),await Rr(this,Ts,pp).call(this,{key:c,value:s},s._clock)}async del(i){let o,s=null;return i._id?(o=i._id,s=i._clock):o=i,await Rr(this,$s,hp).call(this,{_id:o,_deleted:!0}),await Rr(this,Ts,pp).call(this,{key:o,value:null},s)}async get(i,o={}){const s=o.clock||this.clock,c=await get(this.blocks,s,charwise.encode(i));if(!c||c.result===null)throw new Error("Not found");const g=c.result;return o.mvcc===!0&&(g._clock=this.clockToJSON()),g._proof={data:await cidsToProof(c.cids),clock:this.clockToJSON()},g._id=i,g}async*vis(){return yield*vis(this.blocks,this.clock)}setCarUploader(i){this.blocks.valet.uploadFunction=i}setRemoteBlockReader(i){this.blocks.valet.remoteBlockFunction=i}};let Fireproof=mp;jo=new WeakMap,Ss=new WeakSet,fp=async function(i){for(const o of jt(this,jo))await o(i)},$s=new WeakSet,hp=async function(i){if(this.config&&this.config.validateChange){const o=await this.get(i._id).then(s=>s).catch(()=>({}));this.config.validateChange(i,o,this.authCtx)}},Ts=new WeakSet,pp=async function(i,o=null){const s=encodeEvent(i);if(o&&JSON.stringify(o)!==JSON.stringify(this.clockToJSON())&&(await eventsSince(this.blocks,this.clock,s.value._clock)).result.find(({key:$})=>$===s.key))throw new Error("MVCC conflict, document is changed, please reload the document and try again.");const c=await doTransaction("#putToProllyTree",this.blocks,async g=>await put(g,this.clock,s));if(!c)throw console.error("failed",s),new Error("failed to put at storage layer");return this.clock=c.head,await Rr(this,Ss,fp).call(this,[i]),{id:i.key,clock:this.clock,proof:{data:await cidsToProof(c.cids),clock:await cidsToProof(c.clockCIDs)}}},Kr(Fireproof,"storage",(i="global")=>new mp(new TransactionBlockstore(i),[],{name:i}));async function cidsToProof(e){return!e||!e.all?[]:[...await e.all()].map(o=>o.toString())}function decodeEvent(e){const i=charwise.decode(e.key);return{...e,key:i}}function encodeEvent(e){if(!(e&&e.key))return;const i=charwise.encode(e.key);return{...e,key:i}}const compare$1=(e,i)=>{const[o,s]=e,[c,g]=i,b=simpleCompare(o,c);return b!==0?b:refCompare$1(s,g)},refCompare$1=(e,i)=>{if(Number.isNaN(e))return-1;if(Number.isNaN(i))throw new Error("ref may not be Infinity or NaN");return Number.isFinite(e)?simpleCompare(e,i):1},getIndex=async(e,i)=>{const o=[i,NaN],s=[i,1/0],{result:c,cids:g}=await e.getRangeEntries(o,s);return{result:c.map(b=>{const[$,_e]=b.key;return{id:_e,key:$,row:b.value}}),cids:g}},getRange=async(e,i,o)=>{i=[i,NaN],o=[o,1/0];const{result:s,cids:c}=await e.getRangeEntries(i,o);return{result:s.map(b=>{const[$,_e]=b.key;return{id:_e,key:$,row:b.value}}),cids:c}};class DBIndexLeaf extends MapLeaf{get(i){return getIndex(this,i)}range(i,o){return getRange(this,i,o)}bulk(i,o={},s=!0){return super.bulk(i,{...classes,...o},s)}}class DBIndexBranch extends MapBranch{get(i){return getIndex(this,i)}range(i,o){return getRange(this,i,o)}bulk(i,o={},s=!0){return super.bulk(i,{...classes,...o},s)}}const LeafClass=DBIndexLeaf,BranchClass=DBIndexBranch,classes={LeafClass,BranchClass,LeafEntryClass:MapLeafEntry,BranchEntryClass:MapBranchEntry},defaults$2={...classes,compare:compare$1},create$5=e=>(e={...defaults$2,...e},create$8(e)),load=e=>(e={...defaults$2,...e},load$1(e)),compare=(e,i)=>{const[o,s]=e,[c,g]=i,b=simpleCompare(o,c);return b!==0?b:refCompare(s,g)},refCompare=(e,i)=>{if(Number.isNaN(e))return-1;if(Number.isNaN(i))throw new Error("ref may not be Infinity or NaN");return e===1/0?1:simpleCompare(e,i)},dbIndexOpts={cache:nocache,chunker:bf(3),codec:codec$2,hasher:sha256,compare},idIndexOpts={cache:nocache,chunker:bf(3),codec:codec$2,hasher:sha256,compare:simpleCompare},makeDoc$1=({key:e,value:i})=>({_id:e,...i}),indexEntriesForChanges=(e,i)=>{const o=[];return e.forEach(({key:s,value:c,del:g})=>{g||!c||i(makeDoc$1({key:s,value:c}),(b,$)=>{o.push({key:[charwise.encode(b),s],value:$})})}),o};var Pu,dw,Au,fw;const Iu=class{constructor(i,o,s){vr(this,Pu);vr(this,Au);this.database=i,i.indexBlocks||(i.indexBlocks=new TransactionBlockstore(i.name+".indexes")),typeof o=="string"?this.mapFnString=o:(this.mapFn=o,this.mapFnString=o.toString()),this.indexById={root:null,cid:null},this.indexByKey={root:null,cid:null},this.dbHead=null,s&&(this.indexById.cid=s.byId,this.indexByKey.cid=s.byKey,this.dbHead=s.db),this.instanceId=this.database.instanceId+`.DbIndex.${Math.random().toString(36).substring(2,7)}`,this.updateIndexPromise=null,Iu.registerWithDatabase(this,this.database)}static registerWithDatabase(i,o){if(o.indexes.has(i.mapFnString)){const s=o.indexes.get(i.mapFnString);s.mapFn?(s.dbHead=i.dbHead,s.indexById.cid=i.indexById.cid,s.indexByKey.cid=i.indexByKey.cid):(i.dbHead=s.dbHead,i.indexById.cid=s.indexById.cid,i.indexByKey.cid=s.indexByKey.cid,o.indexes.set(i.mapFnString,i))}else o.indexes.set(i.mapFnString,i)}toJSON(){var o,s,c;const i={code:this.mapFnString,clock:{db:null,byId:null,byKey:null}};return i.clock.db=(o=this.dbHead)==null?void 0:o.map(g=>g.toString()),i.clock.byId=(s=this.indexById.cid)==null?void 0:s.toString(),i.clock.byKey=(c=this.indexByKey.cid)==null?void 0:c.toString(),i}static fromJSON(i,{code:o,clock:s}){return new Iu(i,o,s)}async query(i,o=!0){o&&await Rr(this,Pu,dw).call(this,this.database.indexBlocks);const s=await doIndexQuery(this.database.indexBlocks,this.indexByKey,i);return{proof:{index:await cidsToProof(s.cids)},rows:s.result.map(({id:c,key:g,row:b})=>({id:c,key:charwise.decode(g),value:b}))}}};let DbIndex=Iu;Pu=new WeakSet,dw=async function(i){return this.updateIndexPromise?this.updateIndexPromise:(this.updateIndexPromise=Rr(this,Au,fw).call(this,i),this.updateIndexPromise.finally(()=>{this.updateIndexPromise=null}),this.updateIndexPromise)},Au=new WeakSet,fw=async function(i){const o=await this.database.changesSince(this.dbHead);if(o.rows.length===0){this.dbHead=o.clock;return}await doTransaction("#updateIndex",i,async s=>{let c=[],g=[];if(await loadIndex(s,this.indexById,idIndexOpts),await loadIndex(s,this.indexByKey,dbIndexOpts),this.dbHead&&(c=(await this.indexById.root.getMany(o.rows.map(({key:et})=>et))).result.map(et=>({key:et,del:!0})),g=c.map(({key:et})=>({key:et[1],del:!0}))),!this.mapFn)throw new Error("No live map function installed for index, cannot update. Make sure your index definition runs before any queries."+(this.mapFnString?` Your code should match the stored map function source:
`+this.mapFnString:""));const b=indexEntriesForChanges(o.rows,this.mapFn),$=b.map(({key:_e})=>({key:_e[1],value:_e}));this.indexById=await bulkIndex(s,this.indexById,g.concat($),idIndexOpts),this.indexByKey=await bulkIndex(s,this.indexByKey,c.concat(b),dbIndexOpts),this.dbHead=o.clock})};async function bulkIndex(e,i,o,s){if(!o.length)return i;const c=e.put.bind(e),{getBlock:g}=makeGetBlock(e);let b,$;if(!i.root){const nt=i.cid;if(!nt){for await(const ot of await create$5({get:g,list:o,...s})){const ct=await ot.block;await c(ct.cid,ct.bytes),b=ct,$=ot}return{root:$,cid:b.cid}}i.root=await load({cid:nt,get:g,...dbIndexOpts})}const{root:_e,blocks:et}=await i.root.bulk(o);b=await _e.block,$=_e;for await(const nt of et)await c(nt.cid,nt.bytes);return await c(b.cid,b.bytes),{root:$,cid:b.cid}}async function loadIndex(e,i,o){if(!i.root){const s=i.cid;if(!s)return;const{getBlock:c}=makeGetBlock(e);i.root=await load({cid:s,get:c,...o})}return i.root}async function doIndexQuery(e,i,o={}){if(await loadIndex(e,i,dbIndexOpts),o.range){const s=o.range.map(c=>charwise.encode(c));return i.root.range(...s)}else if(o.key){const s=charwise.encode(o.key);return i.root.get(s)}else{const{result:s,...c}=await i.root.getAllEntries();return{result:s.map(({key:[g,b],value:$})=>({key:g,id:b,row:$})),...c}}}var Bo,Nu,Du,hw;class Listener{constructor(i,o){vr(this,Du);vr(this,Bo,new Map);vr(this,Nu,null);this.database=i,an(this,Nu,i.registerListener(s=>Rr(this,Du,hw).call(this,s))),this.routingFn=o||function(s,c){c("*")},this.dbHead=null}on(i,o,s){const c=getTopicList(jt(this,Bo),i);return c.push(o),typeof s<"u"&&this.database.changesSince(s).then(({rows:g})=>{const b=topicsForChanges(g,this.routingFn).get(i);b&&b.forEach($=>o($))}),()=>{const g=c.indexOf(o);g>-1&&c.splice(g,1)}}}Bo=new WeakMap,Nu=new WeakMap,Du=new WeakSet,hw=function(i){if(Array.isArray(i)){const o=topicsForChanges(i,this.routingFn);for(const[s,c]of o)getTopicList(jt(this,Bo),s).forEach(b=>c.forEach($=>b($)))}else if(i.reset)for(const[,o]of jt(this,Bo))o.forEach(s=>s(i))};function getTopicList(e,i){let o=e.get(i);return o||(o=[],e.set(i,o)),o}const makeDoc=({key:e,value:i})=>({_id:e,...i}),topicsForChanges=(e,i)=>{const o=new Map;return e.forEach(({key:s,value:c,del:g})=>{(g||!c)&&(c={_deleted:!0}),i(makeDoc({key:s,value:c}),b=>{getTopicList(o,b).push(s)})}),o},parseCID=e=>typeof e=="string"?CID.parse(e):e;class Hydrator{static fromJSON(i,o){o.hydrate({clock:i.clock.map(s=>parseCID(s)),name:i.name});for(const{code:s,clock:{byId:c,byKey:g,db:b}}of i.indexes)DbIndex.fromJSON(o,{clock:{byId:c?parseCID(c):null,byKey:g?parseCID(g):null,db:b?b.map($=>parseCID($)):null},code:s});return o}static snapshot(i,o){const s=i.toJSON(),c=new Fireproof(i.blocks);o&&(s.clock=o.map(b=>parseCID(b)),s.indexes.forEach(b=>{b.clock.byId=null,b.clock.byKey=null,b.clock.db=null}));const g=this.fromJSON(s,c);return[...i.indexes.values()].forEach(b=>{g.indexes.get(b.mapFnString).mapFn=b.mapFn}),g}static async zoom(i,o){return[...i.indexes.values()].forEach(s=>{s.indexById={root:null,cid:null},s.indexByKey={root:null,cid:null},s.dbHead=null}),i.clock=o.map(s=>parseCID(s)),await i.notifyReset(),i}}const FireproofCtx=reactExports.createContext({addSubscriber:()=>{},database:null,ready:!1}),inboundSubscriberQueue=new Map,database=Fireproof.storage(),listener=new Listener(database);let startedSetup=!1;function useFireproof(e=o=>{},i=async o=>{}){const[o,s]=reactExports.useState(!1),c=(b,$)=>{inboundSubscriberQueue.set(b,$)},g=async()=>{localSet("fireproof",JSON.stringify(database));for(const[,b]of inboundSubscriberQueue)b()};return reactExports.useEffect(()=>{(async()=>{if(o||startedSetup)return;startedSetup=!0,e(database);const $=localGet("fireproof");if($)try{const _e=JSON.parse($);if(console.log("Loading previous database clock. (localStorage.removeItem('fireproof') to reset)"),Hydrator.fromJSON(_e,database),(await database.changesSince()).rows.length<2)throw new Error("Resetting database")}catch(_e){console.error(`Error loading previous database clock. ${$} Resetting.`,_e),await Hydrator.zoom(database,[]),await i(database),localSet("fireproof",JSON.stringify(database))}else await i(database),localSet("fireproof",JSON.stringify(database));s(!0),listener.on("*",hushed("*",g,250))})()},[o]),{addSubscriber:c,database,ready:o}}const husherMap=new Map,husher=(e,i,o)=>{if(!husherMap.has(e)){const s=Date.now();husherMap.set(e,i().finally(()=>setTimeout(()=>husherMap.delete(e),o-(Date.now()-s))))}return husherMap.get(e)},hushed=(e,i,o)=>()=>husher(e,i,o);let storageSupported$1=!1;try{storageSupported$1=window.localStorage&&!0}catch{}function localGet(e){if(storageSupported$1)return localStorage&&localStorage.getItem(e)}function localSet(e,i){if(storageSupported$1)return localStorage&&localStorage.setItem(e,i)}const encoder=new TextEncoder,decoder=new TextDecoder,encode$d=e=>encoder.encode(e),decode$e=e=>decoder.decode(e),code$4=0,name$2="identity",encode$c=coerce,digest=e=>create$b(code$4,encode$c(e)),identity={code:code$4,name:name$2,encode:encode$c,digest},DID_PREFIX="did:",DID_PREFIX_SIZE=DID_PREFIX.length,DID_KEY_PREFIX="did:key:",DID_KEY_PREFIX_SIZE=DID_KEY_PREFIX.length,ED25519=237,RSA=4613,P256=4608,P384=4609,P521=4610,DID_CORE=3357,METHOD_OFFSET=encodingLength(DID_CORE),parse$2=e=>{if(e.startsWith(DID_PREFIX))if(e.startsWith(DID_KEY_PREFIX)){const i=base58btc.decode(e.slice(DID_KEY_PREFIX_SIZE));return decode$d(i)}else{const i=encode$d(e.slice(DID_PREFIX_SIZE)),o=new Uint8Array(i.byteLength+METHOD_OFFSET);return encodeTo(DID_CORE,o),o.set(i,METHOD_OFFSET),new DID$1(o)}else throw new RangeError(`Invalid DID "${e}", must start with 'did:'`)},format$4=e=>e.did(),from$2=e=>e instanceof DID$1?e:e instanceof Uint8Array?decode$d(e):parse$2(typeof e=="string"?e:e.did()),decode$d=e=>{const[i]=decode$m(e),{buffer:o,byteOffset:s,byteLength:c}=e;switch(i){case P256:if(e.length>35)throw new RangeError("Only p256-pub compressed is supported.");case ED25519:case RSA:case P384:case P521:return new DIDKey(o,s,c);case DID_CORE:return new DID$1(o,s,c);default:throw new RangeError(`Unsupported DID encoding, unknown multicode 0x${i.toString(16)}.`)}};let DID$1=class extends Uint8Array{did(){const i=new Uint8Array(this.buffer,this.byteOffset+METHOD_OFFSET);return`did:${decode$e(i)}`}toJSON(){return this.did()}};class DIDKey extends DID$1{did(){return`did:key:${base58btc.encode(this)}`}}const base64$2=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});const NON_STANDARD=53248,ES256K=53479,BLS12381G1=53482,BLS12381G2=53483,EdDSA=53485,ES256=13636096,ES384=13636097,ES512=13636098,RS256=13636101,EIP191=53649,codeName=e=>{switch(e){case ES256K:return"ES256K";case BLS12381G1:return"BLS12381G1";case BLS12381G2:return"BLS12381G2";case EdDSA:return"EdDSA";case ES256:return"ES256";case ES384:return"ES384";case ES512:return"ES512";case RS256:return"RS256";case EIP191:return"EIP191";default:throw new RangeError(`Unknown signature algorithm code 0x${e.toString(16)}`)}},nameCode=e=>{switch(e){case"ES256K":return ES256K;case"BLS12381G1":return BLS12381G1;case"BLS12381G2":return BLS12381G2;case"EdDSA":return EdDSA;case"ES256":return ES256;case"ES384":return ES384;case"ES512":return ES512;case"RS256":return RS256;case"EIP191":return EIP191;default:return NON_STANDARD}};class Signature extends Uint8Array{get code(){const[i]=decode$m(this);return Object.defineProperties(this,{code:{value:i}}),i}get size(){const i=size(this);return Object.defineProperties(this,{size:{value:i}}),i}get algorithm(){const i=algorithm(this);return Object.defineProperties(this,{algorithm:{value:i}}),i}get raw(){const{buffer:i,byteOffset:o,size:s,code:c}=this,g=encodingLength(c),b=encodingLength(s),$=new Uint8Array(i,o+g+b,s);return Object.defineProperties(this,{raw:{value:$}}),$}toJSON(){return toJSON$1(this)}}const algorithm=e=>{const{code:i,raw:o,buffer:s,byteOffset:c}=e;if(i===NON_STANDARD){const g=o.byteLength+encodingLength(i)+encodingLength(o.byteLength),b=new Uint8Array(s,c+g);return decode$e(b)}else return codeName(i)},size=e=>{const i=encodingLength(e.code),[o]=decode$m(new Uint8Array(e.buffer,e.byteOffset+i));return o},create$4=(e,i)=>{codeName(e);const o=encodingLength(e),s=encodingLength(i.byteLength),c=new Signature(o+s+i.byteLength);return encodeTo(e,c),encodeTo(i.byteLength,c,o),c.set(i,o+s),Object.defineProperties(c,{code:{value:e},size:{value:i.byteLength}}),c},createNamed=(e,i)=>{const o=nameCode(e);return o===NON_STANDARD?createNonStandard(e,i):create$4(o,i)},createNonStandard=(e,i)=>{const o=NON_STANDARD,s=encodingLength(o),c=encodingLength(i.byteLength),g=encode$d(e),b=new Signature(s+c+i.byteLength+g.byteLength);return encodeTo(o,b),encodeTo(i.byteLength,b,s),b.set(i,s+c),b.set(g,s+c+i.byteLength),b},view=e=>new Signature(e.buffer,e.byteOffset,e.byteLength),decode$c=e=>{if(!(e instanceof Uint8Array))throw new TypeError(`Can only decode Uint8Array into a Signature, instead got ${JSON.stringify(e)}`);return view(e)},encode$b=e=>decode$c(e),toJSON$1=e=>({"/":{bytes:base64$2.baseEncode(e)}}),readPayload=e=>readPayloadWith(e,{readPrincipal,readProof}),readJWTPayload=e=>readPayloadWith(e,{readPrincipal:readStringPrincipal,readProof:readStringProof}),readPayloadWith=(e,{readPrincipal:i,readProof:o})=>({iss:i(e.iss,"iss"),aud:i(e.aud,"aud"),att:readCapabilities(e.att,"att"),prf:readOptionalArray(e.prf,o,"prf")||[],exp:readNullable(e.exp===1/0?null:e.exp,readInt$1,"exp"),nbf:readOptional(e.nbf,readInt$1,"nbf"),fct:readOptionalArray(e.fct,readFact,"fct")||[],nnc:readOptional(e.nnc,readString,"nnc")}),readSignature=e=>{if(e instanceof Uint8Array)return decode$c(e);throw new TypeError(`Can only decode Uint8Array into a Signature, instead got ${JSON.stringify(e)}`)},readInt$1=(e,i)=>Number.isInteger(e)?e:ParseError.throw(`Expected ${i} to be integer, instead got ${JSON.stringify(e)}`),readCapability=(e,i)=>readStruct(e,asCapability,i),readCapabilities=(e,i)=>readArray(e,readCapability,i),asCapability=e=>({...e,can:readAbility(e.can),with:readResource(e.with)}),readAbility=e=>typeof e!="string"?ParseError.throw(`Capability has invalid 'can: ${JSON.stringify(e)}', value must be a string`):e.slice(1,-1).includes("/")?e.toLocaleLowerCase():e==="*"?e:ParseError.throw(`Capability has invalid 'can: "${e}"', value must have at least one path segment`),readResource=e=>typeof e!="string"?ParseError.throw(`Capability has invalid 'with: ${JSON.stringify(e)}', value must be a string`):parseURL(e)||ParseError.throw(`Capability has invalid 'with: "${e}"', value must be a valid URI string`),parseURL=e=>{try{return new URL(e),e}catch{return null}},readArray=(e,i,o)=>Array.isArray(e)?e.map((s,c)=>i(s,`${o}[${c}]`)):ParseError.throw(`${o} must be an array`),readOptionalArray=(e,i,o)=>e===void 0?e:readArray(e,i,o),readStruct=(e,i,o)=>e!=null&&typeof e=="object"?i(e):ParseError.throw(`${o} must be of type object, instead got ${e}`),readFact=(e,i)=>readStruct(e,Object,i),readProof=(e,i)=>isLink(e)?e:fail$1(`Expected ${i} to be IPLD link, instead got ${JSON.stringify(e)}`),readStringProof=(e,i)=>parseProof(readString(e,i)),parseProof=e=>{try{return parse$3(e)}catch{return create$7(code$5,identity.digest(encode$d(e)))}},readPrincipal=(e,i)=>decode$d(readBytes(e,i)),readStringPrincipal=(e,i)=>parse$2(readString(e,i)),readOptional=(e,i,o="Field")=>e!==void 0?i(e,o):void 0,readNullable=(e,i,o)=>e===null?null:i(e,o),readString=(e,i="Field")=>typeof e=="string"?e:fail$1(`${i} has invalid value ${e}`),readBytes=(e,i)=>e instanceof Uint8Array?e:fail$1(`Expected ${i} to be Uint8Array, instead got ${JSON.stringify(e)}`),readVersion=(e,i)=>/\d+\.\d+\.\d+/.test(e)?e:ParseError.throw(`Invalid version '${i}: ${JSON.stringify(e)}'`),readLiteral=(e,i,o)=>e===i?i:ParseError.throw(`Expected ${o} to be a ${JSON.stringify(i)} instead got ${JSON.stringify(e)}`);class ParseError extends TypeError{get name(){return"ParseError"}static throw(i){throw new this(i)}}const fail$1=e=>ParseError.throw(e);class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(i){const o=this.inRecursive[this.inRecursive.length-1];o&&(o.type===Type.array&&(o.elements++,o.elements!==1&&i.push([44])),o.type===Type.map&&(o.elements++,o.elements!==1&&(o.elements%2===1?i.push([44]):i.push([58]))))}[Type.uint.major](i,o){this.prefix(i);const s=String(o.value),c=[];for(let g=0;g<s.length;g++)c[g]=s.charCodeAt(g);i.push(c)}[Type.negint.major](i,o){this[Type.uint.major](i,o)}[Type.bytes.major](i,o){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](i,o){this.prefix(i);const s=fromString(JSON.stringify(o.value));i.push(s.length>32?asU8A(s):s)}[Type.array.major](i,o){this.prefix(i),this.inRecursive.push({type:Type.array,elements:0}),i.push([91])}[Type.map.major](i,o){this.prefix(i),this.inRecursive.push({type:Type.map,elements:0}),i.push([123])}[Type.tag.major](i,o){}[Type.float.major](i,o){if(o.type.name==="break"){const b=this.inRecursive.pop();if(b){if(b.type===Type.array)i.push([93]);else if(b.type===Type.map)i.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(o.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(i),o.type.name==="true"){i.push([116,114,117,101]);return}else if(o.type.name==="false"){i.push([102,97,108,115,101]);return}else if(o.type.name==="null"){i.push([110,117,108,108]);return}const s=String(o.value),c=[];let g=!1;for(let b=0;b<s.length;b++)c[b]=s.charCodeAt(b),!g&&(c[b]===46||c[b]===101||c[b]===69)&&(g=!0);g||(c.push(46),c.push(48)),i.push(c)}}function mapSorter(e,i){if(Array.isArray(e[0])||Array.isArray(i[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const o=e[0],s=i[0];if(o.type!==Type.string||s.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if(o<s)return-1;if(o>s)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter};function encode$a(e,i){return i=Object.assign({},defaultEncodeOptions,i),encodeCustom(e,new JSONEncoder,i)}class Tokenizer{constructor(i,o={}){this.pos=0,this.data=i,this.options=o,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let i=this.ch();for(;i===32||i===9||i===13||i===10;)i=this.data[++this.pos]}expect(i){if(this.data.length-this.pos<i.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this.pos}`);for(let o=0;o<i.length;o++)if(this.data[this.pos++]!==i[o])throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...i)}'`)}parseNumber(){const i=this.pos;let o=!1,s=!1;const c=$=>{for(;!this.done();){const _e=this.ch();if($.includes(_e))this.pos++;else break}};if(this.ch()===45&&(o=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,s=!0;else return new Token(Type.uint,0,this.pos-i);if(c([48,49,50,51,52,53,54,55,56,57]),o&&this.pos===i+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(s)throw new Error(`${decodeErrPrefix} unexpected token at position ${this.pos}`);s=!0,this.pos++,c([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(s=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,c([48,49,50,51,52,53,54,55,56,57]));const g=String.fromCharCode.apply(null,this.data.subarray(i,this.pos)),b=parseFloat(g);return s?new Token(Type.float,b,this.pos-i):this.options.allowBigInt!==!0||Number.isSafeInteger(b)?new Token(b>=0?Type.uint:Type.negint,b,this.pos-i):new Token(b>=0?Type.uint:Type.negint,BigInt(g),this.pos-i)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let g=this.pos,b=0;g<this.data.length&&b<65536;g++,b++){const $=this.data[g];if($===92||$<32||$>=128)break;if($===34){const _e=String.fromCharCode.apply(null,this.data.subarray(this.pos,g));return this.pos=g+1,new Token(Type.string,_e,b)}}const i=this.pos,o=[],s=()=>{if(this.pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this.pos}`);let g=0;for(let b=0;b<4;b++){let $=this.ch();if($>=48&&$<=57)$-=48;else if($>=97&&$<=102)$=$-97+10;else if($>=65&&$<=70)$=$-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this.pos}`);g=g*16+$,this.pos++}return g},c=()=>{const g=this.ch();let b=null,$=g>239?4:g>223?3:g>191?2:1;if(this.pos+$>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this.pos}`);let _e,et,nt,ot;switch($){case 1:g<128&&(b=g);break;case 2:_e=this.data[this.pos+1],(_e&192)===128&&(ot=(g&31)<<6|_e&63,ot>127&&(b=ot));break;case 3:_e=this.data[this.pos+1],et=this.data[this.pos+2],(_e&192)===128&&(et&192)===128&&(ot=(g&15)<<12|(_e&63)<<6|et&63,ot>2047&&(ot<55296||ot>57343)&&(b=ot));break;case 4:_e=this.data[this.pos+1],et=this.data[this.pos+2],nt=this.data[this.pos+3],(_e&192)===128&&(et&192)===128&&(nt&192)===128&&(ot=(g&15)<<18|(_e&63)<<12|(et&63)<<6|nt&63,ot>65535&&ot<1114112&&(b=ot))}b===null?(b=65533,$=1):b>65535&&(b-=65536,o.push(b>>>10&1023|55296),b=56320|b&1023),o.push(b),this.pos+=$};for(;!this.done();){const g=this.ch();let b;switch(g){case 92:if(this.pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this.pos}`);switch(b=this.ch(),this.pos++,b){case 34:case 39:case 92:case 47:o.push(b);break;case 98:o.push(8);break;case 116:o.push(9);break;case 110:o.push(10);break;case 102:o.push(12);break;case 114:o.push(13);break;case 117:o.push(s());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Token(Type.string,decodeCodePointsArray(o),this.pos-i);default:if(g<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this.pos}`);g<128?(o.push(g),this.pos++):c()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const i=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),i}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}}function decode$b(e,i){return i=Object.assign({tokenizer:new Tokenizer(e,i)},i),decode$i(e,i)}function cidEncoder(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const i=CID.asCID(e);if(!i)return null;const o=i.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,o,o.length),new Token(Type.break,void 0,1)]}function bytesEncoder(e){const i=base64$2.encode(e).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,i,i.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Uint8Array:bytesEncoder,Buffer:bytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(i,o){super(i,o),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const i=this._next();if(i.type===Type.map){const o=this._next();if(o.type===Type.string&&o.value==="/"){const s=this._next();if(s.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(s),new Token(Type.tag,42,0)}if(s.type===Type.map){const c=this._next();if(c.type===Type.string&&c.value==="bytes"){const g=this._next();if(g.type===Type.string){for(let $=0;$<2;$++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const b=base64$2.decode(`m${g.value}`);return new Token(Type.bytes,b,g.value.length)}this.tokenBuffer.push(g)}this.tokenBuffer.push(c)}this.tokenBuffer.push(s)}this.tokenBuffer.push(o)}return i}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID.parse;const encode$9=e=>encode$a(e,encodeOptions),decode$a=e=>{const i=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(e,decodeOptions)});return decode$b(e,i)};new TextDecoder;new TextEncoder;const format$3=e=>{const i=formatHeader(e.v,e.s.algorithm),o=formatPayload(e),s=formatSignature(e.s);return`${i}.${o}.${s}`},formatSignPayload=(e,i,o)=>`${formatHeader(i,o)}.${formatPayload(e)}`,formatHeader=(e,i)=>base64url.baseEncode(encodeHeader(e,i)),formatPayload=e=>base64url.baseEncode(encodePayload(e)),formatSignature=e=>base64url.baseEncode(e.raw),encodeHeader=(e,i)=>encode$9({alg:i,ucv:e,typ:"JWT"}),encodePayload=e=>encode$9({iss:format$4(e.iss),aud:format$4(e.aud),att:e.att,exp:e.exp,prf:e.prf.map(encodeProof),...e.fct.length>0&&{fct:e.fct},...e.nnc&&{nnc:e.nnc},...e.nbf&&{nbf:e.nbf}}),encodeProof=e=>e.toString(),toJSON=e=>JSON.parse(decode$e(encode$9(e)));let View$2=class{constructor(i){this.model=i}get version(){return this.model.v}get issuer(){return from$2(this.model.iss)}get audience(){return from$2(this.model.aud)}get capabilities(){return this.model.att}get expiration(){const{exp:i}=this.model;return i===null?1/0:i}get notBefore(){return this.model.nbf}get nonce(){return this.model.nnc}get facts(){return this.model.fct}get proofs(){return this.model.prf}get signature(){return this.model.s}get jwt(){return this.model.jwt}get s(){return this.model.s}get v(){return this.model.v}get iss(){return this.model.iss}get aud(){return this.model.aud}get att(){return this.model.att}get exp(){return this.model.exp}get nbf(){return this.model.nbf}get nnc(){return this.model.nnc}get fct(){return this.model.fct}get prf(){return this.model.prf}toJSON(){const{v:i,iss:o,aud:s,s:c,att:g,prf:b,exp:$,fct:_e,nnc:et,nbf:nt}=this.model;return{iss:o,aud:s,v:i,s:c,exp:$,...toJSON({att:g,prf:b,..._e.length>0&&{fct:_e}}),...et!=null&&{nnc:et},...nt&&{nbf:nt}}}};const code$3=code$6,from$1=e=>new CBORView(e),encode$8=e=>{const{fct:i,nnc:o,nbf:s,...c}=readPayload(e);return encode$g({...i.length>0&&{fct:i},...o!=null&&{nnc:o},...s&&{nbf:s},...c,v:readVersion(e.v,"v"),s:encodeSignature(e.s,"s")})},encodeSignature=(e,i)=>{try{return encode$b(e)}catch(o){throw new Error(`Expected signature ${i}, instead got ${JSON.stringify(e)}`,{cause:o})}},decode$9=e=>{const i=decode$h(e);return new CBORView({...readPayload(i),v:readVersion(i.v,"v"),s:readSignature(i.s)})};class CBORView extends View$2{get code(){return code$3}format(){return format$3(this.model)}encode(){return encode$8(this.model)}}const parse$1=e=>{const i=e.split("."),[o,s,c]=i.length===3?i:fail$1(`Can't parse UCAN: ${e}: Expected JWT format: 3 dot-separated base64url-encoded values.`),{ucv:g,alg:b}=parseHeader(o);return{...parsePayload(s),v:g,s:createNamed(b,base64url.baseDecode(c))}},parseHeader=e=>{const{ucv:i,alg:o,typ:s}=decode$a(base64url.baseDecode(e));return{typ:readLiteral(s,"JWT","typ"),ucv:readVersion(i,"ucv"),alg:readString(o,"alg")}},parsePayload=e=>{const i=decode$a(base64url.baseDecode(e));return readJWTPayload(i)},decode$8=e=>{const i=decode$e(e);return new JWTView({...parse$1(i),jwt:i})},encode$7=({jwt:e})=>encode$d(e),format$2=({jwt:e})=>e;class JWTView extends View$2{constructor(i){super(i),this.model=i}get code(){return code$5}format(){return format$2(this.model)}encode(){return encode$7(this.model)}}const VERSION="0.9.1",defaultHasher=sha256,decode$7=e=>{try{return decode$9(e)}catch{return decode$8(e)}},write$3=async(e,{hasher:i=defaultHasher}={})=>{const[o,s]=e.jwt?[code$5,encode$7(e)]:[code$3,encode$8(e)],c=await i.digest(s);return{bytes:s,cid:create$7(o,c),data:e}},issue=async({issuer:e,audience:i,capabilities:o,lifetimeInSeconds:s=30,expiration:c=now()+s,notBefore:g,facts:b=[],proofs:$=[],nonce:_e})=>{const et=VERSION,nt=readPayload({iss:parse$2(e.did()),aud:parse$2(i.did()),att:o,fct:b,exp:c,nbf:g,prf:$,nnc:_e}),ot=encodeSignaturePayload(nt,et,e.signatureAlgorithm);return from$1({...nt,v:et,s:await e.sign(ot)})},encodeSignaturePayload=(e,i,o)=>encode$d(formatSignPayload(e,i,o)),now=()=>Math.floor(Date.now()/1e3),isDelegation$1=e=>!isLink(e);let Delegation$1=class{constructor(i,o=new Map){this.root=i,this.blocks=o,Object.defineProperties(this,{blocks:{enumerable:!1}})}get version(){return this.data.version}get signature(){return this.data.signature}get cid(){return this.root.cid}get asCID(){return this.cid}get bytes(){return this.root.bytes}get data(){const i=decode$6(this.root);return Object.defineProperties(this,{data:{value:i,enumerable:!1}}),i}export(){return exportDAG$1(this.root,this.blocks)}get proofs(){return proofs$1(this)}get issuer(){return this.data.issuer}get audience(){return this.data.audience}get capabilities(){return this.data.capabilities}get expiration(){return this.data.expiration}get notBefore(){return this.data.notBefore}get nonce(){return this.data.nonce}get facts(){return this.data.facts}iterate(){return it$1(this)}delegate(){return this}toJSON(){return{...this.data.toJSON(),"/":this.cid.toString(),prf:this.proofs.map(i=>isDelegation$1(i)?i:{"/":i.toString()})}}};const it$1=function*(e){for(const i of e.proofs)isDelegation$1(i)&&(yield*it$1(i),yield i)},decodeCache$1=new WeakMap,decode$6=({bytes:e})=>{const i=decodeCache$1.get(e);if(!i){const o=decode$7(e);return decodeCache$1.set(e,o),o}return i},delegate$1=async({issuer:e,audience:i,proofs:o=[],...s},c)=>{const g=[],b=new Map;for(const ot of o)if(!isDelegation$1(ot))g.push(ot);else{g.push(ot.cid);for(const ct of ot.export())b.set(ct.cid.toString(),ct)}const $=await issue({...s,issuer:e,audience:i,proofs:g}),{cid:_e,bytes:et}=await write$3($,c);decodeCache$1.set(_e,$);const nt=new Delegation$1({cid:_e,bytes:et},b);return Object.defineProperties(nt,{proofs:{value:o}}),nt},exportDAG$1=function*(e,i){for(const o of decode$6(e).proofs){const s=i.get(o.toString());s&&(yield*exportDAG$1(s,i))}yield e},create$3=({root:e,blocks:i})=>new Delegation$1(e,i),proofs$1=e=>{const i=[],{root:o,blocks:s}=e;for(const c of decode$6(o).proofs){const g=s.get(c.toString());i.push(g?create$3({root:g,blocks:s}):c)}return Object.defineProperty(e,"proofs",{value:i}),i},invoke$1=e=>new IssuedInvocation$1(e);let IssuedInvocation$1=class{constructor({issuer:i,audience:o,capability:s,proofs:c=[],expiration:g,lifetimeInSeconds:b,notBefore:$,nonce:_e,facts:et=[]}){this.issuer=i,this.audience=o,this.proofs=c,this.capabilities=[s],this.expiration=g,this.lifetimeInSeconds=b,this.notBefore=$,this.nonce=_e,this.facts=et}delegate(){return delegate$1(this)}async execute(i){const o=this,[s]=await i.execute(o);return s}};const prepare$1=(e,i)=>{if(i.has(e))throw new TypeError("Can not encode circular structure");if(e===void 0&&i.size===0||e===null||typeof e=="symbol"&&i.size===0)return null;if(isLink(e)||ArrayBuffer.isView(e))return e;if(Array.isArray(e)){i.add(e);const o=[];for(const s of e)o.push(s===void 0||typeof s=="symbol"?null:prepare$1(s,i));return o}if(typeof e.toJSON=="function"){i.add(e);const o=e.toJSON();return prepare$1(o,i)}if(typeof e=="object"){i.add(e);const o={};for(const[s,c]of Object.entries(e))c!==void 0&&typeof c!="symbol"&&(o[s]=prepare$1(c,i));return o}return e},encode$6=e=>encode$g(prepare$1(e,new Set)),link$3=async(e,{hasher:i=sha256}={})=>create$7(code$6,await i.digest(e)),write$2=async(e,i)=>{const o=encode$6(e);return{cid:await link$3(o,i),bytes:o}},CBOR$1=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,decode:decode$h,encode:encode$6,link:link$3,write:write$2},Symbol.toStringTag,{value:"Module"})),HEADERS$1=Object.freeze({"content-type":"application/cbor"}),codec$1=CBOR$1,encode$5=e=>({headers:HEADERS$1,body:encode$6(e)}),decode$5=async({headers:e,body:i})=>{const o=e["content-type"]||e["Content-Type"];if(o!=="application/cbor")throw TypeError(`Only 'content-type: application/cbor' is supported, intsead got '${o}'`);return decode$h(i)},CBOR=Object.freeze(Object.defineProperty({__proto__:null,codec:codec$1,decode:decode$5,encode:encode$5},Symbol.toStringTag,{value:"Module"})),code$2=514;let Writer$2=class{constructor(i=[],o=0){this.written=new Set,this.blocks=i,this.byteLength=o}write(...i){for(const o of i){const s=o.cid.toString(base32);this.written.has(s)||(this.blocks.push(o),this.byteLength+=blockLength(o),this.written.add(s))}return this}flush(...i){const o=[];for(const g of i.reverse()){const b=g.cid.toString(base32);this.written.has(b)||(this.blocks.unshift(g),this.byteLength+=blockLength({cid:g.cid,bytes:g.bytes}),this.written.add(b)),o.push(g.cid)}this.byteLength+=headerLength({roots:o});const s=new ArrayBuffer(this.byteLength),c=createWriter$1(s,{roots:o});for(const g of this.blocks)c.write(g);return c.close()}};const createWriter=()=>new Writer$2,encode$4=({roots:e=[],blocks:i})=>{const o=new Writer$2;return i&&o.write(...i.values()),o.flush(...e)},decode$4=async e=>{const i=await CarReader.fromBytes(e),{_header:o,_blocks:s,_keys:c}=i,g=[],b=new Map,$=o.roots.map(_e=>c.indexOf(String(_e)));for(const[_e,et]of s.entries())$.includes(_e)?g.push(et):b.set(et.cid.toString(),et);return{roots:g,blocks:b}},link$2=async(e,{hasher:i=sha256}={})=>create$7(code$2,await i.digest(e)),write$1=async(e,i)=>{const o=encode$4(e),s=await link$2(o,i);return{bytes:o,cid:s}},codec=Object.freeze(Object.defineProperty({__proto__:null,code:code$2,createWriter,decode:decode$4,encode:encode$4,link:link$2,write:write$1},Symbol.toStringTag,{value:"Module"})),HEADERS=Object.freeze({"content-type":"application/car"}),encode$3=async(e,i)=>{const o=[],s=new Map;for(const g of e){const b=await g.delegate();o.push(b.root);for(const $ of b.export())s.set($.cid.toString(),$);s.delete(b.root.cid.toString())}const c=encode$4({roots:o,blocks:s});return{headers:HEADERS,body:c}},decode$3=async({headers:e,body:i})=>{const o=e["content-type"]||e["Content-Type"];if(o!=="application/car")throw TypeError(`Only 'content-type: application/car' is supported, instead got '${o}'`);const{roots:s,blocks:c}=await decode$4(i),g=[];for(const b of s)g.push(create$3({root:b,blocks:c}));return g},CAR=Object.freeze(Object.defineProperty({__proto__:null,codec,decode:decode$3,encode:encode$3},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const open$1=({url:e,method:i="POST",fetch:o})=>{if(!o)if(typeof globalThis.fetch<"u")o=globalThis.fetch.bind(globalThis);else throw new TypeError("ucanto HTTP transport got undefined `fetch`. Try passing in a `fetch` implementation explicitly.");return new Channel({url:e,method:i,fetch:o})};class Channel{constructor({url:i,fetch:o,method:s}){this.fetch=o,this.method=s,this.url=i}async request({headers:i,body:o}){const s=await this.fetch(this.url.href,{headers:i,body:o,method:this.method}),c=s.ok?await s.arrayBuffer():HTTPError.throw("HTTP Request failed",s);return{headers:s.headers.entries?Object.fromEntries(s.headers.entries()):{},body:new Uint8Array(c)}}}class HTTPError extends Error{static throw(i,o){throw new this(i,o)}constructor(i,{url:o,status:s=500,statusText:c="Server error"}){super(i),this.name="HTTPError",this.url=o,this.status=s,this.statusText=c}}const the$1=e=>e,entries$1=e=>Object.entries(e),combine$1=([e,...i])=>{const o=e.map(s=>[s]);for(const s of i){const c=o.splice(0);for(const g of s)for(const b of c)o.push([...b,g])}return o},intersection$3=(e,i)=>{const[o,s]=e.length<i.length?[new Set(e),new Set(i)]:[new Set(i),new Set(e)];for(const c of o)s.has(c)||o.delete(c);return[...o]};let Failure$1=class extends Error{get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:i,name:o,message:s,stack:c}=this;return{error:i,name:o,message:s,stack:c}}},EscalatedCapability$1=class extends Failure$1{constructor(i,o,s){super(),this.claimed=i,this.delegated=o,this.cause=s,this.name=the$1("EscalatedCapability")}describe(){return`Constraint violation: ${this.cause.message}`}},DelegationError$1=class extends Failure$1{constructor(i,o){super(),this.name=the$1("InvalidClaim"),this.causes=i,this.context=o}describe(){return[`Can not derive ${this.context} from delegated capabilities:`,...this.causes.map(i=>li$3(i.message))].join(`
`)}get cause(){if(this.causes.length!==1)return this;{const[i]=this.causes,o=i.name==="InvalidClaim"?i.cause:i;return Object.defineProperties(this,{cause:{value:o}}),o}}},MalformedCapability$1=class extends Failure$1{constructor(i,o){super(),this.name=the$1("MalformedCapability"),this.capability=i,this.cause=o}describe(){return[`Encountered malformed '${this.capability.can}' capability: ${format$1(this.capability)}`,li$3(this.cause.message)].join(`
`)}},UnknownCapability$1=class extends Failure$1{constructor(i){super(),this.name=the$1("UnknownCapability"),this.capability=i}describe(){return`Encountered unknown capability: ${format$1(this.capability)}`}};const format$1=(e,i)=>JSON.stringify(e,(o,s)=>isLink(s)?s.toString():s,i),indent$3=(e,i="  ")=>`${i}${e.split(`
`).join(`
${i}`)}`,li$3=e=>indent$3(`- ${e}`),capability$1=e=>new Capability$1(e),or$3=(e,i)=>new Or$1(e,i),and$3=(...e)=>new And$1(e),derive$1=({from:e,to:i,derives:o})=>new Derive$1(e,i,o);let View$1=class{match(i){return new UnknownCapability$1(i.capability)}select(i){return select$1(this,i)}derive({derives:i,to:o}){return derive$1({derives:i,to:o,from:this})}},Unit$1=class extends View$1{or(i){return or$3(this,i)}and(i){return and$3(this,i)}},Capability$1=class extends Unit$1{constructor(i){super(),this.descriptor={derives,...i}}create(i){const{descriptor:o,can:s}=this,c=o.nb,g=i.nb||{},b=o.with.read(i.with);if(b.error)throw Object.assign(new Error(`Invalid 'with' - ${b.message}`),{cause:b});const $={can:s,with:b};for(const[_e,et]of Object.entries(c||{})){const nt=_e,ot=et.read(g[nt]);if(ot!=null&&ot.error)throw Object.assign(new Error(`Invalid 'nb.${nt}' - ${ot.message}`),{cause:ot});if(ot!==void 0){const ct=$.nb||($.nb={}),at=_e;ct[at]=ot}}return $}invoke({with:i,nb:o,...s}){return invoke$1({...s,capability:this.create({with:i,nb:o})})}async delegate({with:i,nb:o,...s}){const{descriptor:c,can:g}=this,b=c.nb,$=o||{},_e=c.with.read(i);if(_e.error)throw Object.assign(new Error(`Invalid 'with' - ${_e.message}`),{cause:_e});const et={can:g,with:_e};for(const[nt,ot]of Object.entries(b||{})){const ct=nt,at=$[ct],lt=at===void 0?at:ot.read($[ct]);if(lt!=null&&lt.error)throw Object.assign(new Error(`Invalid 'nb.${ct}' - ${lt.message}`),{cause:lt});if(lt!==void 0){const gt=et.nb||(et.nb={}),wt=nt;gt[wt]=lt}}return await delegate$1({capabilities:[et],...s})}get can(){return this.descriptor.can}match(i){const o=parse(this,i);return o.error?o:new Match$1(i,o,this.descriptor)}toString(){return JSON.stringify({can:this.descriptor.can})}},Or$1=class extends Unit$1{constructor(i,o){super(),this.left=i,this.right=o}match(i){const o=this.left.match(i);if(o.error){const s=this.right.match(i);return s.error?s.name==="MalformedCapability"?s:o:s}else return o}toString(){return`${this.left.toString()}|${this.right.toString()}`}},And$1=class pw extends View$1{constructor(i){super(),this.selectors=i}match(i){const o=[];for(const s of this.selectors){const c=s.match(i);if(c.error)return c;o.push(c)}return new AndMatch$1(o)}select(i){return selectGroup$1(this,i)}and(i){return new pw([...this.selectors,i])}toString(){return`[${this.selectors.map(String).join(", ")}]`}},Derive$1=class extends Unit$1{constructor(i,o,s){super(),this.from=i,this.to=o,this.derives=s}create(i){return this.to.create(i)}invoke(i){return this.to.invoke(i)}delegate(i){return this.to.delegate(i)}get can(){return this.to.can}match(i){const o=this.to.match(i);return o.error?o:new DerivedMatch$1(o,this.from,this.derives)}toString(){return this.to.toString()}},Match$1=class yw{constructor(i,o,s){this.source=[i],this.value=o,this.descriptor={derives,...s}}get can(){return this.value.can}get proofs(){const i=[this.source[0].delegation];return Object.defineProperties(this,{proofs:{value:i}}),i}prune(i){return i.canIssue(this.value,this.source[0].delegation.issuer.did())?null:this}select(i){const o=[],s=[],c=[];for(const g of i){const b=parse(this,g,!0);if(b.error)switch(b.name){case"UnknownCapability":o.push(b.capability);break;case"MalformedCapability":default:s.push(new DelegationError$1([b],this))}else{const $=this.descriptor.derives(this.value,b);$.error?s.push(new DelegationError$1([new EscalatedCapability$1(this.value,b,$)],this)):c.push(new yw(g,b,this.descriptor))}}return{matches:c,unknown:o,errors:s}}toString(){const{nb:i}=this.value;return JSON.stringify({can:this.descriptor.can,with:this.value.with,nb:i&&Object.keys(i).length>0?i:void 0})}},DerivedMatch$1=class yp{constructor(i,o,s){this.selected=i,this.from=o,this.derives=s}get can(){return this.value.can}get source(){return this.selected.source}get proofs(){const i=[];for(const{delegation:o}of this.selected.source)i.push(o);return Object.defineProperties(this,{proofs:{value:i}}),i}get value(){return this.selected.value}prune(i){const o=this.selected.prune(i);return o?new yp(o,this.from,this.derives):null}select(i){const{derives:o,selected:s,from:c}=this,{value:g}=s,b=s.select(i),$=c.select(i),_e=[],et=[];for(const nt of $.matches){const ot=o(g,nt.value);ot.error?et.push(new DelegationError$1([new EscalatedCapability$1(g,nt.value,ot)],this)):_e.push(nt)}return{unknown:intersection$3(b.unknown,$.unknown),errors:[...et,...b.errors,...$.errors.map(nt=>new DelegationError$1([nt],this))],matches:[...b.matches.map(nt=>new yp(nt,c,o)),..._e]}}toString(){return this.selected.toString()}},AndMatch$1=class gw{constructor(i){this.matches=i}get selectors(){return this.matches}get source(){const i=[];for(const o of this.matches)i.push(...o.source);return Object.defineProperties(this,{source:{value:i}}),i}prune(i){const o=[];for(const s of this.matches){const c=s.prune(i);c&&o.push(c)}return o.length===0?null:new gw(o)}get proofs(){const i=[];for(const{delegation:o}of this.source)i.push(o);return Object.defineProperties(this,{proofs:{value:i}}),i}get value(){const i=[];for(const o of this.matches)i.push(o.value);return Object.defineProperties(this,{value:{value:i}}),i}select(i){return selectGroup$1(this,i)}toString(){return`[${this.matches.map(i=>i.toString()).join(", ")}]`}};const parse=(e,i,o=!1)=>{const{can:s,with:c,nb:g}=e.descriptor,{delegation:b}=i,$=i.capability;if($.can!==s)return new UnknownCapability$1($);const _e=c.read($.with);if(_e.error)return new MalformedCapability$1($,_e);const et={};if(g){const nt=$.nb||{};for(const[ot,ct]of entries$1(g)){const at=ot;if(at in nt||!o){const lt=ct.read(nt[at]);if(lt!=null&&lt.error)return new MalformedCapability$1($,lt);lt!=null&&(et[at]=lt)}}}return new CapabilityView$1(s,$.with,et,b)};let CapabilityView$1=class{constructor(i,o,s,c){this.can=i,this.with=o,this.delegation=c,this.nb=s}};const select$1=(e,i)=>{const o=[],s=[],c=[];for(const g of i){const b=e.match(g);if(b.error)switch(b.name){case"UnknownCapability":o.push(b.capability);break;case"MalformedCapability":default:c.push(new DelegationError$1([b],b.capability))}else s.push(b)}return{matches:s,errors:c,unknown:o}},selectGroup$1=(e,i)=>{let o;const s=[],c=[];for(const b of e.selectors){const $=b.select(i);o=o?intersection$3(o,$.unknown):$.unknown;for(const _e of $.errors)c.push(new DelegationError$1([_e],e));s.push($.matches)}const g=combine$1(s).map(b=>new AndMatch$1(b));return{unknown:o||[],errors:c,matches:g}},derives=(e,i)=>{if(i.with.endsWith("*")){if(!e.with.startsWith(i.with.slice(0,-1)))return new Failure$1(`Resource ${e.with} does not match delegated ${i.with} `)}else if(i.with!==e.with)return new Failure$1(`Resource ${e.with} is not contained by ${i.with}`);const o=i.nb||{},s=e.nb||{},c=entries$1(o);for(const[g,b]of c)if(s[g]!=b)return new Failure$1(`${String(g)}: ${s[g]} violates ${b}`);return!0};let API$1=class{constructor(i){this.settings=i}toString(){return`new ${this.constructor.name}()`}readWith(i,o){throw new Error("Abstract method readWith must be implemented by subclass")}read(i){return this.readWith(i,this.settings)}is(i){var o;return!((o=this.read(i))!=null&&o.error)}from(i){const o=this.read(i);if(o!=null&&o.error)throw o;return o}optional(){return optional$3(this)}nullable(){return nullable$1(this)}array(){return array$1(this)}or(i){return or$2(this,i)}and(i){return and$2(this,i)}refine(i){return refine$1(this,i)}brand(i){return this}default(i){const o=this.from(i);if(o===void 0)throw new Error("Value of type undefined is not a vaild default");return new Default$1({reader:this,value:o})}},Nullable$1=class extends API$1{readWith(i,o){const s=o.read(i);return s!=null&&s.error?i===null?null:new UnionError$1({causes:[s,typeError$1({expect:"null",actual:i})]}):s}toString(){return`${this.settings}.nullable()`}};const nullable$1=e=>new Nullable$1(e);let Optional$1=class extends API$1{optional(){return this}readWith(i,o){const s=o.read(i);return s!=null&&s.error&&i===void 0?void 0:s}toString(){return`${this.settings}.optional()`}},Default$1=class extends API$1{optional(){return this}readWith(i,{reader:o,value:s}){if(i===void 0)return s;{const c=o.read(i);return c===void 0?s:c}}toString(){return`${this.settings.reader}.default(${JSON.stringify(this.settings.value)})`}get value(){return this.settings.value}};const optional$3=e=>new Optional$1(e);let ArrayOf$1=class extends API$1{readWith(i,o){if(!Array.isArray(i))return typeError$1({expect:"array",actual:i});const s=[];for(const[c,g]of i.entries()){const b=o.read(g);if(b!=null&&b.error)return memberError$1({at:c,cause:b});s.push(b)}return s}get element(){return this.settings}toString(){return`array(${this.element})`}};const array$1=e=>new ArrayOf$1(e);let Union$1=class extends API$1{readWith(i,o){const s=[];for(const c of o){const g=c.read(i);if(g!=null&&g.error)s.push(g);else return g}return new UnionError$1({causes:s})}get variants(){return this.settings}toString(){return`union([${this.variants.map(i=>i.toString()).join(", ")}])`}};const union$1=e=>new Union$1(e),or$2=(e,i)=>union$1([e,i]);let Intersection$1=class extends API$1{readWith(i,o){const s=[];for(const c of o){const g=c.read(i);g!=null&&g.error&&s.push(g)}return s.length>0?new IntersectionError$1({causes:s}):i}toString(){return`intersection([${this.settings.map(i=>i.toString()).join(",")}])`}};const intersection$2=e=>new Intersection$1(e),and$2=(e,i)=>intersection$2([e,i]);let Boolean$2=class extends API$1{readWith(i){switch(i){case!0:case!1:return i;default:return typeError$1({expect:"boolean",actual:i})}}toString(){return"boolean()"}};const anyBoolean$1=new Boolean$2,boolean$1=()=>anyBoolean$1;let UnknownNumber$1=class extends API$1{greaterThan(i){return this.refine(greaterThan$1(i))}lessThan(i){return this.refine(lessThan$1(i))}refine(i){return new RefinedNumber$1({base:this,schema:i})}},AnyNumber$1=class extends UnknownNumber$1{readWith(i){return typeof i=="number"?i:typeError$1({expect:"number",actual:i})}toString(){return"number()"}};const anyNumber$1=new AnyNumber$1;let RefinedNumber$1=class extends UnknownNumber$1{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}},LessThan$1=class extends API$1{readWith(i,o){return i<o?i:error$1(`Expected ${i} < ${o}`)}toString(){return`lessThan(${this.settings})`}};const lessThan$1=e=>new LessThan$1(e);let GreaterThan$1=class extends API$1{readWith(i,o){return i>o?i:error$1(`Expected ${i} > ${o}`)}toString(){return`greaterThan(${this.settings})`}};const greaterThan$1=e=>new GreaterThan$1(e),Integer$1={read(e){return Number.isInteger(e)?e:typeError$1({expect:"integer",actual:e})},toString(){return"Integer"}},anyInteger$1=anyNumber$1.refine(Integer$1),integer$1=()=>anyInteger$1,Float$1={read(e){return Number.isFinite(e)?e:typeError$1({expect:"Float",actual:e})},toString(){return"Float"}};anyNumber$1.refine(Float$1);let UnknownString$1=class extends API$1{refine(i){const o=i;return new RefinedString$1({base:this,schema:o})}startsWith(i){return this.refine(startsWith$1(i))}endsWith(i){return this.refine(endsWith$1(i))}toString(){return"string()"}},RefinedString$1=class extends UnknownString$1{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}},AnyString$1=class extends UnknownString$1{readWith(i){return typeof i=="string"?i:typeError$1({expect:"string",actual:i})}};const anyString$1=new AnyString$1,string$1=()=>anyString$1;let StartsWith$1=class extends API$1{readWith(i,o){return i.startsWith(o)?i:error$1(`Expect string to start with "${o}" instead got "${i}"`)}get prefix(){return this.settings}toString(){return`startsWith("${this.prefix}")`}};const startsWith$1=e=>new StartsWith$1(e);let EndsWith$1=class extends API$1{readWith(i,o){return i.endsWith(o)?i:error$1(`Expect string to end with "${o}" instead got "${i}"`)}get suffix(){return this.settings}toString(){return`endsWith("${this.suffix}")`}};const endsWith$1=e=>new EndsWith$1(e);let Refine$1=class extends API$1{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}};const refine$1=(e,i)=>new Refine$1({base:e,schema:i}),error$1=e=>new SchemaError$1(e);let SchemaError$1=class extends Error{get name(){return"SchemaError"}get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:i,name:o,message:s,stack:c}=this;return{error:i,name:o,message:s,stack:c}}},TypeError$2=class extends SchemaError$1{constructor({expect:i,actual:o}){super(),this.expect=i,this.actual=o}get name(){return"TypeError"}describe(){return`Expected value of type ${this.expect} instead got ${displayTypeName$1(this.actual)}`}};const typeError$1=e=>new TypeError$2(e),displayTypeName$1=e=>{const i=typeof e;switch(i){case"boolean":case"string":return JSON.stringify(e);case"bigint":return`${e}n`;case"number":case"symbol":case"undefined":return String(e);case"object":return e===null?"null":Array.isArray(e)?"array":"object";default:return i}};let ElementError$1=class extends SchemaError$1{constructor({at:i,cause:o}){super(),this.at=i,this.cause=o}get name(){return"ElementError"}describe(){return[`Array contains invalid element at ${this.at}:`,li$2(this.cause.message)].join(`
`)}},FieldError$1=class extends SchemaError$1{constructor({at:i,cause:o}){super(),this.at=i,this.cause=o}get name(){return"FieldError"}describe(){return[`Object contains invalid field "${this.at}":`,li$2(this.cause.message)].join(`
`)}};const memberError$1=({at:e,cause:i})=>typeof e=="string"?new FieldError$1({at:e,cause:i}):new ElementError$1({at:e,cause:i});let UnionError$1=class extends SchemaError$1{constructor({causes:i}){super(),this.causes=i}get name(){return"UnionError"}describe(){const{causes:i}=this;return["Value does not match any type of the union:",...i.map(o=>li$2(o.message))].join(`
`)}},IntersectionError$1=class extends SchemaError$1{constructor({causes:i}){super(),this.causes=i}get name(){return"IntersectionError"}describe(){const{causes:i}=this;return["Value does not match following types of the intersection:",...i.map(o=>li$2(o.message))].join(`
`)}};const indent$2=(e,i="  ")=>`${i}${e.split(`
`).join(`
${i}`)}`,li$2=e=>indent$2(`- ${e}`);let URISchema$1=class extends API$1{readWith(i,{protocol:o}={}){if(typeof i!="string"&&!(i instanceof URL))return error$1(`Expected URI but got ${i===null?"null":typeof i}`);try{const s=new URL(String(i));return o!=null&&s.protocol!==o?error$1(`Expected ${o} URI instead got ${s.href}`):s.href}catch{return error$1("Invalid URI")}}};const match$4=e=>new URISchema$1(e);let LinkSchema$1=class extends API$1{readWith(i,{code:o,algorithm:s,version:c}){return i==null?error$1(`Expected link but got ${i} instead`):isLink(i)?o!=null&&i.code!==o?error$1(`Expected link to be CID with 0x${o.toString(16)} codec`):s!=null&&i.multihash.code!==s?error$1(`Expected link to be CID with 0x${s.toString(16)} hashing algorithm`):c!=null&&i.version!==c?error$1(`Expected link to be CID version ${c} instead of ${i.version}`):i:error$1(`Expected link to be a CID instead of ${i}`)}};const schema$2=new LinkSchema$1({}),link$1=()=>schema$2,match$3=(e={})=>new LinkSchema$1(e),read$2=e=>schema$2.read(e),optional$2=()=>schema$2.optional(),Link$1=Object.freeze(Object.defineProperty({__proto__:null,create:create$7,createLegacy,isLink,link:link$1,match:match$3,optional:optional$2,parse:parse$3,read:read$2,schema:schema$2},Symbol.toStringTag,{value:"Module"}));let DIDSchema$1=class extends API$1{readWith(i,o){const s=o?`did:${o}:`:"did:";return i.startsWith(s)?i:error$1(`Expected a ${s} but got "${i}" instead`)}};const schema$1=string$1().refine(new DIDSchema$1),did=()=>schema$1,read$1=e=>schema$1.read(e),match$2=e=>string$1().refine(new DIDSchema$1(e.method)),from=e=>match$2({}).from(e),DID=Object.freeze(Object.defineProperty({__proto__:null,did,from,match:match$2,read:read$1},Symbol.toStringTag,{value:"Module"}));capability$1({can:"*",with:DID});function equalWith$1(e,i){return e.with===i.with||new Failure$1(`Can not derive ${e.can} with ${e.with} from ${i.with}`)}function equal(e,i,o){return i===void 0||i==="*"||String(e)===String(i)?!0:new Failure$1(`Constrain violation: ${e} violates imposed ${o} constraint ${i}`)}const equalLink$1=(e,i)=>e.with!==i.with?new Failure$1(`Expected 'with: "${i.with}"' instead got '${e.with}'`):i.nb.link&&`${i.nb.link}`!=`${e.nb.link}`?new Failure$1(`Link ${e.nb.link?`${e.nb.link}`:""} violates imposed ${i.nb.link} constraint.`):!0;function fail(e){return e===!0?void 0:e}const top=capability$1({can:"*",with:match$4({protocol:"did:"}),derives:equalWith$1}),store$1=top.derive({to:capability$1({can:"store/*",with:match$4({protocol:"did:"}),derives:equalWith$1}),derives:equalWith$1}),base$2=top.or(store$1),add$3=base$2.derive({to:capability$1({can:"store/add",with:match$4({protocol:"did:"}),nb:{link:Link$1,size:integer$1(),origin:optional$2()},derives:(e,i)=>{const o=equalLink$1(e,i);return o.error?o:e.nb.size!==void 0&&i.nb.size!==void 0&&e.nb.size>i.nb.size?new Failure$1(`Size constraint violation: ${e.nb.size} > ${i.nb.size}`):!0}}),derives:equalWith$1}),remove$2=base$2.derive({to:capability$1({can:"store/remove",with:match$4({protocol:"did:"}),nb:{link:Link$1},derives:equalLink$1}),derives:equalWith$1}),list$2=base$2.derive({to:capability$1({can:"store/list",with:match$4({protocol:"did:"}),nb:{cursor:string$1().optional(),size:integer$1().optional(),pre:boolean$1().optional()},derives:(e,i)=>e.with!==i.with?new Failure$1(`Expected 'with: "${i.with}"' instead got '${e.with}'`):!0}),derives:equalWith$1});add$3.or(remove$2).or(list$2);var retryExports={},retry$2={get exports(){return retryExports},set exports(e){retryExports=e}},retry$1={};function RetryOperation(e,i){typeof i=="boolean"&&(i={forever:i}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=i||{},this._maxRetryTime=i&&i.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var retry_operation=RetryOperation;RetryOperation.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};RetryOperation.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};RetryOperation.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var i=new Date().getTime();if(e&&i-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var o=this._timeouts.shift();if(o===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),o=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},o),this._options.unref&&this._timer.unref(),!0};RetryOperation.prototype.attempt=function(e,i){this._fn=e,i&&(i.timeout&&(this._operationTimeout=i.timeout),i.cb&&(this._operationTimeoutCb=i.cb));var o=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){o._operationTimeoutCb()},o._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};RetryOperation.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)};RetryOperation.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)};RetryOperation.prototype.start=RetryOperation.prototype.try;RetryOperation.prototype.errors=function(){return this._errors};RetryOperation.prototype.attempts=function(){return this._attempts};RetryOperation.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},i=null,o=0,s=0;s<this._errors.length;s++){var c=this._errors[s],g=c.message,b=(e[g]||0)+1;e[g]=b,b>=o&&(i=c,o=b)}return i};(function(e){var i=retry_operation;e.operation=function(o){var s=e.timeouts(o);return new i(s,{forever:o&&(o.forever||o.retries===1/0),unref:o&&o.unref,maxRetryTime:o&&o.maxRetryTime})},e.timeouts=function(o){if(o instanceof Array)return[].concat(o);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var c in o)s[c]=o[c];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var g=[],b=0;b<s.retries;b++)g.push(this.createTimeout(b,s));return o&&o.forever&&!g.length&&g.push(this.createTimeout(b,s)),g.sort(function($,_e){return $-_e}),g},e.createTimeout=function(o,s){var c=s.randomize?Math.random()+1:1,g=Math.round(c*Math.max(s.minTimeout,1)*Math.pow(s.factor,o));return g=Math.min(g,s.maxTimeout),g},e.wrap=function(o,s,c){if(s instanceof Array&&(c=s,s=null),!c){c=[];for(var g in o)typeof o[g]=="function"&&c.push(g)}for(var b=0;b<c.length;b++){var $=c[b],_e=o[$];o[$]=function(nt){var ot=e.operation(s),ct=Array.prototype.slice.call(arguments,1),at=ct.pop();ct.push(function(lt){ot.retry(lt)||(lt&&(arguments[0]=ot.mainError()),at.apply(this,arguments))}),ot.attempt(function(){nt.apply(o,ct)})}.bind(o,_e),o[$].options=s}}})(retry$1);(function(e){e.exports=retry$1})(retry$2);const retry=getDefaultExportFromCjs(retryExports),networkErrorMsgs=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed","fetch failed"]);let AbortError$2=class extends Error{constructor(i){super(),i instanceof Error?(this.originalError=i,{message:i}=i):(this.originalError=new Error(i),this.originalError.stack=this.stack),this.name="AbortError",this.message=i}};const decorateErrorWithCounts=(e,i,o)=>{const s=o.retries-(i-1);return e.attemptNumber=i,e.retriesLeft=s,e},isNetworkError=e=>networkErrorMsgs.has(e),getDOMException$1=e=>globalThis.DOMException===void 0?new Error(e):new DOMException(e);async function pRetry(e,i){return new Promise((o,s)=>{i={onFailedAttempt(){},retries:10,...i};const c=retry.operation(i);c.attempt(async g=>{try{o(await e(g))}catch(b){if(!(b instanceof Error)){s(new TypeError(`Non-error was thrown: "${b}". You should only throw errors.`));return}if(b instanceof AbortError$2)c.stop(),s(b.originalError);else if(b instanceof TypeError&&!isNetworkError(b.message))c.stop(),s(b);else{decorateErrorWithCounts(b,g,i);try{await i.onFailedAttempt(b)}catch($){s($);return}c.retry(b)||s(c.mainError())}}}),i.signal&&!i.signal.aborted&&i.signal.addEventListener("abort",()=>{c.stop();const g=i.signal.reason===void 0?getDOMException$1("The operation was aborted."):i.signal.reason;s(g instanceof Error?g:getDOMException$1(g))},{once:!0})})}const connect=e=>new Connection(e);class Connection{constructor(i){this.id=i.id,this.options=i,this.encoder=i.encoder,this.decoder=i.decoder,this.channel=i.channel,this.hasher=i.hasher||sha256}execute(...i){return execute(i,this)}}const execute=async(e,i)=>{const o=await i.encoder.encode(e,i),s=await i.channel.request(o);return await i.decoder.decode(s)},isDelegation=e=>!isLink(e);class Delegation{constructor(i,o=new Map){this.root=i,this.blocks=o,Object.defineProperties(this,{blocks:{enumerable:!1}})}get version(){return this.data.version}get signature(){return this.data.signature}get cid(){return this.root.cid}get asCID(){return this.cid}get bytes(){return this.root.bytes}get data(){const i=decode$2(this.root);return Object.defineProperties(this,{data:{value:i,enumerable:!1}}),i}export(){return exportDAG(this.root,this.blocks)}get proofs(){return proofs(this)}get issuer(){return this.data.issuer}get audience(){return this.data.audience}get capabilities(){return this.data.capabilities}get expiration(){return this.data.expiration}get notBefore(){return this.data.notBefore}get nonce(){return this.data.nonce}get facts(){return this.data.facts}iterate(){return it(this)}delegate(){return this}toJSON(){return{...this.data.toJSON(),"/":this.cid.toString(),prf:this.proofs.map(i=>isDelegation(i)?i:{"/":i.toString()})}}}const it=function*(e){for(const i of e.proofs)isDelegation(i)&&(yield*it(i),yield i)},decodeCache=new WeakMap,decode$2=({bytes:e})=>{const i=decodeCache.get(e);if(!i){const o=decode$7(e);return decodeCache.set(e,o),o}return i},delegate=async({issuer:e,audience:i,proofs:o=[],...s},c)=>{const g=[],b=new Map;for(const ot of o)if(!isDelegation(ot))g.push(ot);else{g.push(ot.cid);for(const ct of ot.export())b.set(ct.cid.toString(),ct)}const $=await issue({...s,issuer:e,audience:i,proofs:g}),{cid:_e,bytes:et}=await write$3($,c);decodeCache.set(_e,$);const nt=new Delegation({cid:_e,bytes:et},b);return Object.defineProperties(nt,{proofs:{value:o}}),nt},exportDAG=function*(e,i){for(const o of decode$2(e).proofs){const s=i.get(o.toString());s&&(yield*exportDAG(s,i))}yield e},create$2=({root:e,blocks:i})=>new Delegation(e,i),proofs=e=>{const i=[],{root:o,blocks:s}=e;for(const c of decode$2(o).proofs){const g=s.get(c.toString());i.push(g?create$2({root:g,blocks:s}):c)}return Object.defineProperty(e,"proofs",{value:i}),i},invoke=e=>new IssuedInvocation(e);class IssuedInvocation{constructor({issuer:i,audience:o,capability:s,proofs:c=[],expiration:g,lifetimeInSeconds:b,notBefore:$,nonce:_e,facts:et=[]}){this.issuer=i,this.audience=o,this.proofs=c,this.capabilities=[s],this.expiration=g,this.lifetimeInSeconds=b,this.notBefore=$,this.nonce=_e,this.facts=et}delegate(){return delegate(this)}async execute(i){const o=this,[s]=await i.execute(o);return s}}const serviceURL=new URL("https://up.web3.storage"),servicePrincipal=parse$2("did:web:web3.storage"),connection=connect({id:servicePrincipal,encoder:CAR,decoder:CBOR,channel:open$1({url:serviceURL,method:"POST"})}),REQUEST_RETRIES=3;async function add$2({issuer:e,with:i,proofs:o,audience:s},c,g={}){const b=new Uint8Array(await c.arrayBuffer()),$=await link$2(b),_e=g.connection??connection,et=await pRetry(async()=>await add$3.invoke({issuer:e,audience:s??servicePrincipal,with:i,nb:{link:$,size:c.size},proofs:o}).execute(_e),{onFailedAttempt:console.warn,retries:g.retries??REQUEST_RETRIES});if(et.error)throw new Error(`failed ${add$3.can} invocation`,{cause:et});if(et.status==="done")return $;const nt=await pRetry(async()=>{var ot;try{const ct=await fetch(et.url,{method:"PUT",mode:"cors",body:c,headers:et.headers,signal:g.signal});if(ct.status>=400&&ct.status<500)throw new AbortError$2(`upload failed: ${ct.status}`);return ct}catch(ct){throw((ot=g.signal)==null?void 0:ot.aborted)===!0?new AbortError$2("upload aborted"):ct}},{onFailedAttempt:console.warn,retries:g.retries??REQUEST_RETRIES});if(!nt.ok)throw new Error(`upload failed: ${nt.status}`);return $}const upload=top.derive({to:capability$1({can:"upload/*",with:match$4({protocol:"did:"}),derives:equalWith$1}),derives:equalWith$1}),base$1=top.or(upload),CARLink=match$3({code:code$2,version:1}),add$1=base$1.derive({to:capability$1({can:"upload/add",with:match$4({protocol:"did:"}),nb:{root:Link$1,shards:CARLink.array().optional()},derives:(e,i)=>fail(equalWith$1(e,i))||fail(equal(e.nb.root,i.nb.root,"root"))||fail(equal(e.nb.shards,i.nb.shards,"shards"))||!0}),derives:equalWith$1}),remove$1=base$1.derive({to:capability$1({can:"upload/remove",with:match$4({protocol:"did:"}),nb:{root:Link$1},derives:(e,i)=>fail(equalWith$1(e,i))||fail(equal(e.nb.root,i.nb.root,"root"))||!0}),derives:equalWith$1}),list$1=base$1.derive({to:capability$1({can:"upload/list",with:match$4({protocol:"did:"}),nb:{cursor:string$1().optional(),size:integer$1().optional(),pre:boolean$1().optional()}}),derives:equalWith$1});add$1.or(remove$1).or(list$1);const textDecoder=new TextDecoder;function decodeVarint(e,i){let o=0;for(let s=0;;s+=7){if(s>=64)throw new Error("protobuf: varint overflow");if(i>=e.length)throw new Error("protobuf: unexpected end of data");const c=e[i++];if(o+=s<28?(c&127)<<s:(c&127)*2**s,c<128)break}return[o,i]}function decodeBytes(e,i){let o;[o,i]=decodeVarint(e,i);const s=i+o;if(o<0||s<0)throw new Error("protobuf: invalid length");if(s>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(i,s),s]}function decodeKey(e,i){let o;return[o,i]=decodeVarint(e,i),[o&7,o>>3,i]}function decodeLink(e){const i={},o=e.length;let s=0;for(;s<o;){let c,g;if([c,g,s]=decodeKey(e,s),g===1){if(i.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(c!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${c}) for Hash`);if(i.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(i.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[i.Hash,s]=decodeBytes(e,s)}else if(g===2){if(i.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(c!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${c}) for Name`);if(i.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let b;[b,s]=decodeBytes(e,s),i.Name=textDecoder.decode(b)}else if(g===3){if(i.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(c!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${c}) for Tsize`);[i.Tsize,s]=decodeVarint(e,s)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${g}`)}if(s>o)throw new Error("protobuf: (PBLink) unexpected end of data");return i}function decodeNode(e){const i=e.length;let o=0,s,c=!1,g;for(;o<i;){let $,_e;if([$,_e,o]=decodeKey(e,o),$!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${$}`);if(_e===1){if(g)throw new Error("protobuf: (PBNode) duplicate Data section");[g,o]=decodeBytes(e,o),s&&(c=!0)}else if(_e===2){if(c)throw new Error("protobuf: (PBNode) duplicate Links section");s||(s=[]);let et;[et,o]=decodeBytes(e,o),s.push(decodeLink(et))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${_e}`)}if(o>i)throw new Error("protobuf: (PBNode) unexpected end of data");const b={};return g&&(b.Data=g),b.Links=s||[],b}const textEncoder$1=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink$1(e,i){let o=i.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");o=encodeVarint(i,o,e.Tsize)-1,i[o]=24}if(typeof e.Name=="string"){const s=textEncoder$1.encode(e.Name);o-=s.length,i.set(s,o),o=encodeVarint(i,o,s.length)-1,i[o]=18}return e.Hash&&(o-=e.Hash.length,i.set(e.Hash,o),o=encodeVarint(i,o,e.Hash.length)-1,i[o]=10),i.length-o}function encodeNode(e){const i=sizeNode(e),o=new Uint8Array(i);let s=i;if(e.Data&&(s-=e.Data.length,o.set(e.Data,s),s=encodeVarint(o,s,e.Data.length)-1,o[s]=10),e.Links)for(let c=e.Links.length-1;c>=0;c--){const g=encodeLink$1(e.Links[c],o.subarray(0,s));s-=g,s=encodeVarint(o,s,g)-1,o[s]=18}return o}function sizeLink(e){let i=0;if(e.Hash){const o=e.Hash.length;i+=1+o+sov(o)}if(typeof e.Name=="string"){const o=textEncoder$1.encode(e.Name).length;i+=1+o+sov(o)}return typeof e.Tsize=="number"&&(i+=1+sov(e.Tsize)),i}function sizeNode(e){let i=0;if(e.Data){const o=e.Data.length;i+=1+o+sov(o)}if(e.Links)for(const o of e.Links){const s=sizeLink(o);i+=1+s+sov(s)}return i}function encodeVarint(e,i,o){i-=sov(o);const s=i;for(;o>=maxUInt32;)e[i++]=o&127|128,o/=128;for(;o>=128;)e[i++]=o&127|128,o>>>=7;return e[i]=o,s}function sov(e){return e%2===0&&e++,Math.floor((len64(e)+6)/7)}function len64(e){let i=0;return e>=maxInt32&&(e=Math.floor(e/maxInt32),i=32),e>=1<<16&&(e>>>=16,i+=16),e>=1<<8&&(e>>>=8,i+=8),i+len8tab[e]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder=new TextEncoder;function linkComparator(e,i){if(e===i)return 0;const o=e.Name?textEncoder.encode(e.Name):[],s=i.Name?textEncoder.encode(i.Name):[];let c=o.length,g=s.length;for(let b=0,$=Math.min(c,g);b<$;++b)if(o[b]!==s[b]){c=o[b],g=s[b];break}return c<g?-1:g<c?1:0}function hasOnlyProperties(e,i){return!Object.keys(e).some(o=>!i.includes(o))}function asLink(e){if(typeof e.asCID=="object"){const o=CID.asCID(e);if(!o)throw new TypeError("Invalid DAG-PB form");return{Hash:o}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const i={};if(e.Hash){let o=CID.asCID(e.Hash);try{o||(typeof e.Hash=="string"?o=CID.parse(e.Hash):e.Hash instanceof Uint8Array&&(o=CID.decode(e.Hash)))}catch(s){throw new TypeError(`Invalid DAG-PB form: ${s.message}`)}o&&(i.Hash=o)}if(!i.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(i.Name=e.Name),typeof e.Tsize=="number"&&(i.Tsize=e.Tsize),i}function prepare(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const i={};if(e.Data!==void 0)if(typeof e.Data=="string")i.Data=textEncoder.encode(e.Data);else if(e.Data instanceof Uint8Array)i.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))i.Links=e.Links.map(asLink),i.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else i.Links=[];return i}function validate(e){if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(e,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let i=0;i<e.Links.length;i++){const o=e.Links[i];if(!o||typeof o!="object"||Array.isArray(o)||o instanceof Uint8Array||o["/"]&&o["/"]===o.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(o,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(o.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(o.Hash==null||!o.Hash["/"]||o.Hash["/"]!==o.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(o.Name!==void 0&&typeof o.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(o.Tsize!==void 0){if(typeof o.Tsize!="number"||o.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(o.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(i>0&&linkComparator(o,e.Links[i-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}const code$1=112;function encode$2(e){validate(e);const i={};return e.Links&&(i.Links=e.Links.map(o=>{const s={};return o.Hash&&(s.Hash=o.Hash.bytes),o.Name!==void 0&&(s.Name=o.Name),o.Tsize!==void 0&&(s.Tsize=o.Tsize),s})),e.Data&&(i.Data=e.Data),encodeNode(i)}function decode$1(e){const i=decodeNode(e),o={};return i.Data&&(o.Data=i.Data),i.Links&&(o.Links=i.Links.map(s=>{const c={};try{c.Hash=CID.decode(s.Hash)}catch{}if(!c.Hash)throw new Error("Invalid Hash field found in link, expected CID");return s.Name!==void 0&&(c.Name=s.Name),s.Tsize!==void 0&&(c.Tsize=s.Tsize),c})),o}var minimalExports={},minimal$1={get exports(){return minimalExports},set exports(e){minimalExports=e}},indexMinimal={},minimal={},aspromise=asPromise;function asPromise(e,i){for(var o=new Array(arguments.length-1),s=0,c=2,g=!0;c<arguments.length;)o[s++]=arguments[c++];return new Promise(function($,_e){o[s]=function(nt){if(g)if(g=!1,nt)_e(nt);else{for(var ot=new Array(arguments.length-1),ct=0;ct<ot.length;)ot[ct++]=arguments[ct];$.apply(null,ot)}};try{e.apply(i||null,o)}catch(et){g&&(g=!1,_e(et))}})}var base64$1={};(function(e){var i=e;i.length=function($){var _e=$.length;if(!_e)return 0;for(var et=0;--_e%4>1&&$.charAt(_e)==="=";)++et;return Math.ceil($.length*3)/4-et};for(var o=new Array(64),s=new Array(123),c=0;c<64;)s[o[c]=c<26?c+65:c<52?c+71:c<62?c-4:c-59|43]=c++;i.encode=function($,_e,et){for(var nt=null,ot=[],ct=0,at=0,lt;_e<et;){var gt=$[_e++];switch(at){case 0:ot[ct++]=o[gt>>2],lt=(gt&3)<<4,at=1;break;case 1:ot[ct++]=o[lt|gt>>4],lt=(gt&15)<<2,at=2;break;case 2:ot[ct++]=o[lt|gt>>6],ot[ct++]=o[gt&63],at=0;break}ct>8191&&((nt||(nt=[])).push(String.fromCharCode.apply(String,ot)),ct=0)}return at&&(ot[ct++]=o[lt],ot[ct++]=61,at===1&&(ot[ct++]=61)),nt?(ct&&nt.push(String.fromCharCode.apply(String,ot.slice(0,ct))),nt.join("")):String.fromCharCode.apply(String,ot.slice(0,ct))};var g="invalid encoding";i.decode=function($,_e,et){for(var nt=et,ot=0,ct,at=0;at<$.length;){var lt=$.charCodeAt(at++);if(lt===61&&ot>1)break;if((lt=s[lt])===void 0)throw Error(g);switch(ot){case 0:ct=lt,ot=1;break;case 1:_e[et++]=ct<<2|(lt&48)>>4,ct=lt,ot=2;break;case 2:_e[et++]=(ct&15)<<4|(lt&60)>>2,ct=lt,ot=3;break;case 3:_e[et++]=(ct&3)<<6|lt,ot=0;break}}if(ot===1)throw Error(g);return et-nt},i.test=function($){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test($)}})(base64$1);var eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(i,o,s){return(this._listeners[i]||(this._listeners[i]=[])).push({fn:o,ctx:s||this}),this};EventEmitter.prototype.off=function(i,o){if(i===void 0)this._listeners={};else if(o===void 0)this._listeners[i]=[];else for(var s=this._listeners[i],c=0;c<s.length;)s[c].fn===o?s.splice(c,1):++c;return this};EventEmitter.prototype.emit=function(i){var o=this._listeners[i];if(o){for(var s=[],c=1;c<arguments.length;)s.push(arguments[c++]);for(c=0;c<o.length;)o[c].fn.apply(o[c++].ctx,s)}return this};var float=factory(factory);function factory(e){return typeof Float32Array<"u"?function(){var i=new Float32Array([-0]),o=new Uint8Array(i.buffer),s=o[3]===128;function c(_e,et,nt){i[0]=_e,et[nt]=o[0],et[nt+1]=o[1],et[nt+2]=o[2],et[nt+3]=o[3]}function g(_e,et,nt){i[0]=_e,et[nt]=o[3],et[nt+1]=o[2],et[nt+2]=o[1],et[nt+3]=o[0]}e.writeFloatLE=s?c:g,e.writeFloatBE=s?g:c;function b(_e,et){return o[0]=_e[et],o[1]=_e[et+1],o[2]=_e[et+2],o[3]=_e[et+3],i[0]}function $(_e,et){return o[3]=_e[et],o[2]=_e[et+1],o[1]=_e[et+2],o[0]=_e[et+3],i[0]}e.readFloatLE=s?b:$,e.readFloatBE=s?$:b}():function(){function i(s,c,g,b){var $=c<0?1:0;if($&&(c=-c),c===0)s(1/c>0?0:2147483648,g,b);else if(isNaN(c))s(2143289344,g,b);else if(c>34028234663852886e22)s(($<<31|2139095040)>>>0,g,b);else if(c<11754943508222875e-54)s(($<<31|Math.round(c/1401298464324817e-60))>>>0,g,b);else{var _e=Math.floor(Math.log(c)/Math.LN2),et=Math.round(c*Math.pow(2,-_e)*8388608)&8388607;s(($<<31|_e+127<<23|et)>>>0,g,b)}}e.writeFloatLE=i.bind(null,writeUintLE),e.writeFloatBE=i.bind(null,writeUintBE);function o(s,c,g){var b=s(c,g),$=(b>>31)*2+1,_e=b>>>23&255,et=b&8388607;return _e===255?et?NaN:$*(1/0):_e===0?$*1401298464324817e-60*et:$*Math.pow(2,_e-150)*(et+8388608)}e.readFloatLE=o.bind(null,readUintLE),e.readFloatBE=o.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var i=new Float64Array([-0]),o=new Uint8Array(i.buffer),s=o[7]===128;function c(_e,et,nt){i[0]=_e,et[nt]=o[0],et[nt+1]=o[1],et[nt+2]=o[2],et[nt+3]=o[3],et[nt+4]=o[4],et[nt+5]=o[5],et[nt+6]=o[6],et[nt+7]=o[7]}function g(_e,et,nt){i[0]=_e,et[nt]=o[7],et[nt+1]=o[6],et[nt+2]=o[5],et[nt+3]=o[4],et[nt+4]=o[3],et[nt+5]=o[2],et[nt+6]=o[1],et[nt+7]=o[0]}e.writeDoubleLE=s?c:g,e.writeDoubleBE=s?g:c;function b(_e,et){return o[0]=_e[et],o[1]=_e[et+1],o[2]=_e[et+2],o[3]=_e[et+3],o[4]=_e[et+4],o[5]=_e[et+5],o[6]=_e[et+6],o[7]=_e[et+7],i[0]}function $(_e,et){return o[7]=_e[et],o[6]=_e[et+1],o[5]=_e[et+2],o[4]=_e[et+3],o[3]=_e[et+4],o[2]=_e[et+5],o[1]=_e[et+6],o[0]=_e[et+7],i[0]}e.readDoubleLE=s?b:$,e.readDoubleBE=s?$:b}():function(){function i(s,c,g,b,$,_e){var et=b<0?1:0;if(et&&(b=-b),b===0)s(0,$,_e+c),s(1/b>0?0:2147483648,$,_e+g);else if(isNaN(b))s(0,$,_e+c),s(2146959360,$,_e+g);else if(b>17976931348623157e292)s(0,$,_e+c),s((et<<31|2146435072)>>>0,$,_e+g);else{var nt;if(b<22250738585072014e-324)nt=b/5e-324,s(nt>>>0,$,_e+c),s((et<<31|nt/4294967296)>>>0,$,_e+g);else{var ot=Math.floor(Math.log(b)/Math.LN2);ot===1024&&(ot=1023),nt=b*Math.pow(2,-ot),s(nt*4503599627370496>>>0,$,_e+c),s((et<<31|ot+1023<<20|nt*1048576&1048575)>>>0,$,_e+g)}}}e.writeDoubleLE=i.bind(null,writeUintLE,0,4),e.writeDoubleBE=i.bind(null,writeUintBE,4,0);function o(s,c,g,b,$){var _e=s(b,$+c),et=s(b,$+g),nt=(et>>31)*2+1,ot=et>>>20&2047,ct=4294967296*(et&1048575)+_e;return ot===2047?ct?NaN:nt*(1/0):ot===0?nt*5e-324*ct:nt*Math.pow(2,ot-1075)*(ct+4503599627370496)}e.readDoubleLE=o.bind(null,readUintLE,0,4),e.readDoubleBE=o.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,i,o){i[o]=e&255,i[o+1]=e>>>8&255,i[o+2]=e>>>16&255,i[o+3]=e>>>24}function writeUintBE(e,i,o){i[o]=e>>>24,i[o+1]=e>>>16&255,i[o+2]=e>>>8&255,i[o+3]=e&255}function readUintLE(e,i){return(e[i]|e[i+1]<<8|e[i+2]<<16|e[i+3]<<24)>>>0}function readUintBE(e,i){return(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8$2={};(function(e){var i=e;i.length=function(s){for(var c=0,g=0,b=0;b<s.length;++b)g=s.charCodeAt(b),g<128?c+=1:g<2048?c+=2:(g&64512)===55296&&(s.charCodeAt(b+1)&64512)===56320?(++b,c+=4):c+=3;return c},i.read=function(s,c,g){var b=g-c;if(b<1)return"";for(var $=null,_e=[],et=0,nt;c<g;)nt=s[c++],nt<128?_e[et++]=nt:nt>191&&nt<224?_e[et++]=(nt&31)<<6|s[c++]&63:nt>239&&nt<365?(nt=((nt&7)<<18|(s[c++]&63)<<12|(s[c++]&63)<<6|s[c++]&63)-65536,_e[et++]=55296+(nt>>10),_e[et++]=56320+(nt&1023)):_e[et++]=(nt&15)<<12|(s[c++]&63)<<6|s[c++]&63,et>8191&&(($||($=[])).push(String.fromCharCode.apply(String,_e)),et=0);return $?(et&&$.push(String.fromCharCode.apply(String,_e.slice(0,et))),$.join("")):String.fromCharCode.apply(String,_e.slice(0,et))},i.write=function(s,c,g){for(var b=g,$,_e,et=0;et<s.length;++et)$=s.charCodeAt(et),$<128?c[g++]=$:$<2048?(c[g++]=$>>6|192,c[g++]=$&63|128):($&64512)===55296&&((_e=s.charCodeAt(et+1))&64512)===56320?($=65536+(($&1023)<<10)+(_e&1023),++et,c[g++]=$>>18|240,c[g++]=$>>12&63|128,c[g++]=$>>6&63|128,c[g++]=$&63|128):(c[g++]=$>>12|224,c[g++]=$>>6&63|128,c[g++]=$&63|128);return g-b}})(utf8$2);var pool_1=pool;function pool(e,i,o){var s=o||8192,c=s>>>1,g=null,b=s;return function(_e){if(_e<1||_e>c)return e(_e);b+_e>s&&(g=e(s),b=0);var et=i.call(g,b,b+=_e);return b&7&&(b=(b|7)+1),et}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=i;var e=requireMinimal();function i(g,b){this.lo=g>>>0,this.hi=b>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(b){if(b===0)return o;var $=b<0;$&&(b=-b);var _e=b>>>0,et=(b-_e)/4294967296>>>0;return $&&(et=~et>>>0,_e=~_e>>>0,++_e>4294967295&&(_e=0,++et>4294967295&&(et=0))),new i(_e,et)},i.from=function(b){if(typeof b=="number")return i.fromNumber(b);if(e.isString(b))if(e.Long)b=e.Long.fromString(b);else return i.fromNumber(parseInt(b,10));return b.low||b.high?new i(b.low>>>0,b.high>>>0):o},i.prototype.toNumber=function(b){if(!b&&this.hi>>>31){var $=~this.lo+1>>>0,_e=~this.hi>>>0;return $||(_e=_e+1>>>0),-($+_e*4294967296)}return this.lo+this.hi*4294967296},i.prototype.toLong=function(b){return e.Long?new e.Long(this.lo|0,this.hi|0,Boolean(b)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(b)}};var c=String.prototype.charCodeAt;return i.fromHash=function(b){return b===s?o:new i((c.call(b,0)|c.call(b,1)<<8|c.call(b,2)<<16|c.call(b,3)<<24)>>>0,(c.call(b,4)|c.call(b,5)<<8|c.call(b,6)<<16|c.call(b,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var b=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^b)>>>0,this.lo=(this.lo<<1^b)>>>0,this},i.prototype.zzDecode=function(){var b=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^b)>>>0,this.hi=(this.hi>>>1^b)>>>0,this},i.prototype.length=function(){var b=this.lo,$=(this.lo>>>28|this.hi<<4)>>>0,_e=this.hi>>>24;return _e===0?$===0?b<16384?b<128?1:2:b<2097152?3:4:$<16384?$<128?5:6:$<2097152?7:8:_e<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(e){var i=e;i.asPromise=aspromise,i.base64=base64$1,i.EventEmitter=eventemitter,i.float=float,i.inquire=inquire_1,i.utf8=utf8$2,i.pool=pool_1,i.LongBits=requireLongbits(),i.isNode=Boolean(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),i.global=i.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(g){return typeof g=="number"&&isFinite(g)&&Math.floor(g)===g},i.isString=function(g){return typeof g=="string"||g instanceof String},i.isObject=function(g){return g&&typeof g=="object"},i.isset=i.isSet=function(g,b){var $=g[b];return $!=null&&g.hasOwnProperty(b)?typeof $!="object"||(Array.isArray($)?$.length:Object.keys($).length)>0:!1},i.Buffer=function(){try{var c=i.inquire("buffer").Buffer;return c.prototype.utf8Write?c:null}catch{return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(g){return typeof g=="number"?i.Buffer?i._Buffer_allocUnsafe(g):new i.Array(g):i.Buffer?i._Buffer_from(g):typeof Uint8Array>"u"?g:new Uint8Array(g)},i.Array=typeof Uint8Array<"u"?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(g){return g?i.LongBits.from(g).toHash():i.LongBits.zeroHash},i.longFromHash=function(g,b){var $=i.LongBits.fromHash(g);return i.Long?i.Long.fromBits($.lo,$.hi,b):$.toNumber(Boolean(b))};function o(c,g,b){for(var $=Object.keys(g),_e=0;_e<$.length;++_e)(c[$[_e]]===void 0||!b)&&(c[$[_e]]=g[$[_e]]);return c}i.merge=o,i.lcFirst=function(g){return g.charAt(0).toLowerCase()+g.substring(1)};function s(c){function g(b,$){if(!(this instanceof g))return new g(b,$);Object.defineProperty(this,"message",{get:function(){return b}}),Error.captureStackTrace?Error.captureStackTrace(this,g):Object.defineProperty(this,"stack",{value:new Error().stack||""}),$&&o(this,$)}return g.prototype=Object.create(Error.prototype,{constructor:{value:g,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return c},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),g}i.newError=s,i.ProtocolError=s("ProtocolError"),i.oneOfGetter=function(g){for(var b={},$=0;$<g.length;++$)b[g[$]]=1;return function(){for(var _e=Object.keys(this),et=_e.length-1;et>-1;--et)if(b[_e[et]]===1&&this[_e[et]]!==void 0&&this[_e[et]]!==null)return _e[et]}},i.oneOfSetter=function(g){return function(b){for(var $=0;$<g.length;++$)g[$]!==b&&delete this[g[$]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var c=i.Buffer;if(!c){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=c.from!==Uint8Array.from&&c.from||function(b,$){return new c(b,$)},i._Buffer_allocUnsafe=c.allocUnsafe||function(b){return new c(b)}}}(minimal)),minimal}var writer=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(e,i,o){this.fn=e,this.len=i,this.next=void 0,this.val=o}function noop$1(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop$1,0,0),this.tail=this.head,this.states=null}var create$1=function e(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$1();Writer$1.alloc=function e(i){return new util$4.Array(i)};util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray));Writer$1.prototype._push=function e(i,o,s){return this.tail=this.tail.next=new Op(i,o,s),this.len+=o,this};function writeByte(e,i,o){i[o]=e&255}function writeVarint32(e,i,o){for(;e>127;)i[o++]=e&127|128,e>>>=7;i[o]=e}function VarintOp(e,i){this.len=e,this.next=void 0,this.val=i}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer$1.prototype.uint32=function e(i){return this.len+=(this.tail=this.tail.next=new VarintOp((i=i>>>0)<128?1:i<16384?2:i<2097152?3:i<268435456?4:5,i)).len,this};Writer$1.prototype.int32=function e(i){return i<0?this._push(writeVarint64,10,LongBits$1.fromNumber(i)):this.uint32(i)};Writer$1.prototype.sint32=function e(i){return this.uint32((i<<1^i>>31)>>>0)};function writeVarint64(e,i,o){for(;e.hi;)i[o++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)i[o++]=e.lo&127|128,e.lo=e.lo>>>7;i[o++]=e.lo}Writer$1.prototype.uint64=function e(i){var o=LongBits$1.from(i);return this._push(writeVarint64,o.length(),o)};Writer$1.prototype.int64=Writer$1.prototype.uint64;Writer$1.prototype.sint64=function e(i){var o=LongBits$1.from(i).zzEncode();return this._push(writeVarint64,o.length(),o)};Writer$1.prototype.bool=function e(i){return this._push(writeByte,1,i?1:0)};function writeFixed32(e,i,o){i[o]=e&255,i[o+1]=e>>>8&255,i[o+2]=e>>>16&255,i[o+3]=e>>>24}Writer$1.prototype.fixed32=function e(i){return this._push(writeFixed32,4,i>>>0)};Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32;Writer$1.prototype.fixed64=function e(i){var o=LongBits$1.from(i);return this._push(writeFixed32,4,o.lo)._push(writeFixed32,4,o.hi)};Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64;Writer$1.prototype.float=function e(i){return this._push(util$4.float.writeFloatLE,4,i)};Writer$1.prototype.double=function e(i){return this._push(util$4.float.writeDoubleLE,8,i)};var writeBytes=util$4.Array.prototype.set?function e(i,o,s){o.set(i,s)}:function e(i,o,s){for(var c=0;c<i.length;++c)o[s+c]=i[c]};Writer$1.prototype.bytes=function e(i){var o=i.length>>>0;if(!o)return this._push(writeByte,1,0);if(util$4.isString(i)){var s=Writer$1.alloc(o=base64.length(i));base64.decode(i,s,0),i=s}return this.uint32(o)._push(writeBytes,o,i)};Writer$1.prototype.string=function e(i){var o=utf8$1.length(i);return o?this.uint32(o)._push(utf8$1.write,o,i):this._push(writeByte,1,0)};Writer$1.prototype.fork=function e(){return this.states=new State(this),this.head=this.tail=new Op(noop$1,0,0),this.len=0,this};Writer$1.prototype.reset=function e(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop$1,0,0),this.len=0),this};Writer$1.prototype.ldelim=function e(){var i=this.head,o=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=i.next,this.tail=o,this.len+=s),this};Writer$1.prototype.finish=function e(){for(var i=this.head.next,o=this.constructor.alloc(this.len),s=0;i;)i.fn(i.val,o,s),s+=i.len,i=i.next;return o};Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function(i,o,s){o.set(i,s)}:function(i,o,s){if(i.copy)i.copy(o,s,0,i.length);else for(var c=0;c<i.length;)o[s++]=i[c++]}};BufferWriter.prototype.bytes=function e(i){util$3.isString(i)&&(i=util$3._Buffer_from(i,"base64"));var o=i.length>>>0;return this.uint32(o),o&&this._push(BufferWriter.writeBytesBuffer,o,i),this};function writeStringBuffer(e,i,o){e.length<40?util$3.utf8.write(e,i,o):i.utf8Write?i.utf8Write(e,o):i.write(e,o)}BufferWriter.prototype.string=function e(i){var o=util$3.Buffer.byteLength(i);return this.uint32(o),o&&this._push(writeStringBuffer,o,i),this};BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,i){return RangeError("index out of range: "+e.pos+" + "+(i||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array=typeof Uint8Array<"u"?function e(i){if(i instanceof Uint8Array||Array.isArray(i))return new Reader$1(i);throw Error("illegal buffer")}:function e(i){if(Array.isArray(i))return new Reader$1(i);throw Error("illegal buffer")},create=function e(){return util$2.Buffer?function(o){return(Reader$1.create=function(c){return util$2.Buffer.isBuffer(c)?new BufferReader$1(c):create_array(c)})(o)}:create_array};Reader$1.create=create();Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice;Reader$1.prototype.uint32=function e(){var i=4294967295;return function(){if(i=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(i=(i|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(i=(i|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(i=(i|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(i=(i|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return i;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return i}}();Reader$1.prototype.int32=function e(){return this.uint32()|0};Reader$1.prototype.sint32=function e(){var i=this.uint32();return i>>>1^-(i&1)|0};function readLongVarint(){var e=new LongBits(0,0),i=0;if(this.len-this.pos>4){for(;i<4;++i)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<i*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;i=0}else{for(;i<3;++i){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<i*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<i*7)>>>0,e}if(this.len-this.pos>4){for(;i<5;++i)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<i*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;i<5;++i){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<i*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function e(){return this.uint32()!==0};function readFixed32_end(e,i){return(e[i-4]|e[i-3]<<8|e[i-2]<<16|e[i-1]<<24)>>>0}Reader$1.prototype.fixed32=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader$1.prototype.sfixed32=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function e(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var i=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,i};Reader$1.prototype.double=function e(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var i=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,i};Reader$1.prototype.bytes=function e(){var i=this.uint32(),o=this.pos,s=this.pos+i;if(s>this.len)throw indexOutOfRange(this,i);return this.pos+=i,Array.isArray(this.buf)?this.buf.slice(o,s):o===s?new this.buf.constructor(0):this._slice.call(this.buf,o,s)};Reader$1.prototype.string=function e(){var i=this.bytes();return utf8.read(i,0,i.length)};Reader$1.prototype.skip=function e(i){if(typeof i=="number"){if(this.pos+i>this.len)throw indexOutOfRange(this,i);this.pos+=i}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this};Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create(),BufferReader$1._configure();var i=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[i](!1)},uint64:function(){return readLongVarint.call(this)[i](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[i](!1)},fixed64:function(){return readFixed64.call(this)[i](!0)},sfixed64:function(){return readFixed64.call(this)[i](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)};BufferReader.prototype.string=function e(){var i=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+i,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+i,this.len))};BufferReader._configure();var rpc={},service=Service,util=requireMinimal();(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service;function Service(e,i,o){if(typeof e!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(i),this.responseDelimited=Boolean(o)}Service.prototype.rpcCall=function e(i,o,s,c,g){if(!c)throw TypeError("request must be specified");var b=this;if(!g)return util.asPromise(e,b,i,o,s,c);if(!b.rpcImpl){setTimeout(function(){g(Error("already ended"))},0);return}try{return b.rpcImpl(i,o[b.requestDelimited?"encodeDelimited":"encode"](c).finish(),function(_e,et){if(_e)return b.emit("error",_e,i),g(_e);if(et===null){b.end(!0);return}if(!(et instanceof s))try{et=s[b.responseDelimited?"decodeDelimited":"decode"](et)}catch(nt){return b.emit("error",nt,i),g(nt)}return b.emit("data",et,i),g(null,et)})}catch($){b.emit("error",$,i),setTimeout(function(){g($)},0);return}};Service.prototype.end=function e(i){return this.rpcImpl&&(i||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};(function(e){var i=e;i.Service=service})(rpc);var roots={};(function(e){var i=e;i.build="minimal",i.Writer=writer,i.BufferWriter=writer_buffer,i.Reader=reader,i.BufferReader=reader_buffer,i.util=requireMinimal(),i.rpc=rpc,i.roots=roots,i.configure=o;function o(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}o()})(indexMinimal);(function(e){e.exports=indexMinimal})(minimal$1);const $protobuf=getDefaultExportFromCjs(minimalExports),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.unixfs||($protobuf.roots.unixfs={}),Data=$root.Data=(()=>{function e(i){if(this.blocksizes=[],i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.Type=0,e.prototype.Data=$util.newBuffer([]),e.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=$util.emptyArray,e.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(o,s){if(s||(s=$Writer.create()),s.uint32(8).int32(o.Type),o.Data!=null&&Object.hasOwnProperty.call(o,"Data")&&s.uint32(18).bytes(o.Data),o.filesize!=null&&Object.hasOwnProperty.call(o,"filesize")&&s.uint32(24).uint64(o.filesize),o.blocksizes!=null&&o.blocksizes.length)for(var c=0;c<o.blocksizes.length;++c)s.uint32(32).uint64(o.blocksizes[c]);return o.hashType!=null&&Object.hasOwnProperty.call(o,"hashType")&&s.uint32(40).uint64(o.hashType),o.fanout!=null&&Object.hasOwnProperty.call(o,"fanout")&&s.uint32(48).uint64(o.fanout),o.mode!=null&&Object.hasOwnProperty.call(o,"mode")&&s.uint32(56).uint32(o.mode),o.mtime!=null&&Object.hasOwnProperty.call(o,"mtime")&&$root.UnixTime.encode(o.mtime,s.uint32(66).fork()).ldelim(),s},e.decode=function(o,s){o instanceof $Reader||(o=$Reader.create(o));for(var c=s===void 0?o.len:o.pos+s,g=new $root.Data;o.pos<c;){var b=o.uint32();switch(b>>>3){case 1:g.Type=o.int32();break;case 2:g.Data=o.bytes();break;case 3:g.filesize=o.uint64();break;case 4:if(g.blocksizes&&g.blocksizes.length||(g.blocksizes=[]),(b&7)===2)for(var $=o.uint32()+o.pos;o.pos<$;)g.blocksizes.push(o.uint64());else g.blocksizes.push(o.uint64());break;case 5:g.hashType=o.uint64();break;case 6:g.fanout=o.uint64();break;case 7:g.mode=o.uint32();break;case 8:g.mtime=$root.UnixTime.decode(o,o.uint32());break;default:o.skipType(b&7);break}}if(!g.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:g});return g},e.fromObject=function(o){if(o instanceof $root.Data)return o;var s=new $root.Data;switch(o.Type){case"Raw":case 0:s.Type=0;break;case"Directory":case 1:s.Type=1;break;case"File":case 2:s.Type=2;break;case"Metadata":case 3:s.Type=3;break;case"Symlink":case 4:s.Type=4;break;case"HAMTShard":case 5:s.Type=5;break}if(o.Data!=null&&(typeof o.Data=="string"?$util.base64.decode(o.Data,s.Data=$util.newBuffer($util.base64.length(o.Data)),0):o.Data.length&&(s.Data=o.Data)),o.filesize!=null&&($util.Long?(s.filesize=$util.Long.fromValue(o.filesize)).unsigned=!0:typeof o.filesize=="string"?s.filesize=parseInt(o.filesize,10):typeof o.filesize=="number"?s.filesize=o.filesize:typeof o.filesize=="object"&&(s.filesize=new $util.LongBits(o.filesize.low>>>0,o.filesize.high>>>0).toNumber(!0))),o.blocksizes){if(!Array.isArray(o.blocksizes))throw TypeError(".Data.blocksizes: array expected");s.blocksizes=[];for(var c=0;c<o.blocksizes.length;++c)$util.Long?(s.blocksizes[c]=$util.Long.fromValue(o.blocksizes[c])).unsigned=!0:typeof o.blocksizes[c]=="string"?s.blocksizes[c]=parseInt(o.blocksizes[c],10):typeof o.blocksizes[c]=="number"?s.blocksizes[c]=o.blocksizes[c]:typeof o.blocksizes[c]=="object"&&(s.blocksizes[c]=new $util.LongBits(o.blocksizes[c].low>>>0,o.blocksizes[c].high>>>0).toNumber(!0))}if(o.hashType!=null&&($util.Long?(s.hashType=$util.Long.fromValue(o.hashType)).unsigned=!0:typeof o.hashType=="string"?s.hashType=parseInt(o.hashType,10):typeof o.hashType=="number"?s.hashType=o.hashType:typeof o.hashType=="object"&&(s.hashType=new $util.LongBits(o.hashType.low>>>0,o.hashType.high>>>0).toNumber(!0))),o.fanout!=null&&($util.Long?(s.fanout=$util.Long.fromValue(o.fanout)).unsigned=!0:typeof o.fanout=="string"?s.fanout=parseInt(o.fanout,10):typeof o.fanout=="number"?s.fanout=o.fanout:typeof o.fanout=="object"&&(s.fanout=new $util.LongBits(o.fanout.low>>>0,o.fanout.high>>>0).toNumber(!0))),o.mode!=null&&(s.mode=o.mode>>>0),o.mtime!=null){if(typeof o.mtime!="object")throw TypeError(".Data.mtime: object expected");s.mtime=$root.UnixTime.fromObject(o.mtime)}return s},e.toObject=function(o,s){s||(s={});var c={};if((s.arrays||s.defaults)&&(c.blocksizes=[]),s.defaults){if(c.Type=s.enums===String?"Raw":0,s.bytes===String?c.Data="":(c.Data=[],s.bytes!==Array&&(c.Data=$util.newBuffer(c.Data))),$util.Long){var g=new $util.Long(0,0,!0);c.filesize=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else c.filesize=s.longs===String?"0":0;if($util.Long){var g=new $util.Long(0,0,!0);c.hashType=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else c.hashType=s.longs===String?"0":0;if($util.Long){var g=new $util.Long(0,0,!0);c.fanout=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else c.fanout=s.longs===String?"0":0;c.mode=0,c.mtime=null}if(o.Type!=null&&o.hasOwnProperty("Type")&&(c.Type=s.enums===String?$root.Data.DataType[o.Type]:o.Type),o.Data!=null&&o.hasOwnProperty("Data")&&(c.Data=s.bytes===String?$util.base64.encode(o.Data,0,o.Data.length):s.bytes===Array?Array.prototype.slice.call(o.Data):o.Data),o.filesize!=null&&o.hasOwnProperty("filesize")&&(typeof o.filesize=="number"?c.filesize=s.longs===String?String(o.filesize):o.filesize:c.filesize=s.longs===String?$util.Long.prototype.toString.call(o.filesize):s.longs===Number?new $util.LongBits(o.filesize.low>>>0,o.filesize.high>>>0).toNumber(!0):o.filesize),o.blocksizes&&o.blocksizes.length){c.blocksizes=[];for(var b=0;b<o.blocksizes.length;++b)typeof o.blocksizes[b]=="number"?c.blocksizes[b]=s.longs===String?String(o.blocksizes[b]):o.blocksizes[b]:c.blocksizes[b]=s.longs===String?$util.Long.prototype.toString.call(o.blocksizes[b]):s.longs===Number?new $util.LongBits(o.blocksizes[b].low>>>0,o.blocksizes[b].high>>>0).toNumber(!0):o.blocksizes[b]}return o.hashType!=null&&o.hasOwnProperty("hashType")&&(typeof o.hashType=="number"?c.hashType=s.longs===String?String(o.hashType):o.hashType:c.hashType=s.longs===String?$util.Long.prototype.toString.call(o.hashType):s.longs===Number?new $util.LongBits(o.hashType.low>>>0,o.hashType.high>>>0).toNumber(!0):o.hashType),o.fanout!=null&&o.hasOwnProperty("fanout")&&(typeof o.fanout=="number"?c.fanout=s.longs===String?String(o.fanout):o.fanout:c.fanout=s.longs===String?$util.Long.prototype.toString.call(o.fanout):s.longs===Number?new $util.LongBits(o.fanout.low>>>0,o.fanout.high>>>0).toNumber(!0):o.fanout),o.mode!=null&&o.hasOwnProperty("mode")&&(c.mode=o.mode),o.mtime!=null&&o.hasOwnProperty("mtime")&&(c.mtime=$root.UnixTime.toObject(o.mtime,s)),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.DataType=function(){const i={},o=Object.create(i);return o[i[0]="Raw"]=0,o[i[1]="Directory"]=1,o[i[2]="File"]=2,o[i[3]="Metadata"]=3,o[i[4]="Symlink"]=4,o[i[5]="HAMTShard"]=5,o}(),e})();$root.UnixTime=(()=>{function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(o,s){return s||(s=$Writer.create()),s.uint32(8).int64(o.Seconds),o.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(o,"FractionalNanoseconds")&&s.uint32(21).fixed32(o.FractionalNanoseconds),s},e.decode=function(o,s){o instanceof $Reader||(o=$Reader.create(o));for(var c=s===void 0?o.len:o.pos+s,g=new $root.UnixTime;o.pos<c;){var b=o.uint32();switch(b>>>3){case 1:g.Seconds=o.int64();break;case 2:g.FractionalNanoseconds=o.fixed32();break;default:o.skipType(b&7);break}}if(!g.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:g});return g},e.fromObject=function(o){if(o instanceof $root.UnixTime)return o;var s=new $root.UnixTime;return o.Seconds!=null&&($util.Long?(s.Seconds=$util.Long.fromValue(o.Seconds)).unsigned=!1:typeof o.Seconds=="string"?s.Seconds=parseInt(o.Seconds,10):typeof o.Seconds=="number"?s.Seconds=o.Seconds:typeof o.Seconds=="object"&&(s.Seconds=new $util.LongBits(o.Seconds.low>>>0,o.Seconds.high>>>0).toNumber())),o.FractionalNanoseconds!=null&&(s.FractionalNanoseconds=o.FractionalNanoseconds>>>0),s},e.toObject=function(o,s){s||(s={});var c={};if(s.defaults){if($util.Long){var g=new $util.Long(0,0,!1);c.Seconds=s.longs===String?g.toString():s.longs===Number?g.toNumber():g}else c.Seconds=s.longs===String?"0":0;c.FractionalNanoseconds=0}return o.Seconds!=null&&o.hasOwnProperty("Seconds")&&(typeof o.Seconds=="number"?c.Seconds=s.longs===String?String(o.Seconds):o.Seconds:c.Seconds=s.longs===String?$util.Long.prototype.toString.call(o.Seconds):s.longs===Number?new $util.LongBits(o.Seconds.low>>>0,o.Seconds.high>>>0).toNumber():o.Seconds),o.FractionalNanoseconds!=null&&o.hasOwnProperty("FractionalNanoseconds")&&(c.FractionalNanoseconds=o.FractionalNanoseconds),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();$root.Metadata=(()=>{function e(i){if(i)for(var o=Object.keys(i),s=0;s<o.length;++s)i[o[s]]!=null&&(this[o[s]]=i[o[s]])}return e.prototype.MimeType="",e.encode=function(o,s){return s||(s=$Writer.create()),o.MimeType!=null&&Object.hasOwnProperty.call(o,"MimeType")&&s.uint32(10).string(o.MimeType),s},e.decode=function(o,s){o instanceof $Reader||(o=$Reader.create(o));for(var c=s===void 0?o.len:o.pos+s,g=new $root.Metadata;o.pos<c;){var b=o.uint32();switch(b>>>3){case 1:g.MimeType=o.string();break;default:o.skipType(b&7);break}}return g},e.fromObject=function(o){if(o instanceof $root.Metadata)return o;var s=new $root.Metadata;return o.MimeType!=null&&(s.MimeType=String(o.MimeType)),s},e.toObject=function(o,s){s||(s={});var c={};return s.defaults&&(c.MimeType=""),o.MimeType!=null&&o.hasOwnProperty("MimeType")&&(c.MimeType=o.MimeType),c},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();const NodeType=Data.DataType,EMPTY$1=Object.freeze([]),EMPTY_BUFFER=new Uint8Array(0),BLANK=Object.freeze({}),DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8),code=code$1,name$1="UnixFS",encodePB=(e,i)=>(Object(globalThis).debug&&console.log({data:e,links:i}),encode$2(prepare({Data:Data.encode(e).finish(),Links:i}))),createRaw=e=>({type:NodeType.Raw,content:e}),createEmptyFile=e=>createSimpleFile(EMPTY_BUFFER,e),createSimpleFile=(e,i)=>({type:NodeType.File,layout:"simple",content:e,metadata:decodeMetadata(i)}),createFileChunk=e=>({type:NodeType.File,layout:"simple",content:e}),createAdvancedFile=(e,i)=>({type:NodeType.File,layout:"advanced",parts:e,metadata:decodeMetadata(i)}),createFileShard=e=>({type:NodeType.File,layout:"advanced",parts:e}),createComplexFile=(e,i,o)=>({type:NodeType.File,layout:"complex",content:e,parts:i,metadata:decodeMetadata(o)}),createFlatDirectory=(e,i)=>({type:NodeType.Directory,metadata:decodeMetadata(i),entries:e}),createShardedDirectory=(e,i,o,s,c=BLANK)=>({type:NodeType.HAMTShard,bitfield:i,fanout:readFanout(o),hashType:readInt(s),entries:e,metadata:decodeMetadata(c)}),createDirectoryShard=(e,i,o,s)=>({type:NodeType.HAMTShard,bitfield:i,fanout:readFanout(o),hashType:readInt(s),entries:e}),encodeRaw=e=>encodePB({Type:NodeType.Raw,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:EMPTY$1},[]),encodeFile=(e,i=!1)=>{const o=i?BLANK:Object(e).metadata;switch(e.layout){case"simple":return encodeSimpleFile(e.content,o);case"advanced":return encodeAdvancedFile(e.parts,o);case"complex":return encodeComplexFile(e.content,e.parts,o);default:throw new TypeError(`File with unknown layout "${Object(e).layout}" was passed`)}},encodeFileChunk=e=>encodeSimpleFile(e,BLANK),encodeFileShard=e=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e)},e.map(encodeLink)),encodeAdvancedFile=(e,i=BLANK)=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e),...encodeMetadata(i)},e.map(encodeLink)),encodeLink=e=>({Name:"",Tsize:e.dagByteLength,Hash:e.cid}),encodeSimpleFile=(e,i=BLANK)=>encodePB({Type:NodeType.File,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:[],...encodeMetadata(i)},[]),encodeComplexFile=(e,i,o=BLANK)=>encodePB({Type:NodeType.File,Data:e,filesize:e.byteLength+cumulativeContentByteLength(i),blocksizes:i.map(contentByteLength)},i.map(encodeLink)),encodeDirectory=e=>encodePB({Type:e.type,...encodeDirectoryMetadata(e.metadata||BLANK)},e.entries.map(encodeNamedLink)),encodeHAMTShard=({bitfield:e,fanout:i,hashType:o,entries:s,metadata:c=BLANK})=>encodePB({Type:NodeType.HAMTShard,Data:e.byteLength>0?e:void 0,fanout:readFanout(i),hashType:readInt(o),...encodeDirectoryMetadata(c)},s.map(encodeNamedLink)),readFanout=e=>{if(Math.log2(e)%1===0)return e;throw new TypeError(`Expected hamt size to be a power of two instead got ${e}`)},readInt=e=>{if(Number.isInteger(e))return e;throw new TypeError(`Expected an integer value instead got ${e}`)},createSymlink=(e,i=BLANK)=>({type:NodeType.Symlink,content:e,metadata:decodeMetadata(i)}),encodeSymlink=(e,i=!1)=>{const o=i?BLANK:Object(e).metadata;return encodePB({Type:NodeType.Symlink,Data:e.content,...encodeMetadata(o||BLANK)},[])},encode$1=(e,i=!0)=>{switch(e.type){case NodeType.Raw:return encodeRaw(e.content);case NodeType.File:return encodeFile(e);case NodeType.Directory:return encodeDirectory(e);case NodeType.HAMTShard:return encodeHAMTShard(e);case NodeType.Symlink:return encodeSymlink(e);default:throw new Error(`Unknown node type ${Object(e).type}`)}},decode=e=>{const i=decode$1(e),o=Data.decode(i.Data),{Type:s,Data:c,mtime:g,mode:b,blocksizes:$,..._e}=Data.toObject(o,{defaults:!1,arrays:!0,longs:Number,objects:!1}),et={...b&&{mode:b},...decodeMtime(g)},nt=i.Links;switch(o.Type){case NodeType.Raw:return createRaw(c);case NodeType.File:return nt.length===0?new SimpleFileView(c,et):c.byteLength===0?new AdvancedFileView(decodeFileLinks(_e.blocksizes,nt),et):new ComplexFileView(c,decodeFileLinks(_e.blocksizes,nt),et);case NodeType.Directory:return createFlatDirectory(decodeDirectoryLinks(nt),et);case NodeType.HAMTShard:return createShardedDirectory(decodeDirectoryLinks(nt),c||EMPTY_BUFFER,_e.fanout,_e.hashType,et);case NodeType.Symlink:return createSymlink(c,et);default:throw new TypeError(`Unsupported node type ${o.Type}`)}},decodeMtime=e=>e==null?void 0:{mtime:{secs:e.Seconds,nsecs:e.FractionalNanoseconds||0}},decodeFileLinks=(e,i)=>{const o=[],s=e.length;let c=0;for(;c<s;)o.push({cid:i[c].Hash,dagByteLength:i[c].Tsize||0,contentByteLength:e[c]});return o},decodeDirectoryLinks=e=>e.map(i=>({cid:i.Hash,name:i.Name||"",dagByteLength:i.Tsize||0})),cumulativeContentByteLength=e=>e.reduce((i,o)=>i+o.contentByteLength,0),cumulativeDagByteLength=(e,i)=>i.reduce((o,s)=>o+s.dagByteLength,e.byteLength),contentByteLength=e=>e.contentByteLength,encodeNamedLink=({name:e,dagByteLength:i,cid:o})=>({Name:e,Tsize:i,Hash:o}),encodeDirectoryMetadata=e=>encodeMetadata(e,DEFAULT_DIRECTORY_MODE),encodeMetadata=({mode:e,mtime:i},o=DEFAULT_FILE_MODE)=>({mode:e!=null?encodeMode(e,o):void 0,mtime:i!=null?encodeMTime(i):void 0}),decodeMetadata=e=>e==null?BLANK:{...e.mode==null?void 0:{mode:decodeMode(e.mode)},...e.mtime==null?void 0:{mtime:e.mtime}},encodeMTime=e=>e==null?void 0:e.nsecs!==0?{Seconds:e.secs,FractionalNanoseconds:e.nsecs}:{Seconds:e.secs},encodeMode=(e,i)=>{const o=e==null?void 0:decodeMode(e);return o===i||o==null?void 0:o},decodeMode=e=>e&4095|e&4294963200,matchFile=({content:e=EMPTY_BUFFER,parts:i=EMPTY$1,metadata:o=BLANK,...s})=>i.length===0?new SimpleFileView(e,o):e.byteLength===0?new AdvancedFileView(i,o):new ComplexFileView(e,i,o);class SimpleFileView{constructor(i,o){this.content=i,this.metadata=o,this.layout="simple",this.type=NodeType.File}get filesize(){return this.content.byteLength}encode(){return encodeSimpleFile(this.content,this.metadata)}}class AdvancedFileView{constructor(i,o){this.parts=i,this.metadata=o}get layout(){return"advanced"}get type(){return NodeType.File}get fileSize(){return cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeAdvancedFile(this.parts,this.metadata)}}class ComplexFileView{constructor(i,o,s){this.content=i,this.parts=o,this.metadata=s}get layout(){return"complex"}get type(){return NodeType.File}get fileSize(){return this.content.byteLength+cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeComplexFile(this.content,this.parts,this.metadata)}}const filesize=e=>{switch(e.type){case NodeType.Raw:case NodeType.Symlink:return e.content.byteLength;case NodeType.File:switch(e.layout){case"simple":return e.content.byteLength;case"advanced":return cumulativeContentByteLength(e.parts);case"complex":return e.content.byteLength+cumulativeContentByteLength(e.parts)}default:return 0}},UnixFS=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_DIRECTORY_MODE,DEFAULT_FILE_MODE,NodeType,code,createAdvancedFile,createComplexFile,createDirectoryShard,createEmptyFile,createFileChunk,createFileShard,createFlatDirectory,createRaw,createShardedDirectory,createSimpleFile,createSymlink,cumulativeContentByteLength,cumulativeDagByteLength,decode,decodeMetadata,encode:encode$1,encodeAdvancedFile,encodeComplexFile,encodeDirectory,encodeDirectoryMetadata,encodeFile,encodeFileChunk,encodeFileShard,encodeHAMTShard,encodeLink,encodeMetadata,encodeMode,encodeRaw,encodeSimpleFile,encodeSymlink,filesize,matchFile,name:name$1},Symbol.toStringTag,{value:"Module"}));function Indexed(){}Object.defineProperties(Indexed,{prototype:{value:new Proxy(Object.prototype,{get(e,i,o){return typeof i=="symbol"?Reflect.get(e,i,o):o.get(i)}})}});const name="fixed",context={maxChunkSize:262144},type="Stateless",withMaxChunkSize=e=>({type:"Stateless",context:{maxChunkSize:e},name,cut}),cut=({maxChunkSize:e},{byteLength:i},o)=>{const s=i/e|0,c=new Array(s).fill(e),g=o?i-s*e:0;return g>0&&c.push(g),c},FixedSize=Object.freeze(Object.defineProperty({__proto__:null,context,cut,name,type,withMaxChunkSize},Symbol.toStringTag,{value:"Module"}));class Node{constructor(i,o,s){this.id=i,this.children=o,this.metadata=s}}const withWidth=e=>({open:()=>open({width:e}),write,close}),defaults$1={width:174},open=({width:e}=defaults$1)=>({width:e,head:null,leafIndex:[],nodeIndex:[],lastID:0}),write=(e,i)=>{if(i.length===0)return{layout:e,nodes:EMPTY,leaves:EMPTY};{let{lastID:o}=e;const[s,c]=e.head?[null,(i.unshift(e.head),i)]:i.length===1&&e.leafIndex.length===0?[i[0],EMPTY]:[null,i];if(c.length===0)return{layout:{...e,head:s},nodes:EMPTY,leaves:EMPTY};{const g=[...e.leafIndex],b=[];for(const $ of c){const _e={id:++o,content:$};b.push(_e),g.push(_e.id)}return g.length>=e.width?flush({...e,leafIndex:g,head:s,lastID:o},b):{layout:{...e,head:s,leafIndex:g,lastID:o},leaves:b,nodes:EMPTY}}}},flush=(e,i=EMPTY,o=[],s=!1)=>{let{lastID:c}=e;const g=e.nodeIndex.map(et=>[...et]),b=[...e.leafIndex],{width:$}=e;for(;b.length>=$||b.length>0&&s;){grow(g,1);const et=new Node(++c,b.splice(0,$));g[0].push(et.id),o.push(et)}let _e=0;for(;_e<g.length;){const et=g[_e];for(_e++;et.length>=$||et.length>0&&s&&_e<g.length;){const nt=new Node(++c,et.splice(0,$));grow(g,_e+1),g[_e].push(nt.id),o.push(nt)}}return{layout:{...e,lastID:c,leafIndex:b,nodeIndex:g},leaves:i,nodes:o}},close=(e,i)=>{const o=e;if(e.head)return{root:{id:1,content:e.head,metadata:i},leaves:EMPTY,nodes:EMPTY};if(e.leafIndex.length===0)return{root:{id:1,metadata:i},leaves:EMPTY,nodes:EMPTY};{const{nodes:s,layout:c}=flush(o,EMPTY,[],!0),{nodeIndex:g}=c,b=g.length-1,$=g[b];if($.length===1){const _e=s[s.length-1];return s.length=s.length-1,{root:_e,nodes:s,leaves:EMPTY}}else return{root:new Node(c.lastID+1,$,i),nodes:s,leaves:EMPTY}}},grow=(e,i)=>{for(;e.length<i;)e.push([]);return e},EMPTY=[],defaults=()=>({chunker:FixedSize,fileChunkEncoder:UnixFSLeaf,smallFileEncoder:UnixFSLeaf,fileEncoder:UnixFS,fileLayout:withWidth(174),hasher:sha256,linker:{createLink:CID.createV1}}),configure=e=>({...defaults(),...e}),UnixFSLeaf={code,name:name$1,encode:encodeFileChunk};configure({fileChunkEncoder:raw,smallFileEncoder:raw});async function encode(e,i){const{writer:o,out:s}=CarWriter.create(i);let c;(async()=>{try{for await(const $ of e)await o.put($)}catch($){c=$}finally{await o.close()}})();const g=[];for await(const $ of s)g.push($);if(c!=null)throw c;const b=i!=null?[i]:[];return Object.assign(new Blob(g),{version:1,roots:b})}var eventemitter3Exports={},eventemitter3={get exports(){return eventemitter3Exports},set exports(e){eventemitter3Exports=e}};(function(e){var i=Object.prototype.hasOwnProperty,o="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(o=!1));function c(_e,et,nt){this.fn=_e,this.context=et,this.once=nt||!1}function g(_e,et,nt,ot,ct){if(typeof nt!="function")throw new TypeError("The listener must be a function");var at=new c(nt,ot||_e,ct),lt=o?o+et:et;return _e._events[lt]?_e._events[lt].fn?_e._events[lt]=[_e._events[lt],at]:_e._events[lt].push(at):(_e._events[lt]=at,_e._eventsCount++),_e}function b(_e,et){--_e._eventsCount===0?_e._events=new s:delete _e._events[et]}function $(){this._events=new s,this._eventsCount=0}$.prototype.eventNames=function(){var et=[],nt,ot;if(this._eventsCount===0)return et;for(ot in nt=this._events)i.call(nt,ot)&&et.push(o?ot.slice(1):ot);return Object.getOwnPropertySymbols?et.concat(Object.getOwnPropertySymbols(nt)):et},$.prototype.listeners=function(et){var nt=o?o+et:et,ot=this._events[nt];if(!ot)return[];if(ot.fn)return[ot.fn];for(var ct=0,at=ot.length,lt=new Array(at);ct<at;ct++)lt[ct]=ot[ct].fn;return lt},$.prototype.listenerCount=function(et){var nt=o?o+et:et,ot=this._events[nt];return ot?ot.fn?1:ot.length:0},$.prototype.emit=function(et,nt,ot,ct,at,lt){var gt=o?o+et:et;if(!this._events[gt])return!1;var wt=this._events[gt],ft=arguments.length,ut,pt;if(wt.fn){switch(wt.once&&this.removeListener(et,wt.fn,void 0,!0),ft){case 1:return wt.fn.call(wt.context),!0;case 2:return wt.fn.call(wt.context,nt),!0;case 3:return wt.fn.call(wt.context,nt,ot),!0;case 4:return wt.fn.call(wt.context,nt,ot,ct),!0;case 5:return wt.fn.call(wt.context,nt,ot,ct,at),!0;case 6:return wt.fn.call(wt.context,nt,ot,ct,at,lt),!0}for(pt=1,ut=new Array(ft-1);pt<ft;pt++)ut[pt-1]=arguments[pt];wt.fn.apply(wt.context,ut)}else{var vt=wt.length,bt;for(pt=0;pt<vt;pt++)switch(wt[pt].once&&this.removeListener(et,wt[pt].fn,void 0,!0),ft){case 1:wt[pt].fn.call(wt[pt].context);break;case 2:wt[pt].fn.call(wt[pt].context,nt);break;case 3:wt[pt].fn.call(wt[pt].context,nt,ot);break;case 4:wt[pt].fn.call(wt[pt].context,nt,ot,ct);break;default:if(!ut)for(bt=1,ut=new Array(ft-1);bt<ft;bt++)ut[bt-1]=arguments[bt];wt[pt].fn.apply(wt[pt].context,ut)}}return!0},$.prototype.on=function(et,nt,ot){return g(this,et,nt,ot,!1)},$.prototype.once=function(et,nt,ot){return g(this,et,nt,ot,!0)},$.prototype.removeListener=function(et,nt,ot,ct){var at=o?o+et:et;if(!this._events[at])return this;if(!nt)return b(this,at),this;var lt=this._events[at];if(lt.fn)lt.fn===nt&&(!ct||lt.once)&&(!ot||lt.context===ot)&&b(this,at);else{for(var gt=0,wt=[],ft=lt.length;gt<ft;gt++)(lt[gt].fn!==nt||ct&&!lt[gt].once||ot&&lt[gt].context!==ot)&&wt.push(lt[gt]);wt.length?this._events[at]=wt.length===1?wt[0]:wt:b(this,at)}return this},$.prototype.removeAllListeners=function(et){var nt;return et?(nt=o?o+et:et,this._events[nt]&&b(this,nt)):(this._events=new s,this._eventsCount=0),this},$.prototype.off=$.prototype.removeListener,$.prototype.addListener=$.prototype.on,$.prefixed=o,$.EventEmitter=$,e.exports=$})(eventemitter3);class TimeoutError extends Error{constructor(i){super(i),this.name="TimeoutError"}}let AbortError$1=class extends Error{constructor(i){super(),this.name="AbortError",this.message=i}};const getDOMException=e=>globalThis.DOMException===void 0?new AbortError$1(e):new DOMException(e),getAbortedReason=e=>{const i=e.reason===void 0?getDOMException("This operation was aborted."):e.reason;return i instanceof Error?i:getDOMException(i)};function pTimeout(e,i,o,s){let c;const g=new Promise((b,$)=>{if(typeof i!="number"||Math.sign(i)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${i}\``);if(i===Number.POSITIVE_INFINITY){b(e);return}if(s={customTimers:{setTimeout,clearTimeout},...s},s.signal){const{signal:_e}=s;_e.aborted&&$(getAbortedReason(_e)),_e.addEventListener("abort",()=>{$(getAbortedReason(_e))})}c=s.customTimers.setTimeout.call(void 0,()=>{if(typeof o=="function"){try{b(o())}catch(nt){$(nt)}return}const _e=typeof o=="string"?o:`Promise timed out after ${i} milliseconds`,et=o instanceof Error?o:new TimeoutError(_e);typeof e.cancel=="function"&&e.cancel(),$(et)},i),(async()=>{try{b(await e)}catch(_e){$(_e)}finally{s.customTimers.clearTimeout.call(void 0,c)}})()});return g.clear=()=>{clearTimeout(c),c=void 0},g}function lowerBound(e,i,o){let s=0,c=e.length;for(;c>0;){const g=Math.trunc(c/2);let b=s+g;o(e[b],i)<=0?(s=++b,c-=g+1):c=g}return s}var __classPrivateFieldGet$1=globalThis&&globalThis.__classPrivateFieldGet||function(e,i,o,s){if(o==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?e!==i||!s:!i.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?s:o==="a"?s.call(e):s?s.value:i.get(e)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(i,o){o={priority:0,...o};const s={priority:o.priority,run:i};if(this.size&&__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f")[this.size-1].priority>=o.priority){__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").push(s);return}const c=lowerBound(__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f"),s,(g,b)=>b.priority-g.priority);__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").splice(c,0,s)}dequeue(){const i=__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").shift();return i==null?void 0:i.run}filter(i){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").filter(o=>o.priority===i.priority).map(o=>o.run)}get size(){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet=globalThis&&globalThis.__classPrivateFieldSet||function(e,i,o,s,c){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!c)throw new TypeError("Private accessor was defined without a setter");if(typeof i=="function"?e!==i||!c:!i.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?c.call(e,o):c?c.value=o:i.set(e,o),o},__classPrivateFieldGet=globalThis&&globalThis.__classPrivateFieldGet||function(e,i,o,s){if(o==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof i=="function"?e!==i||!s:!i.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?s:o==="a"?s.call(e):s?s.value:i.get(e)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pending,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_throwOnAbort,_PQueue_onEvent;class AbortError extends Error{}class PQueue extends eventemitter3Exports{constructor(i){var o,s,c,g;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pending.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...i},!(typeof i.intervalCap=="number"&&i.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(s=(o=i.intervalCap)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""}\` (${typeof i.intervalCap})`);if(i.interval===void 0||!(Number.isFinite(i.interval)&&i.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(g=(c=i.interval)===null||c===void 0?void 0:c.toString())!==null&&g!==void 0?g:""}\` (${typeof i.interval})`);__classPrivateFieldSet(this,_PQueue_carryoverConcurrencyCount,i.carryoverConcurrencyCount,"f"),__classPrivateFieldSet(this,_PQueue_isIntervalIgnored,i.intervalCap===Number.POSITIVE_INFINITY||i.interval===0,"f"),__classPrivateFieldSet(this,_PQueue_intervalCap,i.intervalCap,"f"),__classPrivateFieldSet(this,_PQueue_interval,i.interval,"f"),__classPrivateFieldSet(this,_PQueue_queue,new i.queueClass,"f"),__classPrivateFieldSet(this,_PQueue_queueClass,i.queueClass,"f"),this.concurrency=i.concurrency,this.timeout=i.timeout,__classPrivateFieldSet(this,_PQueue_throwOnTimeout,i.throwOnTimeout===!0,"f"),__classPrivateFieldSet(this,_PQueue_isPaused,i.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet(this,_PQueue_concurrency,"f")}set concurrency(i){if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);__classPrivateFieldSet(this,_PQueue_concurrency,i,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(i,o={}){return o={timeout:this.timeout,throwOnTimeout:__classPrivateFieldGet(this,_PQueue_throwOnTimeout,"f"),...o},new Promise((s,c)=>{__classPrivateFieldGet(this,_PQueue_queue,"f").enqueue(async()=>{var g,b,$;__classPrivateFieldSet(this,_PQueue_pending,(b=__classPrivateFieldGet(this,_PQueue_pending,"f"),b++,b),"f"),__classPrivateFieldSet(this,_PQueue_intervalCount,($=__classPrivateFieldGet(this,_PQueue_intervalCount,"f"),$++,$),"f");try{if(!((g=o.signal)===null||g===void 0)&&g.aborted)throw new AbortError("The task was aborted.");let _e=i({signal:o.signal});o.timeout&&(_e=pTimeout(Promise.resolve(_e),o.timeout)),o.signal&&(_e=Promise.race([_e,__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_throwOnAbort).call(this,o.signal)]));const et=await _e;s(et),this.emit("completed",et)}catch(_e){if(_e instanceof TimeoutError&&!o.throwOnTimeout){s();return}c(_e),this.emit("error",_e)}finally{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_next).call(this)}},o),this.emit("add"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this)})}async addAll(i,o){return Promise.all(i.map(async s=>this.add(s,o)))}start(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet(this,_PQueue_queue,new(__classPrivateFieldGet(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(i){__classPrivateFieldGet(this,_PQueue_queue,"f").size<i||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet(this,_PQueue_queue,"f").size<i)}async onIdle(){__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet(this,_PQueue_queue,"f").size}sizeBy(i){return __classPrivateFieldGet(this,_PQueue_queue,"f").filter(i).length}get pending(){return __classPrivateFieldGet(this,_PQueue_pending,"f")}get isPaused(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pending=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function e(){return __classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function e(){return __classPrivateFieldGet(this,_PQueue_pending,"f")<__classPrivateFieldGet(this,_PQueue_concurrency,"f")},_PQueue_next=function e(){var i;__classPrivateFieldSet(this,_PQueue_pending,(i=__classPrivateFieldGet(this,_PQueue_pending,"f"),i--,i),"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_onResumeInterval=function e(){__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function e(){const i=Date.now();if(__classPrivateFieldGet(this,_PQueue_intervalId,"f")===void 0){const o=__classPrivateFieldGet(this,_PQueue_intervalEnd,"f")-i;if(o<0)__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f");else return __classPrivateFieldGet(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},o),"f"),!0}return!1},_PQueue_tryToStartAnother=function e(){if(__classPrivateFieldGet(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f"),this.emit("empty"),__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&this.emit("idle"),!1;if(!__classPrivateFieldGet(this,_PQueue_isPaused,"f")){const i=!__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const o=__classPrivateFieldGet(this,_PQueue_queue,"f").dequeue();return o?(this.emit("active"),o(),i&&__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function e(){__classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function e(){__classPrivateFieldGet(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function e(){for(;__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_throwOnAbort=async function e(i){return new Promise((o,s)=>{i.addEventListener("abort",()=>{s(new AbortError("The task was aborted."))},{once:!0})})},_PQueue_onEvent=async function e(i,o){return new Promise(s=>{const c=()=>{o&&!o()||(this.off(i,c),s())};this.on(i,c)})};const SHARD_SIZE=1024*1024*100,CONCURRENT_UPLOADS=3;class ShardingStream extends TransformStream{constructor(i={}){const o=i.shardSize??SHARD_SIZE;let s=[],c=null,g=0;super({async transform(b,$){c!=null&&($.enqueue(await encode(c)),c=null),s.length&&g+b.bytes.length>o&&(c=s,s=[],g=0),s.push(b),g+=b.bytes.length},async flush(b){c!=null&&b.enqueue(await encode(c));const $=s.at(-1);$!=null&&b.enqueue(await encode(s,i.rootCID??$.cid))}})}}class ShardStoringStream extends TransformStream{constructor(i,o={}){const s=new PQueue({concurrency:o.concurrentRequests??CONCURRENT_UPLOADS}),c=new AbortController;super({async transform(g,b){s.add(async()=>{try{const $={...o,signal:c.signal},_e=await add$2(i,g,$),{version:et,roots:nt,size:ot}=g;b.enqueue({version:et,roots:nt,cid:_e,size:ot})}catch($){b.error($),c.abort($)}},{signal:c.signal}),await s.onSizeLessThan(1)},async flush(){await s.onIdle()}})}}const the=e=>e,entries=e=>Object.entries(e),combine=([e,...i])=>{const o=e.map(s=>[s]);for(const s of i){const c=o.splice(0);for(const g of s)for(const b of c)o.push([...b,g])}return o},intersection$1=(e,i)=>{const[o,s]=e.length<i.length?[new Set(e),new Set(i)]:[new Set(i),new Set(e)];for(const c of o)s.has(c)||o.delete(c);return[...o]};class Failure extends Error{get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:i,name:o,message:s,stack:c}=this;return{error:i,name:o,message:s,stack:c}}}class EscalatedCapability extends Failure{constructor(i,o,s){super(),this.claimed=i,this.delegated=o,this.cause=s,this.name=the("EscalatedCapability")}describe(){return`Constraint violation: ${this.cause.message}`}}class DelegationError extends Failure{constructor(i,o){super(),this.name=the("InvalidClaim"),this.causes=i,this.context=o}describe(){return[`Can not derive ${this.context} from delegated capabilities:`,...this.causes.map(i=>li$1(i.message))].join(`
`)}get cause(){if(this.causes.length!==1)return this;{const[i]=this.causes,o=i.name==="InvalidClaim"?i.cause:i;return Object.defineProperties(this,{cause:{value:o}}),o}}}class MalformedCapability extends Failure{constructor(i,o){super(),this.name=the("MalformedCapability"),this.capability=i,this.cause=o}describe(){return[`Encountered malformed '${this.capability.can}' capability: ${format(this.capability)}`,li$1(this.cause.message)].join(`
`)}}class UnknownCapability extends Failure{constructor(i){super(),this.name=the("UnknownCapability"),this.capability=i}describe(){return`Encountered unknown capability: ${format(this.capability)}`}}const format=(e,i)=>JSON.stringify(e,(o,s)=>isLink(s)?s.toString():s,i),indent$1=(e,i="  ")=>`${i}${e.split(`
`).join(`
${i}`)}`,li$1=e=>indent$1(`- ${e}`);class API{constructor(i){this.settings=i}toString(){return`new ${this.constructor.name}()`}readWith(i,o){throw new Error("Abstract method readWith must be implemented by subclass")}read(i){return this.readWith(i,this.settings)}is(i){var o;return!((o=this.read(i))!=null&&o.error)}from(i){const o=this.read(i);if(o!=null&&o.error)throw o;return o}optional(){return optional$1(this)}nullable(){return nullable(this)}array(){return array(this)}or(i){return or$1(this,i)}and(i){return and$1(this,i)}refine(i){return refine(this,i)}brand(i){return this}default(i){const o=this.from(i);if(o===void 0)throw new Error("Value of type undefined is not a vaild default");return new Default({reader:this,value:o})}}class Nullable extends API{readWith(i,o){const s=o.read(i);return s!=null&&s.error?i===null?null:new UnionError({causes:[s,typeError({expect:"null",actual:i})]}):s}toString(){return`${this.settings}.nullable()`}}const nullable=e=>new Nullable(e);class Optional extends API{optional(){return this}readWith(i,o){const s=o.read(i);return s!=null&&s.error&&i===void 0?void 0:s}toString(){return`${this.settings}.optional()`}}class Default extends API{optional(){return this}readWith(i,{reader:o,value:s}){if(i===void 0)return s;{const c=o.read(i);return c===void 0?s:c}}toString(){return`${this.settings.reader}.default(${JSON.stringify(this.settings.value)})`}get value(){return this.settings.value}}const optional$1=e=>new Optional(e);class ArrayOf extends API{readWith(i,o){if(!Array.isArray(i))return typeError({expect:"array",actual:i});const s=[];for(const[c,g]of i.entries()){const b=o.read(g);if(b!=null&&b.error)return memberError({at:c,cause:b});s.push(b)}return s}get element(){return this.settings}toString(){return`array(${this.element})`}}const array=e=>new ArrayOf(e);class Union extends API{readWith(i,o){const s=[];for(const c of o){const g=c.read(i);if(g!=null&&g.error)s.push(g);else return g}return new UnionError({causes:s})}get variants(){return this.settings}toString(){return`union([${this.variants.map(i=>i.toString()).join(", ")}])`}}const union=e=>new Union(e),or$1=(e,i)=>union([e,i]);class Intersection extends API{readWith(i,o){const s=[];for(const c of o){const g=c.read(i);g!=null&&g.error&&s.push(g)}return s.length>0?new IntersectionError({causes:s}):i}toString(){return`intersection([${this.settings.map(i=>i.toString()).join(",")}])`}}const intersection=e=>new Intersection(e),and$1=(e,i)=>intersection([e,i]);let Boolean$1=class extends API{readWith(i){switch(i){case!0:case!1:return i;default:return typeError({expect:"boolean",actual:i})}}toString(){return"boolean()"}};const anyBoolean=new Boolean$1,boolean=()=>anyBoolean;class UnknownNumber extends API{greaterThan(i){return this.refine(greaterThan(i))}lessThan(i){return this.refine(lessThan(i))}refine(i){return new RefinedNumber({base:this,schema:i})}}class AnyNumber extends UnknownNumber{readWith(i){return typeof i=="number"?i:typeError({expect:"number",actual:i})}toString(){return"number()"}}const anyNumber=new AnyNumber;class RefinedNumber extends UnknownNumber{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}class LessThan extends API{readWith(i,o){return i<o?i:error(`Expected ${i} < ${o}`)}toString(){return`lessThan(${this.settings})`}}const lessThan=e=>new LessThan(e);class GreaterThan extends API{readWith(i,o){return i>o?i:error(`Expected ${i} > ${o}`)}toString(){return`greaterThan(${this.settings})`}}const greaterThan=e=>new GreaterThan(e),Integer={read(e){return Number.isInteger(e)?e:typeError({expect:"integer",actual:e})},toString(){return"Integer"}},anyInteger=anyNumber.refine(Integer),integer=()=>anyInteger,Float={read(e){return Number.isFinite(e)?e:typeError({expect:"Float",actual:e})},toString(){return"Float"}};anyNumber.refine(Float);class UnknownString extends API{refine(i){const o=i;return new RefinedString({base:this,schema:o})}startsWith(i){return this.refine(startsWith(i))}endsWith(i){return this.refine(endsWith(i))}toString(){return"string()"}}class RefinedString extends UnknownString{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}class AnyString extends UnknownString{readWith(i){return typeof i=="string"?i:typeError({expect:"string",actual:i})}}const anyString=new AnyString,string=()=>anyString;class StartsWith extends API{readWith(i,o){return i.startsWith(o)?i:error(`Expect string to start with "${o}" instead got "${i}"`)}get prefix(){return this.settings}toString(){return`startsWith("${this.prefix}")`}}const startsWith=e=>new StartsWith(e);class EndsWith extends API{readWith(i,o){return i.endsWith(o)?i:error(`Expect string to end with "${o}" instead got "${i}"`)}get suffix(){return this.settings}toString(){return`endsWith("${this.suffix}")`}}const endsWith=e=>new EndsWith(e);class Refine extends API{readWith(i,{base:o,schema:s}){const c=o.read(i);return c!=null&&c.error?c:s.read(c)}toString(){return`${this.settings.base}.refine(${this.settings.schema})`}}const refine=(e,i)=>new Refine({base:e,schema:i});class Literal extends API{readWith(i,o){return i!==o?new LiteralError({expect:o,actual:i}):o}get value(){return this.settings}default(i=this.value){return super.default(i)}toString(){return`literal(${displayTypeName(this.value)})`}}const literal=e=>new Literal(e);class Struct extends API{readWith(i,o){if(typeof i!="object"||i===null||Array.isArray(i))return typeError({expect:"object",actual:i});const s=i,c={},g=Object.entries(o);for(const[b,$]of g){const _e=$.read(s[b]);if(_e!=null&&_e.error)return memberError({at:b,cause:_e});_e!==void 0&&(c[b]=_e)}return c}partial(){return new Struct(Object.fromEntries(Object.entries(this.shape).map(([i,o])=>[i,optional$1(o)])))}get shape(){return this.settings}toString(){return["struct({ ",...Object.entries(this.shape).map(([i,o])=>`${i}: ${o}, `),"})"].join("")}create(i){return this.from(i||{})}extend(i){return new Struct({...this.shape,...i})}}const struct=e=>{const i={},o=Object.entries(e);for(const[s,c]of o)switch(typeof c){case"number":case"string":case"boolean":i[s]=literal(c);break;case"object":i[s]=c===null?literal(null):c;break;default:throw new Error(`Invalid struct field "${s}", expected schema or literal, instead got ${typeof c}`)}return new Struct(i)},error=e=>new SchemaError(e);class SchemaError extends Error{get name(){return"SchemaError"}get error(){return!0}describe(){return this.name}get message(){return this.describe()}toJSON(){const{error:i,name:o,message:s,stack:c}=this;return{error:i,name:o,message:s,stack:c}}}let TypeError$1=class extends SchemaError{constructor({expect:i,actual:o}){super(),this.expect=i,this.actual=o}get name(){return"TypeError"}describe(){return`Expected value of type ${this.expect} instead got ${displayTypeName(this.actual)}`}};const typeError=e=>new TypeError$1(e),displayTypeName=e=>{const i=typeof e;switch(i){case"boolean":case"string":return JSON.stringify(e);case"bigint":return`${e}n`;case"number":case"symbol":case"undefined":return String(e);case"object":return e===null?"null":Array.isArray(e)?"array":"object";default:return i}};class LiteralError extends SchemaError{constructor({expect:i,actual:o}){super(),this.expect=i,this.actual=o}get name(){return"LiteralError"}describe(){return`Expected literal ${displayTypeName(this.expect)} instead got ${displayTypeName(this.actual)}`}}class ElementError extends SchemaError{constructor({at:i,cause:o}){super(),this.at=i,this.cause=o}get name(){return"ElementError"}describe(){return[`Array contains invalid element at ${this.at}:`,li(this.cause.message)].join(`
`)}}class FieldError extends SchemaError{constructor({at:i,cause:o}){super(),this.at=i,this.cause=o}get name(){return"FieldError"}describe(){return[`Object contains invalid field "${this.at}":`,li(this.cause.message)].join(`
`)}}const memberError=({at:e,cause:i})=>typeof e=="string"?new FieldError({at:e,cause:i}):new ElementError({at:e,cause:i});class UnionError extends SchemaError{constructor({causes:i}){super(),this.causes=i}get name(){return"UnionError"}describe(){const{causes:i}=this;return["Value does not match any type of the union:",...i.map(o=>li(o.message))].join(`
`)}}class IntersectionError extends SchemaError{constructor({causes:i}){super(),this.causes=i}get name(){return"IntersectionError"}describe(){const{causes:i}=this;return["Value does not match following types of the intersection:",...i.map(o=>li(o.message))].join(`
`)}}const indent=(e,i="  ")=>`${i}${e.split(`
`).join(`
${i}`)}`,li=e=>indent(`- ${e}`);class URISchema extends API{readWith(i,{protocol:o}={}){if(typeof i!="string"&&!(i instanceof URL))return error(`Expected URI but got ${i===null?"null":typeof i}`);try{const s=new URL(String(i));return o!=null&&s.protocol!==o?error(`Expected ${o} URI instead got ${s.href}`):s.href}catch{return error("Invalid URI")}}}const match$1=e=>new URISchema(e);class LinkSchema extends API{readWith(i,{code:o,multihash:s={},version:c}){if(i==null)return error(`Expected link but got ${i} instead`);if(isLink(i)){if(o!=null&&i.code!==o)return error(`Expected link to be CID with 0x${o.toString(16)} codec`);if(s.code!=null&&i.multihash.code!==s.code)return error(`Expected link to be CID with 0x${s.code.toString(16)} hashing algorithm`);if(c!=null&&i.version!==c)return error(`Expected link to be CID version ${c} instead of ${i.version}`);const[g,b]=s.digest!=null?[base32.baseEncode(s.digest),base32.baseEncode(i.multihash.digest)]:["",""];return g!==b?error(`Expected link with "${g}" hash digest instead of "${b}"`):i}else return error(`Expected link to be a CID instead of ${i}`)}}const schema=new LinkSchema({}),link=()=>schema,match=(e={})=>new LinkSchema(e),read=e=>schema.read(e),optional=()=>schema.optional(),Link=Object.freeze(Object.defineProperty({__proto__:null,create:create$7,createLegacy,isLink,link,match,optional,parse:parse$3,read,schema},Symbol.toStringTag,{value:"Module"}));class DIDSchema extends API{readWith(i,o){const s=o?`did:${o}:`:"did:";return i.startsWith(s)?i:error(`Expected a ${s} but got "${i}" instead`)}}string().refine(new DIDSchema);const capability=({derives:e=defaultDerives,nb:i=defaultNBSchema,...o})=>new Capability({derives:e,nb:i,...o}),defaultNBSchema=struct({}),or=(e,i)=>new Or(e,i),and=(...e)=>new And(e),derive=({from:e,to:i,derives:o})=>new Derive(e,i,o);class View{match(i){return new UnknownCapability(i.capability)}select(i){return select(this,i)}derive({derives:i,to:o}){return derive({derives:i,to:o,from:this})}}class Unit extends View{or(i){return or(this,i)}and(i){return and(this,i)}}class Capability extends Unit{constructor(i){super(),this.descriptor=i,this.schema=struct({can:literal(i.can),with:i.with,nb:i.nb})}create(i){const{descriptor:o,can:s}=this;o.nb;const c=i.nb||{},g=o.with.read(i.with);if(g.error)throw Object.assign(new Error(`Invalid 'with' - ${g.message}`),{cause:g});const b=o.nb.read(c);if(b.error)throw Object.assign(new Error(`Invalid 'nb' - ${b.message}`),{cause:b});return createCapability({can:s,with:g,nb:b})}invoke({with:i,nb:o,...s}){return invoke({...s,capability:this.create({with:i,nb:o})})}async delegate({nb:i={},with:o,...s}){const{descriptor:c,can:g}=this;c.nb;const b=c.with.read(o);if(b.error)throw Object.assign(new Error(`Invalid 'with' - ${b.message}`),{cause:b});const $=c.nb.partial().read(i);if($.error)throw Object.assign(new Error(`Invalid 'nb' - ${$.message}`),{cause:$});return delegate({capabilities:[createCapability({can:g,with:b,nb:$})],...s})}get can(){return this.descriptor.can}match(i){const o=parseCapability(this.descriptor,i);return o.error?o:new Match(i,o,this.descriptor)}toString(){return JSON.stringify({can:this.descriptor.can})}}const createCapability=({can:e,with:i,nb:o})=>({can:e,with:i,...isEmpty(o)?{}:{nb:o}}),isEmpty=e=>{for(const i in e)return!1;return!0};class Or extends Unit{constructor(i,o){super(),this.left=i,this.right=o}match(i){const o=this.left.match(i);if(o.error){const s=this.right.match(i);return s.error?s.name==="MalformedCapability"?s:o:s}else return o}toString(){return`${this.left.toString()}|${this.right.toString()}`}}class And extends View{constructor(i){super(),this.selectors=i}match(i){const o=[];for(const s of this.selectors){const c=s.match(i);if(c.error)return c;o.push(c)}return new AndMatch(o)}select(i){return selectGroup(this,i)}and(i){return new And([...this.selectors,i])}toString(){return`[${this.selectors.map(String).join(", ")}]`}}class Derive extends Unit{constructor(i,o,s){super(),this.from=i,this.to=o,this.derives=s}create(i){return this.to.create(i)}invoke(i){return this.to.invoke(i)}delegate(i){return this.to.delegate(i)}get can(){return this.to.can}match(i){const o=this.to.match(i);return o.error?o:new DerivedMatch(o,this.from,this.derives)}toString(){return this.to.toString()}}class Match{constructor(i,o,s){this.source=[i],this.value=o,this.descriptor=s}get can(){return this.value.can}get proofs(){const i=[this.source[0].delegation];return Object.defineProperties(this,{proofs:{value:i}}),i}prune(i){return i.canIssue(this.value,this.source[0].delegation.issuer.did())?null:this}select(i){const o=[],s=[],c=[];for(const g of i){const b=resolveCapability(this.descriptor,this.value,g);if(b.error)switch(b.name){case"UnknownCapability":o.push(b.capability);break;case"MalformedCapability":default:s.push(new DelegationError([b],this))}else{const $=this.descriptor.derives(this.value,b);$.error?s.push(new DelegationError([new EscalatedCapability(this.value,b,$)],this)):c.push(new Match(g,b,this.descriptor))}}return{matches:c,unknown:o,errors:s}}toString(){const{nb:i}=this.value;return JSON.stringify({can:this.descriptor.can,with:this.value.with,nb:i&&Object.keys(i).length>0?i:void 0})}}class DerivedMatch{constructor(i,o,s){this.selected=i,this.from=o,this.derives=s}get can(){return this.value.can}get source(){return this.selected.source}get proofs(){const i=[];for(const{delegation:o}of this.selected.source)i.push(o);return Object.defineProperties(this,{proofs:{value:i}}),i}get value(){return this.selected.value}prune(i){const o=this.selected.prune(i);return o?new DerivedMatch(o,this.from,this.derives):null}select(i){const{derives:o,selected:s,from:c}=this,{value:g}=s,b=s.select(i),$=c.select(i),_e=[],et=[];for(const nt of $.matches){const ot=o(g,nt.value);ot.error?et.push(new DelegationError([new EscalatedCapability(g,nt.value,ot)],this)):_e.push(nt)}return{unknown:intersection$1(b.unknown,$.unknown),errors:[...et,...b.errors,...$.errors.map(nt=>new DelegationError([nt],this))],matches:[...b.matches.map(nt=>new DerivedMatch(nt,c,o)),..._e]}}toString(){return this.selected.toString()}}class AndMatch{constructor(i){this.matches=i}get selectors(){return this.matches}get source(){const i=[];for(const o of this.matches)i.push(...o.source);return Object.defineProperties(this,{source:{value:i}}),i}prune(i){const o=[];for(const s of this.matches){const c=s.prune(i);c&&o.push(c)}return o.length===0?null:new AndMatch(o)}get proofs(){const i=[];for(const{delegation:o}of this.source)i.push(o);return Object.defineProperties(this,{proofs:{value:i}}),i}get value(){const i=[];for(const o of this.matches)i.push(o.value);return Object.defineProperties(this,{value:{value:i}}),i}select(i){return selectGroup(this,i)}toString(){return`[${this.matches.map(i=>i.toString()).join(", ")}]`}}const resolveAbility=(e,i,o)=>{switch(e){case i:case"*":return i;default:return e.endsWith("/*")&&i.startsWith(e.slice(0,-1))?i:o}},resolveResource=(e,i,o)=>{switch(e){case i:case"ucan:*":return i;default:return o}},parseCapability=(e,i)=>{const{delegation:o}=i,s=i.capability;if(e.can!==s.can)return new UnknownCapability(s);const c=e.with.read(s.with);if(c.error)return new MalformedCapability(s,c);const g=e.nb.read(s.nb||{});return g.error?new MalformedCapability(s,g):new CapabilityView(e.can,c,g,o)},resolveCapability=(e,i,{capability:o,delegation:s})=>{const c=resolveAbility(o.can,i.can,null);if(c==null)return new UnknownCapability(o);const g=resolveResource(o.with,i.with,o.with),b=e.with.read(g);if(b.error)return new MalformedCapability(o,b);const $=e.nb.read({...i.nb,...o.nb});return $.error?new MalformedCapability(o,$):new CapabilityView(c,b,$,s)};class CapabilityView{constructor(i,o,s,c){this.can=i,this.with=o,this.delegation=c,this.nb=s}}const select=(e,i)=>{const o=[],s=[],c=[];for(const g of i){const b=e.match(g);if(b.error)switch(b.name){case"UnknownCapability":o.push(b.capability);break;case"MalformedCapability":default:c.push(new DelegationError([b],b.capability))}else s.push(b)}return{matches:s,errors:c,unknown:o}},selectGroup=(e,i)=>{let o;const s=[],c=[];for(const b of e.selectors){const $=b.select(i);o=o?intersection$1(o,$.unknown):$.unknown;for(const _e of $.errors)c.push(new DelegationError([_e],e));s.push($.matches)}const g=combine(s).map(b=>new AndMatch(b));return{unknown:o||[],errors:c,matches:g}},defaultDerives=(e,i)=>{if(i.with.endsWith("*")){if(!e.with.startsWith(i.with.slice(0,-1)))return new Failure(`Resource ${e.with} does not match delegated ${i.with} `)}else if(i.with!==e.with)return new Failure(`Resource ${e.with} is not contained by ${i.with}`);const o=i.nb||{},s=e.nb||{},c=entries(o);for(const[g,b]of c)if(s[g]!=b)return new Failure(`${String(g)}: ${s[g]} violates ${b}`);return!0};function equalWith(e,i){return e.with===i.with||new Failure(`Can not derive ${e.can} with ${e.with} from ${i.with}`)}const equalLink=(e,i)=>e.with!==i.with?new Failure(`Expected 'with: "${i.with}"' instead got '${e.with}'`):i.nb.link&&`${i.nb.link}`!=`${e.nb.link}`?new Failure(`Link ${e.nb.link?`${e.nb.link}`:""} violates imposed ${i.nb.link} constraint.`):!0,store=capability({can:"store/*",with:match$1({protocol:"did:"}),derives:equalWith}),add=capability({can:"store/add",with:match$1({protocol:"did:"}),nb:struct({link:Link,size:integer(),origin:optional()}),derives:(e,i)=>{const o=equalLink(e,i);return o.error?o:e.nb.size!==void 0&&i.nb.size!==void 0&&e.nb.size>i.nb.size?new Failure(`Size constraint violation: ${e.nb.size} > ${i.nb.size}`):!0}}),remove=capability({can:"store/remove",with:match$1({protocol:"did:"}),nb:struct({link:Link}),derives:equalLink}),list=capability({can:"store/list",with:match$1({protocol:"did:"}),nb:struct({cursor:string().optional(),size:integer().optional(),pre:boolean().optional()}),derives:(e,i)=>e.with!==i.with?new Failure(`Expected 'with: "${i.with}"' instead got '${e.with}'`):!0});add.or(remove).or(list);const UploaderCtx=reactExports.createContext({uploaderReady:!1});async function fetchWithRetries(e,i){for(let o=0;o<i;o++){const s=await fetch(e);if(s.ok)return s;await new Promise(c=>setTimeout(c,100))}throw new Error(`Failed to fetch ${e} after ${i} retries`)}function useUploader(e){const[{agent:i,space:o},{getProofs:s,loadAgent:c}]=index_productionExports.useKeyring(),g=Boolean(o==null?void 0:o.registered()),[b,$]=reactExports.useState(!1),[_e,et]=reactExports.useState(!1);return reactExports.useEffect(()=>{_e||(e.setRemoteBlockReader(async ct=>{const lt=await(await fetchWithRetries(`https://${ct}.ipfs.w3s.link/`,2)).arrayBuffer();return new Uint8Array(lt)}),et(!0)),g?(async()=>{if(b)return;const ct={with:o.did(),...store};ct.can="store/*";const at={issuer:i,with:ct.with,proofs:await s([ct])};e.setCarUploader(async(lt,gt)=>{await uploadCarBytes(at,lt,gt)}),$(!0)})():(async()=>{await c()})()},[o]),{uploaderReady:b}}async function uploadCarBytes(e,i,o){return await add$2(e,new Blob([o]))}function makeQueryFunctions({ready:e,database:i}){return{fetchAllLists:async()=>(e&&i.allLists?await i.allLists.query({range:["list","listx"]}):{rows:[]}).rows.map(({value:ot})=>ot),fetchListWithTodos:async nt=>{if(!e||!i.todosByList)return Promise.resolve({list:{title:"",type:"list",_id:""},todos:[]});const ot=await i.get(nt),ct=await i.todosByList.query({range:[[nt,"0"],[nt,"9"]]});return{list:ot,todos:ct.rows.map(at=>at.value)}},addList:async nt=>e&&await i.put({title:nt,type:"list"}),addTodo:async(nt,ot)=>e&&await i.put({completed:!1,title:ot,listId:nt,type:"todo",createdAt:new Date().toISOString()}),toggle:async({completed:nt,...ot})=>e&&await i.put({completed:!nt,...ot}),destroy:async({_id:nt})=>e&&await i.del(nt),updateTitle:async(nt,ot)=>(nt.title=ot,e&&await i.put(nt)),clearCompleted:async nt=>{const at=(e&&await i.todosByList.query({range:[[nt,"1"],[nt,"x"]]})).rows.map(lt=>lt.value).filter(lt=>lt.completed);for(const lt of at)await i.del(lt._id)}}}function mulberry32(e){return function(){let i=e+=1831565813;return i=Math.imul(i^i>>>15,i|1),i^=i+Math.imul(i^i>>>7,i|61),((i^i>>>14)>>>0)/4294967296}}const rand=mulberry32(1);async function loadFixtures(e){const i=(g="")=>g+rand().toString(32).slice(2),o=["Building Apps","Having Fun","Getting Groceries"],s=[["In the browser","On the phone","With or without Redux","Login components","GraphQL queries","Automatic replication and versioning"],["Rollerskating meetup","Motorcycle ride","Write a sci-fi story with ChatGPT"],["Macadamia nut milk","Avocado toast","Coffee","Bacon","Sourdough bread","Fruit salad"]];let c;for(let g=0;g<3;g++){c=await e.put({title:o[g],type:"list",_id:i(""+g)});for(let b=0;b<s[g].length;b++)await e.put({_id:i(),title:s[g][b],listId:c.id,completed:rand()>.75,type:"todo",createdAt:"2"+b})}await e.allLists.query({range:[0,1]})}const logo=""+new URL("logo-3a8a057c.svg",import.meta.url).href,AppHeader$1="",AppHeader=e=>jsx("header",{className:"app-header",children:jsx("div",{className:"app-title-wrapper",children:jsx("div",{className:"app-title-wrapper",children:jsxs("div",{className:"app-left-nav",children:[jsx(Link$2,{to:"/",children:jsx("img",{src:logo,className:"app-logo",alt:"Fireproof Storage"})}),jsx("div",{className:"app-title-text",children:jsx("h1",{className:"app-title",children:"TodoMVC"})})]})})})});let storageSupported=!1;try{storageSupported=window.localStorage&&!0}catch(e){}const STRINGARRAYSERIALIZER="#*#*#*#*#*STRINGARRAYSERIALIZER#*#*#*#*#*",noOptions={stateObserver:noop,localStorageName:void 0,controlled:!1};function useInput(e,i){const{stateObserver:o,localStorageName:s,controlled:c}=i||noOptions;let g=e;if(storageSupported&&typeof s=="string"){let nt=localStorage.getItem(s);nt&&(typeof e=="number"?g=Number(nt):Array.isArray(nt)?g=nt.split(STRINGARRAYSERIALIZER):g=nt,o&&o(g))}let[b,$]=reactExports.useState(g);const _e=nt=>{if(nt.target.type==="checkbox")throw new Error("useInput error - type=checkbox specified, this is likely a mistake by the developer. you may want useCheckInput instead");let ot=typeof e=="number"?Number(nt.target.value):nt.target.value;$(ot),storageSupported&&typeof s=="string"&&(ot!==e?localStorage.setItem(s,String(Array.isArray(ot)?ot.join(STRINGARRAYSERIALIZER):ot)):localStorage.removeItem(s)),o&&o(ot)},et=()=>$(e);return c?{onChange:_e,value:b,setValue:$,resetValue:et}:{onChange:_e,value:b}}function noop(){}function InputArea({onSubmit:e,placeholder:i,autoFocus:o=!0}){const{setValue:s,resetValue:c,...g}=useInput("",{controlled:!0});return o&&(g.autoFocus=!0),jsx("input",{className:"new-todo",placeholder:i,onKeyDown:$=>{if($.keyCode!==13)return;$.preventDefault();const _e=$.target.value.trim();_e&&(e(_e),s(""))},...g})}var classnamesExports={},classnames={get exports(){return classnamesExports},set exports(e){classnamesExports=e}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var i={}.hasOwnProperty;function o(){for(var s=[],c=0;c<arguments.length;c++){var g=arguments[c];if(g){var b=typeof g;if(b==="string"||b==="number")s.push(g);else if(Array.isArray(g)){if(g.length){var $=o.apply(null,g);$&&s.push($)}}else if(b==="object"){if(g.toString!==Object.prototype.toString&&!g.toString.toString().includes("[native code]")){s.push(g.toString());continue}for(var _e in g)i.call(g,_e)&&g[_e]&&s.push(_e)}}}return s.join(" ")}e.exports?(o.default=o,e.exports=o):window.classNames=o})()})(classnames);function TodoFooter({count:e,completedCount:i,onClearCompleted:o,nowShowing:s}){const c=e>1?"items":"item";let g=null;return i>0&&(g=jsx("button",{className:"clear-completed",onClick:o,children:"Clear completed"})),jsxs("footer",{className:"footer",children:[jsxs("span",{className:"todo-count",children:[jsx("strong",{children:e})," ",c," left"]}),jsxs("ul",{className:"filters",children:[jsx("li",{children:jsx(Link$2,{to:"",className:classnamesExports({selected:s==="all"}),children:"All"})})," ",jsx("li",{children:jsx(Link$2,{to:`${s==="active"?"../":""}active`,className:classnamesExports({selected:s==="active"}),children:"Active"})})," ",jsx("li",{children:jsx(Link$2,{to:`${s==="completed"?"../":""}completed`,className:classnamesExports({selected:s==="completed"}),children:"Completed"})})]}),g]})}const ESCAPE_KEY=27,ENTER_KEY=13;class TodoItem extends reactExports.Component{constructor(){super(...arguments);Kr(this,"state",{editText:this.props.todo.title});Kr(this,"EditFieldRef",reactExports.createRef());Kr(this,"handleSubmit",o=>{const s=this.state.editText.trim();s?(this.props.onSave(s),this.setState({editText:s})):this.props.onDestroy()});Kr(this,"handleEdit",()=>{this.props.onEdit(),this.setState({editText:this.props.todo.title})});Kr(this,"handleKeyDown",o=>{o.which===ESCAPE_KEY?(this.setState({editText:this.props.todo.title}),this.props.onCancel(o)):o.which===ENTER_KEY&&this.handleSubmit(o)});Kr(this,"handleChange",o=>{this.props.editing&&this.setState({editText:o.target.value})})}shouldComponentUpdate(o,s){return o.todo!==this.props.todo||o.editing!==this.props.editing||s.editText!==this.state.editText}componentDidUpdate(o){if(!o.editing&&this.props.editing){const s=this.EditFieldRef.current;s.focus(),s.setSelectionRange(s.value.length,s.value.length)}}render(){return jsxs("li",{className:classnamesExports({completed:this.props.todo.completed,editing:this.props.editing}),children:[jsxs("div",{className:"view",children:[jsx("input",{className:"toggle",type:"checkbox",checked:this.props.todo.completed,onChange:this.props.onToggle}),jsx("label",{onDoubleClick:this.handleEdit,children:this.props.todo.title}),jsx("button",{className:"destroy",onClick:this.props.onDestroy})]}),jsx("input",{ref:this.EditFieldRef,className:"edit",value:this.state.editText,onBlur:this.handleSubmit,onChange:this.handleChange,onKeyDown:this.handleKeyDown})]})}}const shortLink=e=>`${String(e).slice(0,4)}..${String(e).slice(-4)}`,clockLog=new Set,TimeTravel=({database:e})=>{e.clock&&e.clock.length&&clockLog.add(e.clock.toString());const i=Array.from(clockLog).reverse();return jsxs("div",{className:"timeTravel",children:[jsx("h2",{children:"Time Travel"}),jsxs("p",{children:["Click a ",jsx("b",{children:"Fireproof clock value"})," below to rollback in time."]}),jsx("p",{children:"Clock log (newest first): "}),jsx("ul",{children:i.map(o=>jsx("li",{children:jsx("button",{onClick:async()=>{await Hydrator.zoom(e,[o])},children:shortLink(o)})},o))})]})};function List(){const{ready:e,database:i,addSubscriber:o}=reactExports.useContext(FireproofCtx),{addTodo:s,toggle:c,destroy:g,clearCompleted:b,updateTitle:$}=makeQueryFunctions({ready:e,database:i});let{list:_e,todos:et}=useLoaderData();const[nt,ot]=reactExports.useState(""),ct=useRevalidator();o("List",async()=>{ct.revalidate()});const[{agent:at,space:lt},{getProofs:gt,loadAgent:wt}]=index_productionExports.useKeyring();Boolean(lt==null?void 0:lt.registered());const ft=useNavigate(),{filter:ut}=useParams(),pt=ut||"all",vt={all:et,active:et.filter(Rt=>!Rt.completed),completed:et.filter(Rt=>Rt.completed)},bt=vt[pt],Ct=Rt=>()=>ot(Rt._id),At=async()=>await b(_e._id),Pt=async Rt=>await s(_e._id,Rt);return jsxs("div",{children:[jsxs("div",{className:"listNav",children:[jsx("button",{onClick:()=>ft("/"),children:"Back to all lists"}),jsx("label",{children:_e.title})]}),jsx("ul",{className:"todo-list",children:bt.map(Rt=>{const Wt=hr=>Sr=>hr(Rt,Sr);return jsx(TodoItem,{todo:Rt,onToggle:Wt(c),onDestroy:Wt(g),onSave:Wt($),onEdit:Ct(Rt),editing:nt===Rt._id,onCancel:console.log},Rt._id)})}),jsx(InputArea,{onSubmit:Pt,placeholder:"Add a new item to your list."}),jsx(TodoFooter,{count:bt.length,completedCount:vt.completed.length,onClearCompleted:At,nowShowing:pt}),jsx("div",{className:"dbInfo",children:jsx(TimeTravel,{database:i})})]})}const threeEmptyLists=[{title:"",_id:"",type:"list"},{title:"",_id:"",type:"list"},{title:"",_id:"",type:"list"}],todoItems=({title:e,_id:i},o)=>i===""?jsx("li",{children:jsx("label",{children:" "})},i||o):jsx("li",{children:jsx("label",{children:jsx(Link$2,{to:`/list/${i}`,children:e})})},i||o);function AllLists(){const{ready:e,database:i,addSubscriber:o}=reactExports.useContext(FireproofCtx),{addList:s}=makeQueryFunctions({ready:e,database:i}),c=useRevalidator();o("AllLists",()=>{c.revalidate()});let g=useLoaderData();g.length==0&&(g=threeEmptyLists);const[{agent:b,space:$},{getProofs:_e,loadAgent:et}]=index_productionExports.useKeyring();return Boolean($==null?void 0:$.registered()),jsxs("div",{children:[jsxs("div",{className:"listNav",children:[jsx("button",{onClick:async()=>{console.log("await database.changesSince()",await i.changesSince())},children:"Choose a list."}),jsx("label",{})]}),jsx("ul",{className:"todo-list",children:g.map(todoItems)}),jsx(InputArea,{onSubmit:s,placeholder:"Create a new list or choose one"}),jsx("div",{className:"dbInfo",children:jsx(TimeTravel,{database:i})})]})}const LoadingView=()=>jsx(Layout,{children:jsxs("div",{children:[jsxs("div",{className:"listNav",children:[jsx("button",{children:"Choose a list."}),jsx("label",{})]}),jsx("section",{className:"main",children:jsxs("ul",{className:"todo-list",children:[jsx("li",{children:jsx("label",{children:" "})}),jsx("li",{children:jsx("label",{children:" "})}),jsx("li",{children:jsx("label",{children:" "})})]})}),jsx(InputArea,{placeholder:"Create a new list or choose one"})]})});function Layout({children:e}){return jsxs(Fragment,{children:[jsx(AppHeader,{}),jsx("div",{children:jsx("header",{className:"header",children:e?jsx(Fragment,{children:e}):jsx(Outlet,{})})})]})}const defineIndexes=e=>(e.allLists=new DbIndex(e,function(i,o){i.type==="list"&&o(i.type,i)}),e.todosByList=new DbIndex(e,function(i,o){i.type==="todo"&&i.listId&&o([i.listId,i.createdAt],i)}),window.fireproof=e,e);function App(){console.log("render App");const e=useFireproof(defineIndexes,loadFixtures),{fetchListWithTodos:i,fetchAllLists:o}=makeQueryFunctions(e),s=useUploader(e.database),c=async({params:{listId:_e}})=>await i(_e),g=async({params:_e})=>await o();function b(){return jsxs(Route,{element:jsx(Layout,{}),children:[jsx(Route,{path:"/",loader:g,element:jsx(AllLists,{})}),jsx(Route,{path:"list",children:jsx(Route,{path:":listId",loader:c,element:jsx(List,{}),children:jsx(Route,{path:":filter",element:jsx(List,{})})})})]})}const $=document.location.pathname.split("/list")[0]||"";return jsx(FireproofCtx.Provider,{value:e,children:jsx(index_productionExports.KeyringProvider,{children:jsx(UploaderCtx.Provider,{value:s,children:jsx(RouterProvider,{router:createBrowserRouter(createRoutesFromChildren(b()),{basename:$}),fallbackElement:jsx(LoadingView,{})})})})})}const base="",index="";client.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(App,{})}));
